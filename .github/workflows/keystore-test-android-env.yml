name: Configure Android Keystore for E2E Tests

on:
  push:

permissions:
  contents: write
  id-token: write

jobs:
  ios-e2e:
    runs-on: ubuntu-latest
    env:
      GITHUB_CI: "true"
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Setup Keystores for iOS E2E Tests
        uses: MetaMask/github-tools/.github/actions/configure-keystore@e2e-env-actions-keystore
        with:
          aws-role-to-assume: 'arn:aws:iam::722264665990:role/metamask-mobile-build-signing-certificate-manager'
          aws-region: 'us-east-2'
          platform: 'android'
          environment: 'qa'

      - name: Check keystore file and contents
        shell: bash
        run: |
          echo "üìÅ Checking keystore file at: $ANDROID_KEYSTORE_PATH"
          ls -l "$ANDROID_KEYSTORE_PATH" || echo "‚ùå Keystore file not found"

          echo "üîê Listing keystore entries..."
          keytool -list \
            -keystore "$ANDROID_KEYSTORE_PATH" \
            -storepass "$BITRISEIO_ANDROID_QA_KEYSTORE_PASSWORD" \
            -v | grep "qa" || echo "‚ö†Ô∏è No aliases found or invalid password"

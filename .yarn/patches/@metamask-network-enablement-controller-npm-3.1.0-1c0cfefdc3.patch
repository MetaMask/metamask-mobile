diff --git a/CHANGELOG.md b/CHANGELOG.md
index de65653c1460f352d57e5ddb1f43361708306afc..f9adc4f5190c907cc1358b5cba0a2eba56715893 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -7,6 +7,48 @@ and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0
 
 ## [Unreleased]
 
+## [4.1.0]
+
+### Added
+
+- Add `nativeAssetIdentifiers` state property that maps CAIP-2 chain IDs to CAIP-19-like native asset identifiers (e.g., `eip155:1/slip44:60`) ([#7609](https://github.com/MetaMask/core/pull/7609))
+- Add `initNativeAssetIdentifiers` method to populate `nativeAssetIdentifiers` state property ([#7609](https://github.com/MetaMask/core/pull/7609))
+  - This is designed to be called during controller initialization.
+- Add `Slip44Service` to look up SLIP-44 coin types by native currency symbol ([#7609](https://github.com/MetaMask/core/pull/7609))
+- Add `@metamask/slip44` dependency for SLIP-44 coin type lookups ([#7609](https://github.com/MetaMask/core/pull/7609))
+- Subscribe to `NetworkController:stateChange` to update `nativeAssetIdentifiers` when a network's native currency changes ([#7609](https://github.com/MetaMask/core/pull/7609))
+
+### Changed
+
+- Upgrade `@metamask/utils` from `^11.8.1` to `^11.9.0` ([#7511](https://github.com/MetaMask/core/pull/7511))
+- Move peer dependencies for controller and service packages to direct dependencies ([#7209](https://github.com/MetaMask/core/pull/7209), [#7220](https://github.com/MetaMask/core/pull/7220), [#7236](https://github.com/MetaMask/core/pull/7236), [#7257](https://github.com/MetaMask/core/pull/7257), [#7258](https://github.com/MetaMask/core/pull/7258), [#7289](https://github.com/MetaMask/core/pull/7289), [#7325](https://github.com/MetaMask/core/pull/7325), [#7430](https://github.com/MetaMask/core/pull/7430), [#7494](https://github.com/MetaMask/core/pull/7494), [#7534](https://github.com/MetaMask/core/pull/7534), [#7583](https://github.com/MetaMask/core/pull/7583), [#7596](https://github.com/MetaMask/core/pull/7596), [#7602](https://github.com/MetaMask/core/pull/7602), [#7604](https://github.com/MetaMask/core/pull/7604), [#7642](https://github.com/MetaMask/core/pull/7642))
+  - The dependencies moved are:
+    - `@metamask/multichain-network-controller` (^3.0.2)
+    - `@metamask/network-controller` (^29.0.0)
+    - `@metamask/transaction-controller` (^62.9.2)
+  - In clients, it is now possible for multiple versions of these packages to exist in the dependency tree.
+    - For example, this scenario would be valid: a client relies on `@metamask/controller-a` 1.0.0 and `@metamask/controller-b` 1.0.0, and `@metamask/controller-b` depends on `@metamask/controller-a` 1.1.0.
+  - Note, however, that the versions specified in the client's `package.json` always "win", and you are expected to keep them up to date so as not to break controller and service intercommunication.
+- Bump `@metamask/controller-utils` from `^11.16.0` to `^11.18.0` ([#7534](https://github.com/MetaMask/core/pull/7534), [#7583](https://github.com/MetaMask/core/pull/7583))
+
+### Fixed
+
+- Clean up Slip44Service ([#7626](https://github.com/MetaMask/core/pull/7626))
+- Add missing MegaETH to POPULARE_NETWORKS list ([#7286](https://github.com/MetaMask/core/pull/7286))
+
+## [4.0.0]
+
+### Changed
+
+- Bump `@metamask/controller-utils` from `^11.15.0` to `^11.16.0` ([#7202](https://github.com/MetaMask/core/pull/7202))
+- **BREAKING:** Bump `@metamask/transaction-controller` from `^61.0.0` to `^62.0.0` ([#7202](https://github.com/MetaMask/core/pull/7202))
+- **BREAKING:** Bump `@metamask/network-controller` from `^25.0.0` to `^26.0.0` ([#7202](https://github.com/MetaMask/core/pull/7202))
+- **BREAKING:** Bump `@metamask/multichain-network-controller` from `^2.0.0` to `^3.0.0` ([#7202](https://github.com/MetaMask/core/pull/7202))
+
+### Fixed
+
+- include additional popular networks now enabled by default ([#7014](https://github.com/MetaMask/core/pull/7014))
+
 ## [3.1.0]
 
 ### Added
@@ -150,7 +192,9 @@ and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0
 
 - Initial release ([#6028](https://github.com/MetaMask/core/pull/6028))
 
-[Unreleased]: https://github.com/MetaMask/core/compare/@metamask/network-enablement-controller@3.1.0...HEAD
+[Unreleased]: https://github.com/MetaMask/core/compare/@metamask/network-enablement-controller@4.1.0...HEAD
+[4.1.0]: https://github.com/MetaMask/core/compare/@metamask/network-enablement-controller@4.0.0...@metamask/network-enablement-controller@4.1.0
+[4.0.0]: https://github.com/MetaMask/core/compare/@metamask/network-enablement-controller@3.1.0...@metamask/network-enablement-controller@4.0.0
 [3.1.0]: https://github.com/MetaMask/core/compare/@metamask/network-enablement-controller@3.0.0...@metamask/network-enablement-controller@3.1.0
 [3.0.0]: https://github.com/MetaMask/core/compare/@metamask/network-enablement-controller@2.1.2...@metamask/network-enablement-controller@3.0.0
 [2.1.2]: https://github.com/MetaMask/core/compare/@metamask/network-enablement-controller@2.1.1...@metamask/network-enablement-controller@2.1.2
diff --git a/coverage/NetworkEnablementController.ts.html b/coverage/NetworkEnablementController.ts.html
new file mode 100644
index 0000000000000000000000000000000000000000..ad1a32ad016a594f9848d6ba43fe3a50d1035749
--- /dev/null
+++ b/coverage/NetworkEnablementController.ts.html
@@ -0,0 +1,1540 @@
+
+<!doctype html>
+<html lang="en">
+
+<head>
+    <title>Code coverage report for NetworkEnablementController.ts</title>
+    <meta charset="utf-8" />
+    <link rel="stylesheet" href="prettify.css" />
+    <link rel="stylesheet" href="base.css" />
+    <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
+    <meta name="viewport" content="width=device-width, initial-scale=1" />
+    <style type='text/css'>
+        .coverage-summary .sorter {
+            background-image: url(sort-arrow-sprite.png);
+        }
+    </style>
+</head>
+    
+<body>
+<div class='wrapper'>
+    <div class='pad1'>
+        <h1><a href="index.html">All files</a> NetworkEnablementController.ts</h1>
+        <div class='clearfix'>
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Statements</span>
+                <span class='fraction'>87/87</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Branches</span>
+                <span class='fraction'>21/21</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Functions</span>
+                <span class='fraction'>25/25</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Lines</span>
+                <span class='fraction'>86/86</span>
+            </div>
+        
+            
+        </div>
+        <p class="quiet">
+            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
+        </p>
+        <template id="filterTemplate">
+            <div class="quiet">
+                Filter:
+                <input type="search" id="fileSearch">
+            </div>
+        </template>
+    </div>
+    <div class='status-line high'></div>
+    <pre><table class="coverage">
+<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
+<a name='L2'></a><a href='#L2'>2</a>
+<a name='L3'></a><a href='#L3'>3</a>
+<a name='L4'></a><a href='#L4'>4</a>
+<a name='L5'></a><a href='#L5'>5</a>
+<a name='L6'></a><a href='#L6'>6</a>
+<a name='L7'></a><a href='#L7'>7</a>
+<a name='L8'></a><a href='#L8'>8</a>
+<a name='L9'></a><a href='#L9'>9</a>
+<a name='L10'></a><a href='#L10'>10</a>
+<a name='L11'></a><a href='#L11'>11</a>
+<a name='L12'></a><a href='#L12'>12</a>
+<a name='L13'></a><a href='#L13'>13</a>
+<a name='L14'></a><a href='#L14'>14</a>
+<a name='L15'></a><a href='#L15'>15</a>
+<a name='L16'></a><a href='#L16'>16</a>
+<a name='L17'></a><a href='#L17'>17</a>
+<a name='L18'></a><a href='#L18'>18</a>
+<a name='L19'></a><a href='#L19'>19</a>
+<a name='L20'></a><a href='#L20'>20</a>
+<a name='L21'></a><a href='#L21'>21</a>
+<a name='L22'></a><a href='#L22'>22</a>
+<a name='L23'></a><a href='#L23'>23</a>
+<a name='L24'></a><a href='#L24'>24</a>
+<a name='L25'></a><a href='#L25'>25</a>
+<a name='L26'></a><a href='#L26'>26</a>
+<a name='L27'></a><a href='#L27'>27</a>
+<a name='L28'></a><a href='#L28'>28</a>
+<a name='L29'></a><a href='#L29'>29</a>
+<a name='L30'></a><a href='#L30'>30</a>
+<a name='L31'></a><a href='#L31'>31</a>
+<a name='L32'></a><a href='#L32'>32</a>
+<a name='L33'></a><a href='#L33'>33</a>
+<a name='L34'></a><a href='#L34'>34</a>
+<a name='L35'></a><a href='#L35'>35</a>
+<a name='L36'></a><a href='#L36'>36</a>
+<a name='L37'></a><a href='#L37'>37</a>
+<a name='L38'></a><a href='#L38'>38</a>
+<a name='L39'></a><a href='#L39'>39</a>
+<a name='L40'></a><a href='#L40'>40</a>
+<a name='L41'></a><a href='#L41'>41</a>
+<a name='L42'></a><a href='#L42'>42</a>
+<a name='L43'></a><a href='#L43'>43</a>
+<a name='L44'></a><a href='#L44'>44</a>
+<a name='L45'></a><a href='#L45'>45</a>
+<a name='L46'></a><a href='#L46'>46</a>
+<a name='L47'></a><a href='#L47'>47</a>
+<a name='L48'></a><a href='#L48'>48</a>
+<a name='L49'></a><a href='#L49'>49</a>
+<a name='L50'></a><a href='#L50'>50</a>
+<a name='L51'></a><a href='#L51'>51</a>
+<a name='L52'></a><a href='#L52'>52</a>
+<a name='L53'></a><a href='#L53'>53</a>
+<a name='L54'></a><a href='#L54'>54</a>
+<a name='L55'></a><a href='#L55'>55</a>
+<a name='L56'></a><a href='#L56'>56</a>
+<a name='L57'></a><a href='#L57'>57</a>
+<a name='L58'></a><a href='#L58'>58</a>
+<a name='L59'></a><a href='#L59'>59</a>
+<a name='L60'></a><a href='#L60'>60</a>
+<a name='L61'></a><a href='#L61'>61</a>
+<a name='L62'></a><a href='#L62'>62</a>
+<a name='L63'></a><a href='#L63'>63</a>
+<a name='L64'></a><a href='#L64'>64</a>
+<a name='L65'></a><a href='#L65'>65</a>
+<a name='L66'></a><a href='#L66'>66</a>
+<a name='L67'></a><a href='#L67'>67</a>
+<a name='L68'></a><a href='#L68'>68</a>
+<a name='L69'></a><a href='#L69'>69</a>
+<a name='L70'></a><a href='#L70'>70</a>
+<a name='L71'></a><a href='#L71'>71</a>
+<a name='L72'></a><a href='#L72'>72</a>
+<a name='L73'></a><a href='#L73'>73</a>
+<a name='L74'></a><a href='#L74'>74</a>
+<a name='L75'></a><a href='#L75'>75</a>
+<a name='L76'></a><a href='#L76'>76</a>
+<a name='L77'></a><a href='#L77'>77</a>
+<a name='L78'></a><a href='#L78'>78</a>
+<a name='L79'></a><a href='#L79'>79</a>
+<a name='L80'></a><a href='#L80'>80</a>
+<a name='L81'></a><a href='#L81'>81</a>
+<a name='L82'></a><a href='#L82'>82</a>
+<a name='L83'></a><a href='#L83'>83</a>
+<a name='L84'></a><a href='#L84'>84</a>
+<a name='L85'></a><a href='#L85'>85</a>
+<a name='L86'></a><a href='#L86'>86</a>
+<a name='L87'></a><a href='#L87'>87</a>
+<a name='L88'></a><a href='#L88'>88</a>
+<a name='L89'></a><a href='#L89'>89</a>
+<a name='L90'></a><a href='#L90'>90</a>
+<a name='L91'></a><a href='#L91'>91</a>
+<a name='L92'></a><a href='#L92'>92</a>
+<a name='L93'></a><a href='#L93'>93</a>
+<a name='L94'></a><a href='#L94'>94</a>
+<a name='L95'></a><a href='#L95'>95</a>
+<a name='L96'></a><a href='#L96'>96</a>
+<a name='L97'></a><a href='#L97'>97</a>
+<a name='L98'></a><a href='#L98'>98</a>
+<a name='L99'></a><a href='#L99'>99</a>
+<a name='L100'></a><a href='#L100'>100</a>
+<a name='L101'></a><a href='#L101'>101</a>
+<a name='L102'></a><a href='#L102'>102</a>
+<a name='L103'></a><a href='#L103'>103</a>
+<a name='L104'></a><a href='#L104'>104</a>
+<a name='L105'></a><a href='#L105'>105</a>
+<a name='L106'></a><a href='#L106'>106</a>
+<a name='L107'></a><a href='#L107'>107</a>
+<a name='L108'></a><a href='#L108'>108</a>
+<a name='L109'></a><a href='#L109'>109</a>
+<a name='L110'></a><a href='#L110'>110</a>
+<a name='L111'></a><a href='#L111'>111</a>
+<a name='L112'></a><a href='#L112'>112</a>
+<a name='L113'></a><a href='#L113'>113</a>
+<a name='L114'></a><a href='#L114'>114</a>
+<a name='L115'></a><a href='#L115'>115</a>
+<a name='L116'></a><a href='#L116'>116</a>
+<a name='L117'></a><a href='#L117'>117</a>
+<a name='L118'></a><a href='#L118'>118</a>
+<a name='L119'></a><a href='#L119'>119</a>
+<a name='L120'></a><a href='#L120'>120</a>
+<a name='L121'></a><a href='#L121'>121</a>
+<a name='L122'></a><a href='#L122'>122</a>
+<a name='L123'></a><a href='#L123'>123</a>
+<a name='L124'></a><a href='#L124'>124</a>
+<a name='L125'></a><a href='#L125'>125</a>
+<a name='L126'></a><a href='#L126'>126</a>
+<a name='L127'></a><a href='#L127'>127</a>
+<a name='L128'></a><a href='#L128'>128</a>
+<a name='L129'></a><a href='#L129'>129</a>
+<a name='L130'></a><a href='#L130'>130</a>
+<a name='L131'></a><a href='#L131'>131</a>
+<a name='L132'></a><a href='#L132'>132</a>
+<a name='L133'></a><a href='#L133'>133</a>
+<a name='L134'></a><a href='#L134'>134</a>
+<a name='L135'></a><a href='#L135'>135</a>
+<a name='L136'></a><a href='#L136'>136</a>
+<a name='L137'></a><a href='#L137'>137</a>
+<a name='L138'></a><a href='#L138'>138</a>
+<a name='L139'></a><a href='#L139'>139</a>
+<a name='L140'></a><a href='#L140'>140</a>
+<a name='L141'></a><a href='#L141'>141</a>
+<a name='L142'></a><a href='#L142'>142</a>
+<a name='L143'></a><a href='#L143'>143</a>
+<a name='L144'></a><a href='#L144'>144</a>
+<a name='L145'></a><a href='#L145'>145</a>
+<a name='L146'></a><a href='#L146'>146</a>
+<a name='L147'></a><a href='#L147'>147</a>
+<a name='L148'></a><a href='#L148'>148</a>
+<a name='L149'></a><a href='#L149'>149</a>
+<a name='L150'></a><a href='#L150'>150</a>
+<a name='L151'></a><a href='#L151'>151</a>
+<a name='L152'></a><a href='#L152'>152</a>
+<a name='L153'></a><a href='#L153'>153</a>
+<a name='L154'></a><a href='#L154'>154</a>
+<a name='L155'></a><a href='#L155'>155</a>
+<a name='L156'></a><a href='#L156'>156</a>
+<a name='L157'></a><a href='#L157'>157</a>
+<a name='L158'></a><a href='#L158'>158</a>
+<a name='L159'></a><a href='#L159'>159</a>
+<a name='L160'></a><a href='#L160'>160</a>
+<a name='L161'></a><a href='#L161'>161</a>
+<a name='L162'></a><a href='#L162'>162</a>
+<a name='L163'></a><a href='#L163'>163</a>
+<a name='L164'></a><a href='#L164'>164</a>
+<a name='L165'></a><a href='#L165'>165</a>
+<a name='L166'></a><a href='#L166'>166</a>
+<a name='L167'></a><a href='#L167'>167</a>
+<a name='L168'></a><a href='#L168'>168</a>
+<a name='L169'></a><a href='#L169'>169</a>
+<a name='L170'></a><a href='#L170'>170</a>
+<a name='L171'></a><a href='#L171'>171</a>
+<a name='L172'></a><a href='#L172'>172</a>
+<a name='L173'></a><a href='#L173'>173</a>
+<a name='L174'></a><a href='#L174'>174</a>
+<a name='L175'></a><a href='#L175'>175</a>
+<a name='L176'></a><a href='#L176'>176</a>
+<a name='L177'></a><a href='#L177'>177</a>
+<a name='L178'></a><a href='#L178'>178</a>
+<a name='L179'></a><a href='#L179'>179</a>
+<a name='L180'></a><a href='#L180'>180</a>
+<a name='L181'></a><a href='#L181'>181</a>
+<a name='L182'></a><a href='#L182'>182</a>
+<a name='L183'></a><a href='#L183'>183</a>
+<a name='L184'></a><a href='#L184'>184</a>
+<a name='L185'></a><a href='#L185'>185</a>
+<a name='L186'></a><a href='#L186'>186</a>
+<a name='L187'></a><a href='#L187'>187</a>
+<a name='L188'></a><a href='#L188'>188</a>
+<a name='L189'></a><a href='#L189'>189</a>
+<a name='L190'></a><a href='#L190'>190</a>
+<a name='L191'></a><a href='#L191'>191</a>
+<a name='L192'></a><a href='#L192'>192</a>
+<a name='L193'></a><a href='#L193'>193</a>
+<a name='L194'></a><a href='#L194'>194</a>
+<a name='L195'></a><a href='#L195'>195</a>
+<a name='L196'></a><a href='#L196'>196</a>
+<a name='L197'></a><a href='#L197'>197</a>
+<a name='L198'></a><a href='#L198'>198</a>
+<a name='L199'></a><a href='#L199'>199</a>
+<a name='L200'></a><a href='#L200'>200</a>
+<a name='L201'></a><a href='#L201'>201</a>
+<a name='L202'></a><a href='#L202'>202</a>
+<a name='L203'></a><a href='#L203'>203</a>
+<a name='L204'></a><a href='#L204'>204</a>
+<a name='L205'></a><a href='#L205'>205</a>
+<a name='L206'></a><a href='#L206'>206</a>
+<a name='L207'></a><a href='#L207'>207</a>
+<a name='L208'></a><a href='#L208'>208</a>
+<a name='L209'></a><a href='#L209'>209</a>
+<a name='L210'></a><a href='#L210'>210</a>
+<a name='L211'></a><a href='#L211'>211</a>
+<a name='L212'></a><a href='#L212'>212</a>
+<a name='L213'></a><a href='#L213'>213</a>
+<a name='L214'></a><a href='#L214'>214</a>
+<a name='L215'></a><a href='#L215'>215</a>
+<a name='L216'></a><a href='#L216'>216</a>
+<a name='L217'></a><a href='#L217'>217</a>
+<a name='L218'></a><a href='#L218'>218</a>
+<a name='L219'></a><a href='#L219'>219</a>
+<a name='L220'></a><a href='#L220'>220</a>
+<a name='L221'></a><a href='#L221'>221</a>
+<a name='L222'></a><a href='#L222'>222</a>
+<a name='L223'></a><a href='#L223'>223</a>
+<a name='L224'></a><a href='#L224'>224</a>
+<a name='L225'></a><a href='#L225'>225</a>
+<a name='L226'></a><a href='#L226'>226</a>
+<a name='L227'></a><a href='#L227'>227</a>
+<a name='L228'></a><a href='#L228'>228</a>
+<a name='L229'></a><a href='#L229'>229</a>
+<a name='L230'></a><a href='#L230'>230</a>
+<a name='L231'></a><a href='#L231'>231</a>
+<a name='L232'></a><a href='#L232'>232</a>
+<a name='L233'></a><a href='#L233'>233</a>
+<a name='L234'></a><a href='#L234'>234</a>
+<a name='L235'></a><a href='#L235'>235</a>
+<a name='L236'></a><a href='#L236'>236</a>
+<a name='L237'></a><a href='#L237'>237</a>
+<a name='L238'></a><a href='#L238'>238</a>
+<a name='L239'></a><a href='#L239'>239</a>
+<a name='L240'></a><a href='#L240'>240</a>
+<a name='L241'></a><a href='#L241'>241</a>
+<a name='L242'></a><a href='#L242'>242</a>
+<a name='L243'></a><a href='#L243'>243</a>
+<a name='L244'></a><a href='#L244'>244</a>
+<a name='L245'></a><a href='#L245'>245</a>
+<a name='L246'></a><a href='#L246'>246</a>
+<a name='L247'></a><a href='#L247'>247</a>
+<a name='L248'></a><a href='#L248'>248</a>
+<a name='L249'></a><a href='#L249'>249</a>
+<a name='L250'></a><a href='#L250'>250</a>
+<a name='L251'></a><a href='#L251'>251</a>
+<a name='L252'></a><a href='#L252'>252</a>
+<a name='L253'></a><a href='#L253'>253</a>
+<a name='L254'></a><a href='#L254'>254</a>
+<a name='L255'></a><a href='#L255'>255</a>
+<a name='L256'></a><a href='#L256'>256</a>
+<a name='L257'></a><a href='#L257'>257</a>
+<a name='L258'></a><a href='#L258'>258</a>
+<a name='L259'></a><a href='#L259'>259</a>
+<a name='L260'></a><a href='#L260'>260</a>
+<a name='L261'></a><a href='#L261'>261</a>
+<a name='L262'></a><a href='#L262'>262</a>
+<a name='L263'></a><a href='#L263'>263</a>
+<a name='L264'></a><a href='#L264'>264</a>
+<a name='L265'></a><a href='#L265'>265</a>
+<a name='L266'></a><a href='#L266'>266</a>
+<a name='L267'></a><a href='#L267'>267</a>
+<a name='L268'></a><a href='#L268'>268</a>
+<a name='L269'></a><a href='#L269'>269</a>
+<a name='L270'></a><a href='#L270'>270</a>
+<a name='L271'></a><a href='#L271'>271</a>
+<a name='L272'></a><a href='#L272'>272</a>
+<a name='L273'></a><a href='#L273'>273</a>
+<a name='L274'></a><a href='#L274'>274</a>
+<a name='L275'></a><a href='#L275'>275</a>
+<a name='L276'></a><a href='#L276'>276</a>
+<a name='L277'></a><a href='#L277'>277</a>
+<a name='L278'></a><a href='#L278'>278</a>
+<a name='L279'></a><a href='#L279'>279</a>
+<a name='L280'></a><a href='#L280'>280</a>
+<a name='L281'></a><a href='#L281'>281</a>
+<a name='L282'></a><a href='#L282'>282</a>
+<a name='L283'></a><a href='#L283'>283</a>
+<a name='L284'></a><a href='#L284'>284</a>
+<a name='L285'></a><a href='#L285'>285</a>
+<a name='L286'></a><a href='#L286'>286</a>
+<a name='L287'></a><a href='#L287'>287</a>
+<a name='L288'></a><a href='#L288'>288</a>
+<a name='L289'></a><a href='#L289'>289</a>
+<a name='L290'></a><a href='#L290'>290</a>
+<a name='L291'></a><a href='#L291'>291</a>
+<a name='L292'></a><a href='#L292'>292</a>
+<a name='L293'></a><a href='#L293'>293</a>
+<a name='L294'></a><a href='#L294'>294</a>
+<a name='L295'></a><a href='#L295'>295</a>
+<a name='L296'></a><a href='#L296'>296</a>
+<a name='L297'></a><a href='#L297'>297</a>
+<a name='L298'></a><a href='#L298'>298</a>
+<a name='L299'></a><a href='#L299'>299</a>
+<a name='L300'></a><a href='#L300'>300</a>
+<a name='L301'></a><a href='#L301'>301</a>
+<a name='L302'></a><a href='#L302'>302</a>
+<a name='L303'></a><a href='#L303'>303</a>
+<a name='L304'></a><a href='#L304'>304</a>
+<a name='L305'></a><a href='#L305'>305</a>
+<a name='L306'></a><a href='#L306'>306</a>
+<a name='L307'></a><a href='#L307'>307</a>
+<a name='L308'></a><a href='#L308'>308</a>
+<a name='L309'></a><a href='#L309'>309</a>
+<a name='L310'></a><a href='#L310'>310</a>
+<a name='L311'></a><a href='#L311'>311</a>
+<a name='L312'></a><a href='#L312'>312</a>
+<a name='L313'></a><a href='#L313'>313</a>
+<a name='L314'></a><a href='#L314'>314</a>
+<a name='L315'></a><a href='#L315'>315</a>
+<a name='L316'></a><a href='#L316'>316</a>
+<a name='L317'></a><a href='#L317'>317</a>
+<a name='L318'></a><a href='#L318'>318</a>
+<a name='L319'></a><a href='#L319'>319</a>
+<a name='L320'></a><a href='#L320'>320</a>
+<a name='L321'></a><a href='#L321'>321</a>
+<a name='L322'></a><a href='#L322'>322</a>
+<a name='L323'></a><a href='#L323'>323</a>
+<a name='L324'></a><a href='#L324'>324</a>
+<a name='L325'></a><a href='#L325'>325</a>
+<a name='L326'></a><a href='#L326'>326</a>
+<a name='L327'></a><a href='#L327'>327</a>
+<a name='L328'></a><a href='#L328'>328</a>
+<a name='L329'></a><a href='#L329'>329</a>
+<a name='L330'></a><a href='#L330'>330</a>
+<a name='L331'></a><a href='#L331'>331</a>
+<a name='L332'></a><a href='#L332'>332</a>
+<a name='L333'></a><a href='#L333'>333</a>
+<a name='L334'></a><a href='#L334'>334</a>
+<a name='L335'></a><a href='#L335'>335</a>
+<a name='L336'></a><a href='#L336'>336</a>
+<a name='L337'></a><a href='#L337'>337</a>
+<a name='L338'></a><a href='#L338'>338</a>
+<a name='L339'></a><a href='#L339'>339</a>
+<a name='L340'></a><a href='#L340'>340</a>
+<a name='L341'></a><a href='#L341'>341</a>
+<a name='L342'></a><a href='#L342'>342</a>
+<a name='L343'></a><a href='#L343'>343</a>
+<a name='L344'></a><a href='#L344'>344</a>
+<a name='L345'></a><a href='#L345'>345</a>
+<a name='L346'></a><a href='#L346'>346</a>
+<a name='L347'></a><a href='#L347'>347</a>
+<a name='L348'></a><a href='#L348'>348</a>
+<a name='L349'></a><a href='#L349'>349</a>
+<a name='L350'></a><a href='#L350'>350</a>
+<a name='L351'></a><a href='#L351'>351</a>
+<a name='L352'></a><a href='#L352'>352</a>
+<a name='L353'></a><a href='#L353'>353</a>
+<a name='L354'></a><a href='#L354'>354</a>
+<a name='L355'></a><a href='#L355'>355</a>
+<a name='L356'></a><a href='#L356'>356</a>
+<a name='L357'></a><a href='#L357'>357</a>
+<a name='L358'></a><a href='#L358'>358</a>
+<a name='L359'></a><a href='#L359'>359</a>
+<a name='L360'></a><a href='#L360'>360</a>
+<a name='L361'></a><a href='#L361'>361</a>
+<a name='L362'></a><a href='#L362'>362</a>
+<a name='L363'></a><a href='#L363'>363</a>
+<a name='L364'></a><a href='#L364'>364</a>
+<a name='L365'></a><a href='#L365'>365</a>
+<a name='L366'></a><a href='#L366'>366</a>
+<a name='L367'></a><a href='#L367'>367</a>
+<a name='L368'></a><a href='#L368'>368</a>
+<a name='L369'></a><a href='#L369'>369</a>
+<a name='L370'></a><a href='#L370'>370</a>
+<a name='L371'></a><a href='#L371'>371</a>
+<a name='L372'></a><a href='#L372'>372</a>
+<a name='L373'></a><a href='#L373'>373</a>
+<a name='L374'></a><a href='#L374'>374</a>
+<a name='L375'></a><a href='#L375'>375</a>
+<a name='L376'></a><a href='#L376'>376</a>
+<a name='L377'></a><a href='#L377'>377</a>
+<a name='L378'></a><a href='#L378'>378</a>
+<a name='L379'></a><a href='#L379'>379</a>
+<a name='L380'></a><a href='#L380'>380</a>
+<a name='L381'></a><a href='#L381'>381</a>
+<a name='L382'></a><a href='#L382'>382</a>
+<a name='L383'></a><a href='#L383'>383</a>
+<a name='L384'></a><a href='#L384'>384</a>
+<a name='L385'></a><a href='#L385'>385</a>
+<a name='L386'></a><a href='#L386'>386</a>
+<a name='L387'></a><a href='#L387'>387</a>
+<a name='L388'></a><a href='#L388'>388</a>
+<a name='L389'></a><a href='#L389'>389</a>
+<a name='L390'></a><a href='#L390'>390</a>
+<a name='L391'></a><a href='#L391'>391</a>
+<a name='L392'></a><a href='#L392'>392</a>
+<a name='L393'></a><a href='#L393'>393</a>
+<a name='L394'></a><a href='#L394'>394</a>
+<a name='L395'></a><a href='#L395'>395</a>
+<a name='L396'></a><a href='#L396'>396</a>
+<a name='L397'></a><a href='#L397'>397</a>
+<a name='L398'></a><a href='#L398'>398</a>
+<a name='L399'></a><a href='#L399'>399</a>
+<a name='L400'></a><a href='#L400'>400</a>
+<a name='L401'></a><a href='#L401'>401</a>
+<a name='L402'></a><a href='#L402'>402</a>
+<a name='L403'></a><a href='#L403'>403</a>
+<a name='L404'></a><a href='#L404'>404</a>
+<a name='L405'></a><a href='#L405'>405</a>
+<a name='L406'></a><a href='#L406'>406</a>
+<a name='L407'></a><a href='#L407'>407</a>
+<a name='L408'></a><a href='#L408'>408</a>
+<a name='L409'></a><a href='#L409'>409</a>
+<a name='L410'></a><a href='#L410'>410</a>
+<a name='L411'></a><a href='#L411'>411</a>
+<a name='L412'></a><a href='#L412'>412</a>
+<a name='L413'></a><a href='#L413'>413</a>
+<a name='L414'></a><a href='#L414'>414</a>
+<a name='L415'></a><a href='#L415'>415</a>
+<a name='L416'></a><a href='#L416'>416</a>
+<a name='L417'></a><a href='#L417'>417</a>
+<a name='L418'></a><a href='#L418'>418</a>
+<a name='L419'></a><a href='#L419'>419</a>
+<a name='L420'></a><a href='#L420'>420</a>
+<a name='L421'></a><a href='#L421'>421</a>
+<a name='L422'></a><a href='#L422'>422</a>
+<a name='L423'></a><a href='#L423'>423</a>
+<a name='L424'></a><a href='#L424'>424</a>
+<a name='L425'></a><a href='#L425'>425</a>
+<a name='L426'></a><a href='#L426'>426</a>
+<a name='L427'></a><a href='#L427'>427</a>
+<a name='L428'></a><a href='#L428'>428</a>
+<a name='L429'></a><a href='#L429'>429</a>
+<a name='L430'></a><a href='#L430'>430</a>
+<a name='L431'></a><a href='#L431'>431</a>
+<a name='L432'></a><a href='#L432'>432</a>
+<a name='L433'></a><a href='#L433'>433</a>
+<a name='L434'></a><a href='#L434'>434</a>
+<a name='L435'></a><a href='#L435'>435</a>
+<a name='L436'></a><a href='#L436'>436</a>
+<a name='L437'></a><a href='#L437'>437</a>
+<a name='L438'></a><a href='#L438'>438</a>
+<a name='L439'></a><a href='#L439'>439</a>
+<a name='L440'></a><a href='#L440'>440</a>
+<a name='L441'></a><a href='#L441'>441</a>
+<a name='L442'></a><a href='#L442'>442</a>
+<a name='L443'></a><a href='#L443'>443</a>
+<a name='L444'></a><a href='#L444'>444</a>
+<a name='L445'></a><a href='#L445'>445</a>
+<a name='L446'></a><a href='#L446'>446</a>
+<a name='L447'></a><a href='#L447'>447</a>
+<a name='L448'></a><a href='#L448'>448</a>
+<a name='L449'></a><a href='#L449'>449</a>
+<a name='L450'></a><a href='#L450'>450</a>
+<a name='L451'></a><a href='#L451'>451</a>
+<a name='L452'></a><a href='#L452'>452</a>
+<a name='L453'></a><a href='#L453'>453</a>
+<a name='L454'></a><a href='#L454'>454</a>
+<a name='L455'></a><a href='#L455'>455</a>
+<a name='L456'></a><a href='#L456'>456</a>
+<a name='L457'></a><a href='#L457'>457</a>
+<a name='L458'></a><a href='#L458'>458</a>
+<a name='L459'></a><a href='#L459'>459</a>
+<a name='L460'></a><a href='#L460'>460</a>
+<a name='L461'></a><a href='#L461'>461</a>
+<a name='L462'></a><a href='#L462'>462</a>
+<a name='L463'></a><a href='#L463'>463</a>
+<a name='L464'></a><a href='#L464'>464</a>
+<a name='L465'></a><a href='#L465'>465</a>
+<a name='L466'></a><a href='#L466'>466</a>
+<a name='L467'></a><a href='#L467'>467</a>
+<a name='L468'></a><a href='#L468'>468</a>
+<a name='L469'></a><a href='#L469'>469</a>
+<a name='L470'></a><a href='#L470'>470</a>
+<a name='L471'></a><a href='#L471'>471</a>
+<a name='L472'></a><a href='#L472'>472</a>
+<a name='L473'></a><a href='#L473'>473</a>
+<a name='L474'></a><a href='#L474'>474</a>
+<a name='L475'></a><a href='#L475'>475</a>
+<a name='L476'></a><a href='#L476'>476</a>
+<a name='L477'></a><a href='#L477'>477</a>
+<a name='L478'></a><a href='#L478'>478</a>
+<a name='L479'></a><a href='#L479'>479</a>
+<a name='L480'></a><a href='#L480'>480</a>
+<a name='L481'></a><a href='#L481'>481</a>
+<a name='L482'></a><a href='#L482'>482</a>
+<a name='L483'></a><a href='#L483'>483</a>
+<a name='L484'></a><a href='#L484'>484</a>
+<a name='L485'></a><a href='#L485'>485</a>
+<a name='L486'></a><a href='#L486'>486</a></td><td class="line-coverage quiet"><span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">47x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">47x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">47x</span>
+<span class="cline-any cline-yes">7x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">47x</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">47x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">16x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">15x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">15x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">14x</span>
+<span class="cline-any cline-yes">44x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">14x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-yes">48x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">48x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">18x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">18x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">11x</span>
+<span class="cline-any cline-yes">11x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">8x</span>
+<span class="cline-any cline-yes">8x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">60x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">60x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">11x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">22x</span>
+<span class="cline-any cline-yes">21x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">21x</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">17x</span>
+<span class="cline-any cline-yes">17x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">104x</span>
+<span class="cline-any cline-yes">101x</span>
+<span class="cline-any cline-yes">101x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">48x</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">7x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">7x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">7x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">7x</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">15x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">7x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import { BaseController } from '@metamask/base-controller';
+import type {
+  ControllerGetStateAction,
+  ControllerStateChangeEvent,
+  RestrictedMessenger,
+} from '@metamask/base-controller';
+import { BuiltInNetworkName, ChainId } from '@metamask/controller-utils';
+import type { MultichainNetworkControllerGetStateAction } from '@metamask/multichain-network-controller';
+import type {
+  NetworkControllerGetStateAction,
+  NetworkControllerNetworkAddedEvent,
+  NetworkControllerNetworkRemovedEvent,
+  NetworkControllerStateChangeEvent,
+} from '@metamask/network-controller';
+import type { TransactionControllerTransactionSubmittedEvent } from '@metamask/transaction-controller';
+import type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';
+import { KnownCaipNamespace } from '@metamask/utils';
+&nbsp;
+import { POPULAR_NETWORKS } from './constants';
+import { BtcScope, SolScope } from './types';
+import {
+  deriveKeys,
+  isOnlyNetworkEnabledInNamespace,
+  isPopularNetwork,
+} from './utils';
+&nbsp;
+const controllerName = 'NetworkEnablementController';
+&nbsp;
+/**
+ * Information about an ordered network.
+ */
+export type NetworksInfo = {
+  /**
+   * The network's chain id
+   */
+  networkId: CaipChainId;
+};
+&nbsp;
+/**
+ * A map of enabled networks by CAIP namespace and chain ID.
+ * For EIP-155 networks, the keys are Hex chain IDs.
+ * For other networks, the keys are CAIP chain IDs.
+ */
+type EnabledMap = Record&lt;CaipNamespace, Record&lt;CaipChainId | Hex, boolean&gt;&gt;;
+&nbsp;
+// State shape for NetworkEnablementController
+export type NetworkEnablementControllerState = {
+  enabledNetworkMap: EnabledMap;
+};
+&nbsp;
+export type NetworkEnablementControllerGetStateAction =
+  ControllerGetStateAction&lt;
+    typeof controllerName,
+    NetworkEnablementControllerState
+  &gt;;
+&nbsp;
+export type NetworkEnablementControllerSetEnabledNetworksAction = {
+  type: `${typeof controllerName}:enableNetwork`;
+  handler: NetworkEnablementController['enableNetwork'];
+};
+&nbsp;
+export type NetworkEnablementControllerDisableNetworkAction = {
+  type: `${typeof controllerName}:disableNetwork`;
+  handler: NetworkEnablementController['disableNetwork'];
+};
+&nbsp;
+/**
+ * All actions that {@link NetworkEnablementController} calls internally.
+ */
+export type AllowedActions =
+  | NetworkControllerGetStateAction
+  | MultichainNetworkControllerGetStateAction;
+&nbsp;
+export type NetworkEnablementControllerActions =
+  | NetworkEnablementControllerGetStateAction
+  | NetworkEnablementControllerSetEnabledNetworksAction
+  | NetworkEnablementControllerDisableNetworkAction;
+&nbsp;
+export type NetworkEnablementControllerStateChangeEvent =
+  ControllerStateChangeEvent&lt;
+    typeof controllerName,
+    NetworkEnablementControllerState
+  &gt;;
+&nbsp;
+export type NetworkEnablementControllerEvents =
+  NetworkEnablementControllerStateChangeEvent;
+&nbsp;
+/**
+ * All events that {@link NetworkEnablementController} subscribes to internally.
+ */
+export type AllowedEvents =
+  | NetworkControllerNetworkAddedEvent
+  | NetworkControllerNetworkRemovedEvent
+  | NetworkControllerStateChangeEvent
+  | TransactionControllerTransactionSubmittedEvent;
+&nbsp;
+export type NetworkEnablementControllerMessenger = RestrictedMessenger&lt;
+  typeof controllerName,
+  NetworkEnablementControllerActions | AllowedActions,
+  NetworkEnablementControllerEvents | AllowedEvents,
+  AllowedActions['type'],
+  AllowedEvents['type']
+&gt;;
+&nbsp;
+/**
+ * Gets the default state for the NetworkEnablementController.
+ *
+ * @returns The default state with pre-enabled networks.
+ */
+const getDefaultNetworkEnablementControllerState =
+  (): NetworkEnablementControllerState =&gt; ({
+    enabledNetworkMap: {
+      [KnownCaipNamespace.Eip155]: {
+        [ChainId[BuiltInNetworkName.Mainnet]]: true,
+        [ChainId[BuiltInNetworkName.LineaMainnet]]: true,
+        [ChainId[BuiltInNetworkName.BaseMainnet]]: true,
+      },
+      [KnownCaipNamespace.Solana]: {
+        [SolScope.Mainnet]: true,
+      },
+      [KnownCaipNamespace.Bip122]: {
+        [BtcScope.Mainnet]: true,
+        [BtcScope.Testnet]: false,
+        [BtcScope.Signet]: false,
+      },
+    },
+  });
+&nbsp;
+// Metadata for the controller state
+const metadata = {
+  enabledNetworkMap: {
+    persist: true,
+    anonymous: true,
+  },
+};
+&nbsp;
+/**
+ * Controller responsible for managing network enablement state across different blockchain networks.
+ *
+ * This controller tracks which networks are enabled/disabled for the user and provides methods
+ * to toggle network states. It supports both EVM (EIP-155) and non-EVM networks like Solana.
+ *
+ * The controller maintains a map of enabled networks organized by namespace (e.g., 'eip155', 'solana')
+ * and provides methods to query and modify network enablement states.
+ */
+export class NetworkEnablementController extends BaseController&lt;
+  typeof controllerName,
+  NetworkEnablementControllerState,
+  NetworkEnablementControllerMessenger
+&gt; {
+  /**
+   * Creates a NetworkEnablementController instance.
+   *
+   * @param args - The arguments to this function.
+   * @param args.messenger - Messenger used to communicate with BaseV2 controller.
+   * @param args.state - Initial state to set on this controller.
+   */
+  constructor({
+    messenger,
+    state,
+  }: {
+    messenger: NetworkEnablementControllerMessenger;
+    state?: Partial&lt;NetworkEnablementControllerState&gt;;
+  }) {
+    super({
+      messenger,
+      metadata,
+      name: controllerName,
+      state: {
+        ...getDefaultNetworkEnablementControllerState(),
+        ...state,
+      },
+    });
+&nbsp;
+    messenger.subscribe('NetworkController:networkAdded', ({ chainId }) =&gt; {
+      this.#onAddNetwork(chainId);
+    });
+&nbsp;
+    messenger.subscribe('NetworkController:networkRemoved', ({ chainId }) =&gt; {
+      this.#removeNetworkEntry(chainId);
+    });
+&nbsp;
+    // Listen for confirmed staking transactions
+    messenger.subscribe(
+      'TransactionController:transactionSubmitted',
+      (transactionMeta) =&gt; {
+        if (transactionMeta?.transactionMeta?.chainId) {
+          this.enableNetwork(
+            transactionMeta.transactionMeta.chainId as Hex | CaipChainId,
+          );
+        }
+      },
+    );
+  }
+&nbsp;
+  /**
+   * Enables or disables a network for the user.
+   *
+   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID
+   * (for any blockchain network). The method will automatically convert Hex chain IDs
+   * to CAIP-2 format internally. This dual parameter support allows for backward
+   * compatibility with existing EVM chain ID formats while supporting newer
+   * multi-chain standards.
+   *
+   * When enabling a non-popular network, this method will disable all other networks
+   * to ensure only one network is active at a time (exclusive mode).
+   *
+   * @param chainId - The chain ID of the network to enable or disable. Can be either:
+   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks
+   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)
+   */
+  enableNetwork(chainId: Hex | CaipChainId): void {
+    const { namespace, storageKey } = deriveKeys(chainId);
+&nbsp;
+    this.update((s) =&gt; {
+      // if the namespace bucket does not exist, return
+      // new nemespace are added only when a new network is added
+      if (!s.enabledNetworkMap[namespace]) {
+        return;
+      }
+&nbsp;
+      // disable all networks in the same namespace
+      Object.keys(s.enabledNetworkMap[namespace]).forEach((key) =&gt; {
+        s.enabledNetworkMap[namespace][key as CaipChainId | Hex] = false;
+      });
+&nbsp;
+      // enable the network
+      s.enabledNetworkMap[namespace][storageKey] = true;
+    });
+  }
+&nbsp;
+  /**
+   * Enables all popular networks and Solana mainnet.
+   *
+   * This method enables all networks defined in POPULAR_NETWORKS (EVM networks)
+   * and Solana mainnet. Unlike the enableNetwork method which has exclusive behavior,
+   * this method enables multiple networks across namespaces simultaneously.
+   *
+   * Popular networks that don't exist in NetworkController or MultichainNetworkController configurations will be skipped silently.
+   */
+  enableAllPopularNetworks(): void {
+    this.update((s) =&gt; {
+      // Get current network configurations to check if networks exist
+      const networkControllerState = this.messagingSystem.call(
+        'NetworkController:getState',
+      );
+      const multichainState = this.messagingSystem.call(
+        'MultichainNetworkController:getState',
+      );
+&nbsp;
+      // Enable all popular EVM networks that exist in NetworkController configurations
+      POPULAR_NETWORKS.forEach((chainId) =&gt; {
+        const { namespace, storageKey } = deriveKeys(chainId as Hex);
+&nbsp;
+        // Check if network exists in NetworkController configurations
+        if (
+          networkControllerState.networkConfigurationsByChainId[chainId as Hex]
+        ) {
+          // Ensure namespace bucket exists
+          this.#ensureNamespaceBucket(s, namespace);
+          // Enable the network
+          s.enabledNetworkMap[namespace][storageKey] = true;
+        }
+      });
+&nbsp;
+      // Enable Solana mainnet if it exists in MultichainNetworkController configurations
+      const solanaKeys = deriveKeys(SolScope.Mainnet as CaipChainId);
+      if (
+        multichainState.multichainNetworkConfigurationsByChainId[
+          SolScope.Mainnet
+        ]
+      ) {
+        // Ensure namespace bucket exists
+        this.#ensureNamespaceBucket(s, solanaKeys.namespace);
+        // Enable Solana mainnet
+        s.enabledNetworkMap[solanaKeys.namespace][solanaKeys.storageKey] = true;
+      }
+&nbsp;
+      // Enable Bitcoin mainnet if it exists in MultichainNetworkController configurations
+      const bitcoinKeys = deriveKeys(BtcScope.Mainnet as CaipChainId);
+      if (
+        multichainState.multichainNetworkConfigurationsByChainId[
+          BtcScope.Mainnet
+        ]
+      ) {
+        // Ensure namespace bucket exists
+        this.#ensureNamespaceBucket(s, bitcoinKeys.namespace);
+        // Enable Bitcoin mainnet
+        s.enabledNetworkMap[bitcoinKeys.namespace][bitcoinKeys.storageKey] =
+          true;
+      }
+    });
+  }
+&nbsp;
+  /**
+   * Initializes the network enablement state from network controller configurations.
+   *
+   * This method reads the current network configurations from both NetworkController
+   * and MultichainNetworkController and initializes the enabled network map accordingly.
+   * It ensures proper namespace buckets exist for all configured networks and enables
+   * popular networks by default.
+   *
+   * This method should be called after the NetworkController and MultichainNetworkController
+   * have been initialized and their configurations are available.
+   */
+  init(): void {
+    this.update((s) =&gt; {
+      // Get network configurations from NetworkController (EVM networks)
+      const networkControllerState = this.messagingSystem.call(
+        'NetworkController:getState',
+      );
+&nbsp;
+      // Get network configurations from MultichainNetworkController (all networks)
+      const multichainState = this.messagingSystem.call(
+        'MultichainNetworkController:getState',
+      );
+&nbsp;
+      // Initialize namespace buckets for EVM networks from NetworkController
+      Object.keys(
+        networkControllerState.networkConfigurationsByChainId,
+      ).forEach((chainId) =&gt; {
+        const { namespace } = deriveKeys(chainId as Hex);
+        this.#ensureNamespaceBucket(s, namespace);
+      });
+&nbsp;
+      // Initialize namespace buckets for all networks from MultichainNetworkController
+      Object.keys(
+        multichainState.multichainNetworkConfigurationsByChainId,
+      ).forEach((chainId) =&gt; {
+        const { namespace } = deriveKeys(chainId as CaipChainId);
+        this.#ensureNamespaceBucket(s, namespace);
+      });
+&nbsp;
+      // Enable popular networks that exist in the configurations
+      POPULAR_NETWORKS.forEach((chainId) =&gt; {
+        const { namespace, storageKey } = deriveKeys(chainId as Hex);
+&nbsp;
+        // Check if network exists in NetworkController configurations
+        if (
+          s.enabledNetworkMap[namespace] &amp;&amp;
+          networkControllerState.networkConfigurationsByChainId[chainId as Hex]
+        ) {
+          s.enabledNetworkMap[namespace][storageKey] = true;
+        }
+      });
+&nbsp;
+      // Enable Solana mainnet if it exists in configurations
+      const solanaKeys = deriveKeys(SolScope.Mainnet as CaipChainId);
+      if (
+        s.enabledNetworkMap[solanaKeys.namespace] &amp;&amp;
+        multichainState.multichainNetworkConfigurationsByChainId[
+          SolScope.Mainnet
+        ]
+      ) {
+        s.enabledNetworkMap[solanaKeys.namespace][solanaKeys.storageKey] = true;
+      }
+&nbsp;
+      // Enable Bitcoin mainnet if it exists in configurations
+      const bitcoinKeys = deriveKeys(BtcScope.Mainnet as CaipChainId);
+      if (
+        s.enabledNetworkMap[bitcoinKeys.namespace] &amp;&amp;
+        multichainState.multichainNetworkConfigurationsByChainId[
+          BtcScope.Mainnet
+        ]
+      ) {
+        s.enabledNetworkMap[bitcoinKeys.namespace][bitcoinKeys.storageKey] =
+          true;
+      }
+    });
+  }
+&nbsp;
+  /**
+   * Disables a network for the user.
+   *
+   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID
+   * (for any blockchain network). The method will automatically convert Hex chain IDs
+   * to CAIP-2 format internally.
+   *
+   * Note: This method will prevent disabling the last remaining enabled network
+   * to ensure at least one network is always available.
+   *
+   * @param chainId - The chain ID of the network to disable. Can be either:
+   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks
+   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)
+   */
+  disableNetwork(chainId: Hex | CaipChainId): void {
+    const derivedKeys = deriveKeys(chainId);
+    const { namespace, storageKey } = derivedKeys;
+&nbsp;
+    if (isOnlyNetworkEnabledInNamespace(this.state, derivedKeys)) {
+      throw new Error('Cannot disable the last remaining enabled network');
+    }
+&nbsp;
+    this.update((s) =&gt; {
+      s.enabledNetworkMap[namespace][storageKey] = false;
+    });
+  }
+&nbsp;
+  /**
+   * Checks if a network is enabled.
+   *
+   * @param chainId - The chain ID of the network to check. Can be either:
+   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks
+   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)
+   * @returns True if the network is enabled, false otherwise
+   */
+  isNetworkEnabled(chainId: Hex | CaipChainId): boolean {
+    const derivedKeys = deriveKeys(chainId);
+    const { namespace, storageKey } = derivedKeys;
+    return this.state.enabledNetworkMap[namespace]?.[storageKey] ?? false;
+  }
+&nbsp;
+  /**
+   * Ensures that a namespace bucket exists in the state.
+   *
+   * This method creates the namespace entry in the enabledNetworkMap if it doesn't
+   * already exist. This is used to prepare the state structure before adding
+   * network entries.
+   *
+   * @param state - The current controller state
+   * @param ns - The CAIP namespace to ensure exists
+   */
+  #ensureNamespaceBucket(
+    state: NetworkEnablementControllerState,
+    ns: CaipNamespace,
+  ) {
+    if (!state.enabledNetworkMap[ns]) {
+      state.enabledNetworkMap[ns] = {};
+    }
+  }
+&nbsp;
+  /**
+   * Removes a network entry from the state.
+   *
+   * This method is called when a network is removed from the system. It cleans up
+   * the network entry and ensures that at least one network remains enabled.
+   *
+   * @param chainId - The chain ID to remove (Hex or CAIP-2 format)
+   */
+  #removeNetworkEntry(chainId: Hex | CaipChainId): void {
+    const derivedKeys = deriveKeys(chainId);
+    const { namespace, storageKey } = derivedKeys;
+&nbsp;
+    this.update((s) =&gt; {
+      // fallback and enable ethereum mainnet
+      if (isOnlyNetworkEnabledInNamespace(this.state, derivedKeys)) {
+        s.enabledNetworkMap[namespace][ChainId[BuiltInNetworkName.Mainnet]] =
+          true;
+      }
+&nbsp;
+      if (namespace in s.enabledNetworkMap) {
+        delete s.enabledNetworkMap[namespace][storageKey];
+      }
+    });
+  }
+&nbsp;
+  /**
+   * Handles the addition of a new network to the controller.
+   *
+   * This method is called when a network is added to the system. It automatically
+   * enables the new network and implements exclusive mode for non-popular networks.
+   * If the network already exists, no changes are made.
+   *
+   * @param chainId - The chain ID of the network being added (Hex or CAIP-2 format)
+   */
+  #onAddNetwork(chainId: Hex | CaipChainId): void {
+    const { namespace, storageKey, reference } = deriveKeys(chainId);
+&nbsp;
+    this.update((s) =&gt; {
+      // Ensure the namespace bucket exists
+      this.#ensureNamespaceBucket(s, namespace);
+&nbsp;
+      // If adding a non-popular network, disable all other networks in the same namespace
+      // This implements exclusive mode where only one non-popular network can be active
+      if (!isPopularNetwork(reference)) {
+        Object.keys(s.enabledNetworkMap[namespace]).forEach((key) =&gt; {
+          s.enabledNetworkMap[namespace][key as CaipChainId | Hex] = false;
+        });
+      }
+&nbsp;
+      // Add the new network as enabled
+      s.enabledNetworkMap[namespace][storageKey] = true;
+    });
+  }
+}
+&nbsp;</pre></td></tr></table></pre>
+
+                <div class='push'></div><!-- for sticky footer -->
+            </div><!-- /wrapper -->
+            <div class='footer quiet pad2 space-top1 center small'>
+                Code coverage generated by
+                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
+                at 2025-09-04T23:19:41.552Z
+            </div>
+        <script src="prettify.js"></script>
+        <script>
+            window.onload = function () {
+                prettyPrint();
+            };
+        </script>
+        <script src="sorter.js"></script>
+        <script src="block-navigation.js"></script>
+    </body>
+</html>
+    
\ No newline at end of file
diff --git a/coverage/base.css b/coverage/base.css
new file mode 100644
index 0000000000000000000000000000000000000000..f418035b469aff23689a74c912849662f442aed4
--- /dev/null
+++ b/coverage/base.css
@@ -0,0 +1,224 @@
+body, html {
+  margin:0; padding: 0;
+  height: 100%;
+}
+body {
+    font-family: Helvetica Neue, Helvetica, Arial;
+    font-size: 14px;
+    color:#333;
+}
+.small { font-size: 12px; }
+*, *:after, *:before {
+  -webkit-box-sizing:border-box;
+     -moz-box-sizing:border-box;
+          box-sizing:border-box;
+  }
+h1 { font-size: 20px; margin: 0;}
+h2 { font-size: 14px; }
+pre {
+    font: 12px/1.4 Consolas, "Liberation Mono", Menlo, Courier, monospace;
+    margin: 0;
+    padding: 0;
+    -moz-tab-size: 2;
+    -o-tab-size:  2;
+    tab-size: 2;
+}
+a { color:#0074D9; text-decoration:none; }
+a:hover { text-decoration:underline; }
+.strong { font-weight: bold; }
+.space-top1 { padding: 10px 0 0 0; }
+.pad2y { padding: 20px 0; }
+.pad1y { padding: 10px 0; }
+.pad2x { padding: 0 20px; }
+.pad2 { padding: 20px; }
+.pad1 { padding: 10px; }
+.space-left2 { padding-left:55px; }
+.space-right2 { padding-right:20px; }
+.center { text-align:center; }
+.clearfix { display:block; }
+.clearfix:after {
+  content:'';
+  display:block;
+  height:0;
+  clear:both;
+  visibility:hidden;
+  }
+.fl { float: left; }
+@media only screen and (max-width:640px) {
+  .col3 { width:100%; max-width:100%; }
+  .hide-mobile { display:none!important; }
+}
+
+.quiet {
+  color: #7f7f7f;
+  color: rgba(0,0,0,0.5);
+}
+.quiet a { opacity: 0.7; }
+
+.fraction {
+  font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace;
+  font-size: 10px;
+  color: #555;
+  background: #E8E8E8;
+  padding: 4px 5px;
+  border-radius: 3px;
+  vertical-align: middle;
+}
+
+div.path a:link, div.path a:visited { color: #333; }
+table.coverage {
+  border-collapse: collapse;
+  margin: 10px 0 0 0;
+  padding: 0;
+}
+
+table.coverage td {
+  margin: 0;
+  padding: 0;
+  vertical-align: top;
+}
+table.coverage td.line-count {
+    text-align: right;
+    padding: 0 5px 0 20px;
+}
+table.coverage td.line-coverage {
+    text-align: right;
+    padding-right: 10px;
+    min-width:20px;
+}
+
+table.coverage td span.cline-any {
+    display: inline-block;
+    padding: 0 5px;
+    width: 100%;
+}
+.missing-if-branch {
+    display: inline-block;
+    margin-right: 5px;
+    border-radius: 3px;
+    position: relative;
+    padding: 0 4px;
+    background: #333;
+    color: yellow;
+}
+
+.skip-if-branch {
+    display: none;
+    margin-right: 10px;
+    position: relative;
+    padding: 0 4px;
+    background: #ccc;
+    color: white;
+}
+.missing-if-branch .typ, .skip-if-branch .typ {
+    color: inherit !important;
+}
+.coverage-summary {
+  border-collapse: collapse;
+  width: 100%;
+}
+.coverage-summary tr { border-bottom: 1px solid #bbb; }
+.keyline-all { border: 1px solid #ddd; }
+.coverage-summary td, .coverage-summary th { padding: 10px; }
+.coverage-summary tbody { border: 1px solid #bbb; }
+.coverage-summary td { border-right: 1px solid #bbb; }
+.coverage-summary td:last-child { border-right: none; }
+.coverage-summary th {
+  text-align: left;
+  font-weight: normal;
+  white-space: nowrap;
+}
+.coverage-summary th.file { border-right: none !important; }
+.coverage-summary th.pct { }
+.coverage-summary th.pic,
+.coverage-summary th.abs,
+.coverage-summary td.pct,
+.coverage-summary td.abs { text-align: right; }
+.coverage-summary td.file { white-space: nowrap;  }
+.coverage-summary td.pic { min-width: 120px !important;  }
+.coverage-summary tfoot td { }
+
+.coverage-summary .sorter {
+    height: 10px;
+    width: 7px;
+    display: inline-block;
+    margin-left: 0.5em;
+    background: url(sort-arrow-sprite.png) no-repeat scroll 0 0 transparent;
+}
+.coverage-summary .sorted .sorter {
+    background-position: 0 -20px;
+}
+.coverage-summary .sorted-desc .sorter {
+    background-position: 0 -10px;
+}
+.status-line {  height: 10px; }
+/* yellow */
+.cbranch-no { background: yellow !important; color: #111; }
+/* dark red */
+.red.solid, .status-line.low, .low .cover-fill { background:#C21F39 }
+.low .chart { border:1px solid #C21F39 }
+.highlighted,
+.highlighted .cstat-no, .highlighted .fstat-no, .highlighted .cbranch-no{
+  background: #C21F39 !important;
+}
+/* medium red */
+.cstat-no, .fstat-no, .cbranch-no, .cbranch-no { background:#F6C6CE }
+/* light red */
+.low, .cline-no { background:#FCE1E5 }
+/* light green */
+.high, .cline-yes { background:rgb(230,245,208) }
+/* medium green */
+.cstat-yes { background:rgb(161,215,106) }
+/* dark green */
+.status-line.high, .high .cover-fill { background:rgb(77,146,33) }
+.high .chart { border:1px solid rgb(77,146,33) }
+/* dark yellow (gold) */
+.status-line.medium, .medium .cover-fill { background: #f9cd0b; }
+.medium .chart { border:1px solid #f9cd0b; }
+/* light yellow */
+.medium { background: #fff4c2; }
+
+.cstat-skip { background: #ddd; color: #111; }
+.fstat-skip { background: #ddd; color: #111 !important; }
+.cbranch-skip { background: #ddd !important; color: #111; }
+
+span.cline-neutral { background: #eaeaea; }
+
+.coverage-summary td.empty {
+    opacity: .5;
+    padding-top: 4px;
+    padding-bottom: 4px;
+    line-height: 1;
+    color: #888;
+}
+
+.cover-fill, .cover-empty {
+  display:inline-block;
+  height: 12px;
+}
+.chart {
+  line-height: 0;
+}
+.cover-empty {
+    background: white;
+}
+.cover-full {
+    border-right: none !important;
+}
+pre.prettyprint {
+    border: none !important;
+    padding: 0 !important;
+    margin: 0 !important;
+}
+.com { color: #999 !important; }
+.ignore-none { color: #999; font-weight: normal; }
+
+.wrapper {
+  min-height: 100%;
+  height: auto !important;
+  height: 100%;
+  margin: 0 auto -48px;
+}
+.footer, .push {
+  height: 48px;
+}
diff --git a/coverage/block-navigation.js b/coverage/block-navigation.js
new file mode 100644
index 0000000000000000000000000000000000000000..cc121302316c8faaaebfd6a15f4212d99e563199
--- /dev/null
+++ b/coverage/block-navigation.js
@@ -0,0 +1,87 @@
+/* eslint-disable */
+var jumpToCode = (function init() {
+    // Classes of code we would like to highlight in the file view
+    var missingCoverageClasses = ['.cbranch-no', '.cstat-no', '.fstat-no'];
+
+    // Elements to highlight in the file listing view
+    var fileListingElements = ['td.pct.low'];
+
+    // We don't want to select elements that are direct descendants of another match
+    var notSelector = ':not(' + missingCoverageClasses.join('):not(') + ') > '; // becomes `:not(a):not(b) > `
+
+    // Selecter that finds elements on the page to which we can jump
+    var selector =
+        fileListingElements.join(', ') +
+        ', ' +
+        notSelector +
+        missingCoverageClasses.join(', ' + notSelector); // becomes `:not(a):not(b) > a, :not(a):not(b) > b`
+
+    // The NodeList of matching elements
+    var missingCoverageElements = document.querySelectorAll(selector);
+
+    var currentIndex;
+
+    function toggleClass(index) {
+        missingCoverageElements
+            .item(currentIndex)
+            .classList.remove('highlighted');
+        missingCoverageElements.item(index).classList.add('highlighted');
+    }
+
+    function makeCurrent(index) {
+        toggleClass(index);
+        currentIndex = index;
+        missingCoverageElements.item(index).scrollIntoView({
+            behavior: 'smooth',
+            block: 'center',
+            inline: 'center'
+        });
+    }
+
+    function goToPrevious() {
+        var nextIndex = 0;
+        if (typeof currentIndex !== 'number' || currentIndex === 0) {
+            nextIndex = missingCoverageElements.length - 1;
+        } else if (missingCoverageElements.length > 1) {
+            nextIndex = currentIndex - 1;
+        }
+
+        makeCurrent(nextIndex);
+    }
+
+    function goToNext() {
+        var nextIndex = 0;
+
+        if (
+            typeof currentIndex === 'number' &&
+            currentIndex < missingCoverageElements.length - 1
+        ) {
+            nextIndex = currentIndex + 1;
+        }
+
+        makeCurrent(nextIndex);
+    }
+
+    return function jump(event) {
+        if (
+            document.getElementById('fileSearch') === document.activeElement &&
+            document.activeElement != null
+        ) {
+            // if we're currently focused on the search input, we don't want to navigate
+            return;
+        }
+
+        switch (event.which) {
+            case 78: // n
+            case 74: // j
+                goToNext();
+                break;
+            case 66: // b
+            case 75: // k
+            case 80: // p
+                goToPrevious();
+                break;
+        }
+    };
+})();
+window.addEventListener('keydown', jumpToCode);
diff --git a/coverage/constants.ts.html b/coverage/constants.ts.html
new file mode 100644
index 0000000000000000000000000000000000000000..ed56bde853ccf81627eb982b79b6e614967efb4b
--- /dev/null
+++ b/coverage/constants.ts.html
@@ -0,0 +1,127 @@
+
+<!doctype html>
+<html lang="en">
+
+<head>
+    <title>Code coverage report for constants.ts</title>
+    <meta charset="utf-8" />
+    <link rel="stylesheet" href="prettify.css" />
+    <link rel="stylesheet" href="base.css" />
+    <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
+    <meta name="viewport" content="width=device-width, initial-scale=1" />
+    <style type='text/css'>
+        .coverage-summary .sorter {
+            background-image: url(sort-arrow-sprite.png);
+        }
+    </style>
+</head>
+    
+<body>
+<div class='wrapper'>
+    <div class='pad1'>
+        <h1><a href="index.html">All files</a> constants.ts</h1>
+        <div class='clearfix'>
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Statements</span>
+                <span class='fraction'>1/1</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Branches</span>
+                <span class='fraction'>0/0</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Functions</span>
+                <span class='fraction'>0/0</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Lines</span>
+                <span class='fraction'>1/1</span>
+            </div>
+        
+            
+        </div>
+        <p class="quiet">
+            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
+        </p>
+        <template id="filterTemplate">
+            <div class="quiet">
+                Filter:
+                <input type="search" id="fileSearch">
+            </div>
+        </template>
+    </div>
+    <div class='status-line high'></div>
+    <pre><table class="coverage">
+<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
+<a name='L2'></a><a href='#L2'>2</a>
+<a name='L3'></a><a href='#L3'>3</a>
+<a name='L4'></a><a href='#L4'>4</a>
+<a name='L5'></a><a href='#L5'>5</a>
+<a name='L6'></a><a href='#L6'>6</a>
+<a name='L7'></a><a href='#L7'>7</a>
+<a name='L8'></a><a href='#L8'>8</a>
+<a name='L9'></a><a href='#L9'>9</a>
+<a name='L10'></a><a href='#L10'>10</a>
+<a name='L11'></a><a href='#L11'>11</a>
+<a name='L12'></a><a href='#L12'>12</a>
+<a name='L13'></a><a href='#L13'>13</a>
+<a name='L14'></a><a href='#L14'>14</a>
+<a name='L15'></a><a href='#L15'>15</a></td><td class="line-coverage quiet"><span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">export const POPULAR_NETWORKS = [
+  '0x1', // Ethereum Mainnet
+  '0xe708', // Linea (59144)
+  '0x2105', // Base (8453)
+  '0xa4b1', // Arbitrum One (42161)
+  '0xa86a', // Avalanche C-Chain (43114)
+  '0x38', // BNB Smart Chain (56)
+  '0xa', // Optimism (10)
+  '0x89', // Polygon (137)
+  '0x531', // Sei (Assuming 1329 used in EVM context)
+  '0x144', // zkSync Era (324)
+  '0x2a15c308d', // Palm (11297108109)
+  '0x3e7', // HyperEVM (999)
+];
+&nbsp;</pre></td></tr></table></pre>
+
+                <div class='push'></div><!-- for sticky footer -->
+            </div><!-- /wrapper -->
+            <div class='footer quiet pad2 space-top1 center small'>
+                Code coverage generated by
+                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
+                at 2025-09-04T23:19:41.552Z
+            </div>
+        <script src="prettify.js"></script>
+        <script>
+            window.onload = function () {
+                prettyPrint();
+            };
+        </script>
+        <script src="sorter.js"></script>
+        <script src="block-navigation.js"></script>
+    </body>
+</html>
+    
\ No newline at end of file
diff --git a/coverage/coverage-summary.json b/coverage/coverage-summary.json
new file mode 100644
index 0000000000000000000000000000000000000000..92d2009be7607c6f3bd29b697c157dd188d8f08f
--- /dev/null
+++ b/coverage/coverage-summary.json
@@ -0,0 +1,7 @@
+{"total": {"lines":{"total":147,"covered":147,"skipped":0,"pct":100},"statements":{"total":151,"covered":151,"skipped":0,"pct":100},"functions":{"total":45,"covered":45,"skipped":0,"pct":100},"branches":{"total":38,"covered":38,"skipped":0,"pct":100},"branchesTrue":{"total":0,"covered":0,"skipped":0,"pct":"Unknown"}}
+,"/Users/vincenthoward/Projects/Development/core/packages/network-enablement-controller/src/NetworkEnablementController.ts": {"lines":{"total":86,"covered":86,"skipped":0,"pct":100},"functions":{"total":25,"covered":25,"skipped":0,"pct":100},"statements":{"total":87,"covered":87,"skipped":0,"pct":100},"branches":{"total":21,"covered":21,"skipped":0,"pct":100}}
+,"/Users/vincenthoward/Projects/Development/core/packages/network-enablement-controller/src/constants.ts": {"lines":{"total":1,"covered":1,"skipped":0,"pct":100},"functions":{"total":0,"covered":0,"skipped":0,"pct":100},"statements":{"total":1,"covered":1,"skipped":0,"pct":100},"branches":{"total":0,"covered":0,"skipped":0,"pct":100}}
+,"/Users/vincenthoward/Projects/Development/core/packages/network-enablement-controller/src/selectors.ts": {"lines":{"total":26,"covered":26,"skipped":0,"pct":100},"functions":{"total":14,"covered":14,"skipped":0,"pct":100},"statements":{"total":29,"covered":29,"skipped":0,"pct":100},"branches":{"total":5,"covered":5,"skipped":0,"pct":100}}
+,"/Users/vincenthoward/Projects/Development/core/packages/network-enablement-controller/src/types.ts": {"lines":{"total":8,"covered":8,"skipped":0,"pct":100},"functions":{"total":2,"covered":2,"skipped":0,"pct":100},"statements":{"total":8,"covered":8,"skipped":0,"pct":100},"branches":{"total":4,"covered":4,"skipped":0,"pct":100}}
+,"/Users/vincenthoward/Projects/Development/core/packages/network-enablement-controller/src/utils.ts": {"lines":{"total":26,"covered":26,"skipped":0,"pct":100},"functions":{"total":4,"covered":4,"skipped":0,"pct":100},"statements":{"total":26,"covered":26,"skipped":0,"pct":100},"branches":{"total":8,"covered":8,"skipped":0,"pct":100}}
+}
diff --git a/coverage/favicon.png b/coverage/favicon.png
new file mode 100644
index 0000000000000000000000000000000000000000..c1525b811a167671e9de1fa78aab9f5c0b61cef7
--- /dev/null
+++ b/coverage/favicon.png
@@ -0,0 +1,3 @@
+PNG
+
+   IHDR         h6  IDATxApfT6vq8UF\m[:C\D,y/ bLIB>s1/8z: oK.\I>|Ob'+ .W"!~PJ	IIh3^rs{3p3->!+rM-\t=w4&Da%U*;Jgfzk KJMZ}%2QUXliE!dPh\OI>fJOi( B|u`iz|!fDPV"%kI"g% hHcQ`F; ?E    IENDB`
\ No newline at end of file
diff --git a/coverage/index.html b/coverage/index.html
new file mode 100644
index 0000000000000000000000000000000000000000..aea506f75f632fc91b8ffaca509261c50a585be9
--- /dev/null
+++ b/coverage/index.html
@@ -0,0 +1,176 @@
+
+<!doctype html>
+<html lang="en">
+
+<head>
+    <title>Code coverage report for All files</title>
+    <meta charset="utf-8" />
+    <link rel="stylesheet" href="prettify.css" />
+    <link rel="stylesheet" href="base.css" />
+    <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
+    <meta name="viewport" content="width=device-width, initial-scale=1" />
+    <style type='text/css'>
+        .coverage-summary .sorter {
+            background-image: url(sort-arrow-sprite.png);
+        }
+    </style>
+</head>
+    
+<body>
+<div class='wrapper'>
+    <div class='pad1'>
+        <h1>All files</h1>
+        <div class='clearfix'>
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Statements</span>
+                <span class='fraction'>151/151</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Branches</span>
+                <span class='fraction'>38/38</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Functions</span>
+                <span class='fraction'>45/45</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Lines</span>
+                <span class='fraction'>147/147</span>
+            </div>
+        
+            
+        </div>
+        <p class="quiet">
+            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
+        </p>
+        <template id="filterTemplate">
+            <div class="quiet">
+                Filter:
+                <input type="search" id="fileSearch">
+            </div>
+        </template>
+    </div>
+    <div class='status-line high'></div>
+    <div class="pad1">
+<table class="coverage-summary">
+<thead>
+<tr>
+   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
+   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
+   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
+   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
+   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
+   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
+   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
+   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
+   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
+   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
+</tr>
+</thead>
+<tbody><tr>
+	<td class="file high" data-value="NetworkEnablementController.ts"><a href="NetworkEnablementController.ts.html">NetworkEnablementController.ts</a></td>
+	<td data-value="100" class="pic high">
+	<div class="chart"><div class="cover-fill cover-full" style="width: 100%"></div><div class="cover-empty" style="width: 0%"></div></div>
+	</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="87" class="abs high">87/87</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="21" class="abs high">21/21</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="25" class="abs high">25/25</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="86" class="abs high">86/86</td>
+	</tr>
+
+<tr>
+	<td class="file high" data-value="constants.ts"><a href="constants.ts.html">constants.ts</a></td>
+	<td data-value="100" class="pic high">
+	<div class="chart"><div class="cover-fill cover-full" style="width: 100%"></div><div class="cover-empty" style="width: 0%"></div></div>
+	</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="1" class="abs high">1/1</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="0" class="abs high">0/0</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="0" class="abs high">0/0</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="1" class="abs high">1/1</td>
+	</tr>
+
+<tr>
+	<td class="file high" data-value="selectors.ts"><a href="selectors.ts.html">selectors.ts</a></td>
+	<td data-value="100" class="pic high">
+	<div class="chart"><div class="cover-fill cover-full" style="width: 100%"></div><div class="cover-empty" style="width: 0%"></div></div>
+	</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="29" class="abs high">29/29</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="5" class="abs high">5/5</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="14" class="abs high">14/14</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="26" class="abs high">26/26</td>
+	</tr>
+
+<tr>
+	<td class="file high" data-value="types.ts"><a href="types.ts.html">types.ts</a></td>
+	<td data-value="100" class="pic high">
+	<div class="chart"><div class="cover-fill cover-full" style="width: 100%"></div><div class="cover-empty" style="width: 0%"></div></div>
+	</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="8" class="abs high">8/8</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="4" class="abs high">4/4</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="2" class="abs high">2/2</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="8" class="abs high">8/8</td>
+	</tr>
+
+<tr>
+	<td class="file high" data-value="utils.ts"><a href="utils.ts.html">utils.ts</a></td>
+	<td data-value="100" class="pic high">
+	<div class="chart"><div class="cover-fill cover-full" style="width: 100%"></div><div class="cover-empty" style="width: 0%"></div></div>
+	</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="26" class="abs high">26/26</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="8" class="abs high">8/8</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="4" class="abs high">4/4</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="26" class="abs high">26/26</td>
+	</tr>
+
+</tbody>
+</table>
+</div>
+                <div class='push'></div><!-- for sticky footer -->
+            </div><!-- /wrapper -->
+            <div class='footer quiet pad2 space-top1 center small'>
+                Code coverage generated by
+                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
+                at 2025-09-04T23:19:41.552Z
+            </div>
+        <script src="prettify.js"></script>
+        <script>
+            window.onload = function () {
+                prettyPrint();
+            };
+        </script>
+        <script src="sorter.js"></script>
+        <script src="block-navigation.js"></script>
+    </body>
+</html>
+    
\ No newline at end of file
diff --git a/coverage/lcov-report/NetworkEnablementController.ts.html b/coverage/lcov-report/NetworkEnablementController.ts.html
new file mode 100644
index 0000000000000000000000000000000000000000..d2351582b163ab038c6938ae819d0f8378b11d78
--- /dev/null
+++ b/coverage/lcov-report/NetworkEnablementController.ts.html
@@ -0,0 +1,1540 @@
+
+<!doctype html>
+<html lang="en">
+
+<head>
+    <title>Code coverage report for NetworkEnablementController.ts</title>
+    <meta charset="utf-8" />
+    <link rel="stylesheet" href="prettify.css" />
+    <link rel="stylesheet" href="base.css" />
+    <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
+    <meta name="viewport" content="width=device-width, initial-scale=1" />
+    <style type='text/css'>
+        .coverage-summary .sorter {
+            background-image: url(sort-arrow-sprite.png);
+        }
+    </style>
+</head>
+    
+<body>
+<div class='wrapper'>
+    <div class='pad1'>
+        <h1><a href="index.html">All files</a> NetworkEnablementController.ts</h1>
+        <div class='clearfix'>
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Statements</span>
+                <span class='fraction'>87/87</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Branches</span>
+                <span class='fraction'>21/21</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Functions</span>
+                <span class='fraction'>25/25</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Lines</span>
+                <span class='fraction'>86/86</span>
+            </div>
+        
+            
+        </div>
+        <p class="quiet">
+            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
+        </p>
+        <template id="filterTemplate">
+            <div class="quiet">
+                Filter:
+                <input type="search" id="fileSearch">
+            </div>
+        </template>
+    </div>
+    <div class='status-line high'></div>
+    <pre><table class="coverage">
+<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
+<a name='L2'></a><a href='#L2'>2</a>
+<a name='L3'></a><a href='#L3'>3</a>
+<a name='L4'></a><a href='#L4'>4</a>
+<a name='L5'></a><a href='#L5'>5</a>
+<a name='L6'></a><a href='#L6'>6</a>
+<a name='L7'></a><a href='#L7'>7</a>
+<a name='L8'></a><a href='#L8'>8</a>
+<a name='L9'></a><a href='#L9'>9</a>
+<a name='L10'></a><a href='#L10'>10</a>
+<a name='L11'></a><a href='#L11'>11</a>
+<a name='L12'></a><a href='#L12'>12</a>
+<a name='L13'></a><a href='#L13'>13</a>
+<a name='L14'></a><a href='#L14'>14</a>
+<a name='L15'></a><a href='#L15'>15</a>
+<a name='L16'></a><a href='#L16'>16</a>
+<a name='L17'></a><a href='#L17'>17</a>
+<a name='L18'></a><a href='#L18'>18</a>
+<a name='L19'></a><a href='#L19'>19</a>
+<a name='L20'></a><a href='#L20'>20</a>
+<a name='L21'></a><a href='#L21'>21</a>
+<a name='L22'></a><a href='#L22'>22</a>
+<a name='L23'></a><a href='#L23'>23</a>
+<a name='L24'></a><a href='#L24'>24</a>
+<a name='L25'></a><a href='#L25'>25</a>
+<a name='L26'></a><a href='#L26'>26</a>
+<a name='L27'></a><a href='#L27'>27</a>
+<a name='L28'></a><a href='#L28'>28</a>
+<a name='L29'></a><a href='#L29'>29</a>
+<a name='L30'></a><a href='#L30'>30</a>
+<a name='L31'></a><a href='#L31'>31</a>
+<a name='L32'></a><a href='#L32'>32</a>
+<a name='L33'></a><a href='#L33'>33</a>
+<a name='L34'></a><a href='#L34'>34</a>
+<a name='L35'></a><a href='#L35'>35</a>
+<a name='L36'></a><a href='#L36'>36</a>
+<a name='L37'></a><a href='#L37'>37</a>
+<a name='L38'></a><a href='#L38'>38</a>
+<a name='L39'></a><a href='#L39'>39</a>
+<a name='L40'></a><a href='#L40'>40</a>
+<a name='L41'></a><a href='#L41'>41</a>
+<a name='L42'></a><a href='#L42'>42</a>
+<a name='L43'></a><a href='#L43'>43</a>
+<a name='L44'></a><a href='#L44'>44</a>
+<a name='L45'></a><a href='#L45'>45</a>
+<a name='L46'></a><a href='#L46'>46</a>
+<a name='L47'></a><a href='#L47'>47</a>
+<a name='L48'></a><a href='#L48'>48</a>
+<a name='L49'></a><a href='#L49'>49</a>
+<a name='L50'></a><a href='#L50'>50</a>
+<a name='L51'></a><a href='#L51'>51</a>
+<a name='L52'></a><a href='#L52'>52</a>
+<a name='L53'></a><a href='#L53'>53</a>
+<a name='L54'></a><a href='#L54'>54</a>
+<a name='L55'></a><a href='#L55'>55</a>
+<a name='L56'></a><a href='#L56'>56</a>
+<a name='L57'></a><a href='#L57'>57</a>
+<a name='L58'></a><a href='#L58'>58</a>
+<a name='L59'></a><a href='#L59'>59</a>
+<a name='L60'></a><a href='#L60'>60</a>
+<a name='L61'></a><a href='#L61'>61</a>
+<a name='L62'></a><a href='#L62'>62</a>
+<a name='L63'></a><a href='#L63'>63</a>
+<a name='L64'></a><a href='#L64'>64</a>
+<a name='L65'></a><a href='#L65'>65</a>
+<a name='L66'></a><a href='#L66'>66</a>
+<a name='L67'></a><a href='#L67'>67</a>
+<a name='L68'></a><a href='#L68'>68</a>
+<a name='L69'></a><a href='#L69'>69</a>
+<a name='L70'></a><a href='#L70'>70</a>
+<a name='L71'></a><a href='#L71'>71</a>
+<a name='L72'></a><a href='#L72'>72</a>
+<a name='L73'></a><a href='#L73'>73</a>
+<a name='L74'></a><a href='#L74'>74</a>
+<a name='L75'></a><a href='#L75'>75</a>
+<a name='L76'></a><a href='#L76'>76</a>
+<a name='L77'></a><a href='#L77'>77</a>
+<a name='L78'></a><a href='#L78'>78</a>
+<a name='L79'></a><a href='#L79'>79</a>
+<a name='L80'></a><a href='#L80'>80</a>
+<a name='L81'></a><a href='#L81'>81</a>
+<a name='L82'></a><a href='#L82'>82</a>
+<a name='L83'></a><a href='#L83'>83</a>
+<a name='L84'></a><a href='#L84'>84</a>
+<a name='L85'></a><a href='#L85'>85</a>
+<a name='L86'></a><a href='#L86'>86</a>
+<a name='L87'></a><a href='#L87'>87</a>
+<a name='L88'></a><a href='#L88'>88</a>
+<a name='L89'></a><a href='#L89'>89</a>
+<a name='L90'></a><a href='#L90'>90</a>
+<a name='L91'></a><a href='#L91'>91</a>
+<a name='L92'></a><a href='#L92'>92</a>
+<a name='L93'></a><a href='#L93'>93</a>
+<a name='L94'></a><a href='#L94'>94</a>
+<a name='L95'></a><a href='#L95'>95</a>
+<a name='L96'></a><a href='#L96'>96</a>
+<a name='L97'></a><a href='#L97'>97</a>
+<a name='L98'></a><a href='#L98'>98</a>
+<a name='L99'></a><a href='#L99'>99</a>
+<a name='L100'></a><a href='#L100'>100</a>
+<a name='L101'></a><a href='#L101'>101</a>
+<a name='L102'></a><a href='#L102'>102</a>
+<a name='L103'></a><a href='#L103'>103</a>
+<a name='L104'></a><a href='#L104'>104</a>
+<a name='L105'></a><a href='#L105'>105</a>
+<a name='L106'></a><a href='#L106'>106</a>
+<a name='L107'></a><a href='#L107'>107</a>
+<a name='L108'></a><a href='#L108'>108</a>
+<a name='L109'></a><a href='#L109'>109</a>
+<a name='L110'></a><a href='#L110'>110</a>
+<a name='L111'></a><a href='#L111'>111</a>
+<a name='L112'></a><a href='#L112'>112</a>
+<a name='L113'></a><a href='#L113'>113</a>
+<a name='L114'></a><a href='#L114'>114</a>
+<a name='L115'></a><a href='#L115'>115</a>
+<a name='L116'></a><a href='#L116'>116</a>
+<a name='L117'></a><a href='#L117'>117</a>
+<a name='L118'></a><a href='#L118'>118</a>
+<a name='L119'></a><a href='#L119'>119</a>
+<a name='L120'></a><a href='#L120'>120</a>
+<a name='L121'></a><a href='#L121'>121</a>
+<a name='L122'></a><a href='#L122'>122</a>
+<a name='L123'></a><a href='#L123'>123</a>
+<a name='L124'></a><a href='#L124'>124</a>
+<a name='L125'></a><a href='#L125'>125</a>
+<a name='L126'></a><a href='#L126'>126</a>
+<a name='L127'></a><a href='#L127'>127</a>
+<a name='L128'></a><a href='#L128'>128</a>
+<a name='L129'></a><a href='#L129'>129</a>
+<a name='L130'></a><a href='#L130'>130</a>
+<a name='L131'></a><a href='#L131'>131</a>
+<a name='L132'></a><a href='#L132'>132</a>
+<a name='L133'></a><a href='#L133'>133</a>
+<a name='L134'></a><a href='#L134'>134</a>
+<a name='L135'></a><a href='#L135'>135</a>
+<a name='L136'></a><a href='#L136'>136</a>
+<a name='L137'></a><a href='#L137'>137</a>
+<a name='L138'></a><a href='#L138'>138</a>
+<a name='L139'></a><a href='#L139'>139</a>
+<a name='L140'></a><a href='#L140'>140</a>
+<a name='L141'></a><a href='#L141'>141</a>
+<a name='L142'></a><a href='#L142'>142</a>
+<a name='L143'></a><a href='#L143'>143</a>
+<a name='L144'></a><a href='#L144'>144</a>
+<a name='L145'></a><a href='#L145'>145</a>
+<a name='L146'></a><a href='#L146'>146</a>
+<a name='L147'></a><a href='#L147'>147</a>
+<a name='L148'></a><a href='#L148'>148</a>
+<a name='L149'></a><a href='#L149'>149</a>
+<a name='L150'></a><a href='#L150'>150</a>
+<a name='L151'></a><a href='#L151'>151</a>
+<a name='L152'></a><a href='#L152'>152</a>
+<a name='L153'></a><a href='#L153'>153</a>
+<a name='L154'></a><a href='#L154'>154</a>
+<a name='L155'></a><a href='#L155'>155</a>
+<a name='L156'></a><a href='#L156'>156</a>
+<a name='L157'></a><a href='#L157'>157</a>
+<a name='L158'></a><a href='#L158'>158</a>
+<a name='L159'></a><a href='#L159'>159</a>
+<a name='L160'></a><a href='#L160'>160</a>
+<a name='L161'></a><a href='#L161'>161</a>
+<a name='L162'></a><a href='#L162'>162</a>
+<a name='L163'></a><a href='#L163'>163</a>
+<a name='L164'></a><a href='#L164'>164</a>
+<a name='L165'></a><a href='#L165'>165</a>
+<a name='L166'></a><a href='#L166'>166</a>
+<a name='L167'></a><a href='#L167'>167</a>
+<a name='L168'></a><a href='#L168'>168</a>
+<a name='L169'></a><a href='#L169'>169</a>
+<a name='L170'></a><a href='#L170'>170</a>
+<a name='L171'></a><a href='#L171'>171</a>
+<a name='L172'></a><a href='#L172'>172</a>
+<a name='L173'></a><a href='#L173'>173</a>
+<a name='L174'></a><a href='#L174'>174</a>
+<a name='L175'></a><a href='#L175'>175</a>
+<a name='L176'></a><a href='#L176'>176</a>
+<a name='L177'></a><a href='#L177'>177</a>
+<a name='L178'></a><a href='#L178'>178</a>
+<a name='L179'></a><a href='#L179'>179</a>
+<a name='L180'></a><a href='#L180'>180</a>
+<a name='L181'></a><a href='#L181'>181</a>
+<a name='L182'></a><a href='#L182'>182</a>
+<a name='L183'></a><a href='#L183'>183</a>
+<a name='L184'></a><a href='#L184'>184</a>
+<a name='L185'></a><a href='#L185'>185</a>
+<a name='L186'></a><a href='#L186'>186</a>
+<a name='L187'></a><a href='#L187'>187</a>
+<a name='L188'></a><a href='#L188'>188</a>
+<a name='L189'></a><a href='#L189'>189</a>
+<a name='L190'></a><a href='#L190'>190</a>
+<a name='L191'></a><a href='#L191'>191</a>
+<a name='L192'></a><a href='#L192'>192</a>
+<a name='L193'></a><a href='#L193'>193</a>
+<a name='L194'></a><a href='#L194'>194</a>
+<a name='L195'></a><a href='#L195'>195</a>
+<a name='L196'></a><a href='#L196'>196</a>
+<a name='L197'></a><a href='#L197'>197</a>
+<a name='L198'></a><a href='#L198'>198</a>
+<a name='L199'></a><a href='#L199'>199</a>
+<a name='L200'></a><a href='#L200'>200</a>
+<a name='L201'></a><a href='#L201'>201</a>
+<a name='L202'></a><a href='#L202'>202</a>
+<a name='L203'></a><a href='#L203'>203</a>
+<a name='L204'></a><a href='#L204'>204</a>
+<a name='L205'></a><a href='#L205'>205</a>
+<a name='L206'></a><a href='#L206'>206</a>
+<a name='L207'></a><a href='#L207'>207</a>
+<a name='L208'></a><a href='#L208'>208</a>
+<a name='L209'></a><a href='#L209'>209</a>
+<a name='L210'></a><a href='#L210'>210</a>
+<a name='L211'></a><a href='#L211'>211</a>
+<a name='L212'></a><a href='#L212'>212</a>
+<a name='L213'></a><a href='#L213'>213</a>
+<a name='L214'></a><a href='#L214'>214</a>
+<a name='L215'></a><a href='#L215'>215</a>
+<a name='L216'></a><a href='#L216'>216</a>
+<a name='L217'></a><a href='#L217'>217</a>
+<a name='L218'></a><a href='#L218'>218</a>
+<a name='L219'></a><a href='#L219'>219</a>
+<a name='L220'></a><a href='#L220'>220</a>
+<a name='L221'></a><a href='#L221'>221</a>
+<a name='L222'></a><a href='#L222'>222</a>
+<a name='L223'></a><a href='#L223'>223</a>
+<a name='L224'></a><a href='#L224'>224</a>
+<a name='L225'></a><a href='#L225'>225</a>
+<a name='L226'></a><a href='#L226'>226</a>
+<a name='L227'></a><a href='#L227'>227</a>
+<a name='L228'></a><a href='#L228'>228</a>
+<a name='L229'></a><a href='#L229'>229</a>
+<a name='L230'></a><a href='#L230'>230</a>
+<a name='L231'></a><a href='#L231'>231</a>
+<a name='L232'></a><a href='#L232'>232</a>
+<a name='L233'></a><a href='#L233'>233</a>
+<a name='L234'></a><a href='#L234'>234</a>
+<a name='L235'></a><a href='#L235'>235</a>
+<a name='L236'></a><a href='#L236'>236</a>
+<a name='L237'></a><a href='#L237'>237</a>
+<a name='L238'></a><a href='#L238'>238</a>
+<a name='L239'></a><a href='#L239'>239</a>
+<a name='L240'></a><a href='#L240'>240</a>
+<a name='L241'></a><a href='#L241'>241</a>
+<a name='L242'></a><a href='#L242'>242</a>
+<a name='L243'></a><a href='#L243'>243</a>
+<a name='L244'></a><a href='#L244'>244</a>
+<a name='L245'></a><a href='#L245'>245</a>
+<a name='L246'></a><a href='#L246'>246</a>
+<a name='L247'></a><a href='#L247'>247</a>
+<a name='L248'></a><a href='#L248'>248</a>
+<a name='L249'></a><a href='#L249'>249</a>
+<a name='L250'></a><a href='#L250'>250</a>
+<a name='L251'></a><a href='#L251'>251</a>
+<a name='L252'></a><a href='#L252'>252</a>
+<a name='L253'></a><a href='#L253'>253</a>
+<a name='L254'></a><a href='#L254'>254</a>
+<a name='L255'></a><a href='#L255'>255</a>
+<a name='L256'></a><a href='#L256'>256</a>
+<a name='L257'></a><a href='#L257'>257</a>
+<a name='L258'></a><a href='#L258'>258</a>
+<a name='L259'></a><a href='#L259'>259</a>
+<a name='L260'></a><a href='#L260'>260</a>
+<a name='L261'></a><a href='#L261'>261</a>
+<a name='L262'></a><a href='#L262'>262</a>
+<a name='L263'></a><a href='#L263'>263</a>
+<a name='L264'></a><a href='#L264'>264</a>
+<a name='L265'></a><a href='#L265'>265</a>
+<a name='L266'></a><a href='#L266'>266</a>
+<a name='L267'></a><a href='#L267'>267</a>
+<a name='L268'></a><a href='#L268'>268</a>
+<a name='L269'></a><a href='#L269'>269</a>
+<a name='L270'></a><a href='#L270'>270</a>
+<a name='L271'></a><a href='#L271'>271</a>
+<a name='L272'></a><a href='#L272'>272</a>
+<a name='L273'></a><a href='#L273'>273</a>
+<a name='L274'></a><a href='#L274'>274</a>
+<a name='L275'></a><a href='#L275'>275</a>
+<a name='L276'></a><a href='#L276'>276</a>
+<a name='L277'></a><a href='#L277'>277</a>
+<a name='L278'></a><a href='#L278'>278</a>
+<a name='L279'></a><a href='#L279'>279</a>
+<a name='L280'></a><a href='#L280'>280</a>
+<a name='L281'></a><a href='#L281'>281</a>
+<a name='L282'></a><a href='#L282'>282</a>
+<a name='L283'></a><a href='#L283'>283</a>
+<a name='L284'></a><a href='#L284'>284</a>
+<a name='L285'></a><a href='#L285'>285</a>
+<a name='L286'></a><a href='#L286'>286</a>
+<a name='L287'></a><a href='#L287'>287</a>
+<a name='L288'></a><a href='#L288'>288</a>
+<a name='L289'></a><a href='#L289'>289</a>
+<a name='L290'></a><a href='#L290'>290</a>
+<a name='L291'></a><a href='#L291'>291</a>
+<a name='L292'></a><a href='#L292'>292</a>
+<a name='L293'></a><a href='#L293'>293</a>
+<a name='L294'></a><a href='#L294'>294</a>
+<a name='L295'></a><a href='#L295'>295</a>
+<a name='L296'></a><a href='#L296'>296</a>
+<a name='L297'></a><a href='#L297'>297</a>
+<a name='L298'></a><a href='#L298'>298</a>
+<a name='L299'></a><a href='#L299'>299</a>
+<a name='L300'></a><a href='#L300'>300</a>
+<a name='L301'></a><a href='#L301'>301</a>
+<a name='L302'></a><a href='#L302'>302</a>
+<a name='L303'></a><a href='#L303'>303</a>
+<a name='L304'></a><a href='#L304'>304</a>
+<a name='L305'></a><a href='#L305'>305</a>
+<a name='L306'></a><a href='#L306'>306</a>
+<a name='L307'></a><a href='#L307'>307</a>
+<a name='L308'></a><a href='#L308'>308</a>
+<a name='L309'></a><a href='#L309'>309</a>
+<a name='L310'></a><a href='#L310'>310</a>
+<a name='L311'></a><a href='#L311'>311</a>
+<a name='L312'></a><a href='#L312'>312</a>
+<a name='L313'></a><a href='#L313'>313</a>
+<a name='L314'></a><a href='#L314'>314</a>
+<a name='L315'></a><a href='#L315'>315</a>
+<a name='L316'></a><a href='#L316'>316</a>
+<a name='L317'></a><a href='#L317'>317</a>
+<a name='L318'></a><a href='#L318'>318</a>
+<a name='L319'></a><a href='#L319'>319</a>
+<a name='L320'></a><a href='#L320'>320</a>
+<a name='L321'></a><a href='#L321'>321</a>
+<a name='L322'></a><a href='#L322'>322</a>
+<a name='L323'></a><a href='#L323'>323</a>
+<a name='L324'></a><a href='#L324'>324</a>
+<a name='L325'></a><a href='#L325'>325</a>
+<a name='L326'></a><a href='#L326'>326</a>
+<a name='L327'></a><a href='#L327'>327</a>
+<a name='L328'></a><a href='#L328'>328</a>
+<a name='L329'></a><a href='#L329'>329</a>
+<a name='L330'></a><a href='#L330'>330</a>
+<a name='L331'></a><a href='#L331'>331</a>
+<a name='L332'></a><a href='#L332'>332</a>
+<a name='L333'></a><a href='#L333'>333</a>
+<a name='L334'></a><a href='#L334'>334</a>
+<a name='L335'></a><a href='#L335'>335</a>
+<a name='L336'></a><a href='#L336'>336</a>
+<a name='L337'></a><a href='#L337'>337</a>
+<a name='L338'></a><a href='#L338'>338</a>
+<a name='L339'></a><a href='#L339'>339</a>
+<a name='L340'></a><a href='#L340'>340</a>
+<a name='L341'></a><a href='#L341'>341</a>
+<a name='L342'></a><a href='#L342'>342</a>
+<a name='L343'></a><a href='#L343'>343</a>
+<a name='L344'></a><a href='#L344'>344</a>
+<a name='L345'></a><a href='#L345'>345</a>
+<a name='L346'></a><a href='#L346'>346</a>
+<a name='L347'></a><a href='#L347'>347</a>
+<a name='L348'></a><a href='#L348'>348</a>
+<a name='L349'></a><a href='#L349'>349</a>
+<a name='L350'></a><a href='#L350'>350</a>
+<a name='L351'></a><a href='#L351'>351</a>
+<a name='L352'></a><a href='#L352'>352</a>
+<a name='L353'></a><a href='#L353'>353</a>
+<a name='L354'></a><a href='#L354'>354</a>
+<a name='L355'></a><a href='#L355'>355</a>
+<a name='L356'></a><a href='#L356'>356</a>
+<a name='L357'></a><a href='#L357'>357</a>
+<a name='L358'></a><a href='#L358'>358</a>
+<a name='L359'></a><a href='#L359'>359</a>
+<a name='L360'></a><a href='#L360'>360</a>
+<a name='L361'></a><a href='#L361'>361</a>
+<a name='L362'></a><a href='#L362'>362</a>
+<a name='L363'></a><a href='#L363'>363</a>
+<a name='L364'></a><a href='#L364'>364</a>
+<a name='L365'></a><a href='#L365'>365</a>
+<a name='L366'></a><a href='#L366'>366</a>
+<a name='L367'></a><a href='#L367'>367</a>
+<a name='L368'></a><a href='#L368'>368</a>
+<a name='L369'></a><a href='#L369'>369</a>
+<a name='L370'></a><a href='#L370'>370</a>
+<a name='L371'></a><a href='#L371'>371</a>
+<a name='L372'></a><a href='#L372'>372</a>
+<a name='L373'></a><a href='#L373'>373</a>
+<a name='L374'></a><a href='#L374'>374</a>
+<a name='L375'></a><a href='#L375'>375</a>
+<a name='L376'></a><a href='#L376'>376</a>
+<a name='L377'></a><a href='#L377'>377</a>
+<a name='L378'></a><a href='#L378'>378</a>
+<a name='L379'></a><a href='#L379'>379</a>
+<a name='L380'></a><a href='#L380'>380</a>
+<a name='L381'></a><a href='#L381'>381</a>
+<a name='L382'></a><a href='#L382'>382</a>
+<a name='L383'></a><a href='#L383'>383</a>
+<a name='L384'></a><a href='#L384'>384</a>
+<a name='L385'></a><a href='#L385'>385</a>
+<a name='L386'></a><a href='#L386'>386</a>
+<a name='L387'></a><a href='#L387'>387</a>
+<a name='L388'></a><a href='#L388'>388</a>
+<a name='L389'></a><a href='#L389'>389</a>
+<a name='L390'></a><a href='#L390'>390</a>
+<a name='L391'></a><a href='#L391'>391</a>
+<a name='L392'></a><a href='#L392'>392</a>
+<a name='L393'></a><a href='#L393'>393</a>
+<a name='L394'></a><a href='#L394'>394</a>
+<a name='L395'></a><a href='#L395'>395</a>
+<a name='L396'></a><a href='#L396'>396</a>
+<a name='L397'></a><a href='#L397'>397</a>
+<a name='L398'></a><a href='#L398'>398</a>
+<a name='L399'></a><a href='#L399'>399</a>
+<a name='L400'></a><a href='#L400'>400</a>
+<a name='L401'></a><a href='#L401'>401</a>
+<a name='L402'></a><a href='#L402'>402</a>
+<a name='L403'></a><a href='#L403'>403</a>
+<a name='L404'></a><a href='#L404'>404</a>
+<a name='L405'></a><a href='#L405'>405</a>
+<a name='L406'></a><a href='#L406'>406</a>
+<a name='L407'></a><a href='#L407'>407</a>
+<a name='L408'></a><a href='#L408'>408</a>
+<a name='L409'></a><a href='#L409'>409</a>
+<a name='L410'></a><a href='#L410'>410</a>
+<a name='L411'></a><a href='#L411'>411</a>
+<a name='L412'></a><a href='#L412'>412</a>
+<a name='L413'></a><a href='#L413'>413</a>
+<a name='L414'></a><a href='#L414'>414</a>
+<a name='L415'></a><a href='#L415'>415</a>
+<a name='L416'></a><a href='#L416'>416</a>
+<a name='L417'></a><a href='#L417'>417</a>
+<a name='L418'></a><a href='#L418'>418</a>
+<a name='L419'></a><a href='#L419'>419</a>
+<a name='L420'></a><a href='#L420'>420</a>
+<a name='L421'></a><a href='#L421'>421</a>
+<a name='L422'></a><a href='#L422'>422</a>
+<a name='L423'></a><a href='#L423'>423</a>
+<a name='L424'></a><a href='#L424'>424</a>
+<a name='L425'></a><a href='#L425'>425</a>
+<a name='L426'></a><a href='#L426'>426</a>
+<a name='L427'></a><a href='#L427'>427</a>
+<a name='L428'></a><a href='#L428'>428</a>
+<a name='L429'></a><a href='#L429'>429</a>
+<a name='L430'></a><a href='#L430'>430</a>
+<a name='L431'></a><a href='#L431'>431</a>
+<a name='L432'></a><a href='#L432'>432</a>
+<a name='L433'></a><a href='#L433'>433</a>
+<a name='L434'></a><a href='#L434'>434</a>
+<a name='L435'></a><a href='#L435'>435</a>
+<a name='L436'></a><a href='#L436'>436</a>
+<a name='L437'></a><a href='#L437'>437</a>
+<a name='L438'></a><a href='#L438'>438</a>
+<a name='L439'></a><a href='#L439'>439</a>
+<a name='L440'></a><a href='#L440'>440</a>
+<a name='L441'></a><a href='#L441'>441</a>
+<a name='L442'></a><a href='#L442'>442</a>
+<a name='L443'></a><a href='#L443'>443</a>
+<a name='L444'></a><a href='#L444'>444</a>
+<a name='L445'></a><a href='#L445'>445</a>
+<a name='L446'></a><a href='#L446'>446</a>
+<a name='L447'></a><a href='#L447'>447</a>
+<a name='L448'></a><a href='#L448'>448</a>
+<a name='L449'></a><a href='#L449'>449</a>
+<a name='L450'></a><a href='#L450'>450</a>
+<a name='L451'></a><a href='#L451'>451</a>
+<a name='L452'></a><a href='#L452'>452</a>
+<a name='L453'></a><a href='#L453'>453</a>
+<a name='L454'></a><a href='#L454'>454</a>
+<a name='L455'></a><a href='#L455'>455</a>
+<a name='L456'></a><a href='#L456'>456</a>
+<a name='L457'></a><a href='#L457'>457</a>
+<a name='L458'></a><a href='#L458'>458</a>
+<a name='L459'></a><a href='#L459'>459</a>
+<a name='L460'></a><a href='#L460'>460</a>
+<a name='L461'></a><a href='#L461'>461</a>
+<a name='L462'></a><a href='#L462'>462</a>
+<a name='L463'></a><a href='#L463'>463</a>
+<a name='L464'></a><a href='#L464'>464</a>
+<a name='L465'></a><a href='#L465'>465</a>
+<a name='L466'></a><a href='#L466'>466</a>
+<a name='L467'></a><a href='#L467'>467</a>
+<a name='L468'></a><a href='#L468'>468</a>
+<a name='L469'></a><a href='#L469'>469</a>
+<a name='L470'></a><a href='#L470'>470</a>
+<a name='L471'></a><a href='#L471'>471</a>
+<a name='L472'></a><a href='#L472'>472</a>
+<a name='L473'></a><a href='#L473'>473</a>
+<a name='L474'></a><a href='#L474'>474</a>
+<a name='L475'></a><a href='#L475'>475</a>
+<a name='L476'></a><a href='#L476'>476</a>
+<a name='L477'></a><a href='#L477'>477</a>
+<a name='L478'></a><a href='#L478'>478</a>
+<a name='L479'></a><a href='#L479'>479</a>
+<a name='L480'></a><a href='#L480'>480</a>
+<a name='L481'></a><a href='#L481'>481</a>
+<a name='L482'></a><a href='#L482'>482</a>
+<a name='L483'></a><a href='#L483'>483</a>
+<a name='L484'></a><a href='#L484'>484</a>
+<a name='L485'></a><a href='#L485'>485</a>
+<a name='L486'></a><a href='#L486'>486</a></td><td class="line-coverage quiet"><span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">47x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">47x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">47x</span>
+<span class="cline-any cline-yes">7x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">47x</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">47x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">16x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">15x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">15x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">14x</span>
+<span class="cline-any cline-yes">44x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">14x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-yes">48x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">48x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">18x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">18x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">11x</span>
+<span class="cline-any cline-yes">11x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">8x</span>
+<span class="cline-any cline-yes">8x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">60x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">60x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">11x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">22x</span>
+<span class="cline-any cline-yes">21x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">21x</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">17x</span>
+<span class="cline-any cline-yes">17x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">104x</span>
+<span class="cline-any cline-yes">101x</span>
+<span class="cline-any cline-yes">101x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">48x</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">7x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">7x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">7x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">7x</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">15x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">7x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import { BaseController } from '@metamask/base-controller';
+import type {
+  ControllerGetStateAction,
+  ControllerStateChangeEvent,
+  RestrictedMessenger,
+} from '@metamask/base-controller';
+import { BuiltInNetworkName, ChainId } from '@metamask/controller-utils';
+import type { MultichainNetworkControllerGetStateAction } from '@metamask/multichain-network-controller';
+import type {
+  NetworkControllerGetStateAction,
+  NetworkControllerNetworkAddedEvent,
+  NetworkControllerNetworkRemovedEvent,
+  NetworkControllerStateChangeEvent,
+} from '@metamask/network-controller';
+import type { TransactionControllerTransactionSubmittedEvent } from '@metamask/transaction-controller';
+import type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';
+import { KnownCaipNamespace } from '@metamask/utils';
+&nbsp;
+import { POPULAR_NETWORKS } from './constants';
+import { BtcScope, SolScope } from './types';
+import {
+  deriveKeys,
+  isOnlyNetworkEnabledInNamespace,
+  isPopularNetwork,
+} from './utils';
+&nbsp;
+const controllerName = 'NetworkEnablementController';
+&nbsp;
+/**
+ * Information about an ordered network.
+ */
+export type NetworksInfo = {
+  /**
+   * The network's chain id
+   */
+  networkId: CaipChainId;
+};
+&nbsp;
+/**
+ * A map of enabled networks by CAIP namespace and chain ID.
+ * For EIP-155 networks, the keys are Hex chain IDs.
+ * For other networks, the keys are CAIP chain IDs.
+ */
+type EnabledMap = Record&lt;CaipNamespace, Record&lt;CaipChainId | Hex, boolean&gt;&gt;;
+&nbsp;
+// State shape for NetworkEnablementController
+export type NetworkEnablementControllerState = {
+  enabledNetworkMap: EnabledMap;
+};
+&nbsp;
+export type NetworkEnablementControllerGetStateAction =
+  ControllerGetStateAction&lt;
+    typeof controllerName,
+    NetworkEnablementControllerState
+  &gt;;
+&nbsp;
+export type NetworkEnablementControllerSetEnabledNetworksAction = {
+  type: `${typeof controllerName}:enableNetwork`;
+  handler: NetworkEnablementController['enableNetwork'];
+};
+&nbsp;
+export type NetworkEnablementControllerDisableNetworkAction = {
+  type: `${typeof controllerName}:disableNetwork`;
+  handler: NetworkEnablementController['disableNetwork'];
+};
+&nbsp;
+/**
+ * All actions that {@link NetworkEnablementController} calls internally.
+ */
+export type AllowedActions =
+  | NetworkControllerGetStateAction
+  | MultichainNetworkControllerGetStateAction;
+&nbsp;
+export type NetworkEnablementControllerActions =
+  | NetworkEnablementControllerGetStateAction
+  | NetworkEnablementControllerSetEnabledNetworksAction
+  | NetworkEnablementControllerDisableNetworkAction;
+&nbsp;
+export type NetworkEnablementControllerStateChangeEvent =
+  ControllerStateChangeEvent&lt;
+    typeof controllerName,
+    NetworkEnablementControllerState
+  &gt;;
+&nbsp;
+export type NetworkEnablementControllerEvents =
+  NetworkEnablementControllerStateChangeEvent;
+&nbsp;
+/**
+ * All events that {@link NetworkEnablementController} subscribes to internally.
+ */
+export type AllowedEvents =
+  | NetworkControllerNetworkAddedEvent
+  | NetworkControllerNetworkRemovedEvent
+  | NetworkControllerStateChangeEvent
+  | TransactionControllerTransactionSubmittedEvent;
+&nbsp;
+export type NetworkEnablementControllerMessenger = RestrictedMessenger&lt;
+  typeof controllerName,
+  NetworkEnablementControllerActions | AllowedActions,
+  NetworkEnablementControllerEvents | AllowedEvents,
+  AllowedActions['type'],
+  AllowedEvents['type']
+&gt;;
+&nbsp;
+/**
+ * Gets the default state for the NetworkEnablementController.
+ *
+ * @returns The default state with pre-enabled networks.
+ */
+const getDefaultNetworkEnablementControllerState =
+  (): NetworkEnablementControllerState =&gt; ({
+    enabledNetworkMap: {
+      [KnownCaipNamespace.Eip155]: {
+        [ChainId[BuiltInNetworkName.Mainnet]]: true,
+        [ChainId[BuiltInNetworkName.LineaMainnet]]: true,
+        [ChainId[BuiltInNetworkName.BaseMainnet]]: true,
+      },
+      [KnownCaipNamespace.Solana]: {
+        [SolScope.Mainnet]: true,
+      },
+      [KnownCaipNamespace.Bip122]: {
+        [BtcScope.Mainnet]: true,
+        [BtcScope.Testnet]: false,
+        [BtcScope.Signet]: false,
+      },
+    },
+  });
+&nbsp;
+// Metadata for the controller state
+const metadata = {
+  enabledNetworkMap: {
+    persist: true,
+    anonymous: true,
+  },
+};
+&nbsp;
+/**
+ * Controller responsible for managing network enablement state across different blockchain networks.
+ *
+ * This controller tracks which networks are enabled/disabled for the user and provides methods
+ * to toggle network states. It supports both EVM (EIP-155) and non-EVM networks like Solana.
+ *
+ * The controller maintains a map of enabled networks organized by namespace (e.g., 'eip155', 'solana')
+ * and provides methods to query and modify network enablement states.
+ */
+export class NetworkEnablementController extends BaseController&lt;
+  typeof controllerName,
+  NetworkEnablementControllerState,
+  NetworkEnablementControllerMessenger
+&gt; {
+  /**
+   * Creates a NetworkEnablementController instance.
+   *
+   * @param args - The arguments to this function.
+   * @param args.messenger - Messenger used to communicate with BaseV2 controller.
+   * @param args.state - Initial state to set on this controller.
+   */
+  constructor({
+    messenger,
+    state,
+  }: {
+    messenger: NetworkEnablementControllerMessenger;
+    state?: Partial&lt;NetworkEnablementControllerState&gt;;
+  }) {
+    super({
+      messenger,
+      metadata,
+      name: controllerName,
+      state: {
+        ...getDefaultNetworkEnablementControllerState(),
+        ...state,
+      },
+    });
+&nbsp;
+    messenger.subscribe('NetworkController:networkAdded', ({ chainId }) =&gt; {
+      this.#onAddNetwork(chainId);
+    });
+&nbsp;
+    messenger.subscribe('NetworkController:networkRemoved', ({ chainId }) =&gt; {
+      this.#removeNetworkEntry(chainId);
+    });
+&nbsp;
+    // Listen for confirmed staking transactions
+    messenger.subscribe(
+      'TransactionController:transactionSubmitted',
+      (transactionMeta) =&gt; {
+        if (transactionMeta?.transactionMeta?.chainId) {
+          this.enableNetwork(
+            transactionMeta.transactionMeta.chainId as Hex | CaipChainId,
+          );
+        }
+      },
+    );
+  }
+&nbsp;
+  /**
+   * Enables or disables a network for the user.
+   *
+   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID
+   * (for any blockchain network). The method will automatically convert Hex chain IDs
+   * to CAIP-2 format internally. This dual parameter support allows for backward
+   * compatibility with existing EVM chain ID formats while supporting newer
+   * multi-chain standards.
+   *
+   * When enabling a non-popular network, this method will disable all other networks
+   * to ensure only one network is active at a time (exclusive mode).
+   *
+   * @param chainId - The chain ID of the network to enable or disable. Can be either:
+   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks
+   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)
+   */
+  enableNetwork(chainId: Hex | CaipChainId): void {
+    const { namespace, storageKey } = deriveKeys(chainId);
+&nbsp;
+    this.update((s) =&gt; {
+      // if the namespace bucket does not exist, return
+      // new nemespace are added only when a new network is added
+      if (!s.enabledNetworkMap[namespace]) {
+        return;
+      }
+&nbsp;
+      // disable all networks in the same namespace
+      Object.keys(s.enabledNetworkMap[namespace]).forEach((key) =&gt; {
+        s.enabledNetworkMap[namespace][key as CaipChainId | Hex] = false;
+      });
+&nbsp;
+      // enable the network
+      s.enabledNetworkMap[namespace][storageKey] = true;
+    });
+  }
+&nbsp;
+  /**
+   * Enables all popular networks and Solana mainnet.
+   *
+   * This method enables all networks defined in POPULAR_NETWORKS (EVM networks)
+   * and Solana mainnet. Unlike the enableNetwork method which has exclusive behavior,
+   * this method enables multiple networks across namespaces simultaneously.
+   *
+   * Popular networks that don't exist in NetworkController or MultichainNetworkController configurations will be skipped silently.
+   */
+  enableAllPopularNetworks(): void {
+    this.update((s) =&gt; {
+      // Get current network configurations to check if networks exist
+      const networkControllerState = this.messagingSystem.call(
+        'NetworkController:getState',
+      );
+      const multichainState = this.messagingSystem.call(
+        'MultichainNetworkController:getState',
+      );
+&nbsp;
+      // Enable all popular EVM networks that exist in NetworkController configurations
+      POPULAR_NETWORKS.forEach((chainId) =&gt; {
+        const { namespace, storageKey } = deriveKeys(chainId as Hex);
+&nbsp;
+        // Check if network exists in NetworkController configurations
+        if (
+          networkControllerState.networkConfigurationsByChainId[chainId as Hex]
+        ) {
+          // Ensure namespace bucket exists
+          this.#ensureNamespaceBucket(s, namespace);
+          // Enable the network
+          s.enabledNetworkMap[namespace][storageKey] = true;
+        }
+      });
+&nbsp;
+      // Enable Solana mainnet if it exists in MultichainNetworkController configurations
+      const solanaKeys = deriveKeys(SolScope.Mainnet as CaipChainId);
+      if (
+        multichainState.multichainNetworkConfigurationsByChainId[
+          SolScope.Mainnet
+        ]
+      ) {
+        // Ensure namespace bucket exists
+        this.#ensureNamespaceBucket(s, solanaKeys.namespace);
+        // Enable Solana mainnet
+        s.enabledNetworkMap[solanaKeys.namespace][solanaKeys.storageKey] = true;
+      }
+&nbsp;
+      // Enable Bitcoin mainnet if it exists in MultichainNetworkController configurations
+      const bitcoinKeys = deriveKeys(BtcScope.Mainnet as CaipChainId);
+      if (
+        multichainState.multichainNetworkConfigurationsByChainId[
+          BtcScope.Mainnet
+        ]
+      ) {
+        // Ensure namespace bucket exists
+        this.#ensureNamespaceBucket(s, bitcoinKeys.namespace);
+        // Enable Bitcoin mainnet
+        s.enabledNetworkMap[bitcoinKeys.namespace][bitcoinKeys.storageKey] =
+          true;
+      }
+    });
+  }
+&nbsp;
+  /**
+   * Initializes the network enablement state from network controller configurations.
+   *
+   * This method reads the current network configurations from both NetworkController
+   * and MultichainNetworkController and initializes the enabled network map accordingly.
+   * It ensures proper namespace buckets exist for all configured networks and enables
+   * popular networks by default.
+   *
+   * This method should be called after the NetworkController and MultichainNetworkController
+   * have been initialized and their configurations are available.
+   */
+  init(): void {
+    this.update((s) =&gt; {
+      // Get network configurations from NetworkController (EVM networks)
+      const networkControllerState = this.messagingSystem.call(
+        'NetworkController:getState',
+      );
+&nbsp;
+      // Get network configurations from MultichainNetworkController (all networks)
+      const multichainState = this.messagingSystem.call(
+        'MultichainNetworkController:getState',
+      );
+&nbsp;
+      // Initialize namespace buckets for EVM networks from NetworkController
+      Object.keys(
+        networkControllerState.networkConfigurationsByChainId,
+      ).forEach((chainId) =&gt; {
+        const { namespace } = deriveKeys(chainId as Hex);
+        this.#ensureNamespaceBucket(s, namespace);
+      });
+&nbsp;
+      // Initialize namespace buckets for all networks from MultichainNetworkController
+      Object.keys(
+        multichainState.multichainNetworkConfigurationsByChainId,
+      ).forEach((chainId) =&gt; {
+        const { namespace } = deriveKeys(chainId as CaipChainId);
+        this.#ensureNamespaceBucket(s, namespace);
+      });
+&nbsp;
+      // Enable popular networks that exist in the configurations
+      POPULAR_NETWORKS.forEach((chainId) =&gt; {
+        const { namespace, storageKey } = deriveKeys(chainId as Hex);
+&nbsp;
+        // Check if network exists in NetworkController configurations
+        if (
+          s.enabledNetworkMap[namespace] &amp;&amp;
+          networkControllerState.networkConfigurationsByChainId[chainId as Hex]
+        ) {
+          s.enabledNetworkMap[namespace][storageKey] = true;
+        }
+      });
+&nbsp;
+      // Enable Solana mainnet if it exists in configurations
+      const solanaKeys = deriveKeys(SolScope.Mainnet as CaipChainId);
+      if (
+        s.enabledNetworkMap[solanaKeys.namespace] &amp;&amp;
+        multichainState.multichainNetworkConfigurationsByChainId[
+          SolScope.Mainnet
+        ]
+      ) {
+        s.enabledNetworkMap[solanaKeys.namespace][solanaKeys.storageKey] = true;
+      }
+&nbsp;
+      // Enable Bitcoin mainnet if it exists in configurations
+      const bitcoinKeys = deriveKeys(BtcScope.Mainnet as CaipChainId);
+      if (
+        s.enabledNetworkMap[bitcoinKeys.namespace] &amp;&amp;
+        multichainState.multichainNetworkConfigurationsByChainId[
+          BtcScope.Mainnet
+        ]
+      ) {
+        s.enabledNetworkMap[bitcoinKeys.namespace][bitcoinKeys.storageKey] =
+          true;
+      }
+    });
+  }
+&nbsp;
+  /**
+   * Disables a network for the user.
+   *
+   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID
+   * (for any blockchain network). The method will automatically convert Hex chain IDs
+   * to CAIP-2 format internally.
+   *
+   * Note: This method will prevent disabling the last remaining enabled network
+   * to ensure at least one network is always available.
+   *
+   * @param chainId - The chain ID of the network to disable. Can be either:
+   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks
+   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)
+   */
+  disableNetwork(chainId: Hex | CaipChainId): void {
+    const derivedKeys = deriveKeys(chainId);
+    const { namespace, storageKey } = derivedKeys;
+&nbsp;
+    if (isOnlyNetworkEnabledInNamespace(this.state, derivedKeys)) {
+      throw new Error('Cannot disable the last remaining enabled network');
+    }
+&nbsp;
+    this.update((s) =&gt; {
+      s.enabledNetworkMap[namespace][storageKey] = false;
+    });
+  }
+&nbsp;
+  /**
+   * Checks if a network is enabled.
+   *
+   * @param chainId - The chain ID of the network to check. Can be either:
+   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks
+   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)
+   * @returns True if the network is enabled, false otherwise
+   */
+  isNetworkEnabled(chainId: Hex | CaipChainId): boolean {
+    const derivedKeys = deriveKeys(chainId);
+    const { namespace, storageKey } = derivedKeys;
+    return this.state.enabledNetworkMap[namespace]?.[storageKey] ?? false;
+  }
+&nbsp;
+  /**
+   * Ensures that a namespace bucket exists in the state.
+   *
+   * This method creates the namespace entry in the enabledNetworkMap if it doesn't
+   * already exist. This is used to prepare the state structure before adding
+   * network entries.
+   *
+   * @param state - The current controller state
+   * @param ns - The CAIP namespace to ensure exists
+   */
+  #ensureNamespaceBucket(
+    state: NetworkEnablementControllerState,
+    ns: CaipNamespace,
+  ) {
+    if (!state.enabledNetworkMap[ns]) {
+      state.enabledNetworkMap[ns] = {};
+    }
+  }
+&nbsp;
+  /**
+   * Removes a network entry from the state.
+   *
+   * This method is called when a network is removed from the system. It cleans up
+   * the network entry and ensures that at least one network remains enabled.
+   *
+   * @param chainId - The chain ID to remove (Hex or CAIP-2 format)
+   */
+  #removeNetworkEntry(chainId: Hex | CaipChainId): void {
+    const derivedKeys = deriveKeys(chainId);
+    const { namespace, storageKey } = derivedKeys;
+&nbsp;
+    this.update((s) =&gt; {
+      // fallback and enable ethereum mainnet
+      if (isOnlyNetworkEnabledInNamespace(this.state, derivedKeys)) {
+        s.enabledNetworkMap[namespace][ChainId[BuiltInNetworkName.Mainnet]] =
+          true;
+      }
+&nbsp;
+      if (namespace in s.enabledNetworkMap) {
+        delete s.enabledNetworkMap[namespace][storageKey];
+      }
+    });
+  }
+&nbsp;
+  /**
+   * Handles the addition of a new network to the controller.
+   *
+   * This method is called when a network is added to the system. It automatically
+   * enables the new network and implements exclusive mode for non-popular networks.
+   * If the network already exists, no changes are made.
+   *
+   * @param chainId - The chain ID of the network being added (Hex or CAIP-2 format)
+   */
+  #onAddNetwork(chainId: Hex | CaipChainId): void {
+    const { namespace, storageKey, reference } = deriveKeys(chainId);
+&nbsp;
+    this.update((s) =&gt; {
+      // Ensure the namespace bucket exists
+      this.#ensureNamespaceBucket(s, namespace);
+&nbsp;
+      // If adding a non-popular network, disable all other networks in the same namespace
+      // This implements exclusive mode where only one non-popular network can be active
+      if (!isPopularNetwork(reference)) {
+        Object.keys(s.enabledNetworkMap[namespace]).forEach((key) =&gt; {
+          s.enabledNetworkMap[namespace][key as CaipChainId | Hex] = false;
+        });
+      }
+&nbsp;
+      // Add the new network as enabled
+      s.enabledNetworkMap[namespace][storageKey] = true;
+    });
+  }
+}
+&nbsp;</pre></td></tr></table></pre>
+
+                <div class='push'></div><!-- for sticky footer -->
+            </div><!-- /wrapper -->
+            <div class='footer quiet pad2 space-top1 center small'>
+                Code coverage generated by
+                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
+                at 2025-09-04T23:19:41.560Z
+            </div>
+        <script src="prettify.js"></script>
+        <script>
+            window.onload = function () {
+                prettyPrint();
+            };
+        </script>
+        <script src="sorter.js"></script>
+        <script src="block-navigation.js"></script>
+    </body>
+</html>
+    
\ No newline at end of file
diff --git a/coverage/lcov-report/base.css b/coverage/lcov-report/base.css
new file mode 100644
index 0000000000000000000000000000000000000000..f418035b469aff23689a74c912849662f442aed4
--- /dev/null
+++ b/coverage/lcov-report/base.css
@@ -0,0 +1,224 @@
+body, html {
+  margin:0; padding: 0;
+  height: 100%;
+}
+body {
+    font-family: Helvetica Neue, Helvetica, Arial;
+    font-size: 14px;
+    color:#333;
+}
+.small { font-size: 12px; }
+*, *:after, *:before {
+  -webkit-box-sizing:border-box;
+     -moz-box-sizing:border-box;
+          box-sizing:border-box;
+  }
+h1 { font-size: 20px; margin: 0;}
+h2 { font-size: 14px; }
+pre {
+    font: 12px/1.4 Consolas, "Liberation Mono", Menlo, Courier, monospace;
+    margin: 0;
+    padding: 0;
+    -moz-tab-size: 2;
+    -o-tab-size:  2;
+    tab-size: 2;
+}
+a { color:#0074D9; text-decoration:none; }
+a:hover { text-decoration:underline; }
+.strong { font-weight: bold; }
+.space-top1 { padding: 10px 0 0 0; }
+.pad2y { padding: 20px 0; }
+.pad1y { padding: 10px 0; }
+.pad2x { padding: 0 20px; }
+.pad2 { padding: 20px; }
+.pad1 { padding: 10px; }
+.space-left2 { padding-left:55px; }
+.space-right2 { padding-right:20px; }
+.center { text-align:center; }
+.clearfix { display:block; }
+.clearfix:after {
+  content:'';
+  display:block;
+  height:0;
+  clear:both;
+  visibility:hidden;
+  }
+.fl { float: left; }
+@media only screen and (max-width:640px) {
+  .col3 { width:100%; max-width:100%; }
+  .hide-mobile { display:none!important; }
+}
+
+.quiet {
+  color: #7f7f7f;
+  color: rgba(0,0,0,0.5);
+}
+.quiet a { opacity: 0.7; }
+
+.fraction {
+  font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace;
+  font-size: 10px;
+  color: #555;
+  background: #E8E8E8;
+  padding: 4px 5px;
+  border-radius: 3px;
+  vertical-align: middle;
+}
+
+div.path a:link, div.path a:visited { color: #333; }
+table.coverage {
+  border-collapse: collapse;
+  margin: 10px 0 0 0;
+  padding: 0;
+}
+
+table.coverage td {
+  margin: 0;
+  padding: 0;
+  vertical-align: top;
+}
+table.coverage td.line-count {
+    text-align: right;
+    padding: 0 5px 0 20px;
+}
+table.coverage td.line-coverage {
+    text-align: right;
+    padding-right: 10px;
+    min-width:20px;
+}
+
+table.coverage td span.cline-any {
+    display: inline-block;
+    padding: 0 5px;
+    width: 100%;
+}
+.missing-if-branch {
+    display: inline-block;
+    margin-right: 5px;
+    border-radius: 3px;
+    position: relative;
+    padding: 0 4px;
+    background: #333;
+    color: yellow;
+}
+
+.skip-if-branch {
+    display: none;
+    margin-right: 10px;
+    position: relative;
+    padding: 0 4px;
+    background: #ccc;
+    color: white;
+}
+.missing-if-branch .typ, .skip-if-branch .typ {
+    color: inherit !important;
+}
+.coverage-summary {
+  border-collapse: collapse;
+  width: 100%;
+}
+.coverage-summary tr { border-bottom: 1px solid #bbb; }
+.keyline-all { border: 1px solid #ddd; }
+.coverage-summary td, .coverage-summary th { padding: 10px; }
+.coverage-summary tbody { border: 1px solid #bbb; }
+.coverage-summary td { border-right: 1px solid #bbb; }
+.coverage-summary td:last-child { border-right: none; }
+.coverage-summary th {
+  text-align: left;
+  font-weight: normal;
+  white-space: nowrap;
+}
+.coverage-summary th.file { border-right: none !important; }
+.coverage-summary th.pct { }
+.coverage-summary th.pic,
+.coverage-summary th.abs,
+.coverage-summary td.pct,
+.coverage-summary td.abs { text-align: right; }
+.coverage-summary td.file { white-space: nowrap;  }
+.coverage-summary td.pic { min-width: 120px !important;  }
+.coverage-summary tfoot td { }
+
+.coverage-summary .sorter {
+    height: 10px;
+    width: 7px;
+    display: inline-block;
+    margin-left: 0.5em;
+    background: url(sort-arrow-sprite.png) no-repeat scroll 0 0 transparent;
+}
+.coverage-summary .sorted .sorter {
+    background-position: 0 -20px;
+}
+.coverage-summary .sorted-desc .sorter {
+    background-position: 0 -10px;
+}
+.status-line {  height: 10px; }
+/* yellow */
+.cbranch-no { background: yellow !important; color: #111; }
+/* dark red */
+.red.solid, .status-line.low, .low .cover-fill { background:#C21F39 }
+.low .chart { border:1px solid #C21F39 }
+.highlighted,
+.highlighted .cstat-no, .highlighted .fstat-no, .highlighted .cbranch-no{
+  background: #C21F39 !important;
+}
+/* medium red */
+.cstat-no, .fstat-no, .cbranch-no, .cbranch-no { background:#F6C6CE }
+/* light red */
+.low, .cline-no { background:#FCE1E5 }
+/* light green */
+.high, .cline-yes { background:rgb(230,245,208) }
+/* medium green */
+.cstat-yes { background:rgb(161,215,106) }
+/* dark green */
+.status-line.high, .high .cover-fill { background:rgb(77,146,33) }
+.high .chart { border:1px solid rgb(77,146,33) }
+/* dark yellow (gold) */
+.status-line.medium, .medium .cover-fill { background: #f9cd0b; }
+.medium .chart { border:1px solid #f9cd0b; }
+/* light yellow */
+.medium { background: #fff4c2; }
+
+.cstat-skip { background: #ddd; color: #111; }
+.fstat-skip { background: #ddd; color: #111 !important; }
+.cbranch-skip { background: #ddd !important; color: #111; }
+
+span.cline-neutral { background: #eaeaea; }
+
+.coverage-summary td.empty {
+    opacity: .5;
+    padding-top: 4px;
+    padding-bottom: 4px;
+    line-height: 1;
+    color: #888;
+}
+
+.cover-fill, .cover-empty {
+  display:inline-block;
+  height: 12px;
+}
+.chart {
+  line-height: 0;
+}
+.cover-empty {
+    background: white;
+}
+.cover-full {
+    border-right: none !important;
+}
+pre.prettyprint {
+    border: none !important;
+    padding: 0 !important;
+    margin: 0 !important;
+}
+.com { color: #999 !important; }
+.ignore-none { color: #999; font-weight: normal; }
+
+.wrapper {
+  min-height: 100%;
+  height: auto !important;
+  height: 100%;
+  margin: 0 auto -48px;
+}
+.footer, .push {
+  height: 48px;
+}
diff --git a/coverage/lcov-report/block-navigation.js b/coverage/lcov-report/block-navigation.js
new file mode 100644
index 0000000000000000000000000000000000000000..cc121302316c8faaaebfd6a15f4212d99e563199
--- /dev/null
+++ b/coverage/lcov-report/block-navigation.js
@@ -0,0 +1,87 @@
+/* eslint-disable */
+var jumpToCode = (function init() {
+    // Classes of code we would like to highlight in the file view
+    var missingCoverageClasses = ['.cbranch-no', '.cstat-no', '.fstat-no'];
+
+    // Elements to highlight in the file listing view
+    var fileListingElements = ['td.pct.low'];
+
+    // We don't want to select elements that are direct descendants of another match
+    var notSelector = ':not(' + missingCoverageClasses.join('):not(') + ') > '; // becomes `:not(a):not(b) > `
+
+    // Selecter that finds elements on the page to which we can jump
+    var selector =
+        fileListingElements.join(', ') +
+        ', ' +
+        notSelector +
+        missingCoverageClasses.join(', ' + notSelector); // becomes `:not(a):not(b) > a, :not(a):not(b) > b`
+
+    // The NodeList of matching elements
+    var missingCoverageElements = document.querySelectorAll(selector);
+
+    var currentIndex;
+
+    function toggleClass(index) {
+        missingCoverageElements
+            .item(currentIndex)
+            .classList.remove('highlighted');
+        missingCoverageElements.item(index).classList.add('highlighted');
+    }
+
+    function makeCurrent(index) {
+        toggleClass(index);
+        currentIndex = index;
+        missingCoverageElements.item(index).scrollIntoView({
+            behavior: 'smooth',
+            block: 'center',
+            inline: 'center'
+        });
+    }
+
+    function goToPrevious() {
+        var nextIndex = 0;
+        if (typeof currentIndex !== 'number' || currentIndex === 0) {
+            nextIndex = missingCoverageElements.length - 1;
+        } else if (missingCoverageElements.length > 1) {
+            nextIndex = currentIndex - 1;
+        }
+
+        makeCurrent(nextIndex);
+    }
+
+    function goToNext() {
+        var nextIndex = 0;
+
+        if (
+            typeof currentIndex === 'number' &&
+            currentIndex < missingCoverageElements.length - 1
+        ) {
+            nextIndex = currentIndex + 1;
+        }
+
+        makeCurrent(nextIndex);
+    }
+
+    return function jump(event) {
+        if (
+            document.getElementById('fileSearch') === document.activeElement &&
+            document.activeElement != null
+        ) {
+            // if we're currently focused on the search input, we don't want to navigate
+            return;
+        }
+
+        switch (event.which) {
+            case 78: // n
+            case 74: // j
+                goToNext();
+                break;
+            case 66: // b
+            case 75: // k
+            case 80: // p
+                goToPrevious();
+                break;
+        }
+    };
+})();
+window.addEventListener('keydown', jumpToCode);
diff --git a/coverage/lcov-report/constants.ts.html b/coverage/lcov-report/constants.ts.html
new file mode 100644
index 0000000000000000000000000000000000000000..fea9e274d01aab0116b79fea352715013308c4da
--- /dev/null
+++ b/coverage/lcov-report/constants.ts.html
@@ -0,0 +1,127 @@
+
+<!doctype html>
+<html lang="en">
+
+<head>
+    <title>Code coverage report for constants.ts</title>
+    <meta charset="utf-8" />
+    <link rel="stylesheet" href="prettify.css" />
+    <link rel="stylesheet" href="base.css" />
+    <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
+    <meta name="viewport" content="width=device-width, initial-scale=1" />
+    <style type='text/css'>
+        .coverage-summary .sorter {
+            background-image: url(sort-arrow-sprite.png);
+        }
+    </style>
+</head>
+    
+<body>
+<div class='wrapper'>
+    <div class='pad1'>
+        <h1><a href="index.html">All files</a> constants.ts</h1>
+        <div class='clearfix'>
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Statements</span>
+                <span class='fraction'>1/1</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Branches</span>
+                <span class='fraction'>0/0</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Functions</span>
+                <span class='fraction'>0/0</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Lines</span>
+                <span class='fraction'>1/1</span>
+            </div>
+        
+            
+        </div>
+        <p class="quiet">
+            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
+        </p>
+        <template id="filterTemplate">
+            <div class="quiet">
+                Filter:
+                <input type="search" id="fileSearch">
+            </div>
+        </template>
+    </div>
+    <div class='status-line high'></div>
+    <pre><table class="coverage">
+<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
+<a name='L2'></a><a href='#L2'>2</a>
+<a name='L3'></a><a href='#L3'>3</a>
+<a name='L4'></a><a href='#L4'>4</a>
+<a name='L5'></a><a href='#L5'>5</a>
+<a name='L6'></a><a href='#L6'>6</a>
+<a name='L7'></a><a href='#L7'>7</a>
+<a name='L8'></a><a href='#L8'>8</a>
+<a name='L9'></a><a href='#L9'>9</a>
+<a name='L10'></a><a href='#L10'>10</a>
+<a name='L11'></a><a href='#L11'>11</a>
+<a name='L12'></a><a href='#L12'>12</a>
+<a name='L13'></a><a href='#L13'>13</a>
+<a name='L14'></a><a href='#L14'>14</a>
+<a name='L15'></a><a href='#L15'>15</a></td><td class="line-coverage quiet"><span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">export const POPULAR_NETWORKS = [
+  '0x1', // Ethereum Mainnet
+  '0xe708', // Linea (59144)
+  '0x2105', // Base (8453)
+  '0xa4b1', // Arbitrum One (42161)
+  '0xa86a', // Avalanche C-Chain (43114)
+  '0x38', // BNB Smart Chain (56)
+  '0xa', // Optimism (10)
+  '0x89', // Polygon (137)
+  '0x531', // Sei (Assuming 1329 used in EVM context)
+  '0x144', // zkSync Era (324)
+  '0x2a15c308d', // Palm (11297108109)
+  '0x3e7', // HyperEVM (999)
+];
+&nbsp;</pre></td></tr></table></pre>
+
+                <div class='push'></div><!-- for sticky footer -->
+            </div><!-- /wrapper -->
+            <div class='footer quiet pad2 space-top1 center small'>
+                Code coverage generated by
+                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
+                at 2025-09-04T23:19:41.560Z
+            </div>
+        <script src="prettify.js"></script>
+        <script>
+            window.onload = function () {
+                prettyPrint();
+            };
+        </script>
+        <script src="sorter.js"></script>
+        <script src="block-navigation.js"></script>
+    </body>
+</html>
+    
\ No newline at end of file
diff --git a/coverage/lcov-report/favicon.png b/coverage/lcov-report/favicon.png
new file mode 100644
index 0000000000000000000000000000000000000000..c1525b811a167671e9de1fa78aab9f5c0b61cef7
--- /dev/null
+++ b/coverage/lcov-report/favicon.png
@@ -0,0 +1,3 @@
+PNG
+
+   IHDR         h6  IDATxApfT6vq8UF\m[:C\D,y/ bLIB>s1/8z: oK.\I>|Ob'+ .W"!~PJ	IIh3^rs{3p3->!+rM-\t=w4&Da%U*;Jgfzk KJMZ}%2QUXliE!dPh\OI>fJOi( B|u`iz|!fDPV"%kI"g% hHcQ`F; ?E    IENDB`
\ No newline at end of file
diff --git a/coverage/lcov-report/index.html b/coverage/lcov-report/index.html
new file mode 100644
index 0000000000000000000000000000000000000000..bca0aa58ca576f0f73730a0a3350c6928f8dc4e8
--- /dev/null
+++ b/coverage/lcov-report/index.html
@@ -0,0 +1,176 @@
+
+<!doctype html>
+<html lang="en">
+
+<head>
+    <title>Code coverage report for All files</title>
+    <meta charset="utf-8" />
+    <link rel="stylesheet" href="prettify.css" />
+    <link rel="stylesheet" href="base.css" />
+    <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
+    <meta name="viewport" content="width=device-width, initial-scale=1" />
+    <style type='text/css'>
+        .coverage-summary .sorter {
+            background-image: url(sort-arrow-sprite.png);
+        }
+    </style>
+</head>
+    
+<body>
+<div class='wrapper'>
+    <div class='pad1'>
+        <h1>All files</h1>
+        <div class='clearfix'>
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Statements</span>
+                <span class='fraction'>151/151</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Branches</span>
+                <span class='fraction'>38/38</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Functions</span>
+                <span class='fraction'>45/45</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Lines</span>
+                <span class='fraction'>147/147</span>
+            </div>
+        
+            
+        </div>
+        <p class="quiet">
+            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
+        </p>
+        <template id="filterTemplate">
+            <div class="quiet">
+                Filter:
+                <input type="search" id="fileSearch">
+            </div>
+        </template>
+    </div>
+    <div class='status-line high'></div>
+    <div class="pad1">
+<table class="coverage-summary">
+<thead>
+<tr>
+   <th data-col="file" data-fmt="html" data-html="true" class="file">File</th>
+   <th data-col="pic" data-type="number" data-fmt="html" data-html="true" class="pic"></th>
+   <th data-col="statements" data-type="number" data-fmt="pct" class="pct">Statements</th>
+   <th data-col="statements_raw" data-type="number" data-fmt="html" class="abs"></th>
+   <th data-col="branches" data-type="number" data-fmt="pct" class="pct">Branches</th>
+   <th data-col="branches_raw" data-type="number" data-fmt="html" class="abs"></th>
+   <th data-col="functions" data-type="number" data-fmt="pct" class="pct">Functions</th>
+   <th data-col="functions_raw" data-type="number" data-fmt="html" class="abs"></th>
+   <th data-col="lines" data-type="number" data-fmt="pct" class="pct">Lines</th>
+   <th data-col="lines_raw" data-type="number" data-fmt="html" class="abs"></th>
+</tr>
+</thead>
+<tbody><tr>
+	<td class="file high" data-value="NetworkEnablementController.ts"><a href="NetworkEnablementController.ts.html">NetworkEnablementController.ts</a></td>
+	<td data-value="100" class="pic high">
+	<div class="chart"><div class="cover-fill cover-full" style="width: 100%"></div><div class="cover-empty" style="width: 0%"></div></div>
+	</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="87" class="abs high">87/87</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="21" class="abs high">21/21</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="25" class="abs high">25/25</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="86" class="abs high">86/86</td>
+	</tr>
+
+<tr>
+	<td class="file high" data-value="constants.ts"><a href="constants.ts.html">constants.ts</a></td>
+	<td data-value="100" class="pic high">
+	<div class="chart"><div class="cover-fill cover-full" style="width: 100%"></div><div class="cover-empty" style="width: 0%"></div></div>
+	</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="1" class="abs high">1/1</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="0" class="abs high">0/0</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="0" class="abs high">0/0</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="1" class="abs high">1/1</td>
+	</tr>
+
+<tr>
+	<td class="file high" data-value="selectors.ts"><a href="selectors.ts.html">selectors.ts</a></td>
+	<td data-value="100" class="pic high">
+	<div class="chart"><div class="cover-fill cover-full" style="width: 100%"></div><div class="cover-empty" style="width: 0%"></div></div>
+	</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="29" class="abs high">29/29</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="5" class="abs high">5/5</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="14" class="abs high">14/14</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="26" class="abs high">26/26</td>
+	</tr>
+
+<tr>
+	<td class="file high" data-value="types.ts"><a href="types.ts.html">types.ts</a></td>
+	<td data-value="100" class="pic high">
+	<div class="chart"><div class="cover-fill cover-full" style="width: 100%"></div><div class="cover-empty" style="width: 0%"></div></div>
+	</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="8" class="abs high">8/8</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="4" class="abs high">4/4</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="2" class="abs high">2/2</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="8" class="abs high">8/8</td>
+	</tr>
+
+<tr>
+	<td class="file high" data-value="utils.ts"><a href="utils.ts.html">utils.ts</a></td>
+	<td data-value="100" class="pic high">
+	<div class="chart"><div class="cover-fill cover-full" style="width: 100%"></div><div class="cover-empty" style="width: 0%"></div></div>
+	</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="26" class="abs high">26/26</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="8" class="abs high">8/8</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="4" class="abs high">4/4</td>
+	<td data-value="100" class="pct high">100%</td>
+	<td data-value="26" class="abs high">26/26</td>
+	</tr>
+
+</tbody>
+</table>
+</div>
+                <div class='push'></div><!-- for sticky footer -->
+            </div><!-- /wrapper -->
+            <div class='footer quiet pad2 space-top1 center small'>
+                Code coverage generated by
+                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
+                at 2025-09-04T23:19:41.560Z
+            </div>
+        <script src="prettify.js"></script>
+        <script>
+            window.onload = function () {
+                prettyPrint();
+            };
+        </script>
+        <script src="sorter.js"></script>
+        <script src="block-navigation.js"></script>
+    </body>
+</html>
+    
\ No newline at end of file
diff --git a/coverage/lcov-report/prettify.css b/coverage/lcov-report/prettify.css
new file mode 100644
index 0000000000000000000000000000000000000000..b317a7cda31a440fbd47540297ee3c68d51f343e
--- /dev/null
+++ b/coverage/lcov-report/prettify.css
@@ -0,0 +1 @@
+.pln{color:#000}@media screen{.str{color:#080}.kwd{color:#008}.com{color:#800}.typ{color:#606}.lit{color:#066}.pun,.opn,.clo{color:#660}.tag{color:#008}.atn{color:#606}.atv{color:#080}.dec,.var{color:#606}.fun{color:red}}@media print,projection{.str{color:#060}.kwd{color:#006;font-weight:bold}.com{color:#600;font-style:italic}.typ{color:#404;font-weight:bold}.lit{color:#044}.pun,.opn,.clo{color:#440}.tag{color:#006;font-weight:bold}.atn{color:#404}.atv{color:#060}}pre.prettyprint{padding:2px;border:1px solid #888}ol.linenums{margin-top:0;margin-bottom:0}li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8{list-style-type:none}li.L1,li.L3,li.L5,li.L7,li.L9{background:#eee}
diff --git a/coverage/lcov-report/prettify.js b/coverage/lcov-report/prettify.js
new file mode 100644
index 0000000000000000000000000000000000000000..b3225238f26e3ab49a5e41e9cb287a73c82740b7
--- /dev/null
+++ b/coverage/lcov-report/prettify.js
@@ -0,0 +1,2 @@
+/* eslint-disable */
+window.PR_SHOULD_USE_CONTINUATION=true;(function(){var h=["break,continue,do,else,for,if,return,while"];var u=[h,"auto,case,char,const,default,double,enum,extern,float,goto,int,long,register,short,signed,sizeof,static,struct,switch,typedef,union,unsigned,void,volatile"];var p=[u,"catch,class,delete,false,import,new,operator,private,protected,public,this,throw,true,try,typeof"];var l=[p,"alignof,align_union,asm,axiom,bool,concept,concept_map,const_cast,constexpr,decltype,dynamic_cast,explicit,export,friend,inline,late_check,mutable,namespace,nullptr,reinterpret_cast,static_assert,static_cast,template,typeid,typename,using,virtual,where"];var x=[p,"abstract,boolean,byte,extends,final,finally,implements,import,instanceof,null,native,package,strictfp,super,synchronized,throws,transient"];var R=[x,"as,base,by,checked,decimal,delegate,descending,dynamic,event,fixed,foreach,from,group,implicit,in,interface,internal,into,is,lock,object,out,override,orderby,params,partial,readonly,ref,sbyte,sealed,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,var"];var r="all,and,by,catch,class,else,extends,false,finally,for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,true,try,unless,until,when,while,yes";var w=[p,"debugger,eval,export,function,get,null,set,undefined,var,with,Infinity,NaN"];var s="caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END";var I=[h,"and,as,assert,class,def,del,elif,except,exec,finally,from,global,import,in,is,lambda,nonlocal,not,or,pass,print,raise,try,with,yield,False,True,None"];var f=[h,"alias,and,begin,case,class,def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,rescue,retry,self,super,then,true,undef,unless,until,when,yield,BEGIN,END"];var H=[h,"case,done,elif,esac,eval,fi,function,in,local,set,then,until"];var A=[l,R,w,s+I,f,H];var e=/^(DIR|FILE|vector|(de|priority_)?queue|list|stack|(const_)?iterator|(multi)?(set|map)|bitset|u?(int|float)\d*)/;var C="str";var z="kwd";var j="com";var O="typ";var G="lit";var L="pun";var F="pln";var m="tag";var E="dec";var J="src";var P="atn";var n="atv";var N="nocode";var M="(?:^^\\.?|[+-]|\\!|\\!=|\\!==|\\#|\\%|\\%=|&|&&|&&=|&=|\\(|\\*|\\*=|\\+=|\\,|\\-=|\\->|\\/|\\/=|:|::|\\;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\@|\\[|\\^|\\^=|\\^\\^|\\^\\^=|\\{|\\||\\|=|\\|\\||\\|\\|=|\\~|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\\s*";function k(Z){var ad=0;var S=false;var ac=false;for(var V=0,U=Z.length;V<U;++V){var ae=Z[V];if(ae.ignoreCase){ac=true}else{if(/[a-z]/i.test(ae.source.replace(/\\u[0-9a-f]{4}|\\x[0-9a-f]{2}|\\[^ux]/gi,""))){S=true;ac=false;break}}}var Y={b:8,t:9,n:10,v:11,f:12,r:13};function ab(ah){var ag=ah.charCodeAt(0);if(ag!==92){return ag}var af=ah.charAt(1);ag=Y[af];if(ag){return ag}else{if("0"<=af&&af<="7"){return parseInt(ah.substring(1),8)}else{if(af==="u"||af==="x"){return parseInt(ah.substring(2),16)}else{return ah.charCodeAt(1)}}}}function T(af){if(af<32){return(af<16?"\\x0":"\\x")+af.toString(16)}var ag=String.fromCharCode(af);if(ag==="\\"||ag==="-"||ag==="["||ag==="]"){ag="\\"+ag}return ag}function X(am){var aq=am.substring(1,am.length-1).match(new RegExp("\\\\u[0-9A-Fa-f]{4}|\\\\x[0-9A-Fa-f]{2}|\\\\[0-3][0-7]{0,2}|\\\\[0-7]{1,2}|\\\\[\\s\\S]|-|[^-\\\\]","g"));var ak=[];var af=[];var ao=aq[0]==="^";for(var ar=ao?1:0,aj=aq.length;ar<aj;++ar){var ah=aq[ar];if(/\\[bdsw]/i.test(ah)){ak.push(ah)}else{var ag=ab(ah);var al;if(ar+2<aj&&"-"===aq[ar+1]){al=ab(aq[ar+2]);ar+=2}else{al=ag}af.push([ag,al]);if(!(al<65||ag>122)){if(!(al<65||ag>90)){af.push([Math.max(65,ag)|32,Math.min(al,90)|32])}if(!(al<97||ag>122)){af.push([Math.max(97,ag)&~32,Math.min(al,122)&~32])}}}}af.sort(function(av,au){return(av[0]-au[0])||(au[1]-av[1])});var ai=[];var ap=[NaN,NaN];for(var ar=0;ar<af.length;++ar){var at=af[ar];if(at[0]<=ap[1]+1){ap[1]=Math.max(ap[1],at[1])}else{ai.push(ap=at)}}var an=["["];if(ao){an.push("^")}an.push.apply(an,ak);for(var ar=0;ar<ai.length;++ar){var at=ai[ar];an.push(T(at[0]));if(at[1]>at[0]){if(at[1]+1>at[0]){an.push("-")}an.push(T(at[1]))}}an.push("]");return an.join("")}function W(al){var aj=al.source.match(new RegExp("(?:\\[(?:[^\\x5C\\x5D]|\\\\[\\s\\S])*\\]|\\\\u[A-Fa-f0-9]{4}|\\\\x[A-Fa-f0-9]{2}|\\\\[0-9]+|\\\\[^ux0-9]|\\(\\?[:!=]|[\\(\\)\\^]|[^\\x5B\\x5C\\(\\)\\^]+)","g"));var ah=aj.length;var an=[];for(var ak=0,am=0;ak<ah;++ak){var ag=aj[ak];if(ag==="("){++am}else{if("\\"===ag.charAt(0)){var af=+ag.substring(1);if(af&&af<=am){an[af]=-1}}}}for(var ak=1;ak<an.length;++ak){if(-1===an[ak]){an[ak]=++ad}}for(var ak=0,am=0;ak<ah;++ak){var ag=aj[ak];if(ag==="("){++am;if(an[am]===undefined){aj[ak]="(?:"}}else{if("\\"===ag.charAt(0)){var af=+ag.substring(1);if(af&&af<=am){aj[ak]="\\"+an[am]}}}}for(var ak=0,am=0;ak<ah;++ak){if("^"===aj[ak]&&"^"!==aj[ak+1]){aj[ak]=""}}if(al.ignoreCase&&S){for(var ak=0;ak<ah;++ak){var ag=aj[ak];var ai=ag.charAt(0);if(ag.length>=2&&ai==="["){aj[ak]=X(ag)}else{if(ai!=="\\"){aj[ak]=ag.replace(/[a-zA-Z]/g,function(ao){var ap=ao.charCodeAt(0);return"["+String.fromCharCode(ap&~32,ap|32)+"]"})}}}}return aj.join("")}var aa=[];for(var V=0,U=Z.length;V<U;++V){var ae=Z[V];if(ae.global||ae.multiline){throw new Error(""+ae)}aa.push("(?:"+W(ae)+")")}return new RegExp(aa.join("|"),ac?"gi":"g")}function a(V){var U=/(?:^|\s)nocode(?:\s|$)/;var X=[];var T=0;var Z=[];var W=0;var S;if(V.currentStyle){S=V.currentStyle.whiteSpace}else{if(window.getComputedStyle){S=document.defaultView.getComputedStyle(V,null).getPropertyValue("white-space")}}var Y=S&&"pre"===S.substring(0,3);function aa(ab){switch(ab.nodeType){case 1:if(U.test(ab.className)){return}for(var ae=ab.firstChild;ae;ae=ae.nextSibling){aa(ae)}var ad=ab.nodeName;if("BR"===ad||"LI"===ad){X[W]="\n";Z[W<<1]=T++;Z[(W++<<1)|1]=ab}break;case 3:case 4:var ac=ab.nodeValue;if(ac.length){if(!Y){ac=ac.replace(/[ \t\r\n]+/g," ")}else{ac=ac.replace(/\r\n?/g,"\n")}X[W]=ac;Z[W<<1]=T;T+=ac.length;Z[(W++<<1)|1]=ab}break}}aa(V);return{sourceCode:X.join("").replace(/\n$/,""),spans:Z}}function B(S,U,W,T){if(!U){return}var V={sourceCode:U,basePos:S};W(V);T.push.apply(T,V.decorations)}var v=/\S/;function o(S){var V=undefined;for(var U=S.firstChild;U;U=U.nextSibling){var T=U.nodeType;V=(T===1)?(V?S:U):(T===3)?(v.test(U.nodeValue)?S:V):V}return V===S?undefined:V}function g(U,T){var S={};var V;(function(){var ad=U.concat(T);var ah=[];var ag={};for(var ab=0,Z=ad.length;ab<Z;++ab){var Y=ad[ab];var ac=Y[3];if(ac){for(var ae=ac.length;--ae>=0;){S[ac.charAt(ae)]=Y}}var af=Y[1];var aa=""+af;if(!ag.hasOwnProperty(aa)){ah.push(af);ag[aa]=null}}ah.push(/[\0-\uffff]/);V=k(ah)})();var X=T.length;var W=function(ah){var Z=ah.sourceCode,Y=ah.basePos;var ad=[Y,F];var af=0;var an=Z.match(V)||[];var aj={};for(var ae=0,aq=an.length;ae<aq;++ae){var ag=an[ae];var ap=aj[ag];var ai=void 0;var am;if(typeof ap==="string"){am=false}else{var aa=S[ag.charAt(0)];if(aa){ai=ag.match(aa[1]);ap=aa[0]}else{for(var ao=0;ao<X;++ao){aa=T[ao];ai=ag.match(aa[1]);if(ai){ap=aa[0];break}}if(!ai){ap=F}}am=ap.length>=5&&"lang-"===ap.substring(0,5);if(am&&!(ai&&typeof ai[1]==="string")){am=false;ap=J}if(!am){aj[ag]=ap}}var ab=af;af+=ag.length;if(!am){ad.push(Y+ab,ap)}else{var al=ai[1];var ak=ag.indexOf(al);var ac=ak+al.length;if(ai[2]){ac=ag.length-ai[2].length;ak=ac-al.length}var ar=ap.substring(5);B(Y+ab,ag.substring(0,ak),W,ad);B(Y+ab+ak,al,q(ar,al),ad);B(Y+ab+ac,ag.substring(ac),W,ad)}}ah.decorations=ad};return W}function i(T){var W=[],S=[];if(T.tripleQuotedStrings){W.push([C,/^(?:\'\'\'(?:[^\'\\]|\\[\s\S]|\'{1,2}(?=[^\']))*(?:\'\'\'|$)|\"\"\"(?:[^\"\\]|\\[\s\S]|\"{1,2}(?=[^\"]))*(?:\"\"\"|$)|\'(?:[^\\\']|\\[\s\S])*(?:\'|$)|\"(?:[^\\\"]|\\[\s\S])*(?:\"|$))/,null,"'\""])}else{if(T.multiLineStrings){W.push([C,/^(?:\'(?:[^\\\']|\\[\s\S])*(?:\'|$)|\"(?:[^\\\"]|\\[\s\S])*(?:\"|$)|\`(?:[^\\\`]|\\[\s\S])*(?:\`|$))/,null,"'\"`"])}else{W.push([C,/^(?:\'(?:[^\\\'\r\n]|\\.)*(?:\'|$)|\"(?:[^\\\"\r\n]|\\.)*(?:\"|$))/,null,"\"'"])}}if(T.verbatimStrings){S.push([C,/^@\"(?:[^\"]|\"\")*(?:\"|$)/,null])}var Y=T.hashComments;if(Y){if(T.cStyleComments){if(Y>1){W.push([j,/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/,null,"#"])}else{W.push([j,/^#(?:(?:define|elif|else|endif|error|ifdef|include|ifndef|line|pragma|undef|warning)\b|[^\r\n]*)/,null,"#"])}S.push([C,/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h|[a-z]\w*)>/,null])}else{W.push([j,/^#[^\r\n]*/,null,"#"])}}if(T.cStyleComments){S.push([j,/^\/\/[^\r\n]*/,null]);S.push([j,/^\/\*[\s\S]*?(?:\*\/|$)/,null])}if(T.regexLiterals){var X=("/(?=[^/*])(?:[^/\\x5B\\x5C]|\\x5C[\\s\\S]|\\x5B(?:[^\\x5C\\x5D]|\\x5C[\\s\\S])*(?:\\x5D|$))+/");S.push(["lang-regex",new RegExp("^"+M+"("+X+")")])}var V=T.types;if(V){S.push([O,V])}var U=(""+T.keywords).replace(/^ | $/g,"");if(U.length){S.push([z,new RegExp("^(?:"+U.replace(/[\s,]+/g,"|")+")\\b"),null])}W.push([F,/^\s+/,null," \r\n\t\xA0"]);S.push([G,/^@[a-z_$][a-z_$@0-9]*/i,null],[O,/^(?:[@_]?[A-Z]+[a-z][A-Za-z_$@0-9]*|\w+_t\b)/,null],[F,/^[a-z_$][a-z_$@0-9]*/i,null],[G,new RegExp("^(?:0x[a-f0-9]+|(?:\\d(?:_\\d+)*\\d*(?:\\.\\d*)?|\\.\\d\\+)(?:e[+\\-]?\\d+)?)[a-z]*","i"),null,"0123456789"],[F,/^\\[\s\S]?/,null],[L,/^.[^\s\w\.$@\'\"\`\/\#\\]*/,null]);return g(W,S)}var K=i({keywords:A,hashComments:true,cStyleComments:true,multiLineStrings:true,regexLiterals:true});function Q(V,ag){var U=/(?:^|\s)nocode(?:\s|$)/;var ab=/\r\n?|\n/;var ac=V.ownerDocument;var S;if(V.currentStyle){S=V.currentStyle.whiteSpace}else{if(window.getComputedStyle){S=ac.defaultView.getComputedStyle(V,null).getPropertyValue("white-space")}}var Z=S&&"pre"===S.substring(0,3);var af=ac.createElement("LI");while(V.firstChild){af.appendChild(V.firstChild)}var W=[af];function ae(al){switch(al.nodeType){case 1:if(U.test(al.className)){break}if("BR"===al.nodeName){ad(al);if(al.parentNode){al.parentNode.removeChild(al)}}else{for(var an=al.firstChild;an;an=an.nextSibling){ae(an)}}break;case 3:case 4:if(Z){var am=al.nodeValue;var aj=am.match(ab);if(aj){var ai=am.substring(0,aj.index);al.nodeValue=ai;var ah=am.substring(aj.index+aj[0].length);if(ah){var ak=al.parentNode;ak.insertBefore(ac.createTextNode(ah),al.nextSibling)}ad(al);if(!ai){al.parentNode.removeChild(al)}}}break}}function ad(ak){while(!ak.nextSibling){ak=ak.parentNode;if(!ak){return}}function ai(al,ar){var aq=ar?al.cloneNode(false):al;var ao=al.parentNode;if(ao){var ap=ai(ao,1);var an=al.nextSibling;ap.appendChild(aq);for(var am=an;am;am=an){an=am.nextSibling;ap.appendChild(am)}}return aq}var ah=ai(ak.nextSibling,0);for(var aj;(aj=ah.parentNode)&&aj.nodeType===1;){ah=aj}W.push(ah)}for(var Y=0;Y<W.length;++Y){ae(W[Y])}if(ag===(ag|0)){W[0].setAttribute("value",ag)}var aa=ac.createElement("OL");aa.className="linenums";var X=Math.max(0,((ag-1))|0)||0;for(var Y=0,T=W.length;Y<T;++Y){af=W[Y];af.className="L"+((Y+X)%10);if(!af.firstChild){af.appendChild(ac.createTextNode("\xA0"))}aa.appendChild(af)}V.appendChild(aa)}function D(ac){var aj=/\bMSIE\b/.test(navigator.userAgent);var am=/\n/g;var al=ac.sourceCode;var an=al.length;var V=0;var aa=ac.spans;var T=aa.length;var ah=0;var X=ac.decorations;var Y=X.length;var Z=0;X[Y]=an;var ar,aq;for(aq=ar=0;aq<Y;){if(X[aq]!==X[aq+2]){X[ar++]=X[aq++];X[ar++]=X[aq++]}else{aq+=2}}Y=ar;for(aq=ar=0;aq<Y;){var at=X[aq];var ab=X[aq+1];var W=aq+2;while(W+2<=Y&&X[W+1]===ab){W+=2}X[ar++]=at;X[ar++]=ab;aq=W}Y=X.length=ar;var ae=null;while(ah<T){var af=aa[ah];var S=aa[ah+2]||an;var ag=X[Z];var ap=X[Z+2]||an;var W=Math.min(S,ap);var ak=aa[ah+1];var U;if(ak.nodeType!==1&&(U=al.substring(V,W))){if(aj){U=U.replace(am,"\r")}ak.nodeValue=U;var ai=ak.ownerDocument;var ao=ai.createElement("SPAN");ao.className=X[Z+1];var ad=ak.parentNode;ad.replaceChild(ao,ak);ao.appendChild(ak);if(V<S){aa[ah+1]=ak=ai.createTextNode(al.substring(W,S));ad.insertBefore(ak,ao.nextSibling)}}V=W;if(V>=S){ah+=2}if(V>=ap){Z+=2}}}var t={};function c(U,V){for(var S=V.length;--S>=0;){var T=V[S];if(!t.hasOwnProperty(T)){t[T]=U}else{if(window.console){console.warn("cannot override language handler %s",T)}}}}function q(T,S){if(!(T&&t.hasOwnProperty(T))){T=/^\s*</.test(S)?"default-markup":"default-code"}return t[T]}c(K,["default-code"]);c(g([],[[F,/^[^<?]+/],[E,/^<!\w[^>]*(?:>|$)/],[j,/^<\!--[\s\S]*?(?:-\->|$)/],["lang-",/^<\?([\s\S]+?)(?:\?>|$)/],["lang-",/^<%([\s\S]+?)(?:%>|$)/],[L,/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\s\S]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\s\S]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\s\S]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),["default-markup","htm","html","mxml","xhtml","xml","xsl"]);c(g([[F,/^[\s]+/,null," \t\r\n"],[n,/^(?:\"[^\"]*\"?|\'[^\']*\'?)/,null,"\"'"]],[[m,/^^<\/?[a-z](?:[\w.:-]*\w)?|\/?>$/i],[P,/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^>\'\"\s]*(?:[^>\'\"\s\/]|\/(?=\s)))/],[L,/^[=<>\/]+/],["lang-js",/^on\w+\s*=\s*\"([^\"]+)\"/i],["lang-js",/^on\w+\s*=\s*\'([^\']+)\'/i],["lang-js",/^on\w+\s*=\s*([^\"\'>\s]+)/i],["lang-css",/^style\s*=\s*\"([^\"]+)\"/i],["lang-css",/^style\s*=\s*\'([^\']+)\'/i],["lang-css",/^style\s*=\s*([^\"\'>\s]+)/i]]),["in.tag"]);c(g([],[[n,/^[\s\S]+/]]),["uq.val"]);c(i({keywords:l,hashComments:true,cStyleComments:true,types:e}),["c","cc","cpp","cxx","cyc","m"]);c(i({keywords:"null,true,false"}),["json"]);c(i({keywords:R,hashComments:true,cStyleComments:true,verbatimStrings:true,types:e}),["cs"]);c(i({keywords:x,cStyleComments:true}),["java"]);c(i({keywords:H,hashComments:true,multiLineStrings:true}),["bsh","csh","sh"]);c(i({keywords:I,hashComments:true,multiLineStrings:true,tripleQuotedStrings:true}),["cv","py"]);c(i({keywords:s,hashComments:true,multiLineStrings:true,regexLiterals:true}),["perl","pl","pm"]);c(i({keywords:f,hashComments:true,multiLineStrings:true,regexLiterals:true}),["rb"]);c(i({keywords:w,cStyleComments:true,regexLiterals:true}),["js"]);c(i({keywords:r,hashComments:3,cStyleComments:true,multilineStrings:true,tripleQuotedStrings:true,regexLiterals:true}),["coffee"]);c(g([],[[C,/^[\s\S]+/]]),["regex"]);function d(V){var U=V.langExtension;try{var S=a(V.sourceNode);var T=S.sourceCode;V.sourceCode=T;V.spans=S.spans;V.basePos=0;q(U,T)(V);D(V)}catch(W){if("console" in window){console.log(W&&W.stack?W.stack:W)}}}function y(W,V,U){var S=document.createElement("PRE");S.innerHTML=W;if(U){Q(S,U)}var T={langExtension:V,numberLines:U,sourceNode:S};d(T);return S.innerHTML}function b(ad){function Y(af){return document.getElementsByTagName(af)}var ac=[Y("pre"),Y("code"),Y("xmp")];var T=[];for(var aa=0;aa<ac.length;++aa){for(var Z=0,V=ac[aa].length;Z<V;++Z){T.push(ac[aa][Z])}}ac=null;var W=Date;if(!W.now){W={now:function(){return +(new Date)}}}var X=0;var S;var ab=/\blang(?:uage)?-([\w.]+)(?!\S)/;var ae=/\bprettyprint\b/;function U(){var ag=(window.PR_SHOULD_USE_CONTINUATION?W.now()+250:Infinity);for(;X<T.length&&W.now()<ag;X++){var aj=T[X];var ai=aj.className;if(ai.indexOf("prettyprint")>=0){var ah=ai.match(ab);var am;if(!ah&&(am=o(aj))&&"CODE"===am.tagName){ah=am.className.match(ab)}if(ah){ah=ah[1]}var al=false;for(var ak=aj.parentNode;ak;ak=ak.parentNode){if((ak.tagName==="pre"||ak.tagName==="code"||ak.tagName==="xmp")&&ak.className&&ak.className.indexOf("prettyprint")>=0){al=true;break}}if(!al){var af=aj.className.match(/\blinenums\b(?::(\d+))?/);af=af?af[1]&&af[1].length?+af[1]:true:false;if(af){Q(aj,af)}S={langExtension:ah,sourceNode:aj,numberLines:af};d(S)}}}if(X<T.length){setTimeout(U,250)}else{if(ad){ad()}}}U()}window.prettyPrintOne=y;window.prettyPrint=b;window.PR={createSimpleLexer:g,registerLangHandler:c,sourceDecorator:i,PR_ATTRIB_NAME:P,PR_ATTRIB_VALUE:n,PR_COMMENT:j,PR_DECLARATION:E,PR_KEYWORD:z,PR_LITERAL:G,PR_NOCODE:N,PR_PLAIN:F,PR_PUNCTUATION:L,PR_SOURCE:J,PR_STRING:C,PR_TAG:m,PR_TYPE:O}})();PR.registerLangHandler(PR.createSimpleLexer([],[[PR.PR_DECLARATION,/^<!\w[^>]*(?:>|$)/],[PR.PR_COMMENT,/^<\!--[\s\S]*?(?:-\->|$)/],[PR.PR_PUNCTUATION,/^(?:<[%?]|[%?]>)/],["lang-",/^<\?([\s\S]+?)(?:\?>|$)/],["lang-",/^<%([\s\S]+?)(?:%>|$)/],["lang-",/^<xmp\b[^>]*>([\s\S]+?)<\/xmp\b[^>]*>/i],["lang-handlebars",/^<script\b[^>]*type\s*=\s*['"]?text\/x-handlebars-template['"]?\b[^>]*>([\s\S]*?)(<\/script\b[^>]*>)/i],["lang-js",/^<script\b[^>]*>([\s\S]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\s\S]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i],[PR.PR_DECLARATION,/^{{[#^>/]?\s*[\w.][^}]*}}/],[PR.PR_DECLARATION,/^{{&?\s*[\w.][^}]*}}/],[PR.PR_DECLARATION,/^{{{>?\s*[\w.][^}]*}}}/],[PR.PR_COMMENT,/^{{![^}]*}}/]]),["handlebars","hbs"]);PR.registerLangHandler(PR.createSimpleLexer([[PR.PR_PLAIN,/^[ \t\r\n\f]+/,null," \t\r\n\f"]],[[PR.PR_STRING,/^\"(?:[^\n\r\f\\\"]|\\(?:\r\n?|\n|\f)|\\[\s\S])*\"/,null],[PR.PR_STRING,/^\'(?:[^\n\r\f\\\']|\\(?:\r\n?|\n|\f)|\\[\s\S])*\'/,null],["lang-css-str",/^url\(([^\)\"\']*)\)/i],[PR.PR_KEYWORD,/^(?:url|rgb|\!important|@import|@page|@media|@charset|inherit)(?=[^\-\w]|$)/i,null],["lang-css-kw",/^(-?(?:[_a-z]|(?:\\[0-9a-f]+ ?))(?:[_a-z0-9\-]|\\(?:\\[0-9a-f]+ ?))*)\s*:/i],[PR.PR_COMMENT,/^\/\*[^*]*\*+(?:[^\/*][^*]*\*+)*\//],[PR.PR_COMMENT,/^(?:<!--|-->)/],[PR.PR_LITERAL,/^(?:\d+|\d*\.\d+)(?:%|[a-z]+)?/i],[PR.PR_LITERAL,/^#(?:[0-9a-f]{3}){1,2}/i],[PR.PR_PLAIN,/^-?(?:[_a-z]|(?:\\[\da-f]+ ?))(?:[_a-z\d\-]|\\(?:\\[\da-f]+ ?))*/i],[PR.PR_PUNCTUATION,/^[^\s\w\'\"]+/]]),["css"]);PR.registerLangHandler(PR.createSimpleLexer([],[[PR.PR_KEYWORD,/^-?(?:[_a-z]|(?:\\[\da-f]+ ?))(?:[_a-z\d\-]|\\(?:\\[\da-f]+ ?))*/i]]),["css-kw"]);PR.registerLangHandler(PR.createSimpleLexer([],[[PR.PR_STRING,/^[^\)\"\']+/]]),["css-str"]);
diff --git a/coverage/lcov-report/selectors.ts.html b/coverage/lcov-report/selectors.ts.html
new file mode 100644
index 0000000000000000000000000000000000000000..e4d80c79b6616a6041ef8384fa95f23e1d8bad81
--- /dev/null
+++ b/coverage/lcov-report/selectors.ts.html
@@ -0,0 +1,427 @@
+
+<!doctype html>
+<html lang="en">
+
+<head>
+    <title>Code coverage report for selectors.ts</title>
+    <meta charset="utf-8" />
+    <link rel="stylesheet" href="prettify.css" />
+    <link rel="stylesheet" href="base.css" />
+    <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
+    <meta name="viewport" content="width=device-width, initial-scale=1" />
+    <style type='text/css'>
+        .coverage-summary .sorter {
+            background-image: url(sort-arrow-sprite.png);
+        }
+    </style>
+</head>
+    
+<body>
+<div class='wrapper'>
+    <div class='pad1'>
+        <h1><a href="index.html">All files</a> selectors.ts</h1>
+        <div class='clearfix'>
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Statements</span>
+                <span class='fraction'>29/29</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Branches</span>
+                <span class='fraction'>5/5</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Functions</span>
+                <span class='fraction'>14/14</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Lines</span>
+                <span class='fraction'>26/26</span>
+            </div>
+        
+            
+        </div>
+        <p class="quiet">
+            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
+        </p>
+        <template id="filterTemplate">
+            <div class="quiet">
+                Filter:
+                <input type="search" id="fileSearch">
+            </div>
+        </template>
+    </div>
+    <div class='status-line high'></div>
+    <pre><table class="coverage">
+<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
+<a name='L2'></a><a href='#L2'>2</a>
+<a name='L3'></a><a href='#L3'>3</a>
+<a name='L4'></a><a href='#L4'>4</a>
+<a name='L5'></a><a href='#L5'>5</a>
+<a name='L6'></a><a href='#L6'>6</a>
+<a name='L7'></a><a href='#L7'>7</a>
+<a name='L8'></a><a href='#L8'>8</a>
+<a name='L9'></a><a href='#L9'>9</a>
+<a name='L10'></a><a href='#L10'>10</a>
+<a name='L11'></a><a href='#L11'>11</a>
+<a name='L12'></a><a href='#L12'>12</a>
+<a name='L13'></a><a href='#L13'>13</a>
+<a name='L14'></a><a href='#L14'>14</a>
+<a name='L15'></a><a href='#L15'>15</a>
+<a name='L16'></a><a href='#L16'>16</a>
+<a name='L17'></a><a href='#L17'>17</a>
+<a name='L18'></a><a href='#L18'>18</a>
+<a name='L19'></a><a href='#L19'>19</a>
+<a name='L20'></a><a href='#L20'>20</a>
+<a name='L21'></a><a href='#L21'>21</a>
+<a name='L22'></a><a href='#L22'>22</a>
+<a name='L23'></a><a href='#L23'>23</a>
+<a name='L24'></a><a href='#L24'>24</a>
+<a name='L25'></a><a href='#L25'>25</a>
+<a name='L26'></a><a href='#L26'>26</a>
+<a name='L27'></a><a href='#L27'>27</a>
+<a name='L28'></a><a href='#L28'>28</a>
+<a name='L29'></a><a href='#L29'>29</a>
+<a name='L30'></a><a href='#L30'>30</a>
+<a name='L31'></a><a href='#L31'>31</a>
+<a name='L32'></a><a href='#L32'>32</a>
+<a name='L33'></a><a href='#L33'>33</a>
+<a name='L34'></a><a href='#L34'>34</a>
+<a name='L35'></a><a href='#L35'>35</a>
+<a name='L36'></a><a href='#L36'>36</a>
+<a name='L37'></a><a href='#L37'>37</a>
+<a name='L38'></a><a href='#L38'>38</a>
+<a name='L39'></a><a href='#L39'>39</a>
+<a name='L40'></a><a href='#L40'>40</a>
+<a name='L41'></a><a href='#L41'>41</a>
+<a name='L42'></a><a href='#L42'>42</a>
+<a name='L43'></a><a href='#L43'>43</a>
+<a name='L44'></a><a href='#L44'>44</a>
+<a name='L45'></a><a href='#L45'>45</a>
+<a name='L46'></a><a href='#L46'>46</a>
+<a name='L47'></a><a href='#L47'>47</a>
+<a name='L48'></a><a href='#L48'>48</a>
+<a name='L49'></a><a href='#L49'>49</a>
+<a name='L50'></a><a href='#L50'>50</a>
+<a name='L51'></a><a href='#L51'>51</a>
+<a name='L52'></a><a href='#L52'>52</a>
+<a name='L53'></a><a href='#L53'>53</a>
+<a name='L54'></a><a href='#L54'>54</a>
+<a name='L55'></a><a href='#L55'>55</a>
+<a name='L56'></a><a href='#L56'>56</a>
+<a name='L57'></a><a href='#L57'>57</a>
+<a name='L58'></a><a href='#L58'>58</a>
+<a name='L59'></a><a href='#L59'>59</a>
+<a name='L60'></a><a href='#L60'>60</a>
+<a name='L61'></a><a href='#L61'>61</a>
+<a name='L62'></a><a href='#L62'>62</a>
+<a name='L63'></a><a href='#L63'>63</a>
+<a name='L64'></a><a href='#L64'>64</a>
+<a name='L65'></a><a href='#L65'>65</a>
+<a name='L66'></a><a href='#L66'>66</a>
+<a name='L67'></a><a href='#L67'>67</a>
+<a name='L68'></a><a href='#L68'>68</a>
+<a name='L69'></a><a href='#L69'>69</a>
+<a name='L70'></a><a href='#L70'>70</a>
+<a name='L71'></a><a href='#L71'>71</a>
+<a name='L72'></a><a href='#L72'>72</a>
+<a name='L73'></a><a href='#L73'>73</a>
+<a name='L74'></a><a href='#L74'>74</a>
+<a name='L75'></a><a href='#L75'>75</a>
+<a name='L76'></a><a href='#L76'>76</a>
+<a name='L77'></a><a href='#L77'>77</a>
+<a name='L78'></a><a href='#L78'>78</a>
+<a name='L79'></a><a href='#L79'>79</a>
+<a name='L80'></a><a href='#L80'>80</a>
+<a name='L81'></a><a href='#L81'>81</a>
+<a name='L82'></a><a href='#L82'>82</a>
+<a name='L83'></a><a href='#L83'>83</a>
+<a name='L84'></a><a href='#L84'>84</a>
+<a name='L85'></a><a href='#L85'>85</a>
+<a name='L86'></a><a href='#L86'>86</a>
+<a name='L87'></a><a href='#L87'>87</a>
+<a name='L88'></a><a href='#L88'>88</a>
+<a name='L89'></a><a href='#L89'>89</a>
+<a name='L90'></a><a href='#L90'>90</a>
+<a name='L91'></a><a href='#L91'>91</a>
+<a name='L92'></a><a href='#L92'>92</a>
+<a name='L93'></a><a href='#L93'>93</a>
+<a name='L94'></a><a href='#L94'>94</a>
+<a name='L95'></a><a href='#L95'>95</a>
+<a name='L96'></a><a href='#L96'>96</a>
+<a name='L97'></a><a href='#L97'>97</a>
+<a name='L98'></a><a href='#L98'>98</a>
+<a name='L99'></a><a href='#L99'>99</a>
+<a name='L100'></a><a href='#L100'>100</a>
+<a name='L101'></a><a href='#L101'>101</a>
+<a name='L102'></a><a href='#L102'>102</a>
+<a name='L103'></a><a href='#L103'>103</a>
+<a name='L104'></a><a href='#L104'>104</a>
+<a name='L105'></a><a href='#L105'>105</a>
+<a name='L106'></a><a href='#L106'>106</a>
+<a name='L107'></a><a href='#L107'>107</a>
+<a name='L108'></a><a href='#L108'>108</a>
+<a name='L109'></a><a href='#L109'>109</a>
+<a name='L110'></a><a href='#L110'>110</a>
+<a name='L111'></a><a href='#L111'>111</a>
+<a name='L112'></a><a href='#L112'>112</a>
+<a name='L113'></a><a href='#L113'>113</a>
+<a name='L114'></a><a href='#L114'>114</a>
+<a name='L115'></a><a href='#L115'>115</a></td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">21x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">10x</span>
+<span class="cline-any cline-yes">6x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';
+import { KnownCaipNamespace } from '@metamask/utils';
+import { createSelector } from 'reselect';
+&nbsp;
+import type { NetworkEnablementControllerState } from './NetworkEnablementController';
+import { deriveKeys } from './utils';
+&nbsp;
+/**
+ * Base selector to get the enabled network map from the controller state.
+ *
+ * @param state - The NetworkEnablementController state
+ * @returns The enabled network map
+ */
+export const selectEnabledNetworkMap = (
+  state: NetworkEnablementControllerState,
+) =&gt; state.enabledNetworkMap;
+&nbsp;
+/**
+ * Selector to check if a specific network is enabled.
+ *
+ * This selector accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID
+ * (for any blockchain network) and returns whether the network is currently enabled.
+ * It returns false for unknown networks or if there's an error parsing the chain ID.
+ *
+ * @param chainId - The chain ID to check (Hex or CAIP-2 format)
+ * @returns A selector function that returns true if the network is enabled, false otherwise
+ */
+export const selectIsNetworkEnabled = (chainId: Hex | CaipChainId) =&gt;
+  createSelector(selectEnabledNetworkMap, (enabledNetworkMap) =&gt; {
+    const { namespace, storageKey } = deriveKeys(chainId);
+&nbsp;
+    return (
+      namespace in enabledNetworkMap &amp;&amp;
+      storageKey in enabledNetworkMap[namespace] &amp;&amp;
+      enabledNetworkMap[namespace][storageKey]
+    );
+  });
+&nbsp;
+/**
+ * Selector builder to get all enabled networks for a specific namespace.
+ *
+ * The selector returned by this function returns an array of chain IDs (as strings) for all enabled networks
+ * within the specified namespace (e.g., 'eip155' for EVM networks, 'solana' for Solana).
+ *
+ * @param namespace - The CAIP namespace to get enabled networks for (e.g., 'eip155', 'solana')
+ * @returns A selector function that returns an array of chain ID strings for enabled networks in the namespace
+ */
+export const createSelectorForEnabledNetworksForNamespace = (
+  namespace: CaipNamespace,
+) =&gt;
+  createSelector(selectEnabledNetworkMap, (enabledNetworkMap) =&gt; {
+    return Object.entries(enabledNetworkMap[namespace] ?? {})
+      .filter(([, enabled]) =&gt; enabled)
+      .map(([id]) =&gt; id);
+  });
+&nbsp;
+/**
+ * Selector to get all enabled networks across all namespaces.
+ *
+ * This selector returns a record where keys are CAIP namespaces and values are arrays
+ * of enabled chain IDs within each namespace.
+ *
+ * @returns A selector function that returns a record mapping namespace to array of enabled chain IDs
+ */
+export const selectAllEnabledNetworks = createSelector(
+  selectEnabledNetworkMap,
+  (enabledNetworkMap) =&gt; {
+    return (Object.keys(enabledNetworkMap) as CaipNamespace[]).reduce(
+      (acc, ns) =&gt; {
+        acc[ns] = Object.entries(enabledNetworkMap[ns])
+          .filter(([, enabled]) =&gt; enabled)
+          .map(([id]) =&gt; id);
+        return acc;
+      },
+      {} as Record&lt;CaipNamespace, string[]&gt;,
+    );
+  },
+);
+&nbsp;
+/**
+ * Selector to get the total count of enabled networks across all namespaces.
+ *
+ * @returns A selector function that returns the total number of enabled networks
+ */
+export const selectEnabledNetworksCount = createSelector(
+  selectAllEnabledNetworks,
+  (allEnabledNetworks) =&gt; {
+    return Object.values(allEnabledNetworks).flat().length;
+  },
+);
+&nbsp;
+/**
+ * Selector to get all enabled EVM networks.
+ *
+ * This is a convenience selector that specifically targets EIP-155 networks.
+ *
+ * @returns A selector function that returns an array of enabled EVM chain IDs
+ */
+export const selectEnabledEvmNetworks = createSelector(
+  createSelectorForEnabledNetworksForNamespace(KnownCaipNamespace.Eip155),
+  (enabledEvmNetworks) =&gt; enabledEvmNetworks,
+);
+&nbsp;
+/**
+ * Selector to get all enabled Solana networks.
+ *
+ * This is a convenience selector that specifically targets Solana networks.
+ *
+ * @returns A selector function that returns an array of enabled Solana chain IDs
+ */
+export const selectEnabledSolanaNetworks = createSelector(
+  createSelectorForEnabledNetworksForNamespace(KnownCaipNamespace.Solana),
+  (enabledSolanaNetworks) =&gt; enabledSolanaNetworks,
+);
+&nbsp;</pre></td></tr></table></pre>
+
+                <div class='push'></div><!-- for sticky footer -->
+            </div><!-- /wrapper -->
+            <div class='footer quiet pad2 space-top1 center small'>
+                Code coverage generated by
+                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
+                at 2025-09-04T23:19:41.560Z
+            </div>
+        <script src="prettify.js"></script>
+        <script>
+            window.onload = function () {
+                prettyPrint();
+            };
+        </script>
+        <script src="sorter.js"></script>
+        <script src="block-navigation.js"></script>
+    </body>
+</html>
+    
\ No newline at end of file
diff --git a/coverage/lcov-report/sort-arrow-sprite.png b/coverage/lcov-report/sort-arrow-sprite.png
new file mode 100644
index 0000000000000000000000000000000000000000..6ed68316eb3f65dec9063332d2f69bf3093bbfab
--- /dev/null
+++ b/coverage/lcov-report/sort-arrow-sprite.png
@@ -0,0 +1,3 @@
+PNG
+
+   IHDR         F3   QIDATxcp/c 0FH0LE]XJ6A2*0%`b(B0p Nx    IENDB`
\ No newline at end of file
diff --git a/coverage/lcov-report/sorter.js b/coverage/lcov-report/sorter.js
new file mode 100644
index 0000000000000000000000000000000000000000..2bb296a8ca8e48e468f22b92250b9fe2518b8cfc
--- /dev/null
+++ b/coverage/lcov-report/sorter.js
@@ -0,0 +1,196 @@
+/* eslint-disable */
+var addSorting = (function() {
+    'use strict';
+    var cols,
+        currentSort = {
+            index: 0,
+            desc: false
+        };
+
+    // returns the summary table element
+    function getTable() {
+        return document.querySelector('.coverage-summary');
+    }
+    // returns the thead element of the summary table
+    function getTableHeader() {
+        return getTable().querySelector('thead tr');
+    }
+    // returns the tbody element of the summary table
+    function getTableBody() {
+        return getTable().querySelector('tbody');
+    }
+    // returns the th element for nth column
+    function getNthColumn(n) {
+        return getTableHeader().querySelectorAll('th')[n];
+    }
+
+    function onFilterInput() {
+        const searchValue = document.getElementById('fileSearch').value;
+        const rows = document.getElementsByTagName('tbody')[0].children;
+        for (let i = 0; i < rows.length; i++) {
+            const row = rows[i];
+            if (
+                row.textContent
+                    .toLowerCase()
+                    .includes(searchValue.toLowerCase())
+            ) {
+                row.style.display = '';
+            } else {
+                row.style.display = 'none';
+            }
+        }
+    }
+
+    // loads the search box
+    function addSearchBox() {
+        var template = document.getElementById('filterTemplate');
+        var templateClone = template.content.cloneNode(true);
+        templateClone.getElementById('fileSearch').oninput = onFilterInput;
+        template.parentElement.appendChild(templateClone);
+    }
+
+    // loads all columns
+    function loadColumns() {
+        var colNodes = getTableHeader().querySelectorAll('th'),
+            colNode,
+            cols = [],
+            col,
+            i;
+
+        for (i = 0; i < colNodes.length; i += 1) {
+            colNode = colNodes[i];
+            col = {
+                key: colNode.getAttribute('data-col'),
+                sortable: !colNode.getAttribute('data-nosort'),
+                type: colNode.getAttribute('data-type') || 'string'
+            };
+            cols.push(col);
+            if (col.sortable) {
+                col.defaultDescSort = col.type === 'number';
+                colNode.innerHTML =
+                    colNode.innerHTML + '<span class="sorter"></span>';
+            }
+        }
+        return cols;
+    }
+    // attaches a data attribute to every tr element with an object
+    // of data values keyed by column name
+    function loadRowData(tableRow) {
+        var tableCols = tableRow.querySelectorAll('td'),
+            colNode,
+            col,
+            data = {},
+            i,
+            val;
+        for (i = 0; i < tableCols.length; i += 1) {
+            colNode = tableCols[i];
+            col = cols[i];
+            val = colNode.getAttribute('data-value');
+            if (col.type === 'number') {
+                val = Number(val);
+            }
+            data[col.key] = val;
+        }
+        return data;
+    }
+    // loads all row data
+    function loadData() {
+        var rows = getTableBody().querySelectorAll('tr'),
+            i;
+
+        for (i = 0; i < rows.length; i += 1) {
+            rows[i].data = loadRowData(rows[i]);
+        }
+    }
+    // sorts the table using the data for the ith column
+    function sortByIndex(index, desc) {
+        var key = cols[index].key,
+            sorter = function(a, b) {
+                a = a.data[key];
+                b = b.data[key];
+                return a < b ? -1 : a > b ? 1 : 0;
+            },
+            finalSorter = sorter,
+            tableBody = document.querySelector('.coverage-summary tbody'),
+            rowNodes = tableBody.querySelectorAll('tr'),
+            rows = [],
+            i;
+
+        if (desc) {
+            finalSorter = function(a, b) {
+                return -1 * sorter(a, b);
+            };
+        }
+
+        for (i = 0; i < rowNodes.length; i += 1) {
+            rows.push(rowNodes[i]);
+            tableBody.removeChild(rowNodes[i]);
+        }
+
+        rows.sort(finalSorter);
+
+        for (i = 0; i < rows.length; i += 1) {
+            tableBody.appendChild(rows[i]);
+        }
+    }
+    // removes sort indicators for current column being sorted
+    function removeSortIndicators() {
+        var col = getNthColumn(currentSort.index),
+            cls = col.className;
+
+        cls = cls.replace(/ sorted$/, '').replace(/ sorted-desc$/, '');
+        col.className = cls;
+    }
+    // adds sort indicators for current column being sorted
+    function addSortIndicators() {
+        getNthColumn(currentSort.index).className += currentSort.desc
+            ? ' sorted-desc'
+            : ' sorted';
+    }
+    // adds event listeners for all sorter widgets
+    function enableUI() {
+        var i,
+            el,
+            ithSorter = function ithSorter(i) {
+                var col = cols[i];
+
+                return function() {
+                    var desc = col.defaultDescSort;
+
+                    if (currentSort.index === i) {
+                        desc = !currentSort.desc;
+                    }
+                    sortByIndex(i, desc);
+                    removeSortIndicators();
+                    currentSort.index = i;
+                    currentSort.desc = desc;
+                    addSortIndicators();
+                };
+            };
+        for (i = 0; i < cols.length; i += 1) {
+            if (cols[i].sortable) {
+                // add the click event handler on the th so users
+                // dont have to click on those tiny arrows
+                el = getNthColumn(i).querySelector('.sorter').parentElement;
+                if (el.addEventListener) {
+                    el.addEventListener('click', ithSorter(i));
+                } else {
+                    el.attachEvent('onclick', ithSorter(i));
+                }
+            }
+        }
+    }
+    // adds sorting functionality to the UI
+    return function() {
+        if (!getTable()) {
+            return;
+        }
+        cols = loadColumns();
+        loadData();
+        addSearchBox();
+        addSortIndicators();
+        enableUI();
+    };
+})();
+
+window.addEventListener('load', addSorting);
diff --git a/coverage/lcov-report/types.ts.html b/coverage/lcov-report/types.ts.html
new file mode 100644
index 0000000000000000000000000000000000000000..77799a582bde0e2c7b18b7e34b450f5bd851acff
--- /dev/null
+++ b/coverage/lcov-report/types.ts.html
@@ -0,0 +1,136 @@
+
+<!doctype html>
+<html lang="en">
+
+<head>
+    <title>Code coverage report for types.ts</title>
+    <meta charset="utf-8" />
+    <link rel="stylesheet" href="prettify.css" />
+    <link rel="stylesheet" href="base.css" />
+    <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
+    <meta name="viewport" content="width=device-width, initial-scale=1" />
+    <style type='text/css'>
+        .coverage-summary .sorter {
+            background-image: url(sort-arrow-sprite.png);
+        }
+    </style>
+</head>
+    
+<body>
+<div class='wrapper'>
+    <div class='pad1'>
+        <h1><a href="index.html">All files</a> types.ts</h1>
+        <div class='clearfix'>
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Statements</span>
+                <span class='fraction'>8/8</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Branches</span>
+                <span class='fraction'>4/4</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Functions</span>
+                <span class='fraction'>2/2</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Lines</span>
+                <span class='fraction'>8/8</span>
+            </div>
+        
+            
+        </div>
+        <p class="quiet">
+            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
+        </p>
+        <template id="filterTemplate">
+            <div class="quiet">
+                Filter:
+                <input type="search" id="fileSearch">
+            </div>
+        </template>
+    </div>
+    <div class='status-line high'></div>
+    <pre><table class="coverage">
+<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
+<a name='L2'></a><a href='#L2'>2</a>
+<a name='L3'></a><a href='#L3'>3</a>
+<a name='L4'></a><a href='#L4'>4</a>
+<a name='L5'></a><a href='#L5'>5</a>
+<a name='L6'></a><a href='#L6'>6</a>
+<a name='L7'></a><a href='#L7'>7</a>
+<a name='L8'></a><a href='#L8'>8</a>
+<a name='L9'></a><a href='#L9'>9</a>
+<a name='L10'></a><a href='#L10'>10</a>
+<a name='L11'></a><a href='#L11'>11</a>
+<a name='L12'></a><a href='#L12'>12</a>
+<a name='L13'></a><a href='#L13'>13</a>
+<a name='L14'></a><a href='#L14'>14</a>
+<a name='L15'></a><a href='#L15'>15</a>
+<a name='L16'></a><a href='#L16'>16</a>
+<a name='L17'></a><a href='#L17'>17</a>
+<a name='L18'></a><a href='#L18'>18</a></td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
+ * Scopes for Solana account type. See {@link KeyringAccount.scopes}.
+ */
+export enum SolScope {
+  Devnet = 'solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1',
+  Mainnet = 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+  Testnet = 'solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z',
+}
+&nbsp;
+/**
+ * Scopes for Bitcoin account type. See {@link KeyringAccount.scopes}.
+ */
+export enum BtcScope {
+  Mainnet = 'bip122:000000000019d6689c085ae165831e93',
+  Testnet = 'bip122:000000000933ea01ad0ee984209779ba',
+  Signet = 'bip122:00000008819873e925422c1ff0f99f7c',
+}
+&nbsp;</pre></td></tr></table></pre>
+
+                <div class='push'></div><!-- for sticky footer -->
+            </div><!-- /wrapper -->
+            <div class='footer quiet pad2 space-top1 center small'>
+                Code coverage generated by
+                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
+                at 2025-09-04T23:19:41.560Z
+            </div>
+        <script src="prettify.js"></script>
+        <script>
+            window.onload = function () {
+                prettyPrint();
+            };
+        </script>
+        <script src="sorter.js"></script>
+        <script src="block-navigation.js"></script>
+    </body>
+</html>
+    
\ No newline at end of file
diff --git a/coverage/lcov-report/utils.ts.html b/coverage/lcov-report/utils.ts.html
new file mode 100644
index 0000000000000000000000000000000000000000..1541485021609dc7eb0d4cebd5c125e2d042d49a
--- /dev/null
+++ b/coverage/lcov-report/utils.ts.html
@@ -0,0 +1,394 @@
+
+<!doctype html>
+<html lang="en">
+
+<head>
+    <title>Code coverage report for utils.ts</title>
+    <meta charset="utf-8" />
+    <link rel="stylesheet" href="prettify.css" />
+    <link rel="stylesheet" href="base.css" />
+    <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
+    <meta name="viewport" content="width=device-width, initial-scale=1" />
+    <style type='text/css'>
+        .coverage-summary .sorter {
+            background-image: url(sort-arrow-sprite.png);
+        }
+    </style>
+</head>
+    
+<body>
+<div class='wrapper'>
+    <div class='pad1'>
+        <h1><a href="index.html">All files</a> utils.ts</h1>
+        <div class='clearfix'>
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Statements</span>
+                <span class='fraction'>26/26</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Branches</span>
+                <span class='fraction'>8/8</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Functions</span>
+                <span class='fraction'>4/4</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Lines</span>
+                <span class='fraction'>26/26</span>
+            </div>
+        
+            
+        </div>
+        <p class="quiet">
+            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
+        </p>
+        <template id="filterTemplate">
+            <div class="quiet">
+                Filter:
+                <input type="search" id="fileSearch">
+            </div>
+        </template>
+    </div>
+    <div class='status-line high'></div>
+    <pre><table class="coverage">
+<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
+<a name='L2'></a><a href='#L2'>2</a>
+<a name='L3'></a><a href='#L3'>3</a>
+<a name='L4'></a><a href='#L4'>4</a>
+<a name='L5'></a><a href='#L5'>5</a>
+<a name='L6'></a><a href='#L6'>6</a>
+<a name='L7'></a><a href='#L7'>7</a>
+<a name='L8'></a><a href='#L8'>8</a>
+<a name='L9'></a><a href='#L9'>9</a>
+<a name='L10'></a><a href='#L10'>10</a>
+<a name='L11'></a><a href='#L11'>11</a>
+<a name='L12'></a><a href='#L12'>12</a>
+<a name='L13'></a><a href='#L13'>13</a>
+<a name='L14'></a><a href='#L14'>14</a>
+<a name='L15'></a><a href='#L15'>15</a>
+<a name='L16'></a><a href='#L16'>16</a>
+<a name='L17'></a><a href='#L17'>17</a>
+<a name='L18'></a><a href='#L18'>18</a>
+<a name='L19'></a><a href='#L19'>19</a>
+<a name='L20'></a><a href='#L20'>20</a>
+<a name='L21'></a><a href='#L21'>21</a>
+<a name='L22'></a><a href='#L22'>22</a>
+<a name='L23'></a><a href='#L23'>23</a>
+<a name='L24'></a><a href='#L24'>24</a>
+<a name='L25'></a><a href='#L25'>25</a>
+<a name='L26'></a><a href='#L26'>26</a>
+<a name='L27'></a><a href='#L27'>27</a>
+<a name='L28'></a><a href='#L28'>28</a>
+<a name='L29'></a><a href='#L29'>29</a>
+<a name='L30'></a><a href='#L30'>30</a>
+<a name='L31'></a><a href='#L31'>31</a>
+<a name='L32'></a><a href='#L32'>32</a>
+<a name='L33'></a><a href='#L33'>33</a>
+<a name='L34'></a><a href='#L34'>34</a>
+<a name='L35'></a><a href='#L35'>35</a>
+<a name='L36'></a><a href='#L36'>36</a>
+<a name='L37'></a><a href='#L37'>37</a>
+<a name='L38'></a><a href='#L38'>38</a>
+<a name='L39'></a><a href='#L39'>39</a>
+<a name='L40'></a><a href='#L40'>40</a>
+<a name='L41'></a><a href='#L41'>41</a>
+<a name='L42'></a><a href='#L42'>42</a>
+<a name='L43'></a><a href='#L43'>43</a>
+<a name='L44'></a><a href='#L44'>44</a>
+<a name='L45'></a><a href='#L45'>45</a>
+<a name='L46'></a><a href='#L46'>46</a>
+<a name='L47'></a><a href='#L47'>47</a>
+<a name='L48'></a><a href='#L48'>48</a>
+<a name='L49'></a><a href='#L49'>49</a>
+<a name='L50'></a><a href='#L50'>50</a>
+<a name='L51'></a><a href='#L51'>51</a>
+<a name='L52'></a><a href='#L52'>52</a>
+<a name='L53'></a><a href='#L53'>53</a>
+<a name='L54'></a><a href='#L54'>54</a>
+<a name='L55'></a><a href='#L55'>55</a>
+<a name='L56'></a><a href='#L56'>56</a>
+<a name='L57'></a><a href='#L57'>57</a>
+<a name='L58'></a><a href='#L58'>58</a>
+<a name='L59'></a><a href='#L59'>59</a>
+<a name='L60'></a><a href='#L60'>60</a>
+<a name='L61'></a><a href='#L61'>61</a>
+<a name='L62'></a><a href='#L62'>62</a>
+<a name='L63'></a><a href='#L63'>63</a>
+<a name='L64'></a><a href='#L64'>64</a>
+<a name='L65'></a><a href='#L65'>65</a>
+<a name='L66'></a><a href='#L66'>66</a>
+<a name='L67'></a><a href='#L67'>67</a>
+<a name='L68'></a><a href='#L68'>68</a>
+<a name='L69'></a><a href='#L69'>69</a>
+<a name='L70'></a><a href='#L70'>70</a>
+<a name='L71'></a><a href='#L71'>71</a>
+<a name='L72'></a><a href='#L72'>72</a>
+<a name='L73'></a><a href='#L73'>73</a>
+<a name='L74'></a><a href='#L74'>74</a>
+<a name='L75'></a><a href='#L75'>75</a>
+<a name='L76'></a><a href='#L76'>76</a>
+<a name='L77'></a><a href='#L77'>77</a>
+<a name='L78'></a><a href='#L78'>78</a>
+<a name='L79'></a><a href='#L79'>79</a>
+<a name='L80'></a><a href='#L80'>80</a>
+<a name='L81'></a><a href='#L81'>81</a>
+<a name='L82'></a><a href='#L82'>82</a>
+<a name='L83'></a><a href='#L83'>83</a>
+<a name='L84'></a><a href='#L84'>84</a>
+<a name='L85'></a><a href='#L85'>85</a>
+<a name='L86'></a><a href='#L86'>86</a>
+<a name='L87'></a><a href='#L87'>87</a>
+<a name='L88'></a><a href='#L88'>88</a>
+<a name='L89'></a><a href='#L89'>89</a>
+<a name='L90'></a><a href='#L90'>90</a>
+<a name='L91'></a><a href='#L91'>91</a>
+<a name='L92'></a><a href='#L92'>92</a>
+<a name='L93'></a><a href='#L93'>93</a>
+<a name='L94'></a><a href='#L94'>94</a>
+<a name='L95'></a><a href='#L95'>95</a>
+<a name='L96'></a><a href='#L96'>96</a>
+<a name='L97'></a><a href='#L97'>97</a>
+<a name='L98'></a><a href='#L98'>98</a>
+<a name='L99'></a><a href='#L99'>99</a>
+<a name='L100'></a><a href='#L100'>100</a>
+<a name='L101'></a><a href='#L101'>101</a>
+<a name='L102'></a><a href='#L102'>102</a>
+<a name='L103'></a><a href='#L103'>103</a>
+<a name='L104'></a><a href='#L104'>104</a></td><td class="line-coverage quiet"><span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-yes">318x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">313x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">313x</span>
+<span class="cline-any cline-yes">210x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">103x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">313x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">36x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">36x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">35x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">35x</span>
+<span class="cline-any cline-yes">94x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">35x</span>
+<span class="cline-any cline-yes">12x</span>
+<span class="cline-any cline-yes">12x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">23x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-yes">12x</span>
+<span class="cline-any cline-yes">12x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import { toHex } from '@metamask/controller-utils';
+import { toEvmCaipChainId } from '@metamask/multichain-network-controller';
+import type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';
+import {
+  isCaipChainId,
+  isHexString,
+  KnownCaipNamespace,
+  parseCaipChainId,
+} from '@metamask/utils';
+&nbsp;
+import { POPULAR_NETWORKS } from './constants';
+import type { NetworkEnablementControllerState } from './NetworkEnablementController';
+&nbsp;
+/**
+ * Represents the parsed keys derived from a chain ID.
+ */
+export type DerivedKeys = {
+  namespace: CaipNamespace;
+  storageKey: Hex | CaipChainId;
+  caipChainId: CaipChainId;
+  reference: string;
+};
+&nbsp;
+/**
+ * Derives the namespace, storage key, and CAIP chain ID from a given chain ID.
+ *
+ * This utility function handles the conversion between different chain ID formats.
+ * For EVM networks, it converts Hex chain IDs to CAIP-2 format and determines
+ * the appropriate storage key. For non-EVM networks, it parses the CAIP-2 chain ID
+ * and uses the full chain ID as the storage key.
+ *
+ * @param chainId - The chain ID to derive keys from (Hex or CAIP-2 format)
+ * @returns An object containing namespace, storageKey, and caipId
+ * @throws Error if the chain ID cannot be parsed
+ */
+export function deriveKeys(chainId: Hex | CaipChainId): DerivedKeys {
+  const caipChainId = isCaipChainId(chainId)
+    ? chainId
+    : toEvmCaipChainId(chainId);
+&nbsp;
+  const { namespace, reference } = parseCaipChainId(caipChainId);
+  let storageKey;
+  if (namespace === (KnownCaipNamespace.Eip155 as string)) {
+    storageKey = isHexString(chainId) ? chainId : toHex(reference);
+  } else {
+    storageKey = caipChainId;
+  }
+  return { namespace, storageKey, caipChainId, reference };
+}
+&nbsp;
+/**
+ * Checks if the specified network is the only enabled network in its namespace.
+ *
+ * This function is used to prevent unnecessary state updates when trying to enable
+ * This method is used to prevent the last network in a namespace from being removed.
+ *
+ * @param state - The current controller state
+ * @param derivedKeys - The parsed keys object containing namespace and storageKey
+ * @returns True if the network is the only enabled network in the namespace, false otherwise
+ */
+export function isOnlyNetworkEnabledInNamespace(
+  state: NetworkEnablementControllerState,
+  derivedKeys: DerivedKeys,
+): boolean {
+  const { namespace, storageKey } = derivedKeys;
+&nbsp;
+  // Early return if namespace doesn't exist
+  if (!state.enabledNetworkMap[namespace]) {
+    return false;
+  }
+&nbsp;
+  const networks = state.enabledNetworkMap[namespace];
+&nbsp;
+  // Get all enabled networks in this namespace
+  const enabledNetworks = Object.entries(networks).filter(
+    ([_, enabled]) =&gt; enabled,
+  );
+&nbsp;
+  // Check if there's exactly one enabled network and it matches our target
+  if (enabledNetworks.length === 1) {
+    const [onlyEnabledKey] = enabledNetworks[0];
+    return onlyEnabledKey === storageKey;
+  }
+&nbsp;
+  // Return false if there are zero or multiple enabled networks
+  return false;
+}
+&nbsp;
+/**
+ * Checks if a network is considered popular based on its reference.
+ *
+ * @param reference - The network reference (typically the chain ID reference part)
+ * @returns True if the network is popular, false otherwise
+ */
+export function isPopularNetwork(reference: string): boolean {
+  try {
+    return POPULAR_NETWORKS.includes(toHex(reference));
+  } catch {
+    // If toHex fails (e.g., for non-decimal references like Bitcoin hashes),
+    // the network is not popular
+    return false;
+  }
+}
+&nbsp;</pre></td></tr></table></pre>
+
+                <div class='push'></div><!-- for sticky footer -->
+            </div><!-- /wrapper -->
+            <div class='footer quiet pad2 space-top1 center small'>
+                Code coverage generated by
+                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
+                at 2025-09-04T23:19:41.560Z
+            </div>
+        <script src="prettify.js"></script>
+        <script>
+            window.onload = function () {
+                prettyPrint();
+            };
+        </script>
+        <script src="sorter.js"></script>
+        <script src="block-navigation.js"></script>
+    </body>
+</html>
+    
\ No newline at end of file
diff --git a/coverage/lcov.info b/coverage/lcov.info
new file mode 100644
index 0000000000000000000000000000000000000000..185355fd2c6b90e372c776d2abc496ba7f05c37d
--- /dev/null
+++ b/coverage/lcov.info
@@ -0,0 +1,320 @@
+TN:
+SF:src/NetworkEnablementController.ts
+FN:111,(anonymous_1)
+FN:158,(anonymous_2)
+FN:175,(anonymous_3)
+FN:179,(anonymous_4)
+FN:186,(anonymous_5)
+FN:212,(anonymous_6)
+FN:215,(anonymous_7)
+FN:223,(anonymous_8)
+FN:241,(anonymous_9)
+FN:242,(anonymous_10)
+FN:252,(anonymous_11)
+FN:306,(anonymous_12)
+FN:307,(anonymous_13)
+FN:321,(anonymous_14)
+FN:329,(anonymous_15)
+FN:335,(anonymous_16)
+FN:386,(anonymous_17)
+FN:394,(anonymous_18)
+FN:407,(anonymous_19)
+FN:424,_NetworkEnablementController_ensureNamespaceBucket
+FN:430,_NetworkEnablementController_removeNetworkEntry
+FN:444,(anonymous_22)
+FN:455,_NetworkEnablementController_onAddNetwork
+FN:469,(anonymous_24)
+FN:476,(anonymous_25)
+FNF:25
+FNH:25
+FNDA:47,(anonymous_1)
+FNDA:47,(anonymous_2)
+FNDA:7,(anonymous_3)
+FNDA:2,(anonymous_4)
+FNDA:5,(anonymous_5)
+FNDA:16,(anonymous_6)
+FNDA:15,(anonymous_7)
+FNDA:44,(anonymous_8)
+FNDA:4,(anonymous_9)
+FNDA:4,(anonymous_10)
+FNDA:48,(anonymous_11)
+FNDA:5,(anonymous_12)
+FNDA:5,(anonymous_13)
+FNDA:11,(anonymous_14)
+FNDA:8,(anonymous_15)
+FNDA:60,(anonymous_16)
+FNDA:22,(anonymous_17)
+FNDA:17,(anonymous_18)
+FNDA:104,(anonymous_19)
+FNDA:48,_NetworkEnablementController_ensureNamespaceBucket
+FNDA:2,_NetworkEnablementController_removeNetworkEntry
+FNDA:2,(anonymous_22)
+FNDA:7,_NetworkEnablementController_onAddNetwork
+FNDA:7,(anonymous_24)
+FNDA:15,(anonymous_25)
+DA:1,1
+DA:7,1
+DA:17,1
+DA:19,1
+DA:20,1
+DA:21,1
+DA:27,1
+DA:111,47
+DA:130,1
+DA:146,1
+DA:165,47
+DA:175,47
+DA:176,7
+DA:179,47
+DA:180,2
+DA:184,47
+DA:187,5
+DA:188,1
+DA:213,16
+DA:215,15
+DA:218,15
+DA:219,1
+DA:223,14
+DA:224,44
+DA:228,14
+DA:242,4
+DA:244,4
+DA:247,4
+DA:252,4
+DA:253,48
+DA:256,48
+DA:260,18
+DA:262,18
+DA:267,4
+DA:268,4
+DA:274,3
+DA:276,3
+DA:280,4
+DA:281,4
+DA:287,1
+DA:289,1
+DA:307,5
+DA:309,5
+DA:314,5
+DA:319,5
+DA:322,11
+DA:323,11
+DA:327,5
+DA:330,8
+DA:331,8
+DA:335,5
+DA:336,60
+DA:339,60
+DA:343,11
+DA:348,5
+DA:349,5
+DA:355,3
+DA:359,5
+DA:360,5
+DA:366,1
+DA:387,22
+DA:388,21
+DA:390,21
+DA:391,4
+DA:394,17
+DA:395,17
+DA:408,104
+DA:409,101
+DA:410,101
+DA:424,1
+DA:427,48
+DA:428,2
+DA:441,2
+DA:442,2
+DA:444,2
+DA:446,2
+DA:447,1
+DA:451,2
+DA:452,2
+DA:467,7
+DA:469,7
+DA:471,7
+DA:475,7
+DA:476,5
+DA:477,15
+DA:482,7
+LF:86
+LH:86
+BRDA:187,0,0,1
+BRDA:218,1,0,1
+BRDA:256,2,0,18
+BRDA:268,3,0,3
+BRDA:281,4,0,1
+BRDA:339,5,0,11
+BRDA:340,6,0,60
+BRDA:340,6,1,60
+BRDA:349,7,0,3
+BRDA:350,8,0,5
+BRDA:350,8,1,4
+BRDA:360,9,0,1
+BRDA:361,10,0,5
+BRDA:361,10,1,3
+BRDA:390,11,0,4
+BRDA:410,12,0,101
+BRDA:410,12,1,10
+BRDA:427,13,0,2
+BRDA:446,14,0,1
+BRDA:451,15,0,2
+BRDA:475,16,0,5
+BRF:21
+BRH:21
+end_of_record
+TN:
+SF:src/constants.ts
+FNF:0
+FNH:0
+DA:1,3
+LF:1
+LH:1
+BRF:0
+BRH:0
+end_of_record
+TN:
+SF:src/selectors.ts
+FN:14,(anonymous_0)
+FN:28,(anonymous_1)
+FN:29,(anonymous_2)
+FN:48,(anonymous_3)
+FN:51,(anonymous_4)
+FN:53,(anonymous_5)
+FN:54,(anonymous_6)
+FN:67,(anonymous_7)
+FN:69,(anonymous_8)
+FN:71,(anonymous_9)
+FN:72,(anonymous_10)
+FN:87,(anonymous_11)
+FN:101,(anonymous_12)
+FN:113,(anonymous_13)
+FNF:14
+FNH:14
+FNDA:21,(anonymous_0)
+FNDA:4,(anonymous_1)
+FNDA:4,(anonymous_2)
+FNDA:5,(anonymous_3)
+FNDA:5,(anonymous_4)
+FNDA:10,(anonymous_5)
+FNDA:6,(anonymous_6)
+FNDA:1,(anonymous_7)
+FNDA:2,(anonymous_8)
+FNDA:5,(anonymous_9)
+FNDA:3,(anonymous_10)
+FNDA:1,(anonymous_11)
+FNDA:2,(anonymous_12)
+FNDA:2,(anonymous_13)
+DA:2,1
+DA:3,1
+DA:6,1
+DA:14,1
+DA:16,21
+DA:28,1
+DA:29,4
+DA:30,4
+DA:32,4
+DA:48,1
+DA:51,5
+DA:52,5
+DA:53,10
+DA:54,6
+DA:65,1
+DA:68,1
+DA:70,2
+DA:71,5
+DA:72,3
+DA:73,2
+DA:85,1
+DA:88,1
+DA:99,1
+DA:101,2
+DA:111,1
+DA:113,2
+LF:26
+LH:26
+BRDA:33,0,0,4
+BRDA:33,0,1,4
+BRDA:33,0,2,3
+BRDA:52,1,0,5
+BRDA:52,1,1,1
+BRF:5
+BRH:5
+end_of_record
+TN:
+SF:src/types.ts
+FN:4,(anonymous_0)
+FN:13,(anonymous_1)
+FNF:2
+FNH:2
+FNDA:1,(anonymous_0)
+FNDA:1,(anonymous_1)
+DA:4,1
+DA:5,1
+DA:6,1
+DA:7,1
+DA:13,1
+DA:14,1
+DA:15,1
+DA:16,1
+LF:8
+LH:8
+BRDA:4,0,0,1
+BRDA:4,0,1,1
+BRDA:13,1,0,1
+BRDA:13,1,1,1
+BRF:4
+BRH:4
+end_of_record
+TN:
+SF:src/utils.ts
+FN:36,deriveKeys
+FN:61,isOnlyNetworkEnabledInNamespace
+FN:76,(anonymous_2)
+FN:95,isPopularNetwork
+FNF:4
+FNH:4
+FNDA:318,deriveKeys
+FNDA:36,isOnlyNetworkEnabledInNamespace
+FNDA:94,(anonymous_2)
+FNDA:12,isPopularNetwork
+DA:1,3
+DA:2,3
+DA:4,3
+DA:11,3
+DA:36,3
+DA:37,318
+DA:41,313
+DA:43,313
+DA:44,210
+DA:46,103
+DA:48,313
+DA:61,3
+DA:65,36
+DA:68,36
+DA:69,1
+DA:72,35
+DA:75,35
+DA:76,94
+DA:80,35
+DA:81,12
+DA:82,12
+DA:86,23
+DA:95,3
+DA:96,12
+DA:97,12
+DA:101,5
+LF:26
+LH:26
+BRDA:37,0,0,123
+BRDA:37,0,1,195
+BRDA:43,1,0,210
+BRDA:43,1,1,103
+BRDA:44,2,0,190
+BRDA:44,2,1,20
+BRDA:68,3,0,1
+BRDA:80,4,0,12
+BRF:8
+BRH:8
+end_of_record
diff --git a/coverage/prettify.css b/coverage/prettify.css
new file mode 100644
index 0000000000000000000000000000000000000000..b317a7cda31a440fbd47540297ee3c68d51f343e
--- /dev/null
+++ b/coverage/prettify.css
@@ -0,0 +1 @@
+.pln{color:#000}@media screen{.str{color:#080}.kwd{color:#008}.com{color:#800}.typ{color:#606}.lit{color:#066}.pun,.opn,.clo{color:#660}.tag{color:#008}.atn{color:#606}.atv{color:#080}.dec,.var{color:#606}.fun{color:red}}@media print,projection{.str{color:#060}.kwd{color:#006;font-weight:bold}.com{color:#600;font-style:italic}.typ{color:#404;font-weight:bold}.lit{color:#044}.pun,.opn,.clo{color:#440}.tag{color:#006;font-weight:bold}.atn{color:#404}.atv{color:#060}}pre.prettyprint{padding:2px;border:1px solid #888}ol.linenums{margin-top:0;margin-bottom:0}li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8{list-style-type:none}li.L1,li.L3,li.L5,li.L7,li.L9{background:#eee}
diff --git a/coverage/prettify.js b/coverage/prettify.js
new file mode 100644
index 0000000000000000000000000000000000000000..b3225238f26e3ab49a5e41e9cb287a73c82740b7
--- /dev/null
+++ b/coverage/prettify.js
@@ -0,0 +1,2 @@
+/* eslint-disable */
+window.PR_SHOULD_USE_CONTINUATION=true;(function(){var h=["break,continue,do,else,for,if,return,while"];var u=[h,"auto,case,char,const,default,double,enum,extern,float,goto,int,long,register,short,signed,sizeof,static,struct,switch,typedef,union,unsigned,void,volatile"];var p=[u,"catch,class,delete,false,import,new,operator,private,protected,public,this,throw,true,try,typeof"];var l=[p,"alignof,align_union,asm,axiom,bool,concept,concept_map,const_cast,constexpr,decltype,dynamic_cast,explicit,export,friend,inline,late_check,mutable,namespace,nullptr,reinterpret_cast,static_assert,static_cast,template,typeid,typename,using,virtual,where"];var x=[p,"abstract,boolean,byte,extends,final,finally,implements,import,instanceof,null,native,package,strictfp,super,synchronized,throws,transient"];var R=[x,"as,base,by,checked,decimal,delegate,descending,dynamic,event,fixed,foreach,from,group,implicit,in,interface,internal,into,is,lock,object,out,override,orderby,params,partial,readonly,ref,sbyte,sealed,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,var"];var r="all,and,by,catch,class,else,extends,false,finally,for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,true,try,unless,until,when,while,yes";var w=[p,"debugger,eval,export,function,get,null,set,undefined,var,with,Infinity,NaN"];var s="caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END";var I=[h,"and,as,assert,class,def,del,elif,except,exec,finally,from,global,import,in,is,lambda,nonlocal,not,or,pass,print,raise,try,with,yield,False,True,None"];var f=[h,"alias,and,begin,case,class,def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,rescue,retry,self,super,then,true,undef,unless,until,when,yield,BEGIN,END"];var H=[h,"case,done,elif,esac,eval,fi,function,in,local,set,then,until"];var A=[l,R,w,s+I,f,H];var e=/^(DIR|FILE|vector|(de|priority_)?queue|list|stack|(const_)?iterator|(multi)?(set|map)|bitset|u?(int|float)\d*)/;var C="str";var z="kwd";var j="com";var O="typ";var G="lit";var L="pun";var F="pln";var m="tag";var E="dec";var J="src";var P="atn";var n="atv";var N="nocode";var M="(?:^^\\.?|[+-]|\\!|\\!=|\\!==|\\#|\\%|\\%=|&|&&|&&=|&=|\\(|\\*|\\*=|\\+=|\\,|\\-=|\\->|\\/|\\/=|:|::|\\;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\@|\\[|\\^|\\^=|\\^\\^|\\^\\^=|\\{|\\||\\|=|\\|\\||\\|\\|=|\\~|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\\s*";function k(Z){var ad=0;var S=false;var ac=false;for(var V=0,U=Z.length;V<U;++V){var ae=Z[V];if(ae.ignoreCase){ac=true}else{if(/[a-z]/i.test(ae.source.replace(/\\u[0-9a-f]{4}|\\x[0-9a-f]{2}|\\[^ux]/gi,""))){S=true;ac=false;break}}}var Y={b:8,t:9,n:10,v:11,f:12,r:13};function ab(ah){var ag=ah.charCodeAt(0);if(ag!==92){return ag}var af=ah.charAt(1);ag=Y[af];if(ag){return ag}else{if("0"<=af&&af<="7"){return parseInt(ah.substring(1),8)}else{if(af==="u"||af==="x"){return parseInt(ah.substring(2),16)}else{return ah.charCodeAt(1)}}}}function T(af){if(af<32){return(af<16?"\\x0":"\\x")+af.toString(16)}var ag=String.fromCharCode(af);if(ag==="\\"||ag==="-"||ag==="["||ag==="]"){ag="\\"+ag}return ag}function X(am){var aq=am.substring(1,am.length-1).match(new RegExp("\\\\u[0-9A-Fa-f]{4}|\\\\x[0-9A-Fa-f]{2}|\\\\[0-3][0-7]{0,2}|\\\\[0-7]{1,2}|\\\\[\\s\\S]|-|[^-\\\\]","g"));var ak=[];var af=[];var ao=aq[0]==="^";for(var ar=ao?1:0,aj=aq.length;ar<aj;++ar){var ah=aq[ar];if(/\\[bdsw]/i.test(ah)){ak.push(ah)}else{var ag=ab(ah);var al;if(ar+2<aj&&"-"===aq[ar+1]){al=ab(aq[ar+2]);ar+=2}else{al=ag}af.push([ag,al]);if(!(al<65||ag>122)){if(!(al<65||ag>90)){af.push([Math.max(65,ag)|32,Math.min(al,90)|32])}if(!(al<97||ag>122)){af.push([Math.max(97,ag)&~32,Math.min(al,122)&~32])}}}}af.sort(function(av,au){return(av[0]-au[0])||(au[1]-av[1])});var ai=[];var ap=[NaN,NaN];for(var ar=0;ar<af.length;++ar){var at=af[ar];if(at[0]<=ap[1]+1){ap[1]=Math.max(ap[1],at[1])}else{ai.push(ap=at)}}var an=["["];if(ao){an.push("^")}an.push.apply(an,ak);for(var ar=0;ar<ai.length;++ar){var at=ai[ar];an.push(T(at[0]));if(at[1]>at[0]){if(at[1]+1>at[0]){an.push("-")}an.push(T(at[1]))}}an.push("]");return an.join("")}function W(al){var aj=al.source.match(new RegExp("(?:\\[(?:[^\\x5C\\x5D]|\\\\[\\s\\S])*\\]|\\\\u[A-Fa-f0-9]{4}|\\\\x[A-Fa-f0-9]{2}|\\\\[0-9]+|\\\\[^ux0-9]|\\(\\?[:!=]|[\\(\\)\\^]|[^\\x5B\\x5C\\(\\)\\^]+)","g"));var ah=aj.length;var an=[];for(var ak=0,am=0;ak<ah;++ak){var ag=aj[ak];if(ag==="("){++am}else{if("\\"===ag.charAt(0)){var af=+ag.substring(1);if(af&&af<=am){an[af]=-1}}}}for(var ak=1;ak<an.length;++ak){if(-1===an[ak]){an[ak]=++ad}}for(var ak=0,am=0;ak<ah;++ak){var ag=aj[ak];if(ag==="("){++am;if(an[am]===undefined){aj[ak]="(?:"}}else{if("\\"===ag.charAt(0)){var af=+ag.substring(1);if(af&&af<=am){aj[ak]="\\"+an[am]}}}}for(var ak=0,am=0;ak<ah;++ak){if("^"===aj[ak]&&"^"!==aj[ak+1]){aj[ak]=""}}if(al.ignoreCase&&S){for(var ak=0;ak<ah;++ak){var ag=aj[ak];var ai=ag.charAt(0);if(ag.length>=2&&ai==="["){aj[ak]=X(ag)}else{if(ai!=="\\"){aj[ak]=ag.replace(/[a-zA-Z]/g,function(ao){var ap=ao.charCodeAt(0);return"["+String.fromCharCode(ap&~32,ap|32)+"]"})}}}}return aj.join("")}var aa=[];for(var V=0,U=Z.length;V<U;++V){var ae=Z[V];if(ae.global||ae.multiline){throw new Error(""+ae)}aa.push("(?:"+W(ae)+")")}return new RegExp(aa.join("|"),ac?"gi":"g")}function a(V){var U=/(?:^|\s)nocode(?:\s|$)/;var X=[];var T=0;var Z=[];var W=0;var S;if(V.currentStyle){S=V.currentStyle.whiteSpace}else{if(window.getComputedStyle){S=document.defaultView.getComputedStyle(V,null).getPropertyValue("white-space")}}var Y=S&&"pre"===S.substring(0,3);function aa(ab){switch(ab.nodeType){case 1:if(U.test(ab.className)){return}for(var ae=ab.firstChild;ae;ae=ae.nextSibling){aa(ae)}var ad=ab.nodeName;if("BR"===ad||"LI"===ad){X[W]="\n";Z[W<<1]=T++;Z[(W++<<1)|1]=ab}break;case 3:case 4:var ac=ab.nodeValue;if(ac.length){if(!Y){ac=ac.replace(/[ \t\r\n]+/g," ")}else{ac=ac.replace(/\r\n?/g,"\n")}X[W]=ac;Z[W<<1]=T;T+=ac.length;Z[(W++<<1)|1]=ab}break}}aa(V);return{sourceCode:X.join("").replace(/\n$/,""),spans:Z}}function B(S,U,W,T){if(!U){return}var V={sourceCode:U,basePos:S};W(V);T.push.apply(T,V.decorations)}var v=/\S/;function o(S){var V=undefined;for(var U=S.firstChild;U;U=U.nextSibling){var T=U.nodeType;V=(T===1)?(V?S:U):(T===3)?(v.test(U.nodeValue)?S:V):V}return V===S?undefined:V}function g(U,T){var S={};var V;(function(){var ad=U.concat(T);var ah=[];var ag={};for(var ab=0,Z=ad.length;ab<Z;++ab){var Y=ad[ab];var ac=Y[3];if(ac){for(var ae=ac.length;--ae>=0;){S[ac.charAt(ae)]=Y}}var af=Y[1];var aa=""+af;if(!ag.hasOwnProperty(aa)){ah.push(af);ag[aa]=null}}ah.push(/[\0-\uffff]/);V=k(ah)})();var X=T.length;var W=function(ah){var Z=ah.sourceCode,Y=ah.basePos;var ad=[Y,F];var af=0;var an=Z.match(V)||[];var aj={};for(var ae=0,aq=an.length;ae<aq;++ae){var ag=an[ae];var ap=aj[ag];var ai=void 0;var am;if(typeof ap==="string"){am=false}else{var aa=S[ag.charAt(0)];if(aa){ai=ag.match(aa[1]);ap=aa[0]}else{for(var ao=0;ao<X;++ao){aa=T[ao];ai=ag.match(aa[1]);if(ai){ap=aa[0];break}}if(!ai){ap=F}}am=ap.length>=5&&"lang-"===ap.substring(0,5);if(am&&!(ai&&typeof ai[1]==="string")){am=false;ap=J}if(!am){aj[ag]=ap}}var ab=af;af+=ag.length;if(!am){ad.push(Y+ab,ap)}else{var al=ai[1];var ak=ag.indexOf(al);var ac=ak+al.length;if(ai[2]){ac=ag.length-ai[2].length;ak=ac-al.length}var ar=ap.substring(5);B(Y+ab,ag.substring(0,ak),W,ad);B(Y+ab+ak,al,q(ar,al),ad);B(Y+ab+ac,ag.substring(ac),W,ad)}}ah.decorations=ad};return W}function i(T){var W=[],S=[];if(T.tripleQuotedStrings){W.push([C,/^(?:\'\'\'(?:[^\'\\]|\\[\s\S]|\'{1,2}(?=[^\']))*(?:\'\'\'|$)|\"\"\"(?:[^\"\\]|\\[\s\S]|\"{1,2}(?=[^\"]))*(?:\"\"\"|$)|\'(?:[^\\\']|\\[\s\S])*(?:\'|$)|\"(?:[^\\\"]|\\[\s\S])*(?:\"|$))/,null,"'\""])}else{if(T.multiLineStrings){W.push([C,/^(?:\'(?:[^\\\']|\\[\s\S])*(?:\'|$)|\"(?:[^\\\"]|\\[\s\S])*(?:\"|$)|\`(?:[^\\\`]|\\[\s\S])*(?:\`|$))/,null,"'\"`"])}else{W.push([C,/^(?:\'(?:[^\\\'\r\n]|\\.)*(?:\'|$)|\"(?:[^\\\"\r\n]|\\.)*(?:\"|$))/,null,"\"'"])}}if(T.verbatimStrings){S.push([C,/^@\"(?:[^\"]|\"\")*(?:\"|$)/,null])}var Y=T.hashComments;if(Y){if(T.cStyleComments){if(Y>1){W.push([j,/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/,null,"#"])}else{W.push([j,/^#(?:(?:define|elif|else|endif|error|ifdef|include|ifndef|line|pragma|undef|warning)\b|[^\r\n]*)/,null,"#"])}S.push([C,/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h|[a-z]\w*)>/,null])}else{W.push([j,/^#[^\r\n]*/,null,"#"])}}if(T.cStyleComments){S.push([j,/^\/\/[^\r\n]*/,null]);S.push([j,/^\/\*[\s\S]*?(?:\*\/|$)/,null])}if(T.regexLiterals){var X=("/(?=[^/*])(?:[^/\\x5B\\x5C]|\\x5C[\\s\\S]|\\x5B(?:[^\\x5C\\x5D]|\\x5C[\\s\\S])*(?:\\x5D|$))+/");S.push(["lang-regex",new RegExp("^"+M+"("+X+")")])}var V=T.types;if(V){S.push([O,V])}var U=(""+T.keywords).replace(/^ | $/g,"");if(U.length){S.push([z,new RegExp("^(?:"+U.replace(/[\s,]+/g,"|")+")\\b"),null])}W.push([F,/^\s+/,null," \r\n\t\xA0"]);S.push([G,/^@[a-z_$][a-z_$@0-9]*/i,null],[O,/^(?:[@_]?[A-Z]+[a-z][A-Za-z_$@0-9]*|\w+_t\b)/,null],[F,/^[a-z_$][a-z_$@0-9]*/i,null],[G,new RegExp("^(?:0x[a-f0-9]+|(?:\\d(?:_\\d+)*\\d*(?:\\.\\d*)?|\\.\\d\\+)(?:e[+\\-]?\\d+)?)[a-z]*","i"),null,"0123456789"],[F,/^\\[\s\S]?/,null],[L,/^.[^\s\w\.$@\'\"\`\/\#\\]*/,null]);return g(W,S)}var K=i({keywords:A,hashComments:true,cStyleComments:true,multiLineStrings:true,regexLiterals:true});function Q(V,ag){var U=/(?:^|\s)nocode(?:\s|$)/;var ab=/\r\n?|\n/;var ac=V.ownerDocument;var S;if(V.currentStyle){S=V.currentStyle.whiteSpace}else{if(window.getComputedStyle){S=ac.defaultView.getComputedStyle(V,null).getPropertyValue("white-space")}}var Z=S&&"pre"===S.substring(0,3);var af=ac.createElement("LI");while(V.firstChild){af.appendChild(V.firstChild)}var W=[af];function ae(al){switch(al.nodeType){case 1:if(U.test(al.className)){break}if("BR"===al.nodeName){ad(al);if(al.parentNode){al.parentNode.removeChild(al)}}else{for(var an=al.firstChild;an;an=an.nextSibling){ae(an)}}break;case 3:case 4:if(Z){var am=al.nodeValue;var aj=am.match(ab);if(aj){var ai=am.substring(0,aj.index);al.nodeValue=ai;var ah=am.substring(aj.index+aj[0].length);if(ah){var ak=al.parentNode;ak.insertBefore(ac.createTextNode(ah),al.nextSibling)}ad(al);if(!ai){al.parentNode.removeChild(al)}}}break}}function ad(ak){while(!ak.nextSibling){ak=ak.parentNode;if(!ak){return}}function ai(al,ar){var aq=ar?al.cloneNode(false):al;var ao=al.parentNode;if(ao){var ap=ai(ao,1);var an=al.nextSibling;ap.appendChild(aq);for(var am=an;am;am=an){an=am.nextSibling;ap.appendChild(am)}}return aq}var ah=ai(ak.nextSibling,0);for(var aj;(aj=ah.parentNode)&&aj.nodeType===1;){ah=aj}W.push(ah)}for(var Y=0;Y<W.length;++Y){ae(W[Y])}if(ag===(ag|0)){W[0].setAttribute("value",ag)}var aa=ac.createElement("OL");aa.className="linenums";var X=Math.max(0,((ag-1))|0)||0;for(var Y=0,T=W.length;Y<T;++Y){af=W[Y];af.className="L"+((Y+X)%10);if(!af.firstChild){af.appendChild(ac.createTextNode("\xA0"))}aa.appendChild(af)}V.appendChild(aa)}function D(ac){var aj=/\bMSIE\b/.test(navigator.userAgent);var am=/\n/g;var al=ac.sourceCode;var an=al.length;var V=0;var aa=ac.spans;var T=aa.length;var ah=0;var X=ac.decorations;var Y=X.length;var Z=0;X[Y]=an;var ar,aq;for(aq=ar=0;aq<Y;){if(X[aq]!==X[aq+2]){X[ar++]=X[aq++];X[ar++]=X[aq++]}else{aq+=2}}Y=ar;for(aq=ar=0;aq<Y;){var at=X[aq];var ab=X[aq+1];var W=aq+2;while(W+2<=Y&&X[W+1]===ab){W+=2}X[ar++]=at;X[ar++]=ab;aq=W}Y=X.length=ar;var ae=null;while(ah<T){var af=aa[ah];var S=aa[ah+2]||an;var ag=X[Z];var ap=X[Z+2]||an;var W=Math.min(S,ap);var ak=aa[ah+1];var U;if(ak.nodeType!==1&&(U=al.substring(V,W))){if(aj){U=U.replace(am,"\r")}ak.nodeValue=U;var ai=ak.ownerDocument;var ao=ai.createElement("SPAN");ao.className=X[Z+1];var ad=ak.parentNode;ad.replaceChild(ao,ak);ao.appendChild(ak);if(V<S){aa[ah+1]=ak=ai.createTextNode(al.substring(W,S));ad.insertBefore(ak,ao.nextSibling)}}V=W;if(V>=S){ah+=2}if(V>=ap){Z+=2}}}var t={};function c(U,V){for(var S=V.length;--S>=0;){var T=V[S];if(!t.hasOwnProperty(T)){t[T]=U}else{if(window.console){console.warn("cannot override language handler %s",T)}}}}function q(T,S){if(!(T&&t.hasOwnProperty(T))){T=/^\s*</.test(S)?"default-markup":"default-code"}return t[T]}c(K,["default-code"]);c(g([],[[F,/^[^<?]+/],[E,/^<!\w[^>]*(?:>|$)/],[j,/^<\!--[\s\S]*?(?:-\->|$)/],["lang-",/^<\?([\s\S]+?)(?:\?>|$)/],["lang-",/^<%([\s\S]+?)(?:%>|$)/],[L,/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\s\S]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\s\S]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\s\S]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),["default-markup","htm","html","mxml","xhtml","xml","xsl"]);c(g([[F,/^[\s]+/,null," \t\r\n"],[n,/^(?:\"[^\"]*\"?|\'[^\']*\'?)/,null,"\"'"]],[[m,/^^<\/?[a-z](?:[\w.:-]*\w)?|\/?>$/i],[P,/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^>\'\"\s]*(?:[^>\'\"\s\/]|\/(?=\s)))/],[L,/^[=<>\/]+/],["lang-js",/^on\w+\s*=\s*\"([^\"]+)\"/i],["lang-js",/^on\w+\s*=\s*\'([^\']+)\'/i],["lang-js",/^on\w+\s*=\s*([^\"\'>\s]+)/i],["lang-css",/^style\s*=\s*\"([^\"]+)\"/i],["lang-css",/^style\s*=\s*\'([^\']+)\'/i],["lang-css",/^style\s*=\s*([^\"\'>\s]+)/i]]),["in.tag"]);c(g([],[[n,/^[\s\S]+/]]),["uq.val"]);c(i({keywords:l,hashComments:true,cStyleComments:true,types:e}),["c","cc","cpp","cxx","cyc","m"]);c(i({keywords:"null,true,false"}),["json"]);c(i({keywords:R,hashComments:true,cStyleComments:true,verbatimStrings:true,types:e}),["cs"]);c(i({keywords:x,cStyleComments:true}),["java"]);c(i({keywords:H,hashComments:true,multiLineStrings:true}),["bsh","csh","sh"]);c(i({keywords:I,hashComments:true,multiLineStrings:true,tripleQuotedStrings:true}),["cv","py"]);c(i({keywords:s,hashComments:true,multiLineStrings:true,regexLiterals:true}),["perl","pl","pm"]);c(i({keywords:f,hashComments:true,multiLineStrings:true,regexLiterals:true}),["rb"]);c(i({keywords:w,cStyleComments:true,regexLiterals:true}),["js"]);c(i({keywords:r,hashComments:3,cStyleComments:true,multilineStrings:true,tripleQuotedStrings:true,regexLiterals:true}),["coffee"]);c(g([],[[C,/^[\s\S]+/]]),["regex"]);function d(V){var U=V.langExtension;try{var S=a(V.sourceNode);var T=S.sourceCode;V.sourceCode=T;V.spans=S.spans;V.basePos=0;q(U,T)(V);D(V)}catch(W){if("console" in window){console.log(W&&W.stack?W.stack:W)}}}function y(W,V,U){var S=document.createElement("PRE");S.innerHTML=W;if(U){Q(S,U)}var T={langExtension:V,numberLines:U,sourceNode:S};d(T);return S.innerHTML}function b(ad){function Y(af){return document.getElementsByTagName(af)}var ac=[Y("pre"),Y("code"),Y("xmp")];var T=[];for(var aa=0;aa<ac.length;++aa){for(var Z=0,V=ac[aa].length;Z<V;++Z){T.push(ac[aa][Z])}}ac=null;var W=Date;if(!W.now){W={now:function(){return +(new Date)}}}var X=0;var S;var ab=/\blang(?:uage)?-([\w.]+)(?!\S)/;var ae=/\bprettyprint\b/;function U(){var ag=(window.PR_SHOULD_USE_CONTINUATION?W.now()+250:Infinity);for(;X<T.length&&W.now()<ag;X++){var aj=T[X];var ai=aj.className;if(ai.indexOf("prettyprint")>=0){var ah=ai.match(ab);var am;if(!ah&&(am=o(aj))&&"CODE"===am.tagName){ah=am.className.match(ab)}if(ah){ah=ah[1]}var al=false;for(var ak=aj.parentNode;ak;ak=ak.parentNode){if((ak.tagName==="pre"||ak.tagName==="code"||ak.tagName==="xmp")&&ak.className&&ak.className.indexOf("prettyprint")>=0){al=true;break}}if(!al){var af=aj.className.match(/\blinenums\b(?::(\d+))?/);af=af?af[1]&&af[1].length?+af[1]:true:false;if(af){Q(aj,af)}S={langExtension:ah,sourceNode:aj,numberLines:af};d(S)}}}if(X<T.length){setTimeout(U,250)}else{if(ad){ad()}}}U()}window.prettyPrintOne=y;window.prettyPrint=b;window.PR={createSimpleLexer:g,registerLangHandler:c,sourceDecorator:i,PR_ATTRIB_NAME:P,PR_ATTRIB_VALUE:n,PR_COMMENT:j,PR_DECLARATION:E,PR_KEYWORD:z,PR_LITERAL:G,PR_NOCODE:N,PR_PLAIN:F,PR_PUNCTUATION:L,PR_SOURCE:J,PR_STRING:C,PR_TAG:m,PR_TYPE:O}})();PR.registerLangHandler(PR.createSimpleLexer([],[[PR.PR_DECLARATION,/^<!\w[^>]*(?:>|$)/],[PR.PR_COMMENT,/^<\!--[\s\S]*?(?:-\->|$)/],[PR.PR_PUNCTUATION,/^(?:<[%?]|[%?]>)/],["lang-",/^<\?([\s\S]+?)(?:\?>|$)/],["lang-",/^<%([\s\S]+?)(?:%>|$)/],["lang-",/^<xmp\b[^>]*>([\s\S]+?)<\/xmp\b[^>]*>/i],["lang-handlebars",/^<script\b[^>]*type\s*=\s*['"]?text\/x-handlebars-template['"]?\b[^>]*>([\s\S]*?)(<\/script\b[^>]*>)/i],["lang-js",/^<script\b[^>]*>([\s\S]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\s\S]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i],[PR.PR_DECLARATION,/^{{[#^>/]?\s*[\w.][^}]*}}/],[PR.PR_DECLARATION,/^{{&?\s*[\w.][^}]*}}/],[PR.PR_DECLARATION,/^{{{>?\s*[\w.][^}]*}}}/],[PR.PR_COMMENT,/^{{![^}]*}}/]]),["handlebars","hbs"]);PR.registerLangHandler(PR.createSimpleLexer([[PR.PR_PLAIN,/^[ \t\r\n\f]+/,null," \t\r\n\f"]],[[PR.PR_STRING,/^\"(?:[^\n\r\f\\\"]|\\(?:\r\n?|\n|\f)|\\[\s\S])*\"/,null],[PR.PR_STRING,/^\'(?:[^\n\r\f\\\']|\\(?:\r\n?|\n|\f)|\\[\s\S])*\'/,null],["lang-css-str",/^url\(([^\)\"\']*)\)/i],[PR.PR_KEYWORD,/^(?:url|rgb|\!important|@import|@page|@media|@charset|inherit)(?=[^\-\w]|$)/i,null],["lang-css-kw",/^(-?(?:[_a-z]|(?:\\[0-9a-f]+ ?))(?:[_a-z0-9\-]|\\(?:\\[0-9a-f]+ ?))*)\s*:/i],[PR.PR_COMMENT,/^\/\*[^*]*\*+(?:[^\/*][^*]*\*+)*\//],[PR.PR_COMMENT,/^(?:<!--|-->)/],[PR.PR_LITERAL,/^(?:\d+|\d*\.\d+)(?:%|[a-z]+)?/i],[PR.PR_LITERAL,/^#(?:[0-9a-f]{3}){1,2}/i],[PR.PR_PLAIN,/^-?(?:[_a-z]|(?:\\[\da-f]+ ?))(?:[_a-z\d\-]|\\(?:\\[\da-f]+ ?))*/i],[PR.PR_PUNCTUATION,/^[^\s\w\'\"]+/]]),["css"]);PR.registerLangHandler(PR.createSimpleLexer([],[[PR.PR_KEYWORD,/^-?(?:[_a-z]|(?:\\[\da-f]+ ?))(?:[_a-z\d\-]|\\(?:\\[\da-f]+ ?))*/i]]),["css-kw"]);PR.registerLangHandler(PR.createSimpleLexer([],[[PR.PR_STRING,/^[^\)\"\']+/]]),["css-str"]);
diff --git a/coverage/selectors.ts.html b/coverage/selectors.ts.html
new file mode 100644
index 0000000000000000000000000000000000000000..8209578a3f22d825c9442f5f9e082d0eeb6c626a
--- /dev/null
+++ b/coverage/selectors.ts.html
@@ -0,0 +1,427 @@
+
+<!doctype html>
+<html lang="en">
+
+<head>
+    <title>Code coverage report for selectors.ts</title>
+    <meta charset="utf-8" />
+    <link rel="stylesheet" href="prettify.css" />
+    <link rel="stylesheet" href="base.css" />
+    <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
+    <meta name="viewport" content="width=device-width, initial-scale=1" />
+    <style type='text/css'>
+        .coverage-summary .sorter {
+            background-image: url(sort-arrow-sprite.png);
+        }
+    </style>
+</head>
+    
+<body>
+<div class='wrapper'>
+    <div class='pad1'>
+        <h1><a href="index.html">All files</a> selectors.ts</h1>
+        <div class='clearfix'>
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Statements</span>
+                <span class='fraction'>29/29</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Branches</span>
+                <span class='fraction'>5/5</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Functions</span>
+                <span class='fraction'>14/14</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Lines</span>
+                <span class='fraction'>26/26</span>
+            </div>
+        
+            
+        </div>
+        <p class="quiet">
+            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
+        </p>
+        <template id="filterTemplate">
+            <div class="quiet">
+                Filter:
+                <input type="search" id="fileSearch">
+            </div>
+        </template>
+    </div>
+    <div class='status-line high'></div>
+    <pre><table class="coverage">
+<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
+<a name='L2'></a><a href='#L2'>2</a>
+<a name='L3'></a><a href='#L3'>3</a>
+<a name='L4'></a><a href='#L4'>4</a>
+<a name='L5'></a><a href='#L5'>5</a>
+<a name='L6'></a><a href='#L6'>6</a>
+<a name='L7'></a><a href='#L7'>7</a>
+<a name='L8'></a><a href='#L8'>8</a>
+<a name='L9'></a><a href='#L9'>9</a>
+<a name='L10'></a><a href='#L10'>10</a>
+<a name='L11'></a><a href='#L11'>11</a>
+<a name='L12'></a><a href='#L12'>12</a>
+<a name='L13'></a><a href='#L13'>13</a>
+<a name='L14'></a><a href='#L14'>14</a>
+<a name='L15'></a><a href='#L15'>15</a>
+<a name='L16'></a><a href='#L16'>16</a>
+<a name='L17'></a><a href='#L17'>17</a>
+<a name='L18'></a><a href='#L18'>18</a>
+<a name='L19'></a><a href='#L19'>19</a>
+<a name='L20'></a><a href='#L20'>20</a>
+<a name='L21'></a><a href='#L21'>21</a>
+<a name='L22'></a><a href='#L22'>22</a>
+<a name='L23'></a><a href='#L23'>23</a>
+<a name='L24'></a><a href='#L24'>24</a>
+<a name='L25'></a><a href='#L25'>25</a>
+<a name='L26'></a><a href='#L26'>26</a>
+<a name='L27'></a><a href='#L27'>27</a>
+<a name='L28'></a><a href='#L28'>28</a>
+<a name='L29'></a><a href='#L29'>29</a>
+<a name='L30'></a><a href='#L30'>30</a>
+<a name='L31'></a><a href='#L31'>31</a>
+<a name='L32'></a><a href='#L32'>32</a>
+<a name='L33'></a><a href='#L33'>33</a>
+<a name='L34'></a><a href='#L34'>34</a>
+<a name='L35'></a><a href='#L35'>35</a>
+<a name='L36'></a><a href='#L36'>36</a>
+<a name='L37'></a><a href='#L37'>37</a>
+<a name='L38'></a><a href='#L38'>38</a>
+<a name='L39'></a><a href='#L39'>39</a>
+<a name='L40'></a><a href='#L40'>40</a>
+<a name='L41'></a><a href='#L41'>41</a>
+<a name='L42'></a><a href='#L42'>42</a>
+<a name='L43'></a><a href='#L43'>43</a>
+<a name='L44'></a><a href='#L44'>44</a>
+<a name='L45'></a><a href='#L45'>45</a>
+<a name='L46'></a><a href='#L46'>46</a>
+<a name='L47'></a><a href='#L47'>47</a>
+<a name='L48'></a><a href='#L48'>48</a>
+<a name='L49'></a><a href='#L49'>49</a>
+<a name='L50'></a><a href='#L50'>50</a>
+<a name='L51'></a><a href='#L51'>51</a>
+<a name='L52'></a><a href='#L52'>52</a>
+<a name='L53'></a><a href='#L53'>53</a>
+<a name='L54'></a><a href='#L54'>54</a>
+<a name='L55'></a><a href='#L55'>55</a>
+<a name='L56'></a><a href='#L56'>56</a>
+<a name='L57'></a><a href='#L57'>57</a>
+<a name='L58'></a><a href='#L58'>58</a>
+<a name='L59'></a><a href='#L59'>59</a>
+<a name='L60'></a><a href='#L60'>60</a>
+<a name='L61'></a><a href='#L61'>61</a>
+<a name='L62'></a><a href='#L62'>62</a>
+<a name='L63'></a><a href='#L63'>63</a>
+<a name='L64'></a><a href='#L64'>64</a>
+<a name='L65'></a><a href='#L65'>65</a>
+<a name='L66'></a><a href='#L66'>66</a>
+<a name='L67'></a><a href='#L67'>67</a>
+<a name='L68'></a><a href='#L68'>68</a>
+<a name='L69'></a><a href='#L69'>69</a>
+<a name='L70'></a><a href='#L70'>70</a>
+<a name='L71'></a><a href='#L71'>71</a>
+<a name='L72'></a><a href='#L72'>72</a>
+<a name='L73'></a><a href='#L73'>73</a>
+<a name='L74'></a><a href='#L74'>74</a>
+<a name='L75'></a><a href='#L75'>75</a>
+<a name='L76'></a><a href='#L76'>76</a>
+<a name='L77'></a><a href='#L77'>77</a>
+<a name='L78'></a><a href='#L78'>78</a>
+<a name='L79'></a><a href='#L79'>79</a>
+<a name='L80'></a><a href='#L80'>80</a>
+<a name='L81'></a><a href='#L81'>81</a>
+<a name='L82'></a><a href='#L82'>82</a>
+<a name='L83'></a><a href='#L83'>83</a>
+<a name='L84'></a><a href='#L84'>84</a>
+<a name='L85'></a><a href='#L85'>85</a>
+<a name='L86'></a><a href='#L86'>86</a>
+<a name='L87'></a><a href='#L87'>87</a>
+<a name='L88'></a><a href='#L88'>88</a>
+<a name='L89'></a><a href='#L89'>89</a>
+<a name='L90'></a><a href='#L90'>90</a>
+<a name='L91'></a><a href='#L91'>91</a>
+<a name='L92'></a><a href='#L92'>92</a>
+<a name='L93'></a><a href='#L93'>93</a>
+<a name='L94'></a><a href='#L94'>94</a>
+<a name='L95'></a><a href='#L95'>95</a>
+<a name='L96'></a><a href='#L96'>96</a>
+<a name='L97'></a><a href='#L97'>97</a>
+<a name='L98'></a><a href='#L98'>98</a>
+<a name='L99'></a><a href='#L99'>99</a>
+<a name='L100'></a><a href='#L100'>100</a>
+<a name='L101'></a><a href='#L101'>101</a>
+<a name='L102'></a><a href='#L102'>102</a>
+<a name='L103'></a><a href='#L103'>103</a>
+<a name='L104'></a><a href='#L104'>104</a>
+<a name='L105'></a><a href='#L105'>105</a>
+<a name='L106'></a><a href='#L106'>106</a>
+<a name='L107'></a><a href='#L107'>107</a>
+<a name='L108'></a><a href='#L108'>108</a>
+<a name='L109'></a><a href='#L109'>109</a>
+<a name='L110'></a><a href='#L110'>110</a>
+<a name='L111'></a><a href='#L111'>111</a>
+<a name='L112'></a><a href='#L112'>112</a>
+<a name='L113'></a><a href='#L113'>113</a>
+<a name='L114'></a><a href='#L114'>114</a>
+<a name='L115'></a><a href='#L115'>115</a></td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">21x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">4x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">10x</span>
+<span class="cline-any cline-yes">6x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">2x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';
+import { KnownCaipNamespace } from '@metamask/utils';
+import { createSelector } from 'reselect';
+&nbsp;
+import type { NetworkEnablementControllerState } from './NetworkEnablementController';
+import { deriveKeys } from './utils';
+&nbsp;
+/**
+ * Base selector to get the enabled network map from the controller state.
+ *
+ * @param state - The NetworkEnablementController state
+ * @returns The enabled network map
+ */
+export const selectEnabledNetworkMap = (
+  state: NetworkEnablementControllerState,
+) =&gt; state.enabledNetworkMap;
+&nbsp;
+/**
+ * Selector to check if a specific network is enabled.
+ *
+ * This selector accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID
+ * (for any blockchain network) and returns whether the network is currently enabled.
+ * It returns false for unknown networks or if there's an error parsing the chain ID.
+ *
+ * @param chainId - The chain ID to check (Hex or CAIP-2 format)
+ * @returns A selector function that returns true if the network is enabled, false otherwise
+ */
+export const selectIsNetworkEnabled = (chainId: Hex | CaipChainId) =&gt;
+  createSelector(selectEnabledNetworkMap, (enabledNetworkMap) =&gt; {
+    const { namespace, storageKey } = deriveKeys(chainId);
+&nbsp;
+    return (
+      namespace in enabledNetworkMap &amp;&amp;
+      storageKey in enabledNetworkMap[namespace] &amp;&amp;
+      enabledNetworkMap[namespace][storageKey]
+    );
+  });
+&nbsp;
+/**
+ * Selector builder to get all enabled networks for a specific namespace.
+ *
+ * The selector returned by this function returns an array of chain IDs (as strings) for all enabled networks
+ * within the specified namespace (e.g., 'eip155' for EVM networks, 'solana' for Solana).
+ *
+ * @param namespace - The CAIP namespace to get enabled networks for (e.g., 'eip155', 'solana')
+ * @returns A selector function that returns an array of chain ID strings for enabled networks in the namespace
+ */
+export const createSelectorForEnabledNetworksForNamespace = (
+  namespace: CaipNamespace,
+) =&gt;
+  createSelector(selectEnabledNetworkMap, (enabledNetworkMap) =&gt; {
+    return Object.entries(enabledNetworkMap[namespace] ?? {})
+      .filter(([, enabled]) =&gt; enabled)
+      .map(([id]) =&gt; id);
+  });
+&nbsp;
+/**
+ * Selector to get all enabled networks across all namespaces.
+ *
+ * This selector returns a record where keys are CAIP namespaces and values are arrays
+ * of enabled chain IDs within each namespace.
+ *
+ * @returns A selector function that returns a record mapping namespace to array of enabled chain IDs
+ */
+export const selectAllEnabledNetworks = createSelector(
+  selectEnabledNetworkMap,
+  (enabledNetworkMap) =&gt; {
+    return (Object.keys(enabledNetworkMap) as CaipNamespace[]).reduce(
+      (acc, ns) =&gt; {
+        acc[ns] = Object.entries(enabledNetworkMap[ns])
+          .filter(([, enabled]) =&gt; enabled)
+          .map(([id]) =&gt; id);
+        return acc;
+      },
+      {} as Record&lt;CaipNamespace, string[]&gt;,
+    );
+  },
+);
+&nbsp;
+/**
+ * Selector to get the total count of enabled networks across all namespaces.
+ *
+ * @returns A selector function that returns the total number of enabled networks
+ */
+export const selectEnabledNetworksCount = createSelector(
+  selectAllEnabledNetworks,
+  (allEnabledNetworks) =&gt; {
+    return Object.values(allEnabledNetworks).flat().length;
+  },
+);
+&nbsp;
+/**
+ * Selector to get all enabled EVM networks.
+ *
+ * This is a convenience selector that specifically targets EIP-155 networks.
+ *
+ * @returns A selector function that returns an array of enabled EVM chain IDs
+ */
+export const selectEnabledEvmNetworks = createSelector(
+  createSelectorForEnabledNetworksForNamespace(KnownCaipNamespace.Eip155),
+  (enabledEvmNetworks) =&gt; enabledEvmNetworks,
+);
+&nbsp;
+/**
+ * Selector to get all enabled Solana networks.
+ *
+ * This is a convenience selector that specifically targets Solana networks.
+ *
+ * @returns A selector function that returns an array of enabled Solana chain IDs
+ */
+export const selectEnabledSolanaNetworks = createSelector(
+  createSelectorForEnabledNetworksForNamespace(KnownCaipNamespace.Solana),
+  (enabledSolanaNetworks) =&gt; enabledSolanaNetworks,
+);
+&nbsp;</pre></td></tr></table></pre>
+
+                <div class='push'></div><!-- for sticky footer -->
+            </div><!-- /wrapper -->
+            <div class='footer quiet pad2 space-top1 center small'>
+                Code coverage generated by
+                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
+                at 2025-09-04T23:19:41.552Z
+            </div>
+        <script src="prettify.js"></script>
+        <script>
+            window.onload = function () {
+                prettyPrint();
+            };
+        </script>
+        <script src="sorter.js"></script>
+        <script src="block-navigation.js"></script>
+    </body>
+</html>
+    
\ No newline at end of file
diff --git a/coverage/sort-arrow-sprite.png b/coverage/sort-arrow-sprite.png
new file mode 100644
index 0000000000000000000000000000000000000000..6ed68316eb3f65dec9063332d2f69bf3093bbfab
--- /dev/null
+++ b/coverage/sort-arrow-sprite.png
@@ -0,0 +1,3 @@
+PNG
+
+   IHDR         F3   QIDATxcp/c 0FH0LE]XJ6A2*0%`b(B0p Nx    IENDB`
\ No newline at end of file
diff --git a/coverage/sorter.js b/coverage/sorter.js
new file mode 100644
index 0000000000000000000000000000000000000000..2bb296a8ca8e48e468f22b92250b9fe2518b8cfc
--- /dev/null
+++ b/coverage/sorter.js
@@ -0,0 +1,196 @@
+/* eslint-disable */
+var addSorting = (function() {
+    'use strict';
+    var cols,
+        currentSort = {
+            index: 0,
+            desc: false
+        };
+
+    // returns the summary table element
+    function getTable() {
+        return document.querySelector('.coverage-summary');
+    }
+    // returns the thead element of the summary table
+    function getTableHeader() {
+        return getTable().querySelector('thead tr');
+    }
+    // returns the tbody element of the summary table
+    function getTableBody() {
+        return getTable().querySelector('tbody');
+    }
+    // returns the th element for nth column
+    function getNthColumn(n) {
+        return getTableHeader().querySelectorAll('th')[n];
+    }
+
+    function onFilterInput() {
+        const searchValue = document.getElementById('fileSearch').value;
+        const rows = document.getElementsByTagName('tbody')[0].children;
+        for (let i = 0; i < rows.length; i++) {
+            const row = rows[i];
+            if (
+                row.textContent
+                    .toLowerCase()
+                    .includes(searchValue.toLowerCase())
+            ) {
+                row.style.display = '';
+            } else {
+                row.style.display = 'none';
+            }
+        }
+    }
+
+    // loads the search box
+    function addSearchBox() {
+        var template = document.getElementById('filterTemplate');
+        var templateClone = template.content.cloneNode(true);
+        templateClone.getElementById('fileSearch').oninput = onFilterInput;
+        template.parentElement.appendChild(templateClone);
+    }
+
+    // loads all columns
+    function loadColumns() {
+        var colNodes = getTableHeader().querySelectorAll('th'),
+            colNode,
+            cols = [],
+            col,
+            i;
+
+        for (i = 0; i < colNodes.length; i += 1) {
+            colNode = colNodes[i];
+            col = {
+                key: colNode.getAttribute('data-col'),
+                sortable: !colNode.getAttribute('data-nosort'),
+                type: colNode.getAttribute('data-type') || 'string'
+            };
+            cols.push(col);
+            if (col.sortable) {
+                col.defaultDescSort = col.type === 'number';
+                colNode.innerHTML =
+                    colNode.innerHTML + '<span class="sorter"></span>';
+            }
+        }
+        return cols;
+    }
+    // attaches a data attribute to every tr element with an object
+    // of data values keyed by column name
+    function loadRowData(tableRow) {
+        var tableCols = tableRow.querySelectorAll('td'),
+            colNode,
+            col,
+            data = {},
+            i,
+            val;
+        for (i = 0; i < tableCols.length; i += 1) {
+            colNode = tableCols[i];
+            col = cols[i];
+            val = colNode.getAttribute('data-value');
+            if (col.type === 'number') {
+                val = Number(val);
+            }
+            data[col.key] = val;
+        }
+        return data;
+    }
+    // loads all row data
+    function loadData() {
+        var rows = getTableBody().querySelectorAll('tr'),
+            i;
+
+        for (i = 0; i < rows.length; i += 1) {
+            rows[i].data = loadRowData(rows[i]);
+        }
+    }
+    // sorts the table using the data for the ith column
+    function sortByIndex(index, desc) {
+        var key = cols[index].key,
+            sorter = function(a, b) {
+                a = a.data[key];
+                b = b.data[key];
+                return a < b ? -1 : a > b ? 1 : 0;
+            },
+            finalSorter = sorter,
+            tableBody = document.querySelector('.coverage-summary tbody'),
+            rowNodes = tableBody.querySelectorAll('tr'),
+            rows = [],
+            i;
+
+        if (desc) {
+            finalSorter = function(a, b) {
+                return -1 * sorter(a, b);
+            };
+        }
+
+        for (i = 0; i < rowNodes.length; i += 1) {
+            rows.push(rowNodes[i]);
+            tableBody.removeChild(rowNodes[i]);
+        }
+
+        rows.sort(finalSorter);
+
+        for (i = 0; i < rows.length; i += 1) {
+            tableBody.appendChild(rows[i]);
+        }
+    }
+    // removes sort indicators for current column being sorted
+    function removeSortIndicators() {
+        var col = getNthColumn(currentSort.index),
+            cls = col.className;
+
+        cls = cls.replace(/ sorted$/, '').replace(/ sorted-desc$/, '');
+        col.className = cls;
+    }
+    // adds sort indicators for current column being sorted
+    function addSortIndicators() {
+        getNthColumn(currentSort.index).className += currentSort.desc
+            ? ' sorted-desc'
+            : ' sorted';
+    }
+    // adds event listeners for all sorter widgets
+    function enableUI() {
+        var i,
+            el,
+            ithSorter = function ithSorter(i) {
+                var col = cols[i];
+
+                return function() {
+                    var desc = col.defaultDescSort;
+
+                    if (currentSort.index === i) {
+                        desc = !currentSort.desc;
+                    }
+                    sortByIndex(i, desc);
+                    removeSortIndicators();
+                    currentSort.index = i;
+                    currentSort.desc = desc;
+                    addSortIndicators();
+                };
+            };
+        for (i = 0; i < cols.length; i += 1) {
+            if (cols[i].sortable) {
+                // add the click event handler on the th so users
+                // dont have to click on those tiny arrows
+                el = getNthColumn(i).querySelector('.sorter').parentElement;
+                if (el.addEventListener) {
+                    el.addEventListener('click', ithSorter(i));
+                } else {
+                    el.attachEvent('onclick', ithSorter(i));
+                }
+            }
+        }
+    }
+    // adds sorting functionality to the UI
+    return function() {
+        if (!getTable()) {
+            return;
+        }
+        cols = loadColumns();
+        loadData();
+        addSearchBox();
+        addSortIndicators();
+        enableUI();
+    };
+})();
+
+window.addEventListener('load', addSorting);
diff --git a/coverage/types.ts.html b/coverage/types.ts.html
new file mode 100644
index 0000000000000000000000000000000000000000..1607dcd38ad8309c97c0194a80726f87354e8ebf
--- /dev/null
+++ b/coverage/types.ts.html
@@ -0,0 +1,136 @@
+
+<!doctype html>
+<html lang="en">
+
+<head>
+    <title>Code coverage report for types.ts</title>
+    <meta charset="utf-8" />
+    <link rel="stylesheet" href="prettify.css" />
+    <link rel="stylesheet" href="base.css" />
+    <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
+    <meta name="viewport" content="width=device-width, initial-scale=1" />
+    <style type='text/css'>
+        .coverage-summary .sorter {
+            background-image: url(sort-arrow-sprite.png);
+        }
+    </style>
+</head>
+    
+<body>
+<div class='wrapper'>
+    <div class='pad1'>
+        <h1><a href="index.html">All files</a> types.ts</h1>
+        <div class='clearfix'>
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Statements</span>
+                <span class='fraction'>8/8</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Branches</span>
+                <span class='fraction'>4/4</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Functions</span>
+                <span class='fraction'>2/2</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Lines</span>
+                <span class='fraction'>8/8</span>
+            </div>
+        
+            
+        </div>
+        <p class="quiet">
+            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
+        </p>
+        <template id="filterTemplate">
+            <div class="quiet">
+                Filter:
+                <input type="search" id="fileSearch">
+            </div>
+        </template>
+    </div>
+    <div class='status-line high'></div>
+    <pre><table class="coverage">
+<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
+<a name='L2'></a><a href='#L2'>2</a>
+<a name='L3'></a><a href='#L3'>3</a>
+<a name='L4'></a><a href='#L4'>4</a>
+<a name='L5'></a><a href='#L5'>5</a>
+<a name='L6'></a><a href='#L6'>6</a>
+<a name='L7'></a><a href='#L7'>7</a>
+<a name='L8'></a><a href='#L8'>8</a>
+<a name='L9'></a><a href='#L9'>9</a>
+<a name='L10'></a><a href='#L10'>10</a>
+<a name='L11'></a><a href='#L11'>11</a>
+<a name='L12'></a><a href='#L12'>12</a>
+<a name='L13'></a><a href='#L13'>13</a>
+<a name='L14'></a><a href='#L14'>14</a>
+<a name='L15'></a><a href='#L15'>15</a>
+<a name='L16'></a><a href='#L16'>16</a>
+<a name='L17'></a><a href='#L17'>17</a>
+<a name='L18'></a><a href='#L18'>18</a></td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
+ * Scopes for Solana account type. See {@link KeyringAccount.scopes}.
+ */
+export enum SolScope {
+  Devnet = 'solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1',
+  Mainnet = 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+  Testnet = 'solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z',
+}
+&nbsp;
+/**
+ * Scopes for Bitcoin account type. See {@link KeyringAccount.scopes}.
+ */
+export enum BtcScope {
+  Mainnet = 'bip122:000000000019d6689c085ae165831e93',
+  Testnet = 'bip122:000000000933ea01ad0ee984209779ba',
+  Signet = 'bip122:00000008819873e925422c1ff0f99f7c',
+}
+&nbsp;</pre></td></tr></table></pre>
+
+                <div class='push'></div><!-- for sticky footer -->
+            </div><!-- /wrapper -->
+            <div class='footer quiet pad2 space-top1 center small'>
+                Code coverage generated by
+                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
+                at 2025-09-04T23:19:41.552Z
+            </div>
+        <script src="prettify.js"></script>
+        <script>
+            window.onload = function () {
+                prettyPrint();
+            };
+        </script>
+        <script src="sorter.js"></script>
+        <script src="block-navigation.js"></script>
+    </body>
+</html>
+    
\ No newline at end of file
diff --git a/coverage/utils.ts.html b/coverage/utils.ts.html
new file mode 100644
index 0000000000000000000000000000000000000000..9694f3fd8d8a80bbce8a80dd3aa04e818777b230
--- /dev/null
+++ b/coverage/utils.ts.html
@@ -0,0 +1,394 @@
+
+<!doctype html>
+<html lang="en">
+
+<head>
+    <title>Code coverage report for utils.ts</title>
+    <meta charset="utf-8" />
+    <link rel="stylesheet" href="prettify.css" />
+    <link rel="stylesheet" href="base.css" />
+    <link rel="shortcut icon" type="image/x-icon" href="favicon.png" />
+    <meta name="viewport" content="width=device-width, initial-scale=1" />
+    <style type='text/css'>
+        .coverage-summary .sorter {
+            background-image: url(sort-arrow-sprite.png);
+        }
+    </style>
+</head>
+    
+<body>
+<div class='wrapper'>
+    <div class='pad1'>
+        <h1><a href="index.html">All files</a> utils.ts</h1>
+        <div class='clearfix'>
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Statements</span>
+                <span class='fraction'>26/26</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Branches</span>
+                <span class='fraction'>8/8</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Functions</span>
+                <span class='fraction'>4/4</span>
+            </div>
+        
+            
+            <div class='fl pad1y space-right2'>
+                <span class="strong">100% </span>
+                <span class="quiet">Lines</span>
+                <span class='fraction'>26/26</span>
+            </div>
+        
+            
+        </div>
+        <p class="quiet">
+            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
+        </p>
+        <template id="filterTemplate">
+            <div class="quiet">
+                Filter:
+                <input type="search" id="fileSearch">
+            </div>
+        </template>
+    </div>
+    <div class='status-line high'></div>
+    <pre><table class="coverage">
+<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
+<a name='L2'></a><a href='#L2'>2</a>
+<a name='L3'></a><a href='#L3'>3</a>
+<a name='L4'></a><a href='#L4'>4</a>
+<a name='L5'></a><a href='#L5'>5</a>
+<a name='L6'></a><a href='#L6'>6</a>
+<a name='L7'></a><a href='#L7'>7</a>
+<a name='L8'></a><a href='#L8'>8</a>
+<a name='L9'></a><a href='#L9'>9</a>
+<a name='L10'></a><a href='#L10'>10</a>
+<a name='L11'></a><a href='#L11'>11</a>
+<a name='L12'></a><a href='#L12'>12</a>
+<a name='L13'></a><a href='#L13'>13</a>
+<a name='L14'></a><a href='#L14'>14</a>
+<a name='L15'></a><a href='#L15'>15</a>
+<a name='L16'></a><a href='#L16'>16</a>
+<a name='L17'></a><a href='#L17'>17</a>
+<a name='L18'></a><a href='#L18'>18</a>
+<a name='L19'></a><a href='#L19'>19</a>
+<a name='L20'></a><a href='#L20'>20</a>
+<a name='L21'></a><a href='#L21'>21</a>
+<a name='L22'></a><a href='#L22'>22</a>
+<a name='L23'></a><a href='#L23'>23</a>
+<a name='L24'></a><a href='#L24'>24</a>
+<a name='L25'></a><a href='#L25'>25</a>
+<a name='L26'></a><a href='#L26'>26</a>
+<a name='L27'></a><a href='#L27'>27</a>
+<a name='L28'></a><a href='#L28'>28</a>
+<a name='L29'></a><a href='#L29'>29</a>
+<a name='L30'></a><a href='#L30'>30</a>
+<a name='L31'></a><a href='#L31'>31</a>
+<a name='L32'></a><a href='#L32'>32</a>
+<a name='L33'></a><a href='#L33'>33</a>
+<a name='L34'></a><a href='#L34'>34</a>
+<a name='L35'></a><a href='#L35'>35</a>
+<a name='L36'></a><a href='#L36'>36</a>
+<a name='L37'></a><a href='#L37'>37</a>
+<a name='L38'></a><a href='#L38'>38</a>
+<a name='L39'></a><a href='#L39'>39</a>
+<a name='L40'></a><a href='#L40'>40</a>
+<a name='L41'></a><a href='#L41'>41</a>
+<a name='L42'></a><a href='#L42'>42</a>
+<a name='L43'></a><a href='#L43'>43</a>
+<a name='L44'></a><a href='#L44'>44</a>
+<a name='L45'></a><a href='#L45'>45</a>
+<a name='L46'></a><a href='#L46'>46</a>
+<a name='L47'></a><a href='#L47'>47</a>
+<a name='L48'></a><a href='#L48'>48</a>
+<a name='L49'></a><a href='#L49'>49</a>
+<a name='L50'></a><a href='#L50'>50</a>
+<a name='L51'></a><a href='#L51'>51</a>
+<a name='L52'></a><a href='#L52'>52</a>
+<a name='L53'></a><a href='#L53'>53</a>
+<a name='L54'></a><a href='#L54'>54</a>
+<a name='L55'></a><a href='#L55'>55</a>
+<a name='L56'></a><a href='#L56'>56</a>
+<a name='L57'></a><a href='#L57'>57</a>
+<a name='L58'></a><a href='#L58'>58</a>
+<a name='L59'></a><a href='#L59'>59</a>
+<a name='L60'></a><a href='#L60'>60</a>
+<a name='L61'></a><a href='#L61'>61</a>
+<a name='L62'></a><a href='#L62'>62</a>
+<a name='L63'></a><a href='#L63'>63</a>
+<a name='L64'></a><a href='#L64'>64</a>
+<a name='L65'></a><a href='#L65'>65</a>
+<a name='L66'></a><a href='#L66'>66</a>
+<a name='L67'></a><a href='#L67'>67</a>
+<a name='L68'></a><a href='#L68'>68</a>
+<a name='L69'></a><a href='#L69'>69</a>
+<a name='L70'></a><a href='#L70'>70</a>
+<a name='L71'></a><a href='#L71'>71</a>
+<a name='L72'></a><a href='#L72'>72</a>
+<a name='L73'></a><a href='#L73'>73</a>
+<a name='L74'></a><a href='#L74'>74</a>
+<a name='L75'></a><a href='#L75'>75</a>
+<a name='L76'></a><a href='#L76'>76</a>
+<a name='L77'></a><a href='#L77'>77</a>
+<a name='L78'></a><a href='#L78'>78</a>
+<a name='L79'></a><a href='#L79'>79</a>
+<a name='L80'></a><a href='#L80'>80</a>
+<a name='L81'></a><a href='#L81'>81</a>
+<a name='L82'></a><a href='#L82'>82</a>
+<a name='L83'></a><a href='#L83'>83</a>
+<a name='L84'></a><a href='#L84'>84</a>
+<a name='L85'></a><a href='#L85'>85</a>
+<a name='L86'></a><a href='#L86'>86</a>
+<a name='L87'></a><a href='#L87'>87</a>
+<a name='L88'></a><a href='#L88'>88</a>
+<a name='L89'></a><a href='#L89'>89</a>
+<a name='L90'></a><a href='#L90'>90</a>
+<a name='L91'></a><a href='#L91'>91</a>
+<a name='L92'></a><a href='#L92'>92</a>
+<a name='L93'></a><a href='#L93'>93</a>
+<a name='L94'></a><a href='#L94'>94</a>
+<a name='L95'></a><a href='#L95'>95</a>
+<a name='L96'></a><a href='#L96'>96</a>
+<a name='L97'></a><a href='#L97'>97</a>
+<a name='L98'></a><a href='#L98'>98</a>
+<a name='L99'></a><a href='#L99'>99</a>
+<a name='L100'></a><a href='#L100'>100</a>
+<a name='L101'></a><a href='#L101'>101</a>
+<a name='L102'></a><a href='#L102'>102</a>
+<a name='L103'></a><a href='#L103'>103</a>
+<a name='L104'></a><a href='#L104'>104</a></td><td class="line-coverage quiet"><span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-yes">318x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">313x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">313x</span>
+<span class="cline-any cline-yes">210x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">103x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">313x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">36x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">36x</span>
+<span class="cline-any cline-yes">1x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">35x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">35x</span>
+<span class="cline-any cline-yes">94x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">35x</span>
+<span class="cline-any cline-yes">12x</span>
+<span class="cline-any cline-yes">12x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">23x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">3x</span>
+<span class="cline-any cline-yes">12x</span>
+<span class="cline-any cline-yes">12x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-yes">5x</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span>
+<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import { toHex } from '@metamask/controller-utils';
+import { toEvmCaipChainId } from '@metamask/multichain-network-controller';
+import type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';
+import {
+  isCaipChainId,
+  isHexString,
+  KnownCaipNamespace,
+  parseCaipChainId,
+} from '@metamask/utils';
+&nbsp;
+import { POPULAR_NETWORKS } from './constants';
+import type { NetworkEnablementControllerState } from './NetworkEnablementController';
+&nbsp;
+/**
+ * Represents the parsed keys derived from a chain ID.
+ */
+export type DerivedKeys = {
+  namespace: CaipNamespace;
+  storageKey: Hex | CaipChainId;
+  caipChainId: CaipChainId;
+  reference: string;
+};
+&nbsp;
+/**
+ * Derives the namespace, storage key, and CAIP chain ID from a given chain ID.
+ *
+ * This utility function handles the conversion between different chain ID formats.
+ * For EVM networks, it converts Hex chain IDs to CAIP-2 format and determines
+ * the appropriate storage key. For non-EVM networks, it parses the CAIP-2 chain ID
+ * and uses the full chain ID as the storage key.
+ *
+ * @param chainId - The chain ID to derive keys from (Hex or CAIP-2 format)
+ * @returns An object containing namespace, storageKey, and caipId
+ * @throws Error if the chain ID cannot be parsed
+ */
+export function deriveKeys(chainId: Hex | CaipChainId): DerivedKeys {
+  const caipChainId = isCaipChainId(chainId)
+    ? chainId
+    : toEvmCaipChainId(chainId);
+&nbsp;
+  const { namespace, reference } = parseCaipChainId(caipChainId);
+  let storageKey;
+  if (namespace === (KnownCaipNamespace.Eip155 as string)) {
+    storageKey = isHexString(chainId) ? chainId : toHex(reference);
+  } else {
+    storageKey = caipChainId;
+  }
+  return { namespace, storageKey, caipChainId, reference };
+}
+&nbsp;
+/**
+ * Checks if the specified network is the only enabled network in its namespace.
+ *
+ * This function is used to prevent unnecessary state updates when trying to enable
+ * This method is used to prevent the last network in a namespace from being removed.
+ *
+ * @param state - The current controller state
+ * @param derivedKeys - The parsed keys object containing namespace and storageKey
+ * @returns True if the network is the only enabled network in the namespace, false otherwise
+ */
+export function isOnlyNetworkEnabledInNamespace(
+  state: NetworkEnablementControllerState,
+  derivedKeys: DerivedKeys,
+): boolean {
+  const { namespace, storageKey } = derivedKeys;
+&nbsp;
+  // Early return if namespace doesn't exist
+  if (!state.enabledNetworkMap[namespace]) {
+    return false;
+  }
+&nbsp;
+  const networks = state.enabledNetworkMap[namespace];
+&nbsp;
+  // Get all enabled networks in this namespace
+  const enabledNetworks = Object.entries(networks).filter(
+    ([_, enabled]) =&gt; enabled,
+  );
+&nbsp;
+  // Check if there's exactly one enabled network and it matches our target
+  if (enabledNetworks.length === 1) {
+    const [onlyEnabledKey] = enabledNetworks[0];
+    return onlyEnabledKey === storageKey;
+  }
+&nbsp;
+  // Return false if there are zero or multiple enabled networks
+  return false;
+}
+&nbsp;
+/**
+ * Checks if a network is considered popular based on its reference.
+ *
+ * @param reference - The network reference (typically the chain ID reference part)
+ * @returns True if the network is popular, false otherwise
+ */
+export function isPopularNetwork(reference: string): boolean {
+  try {
+    return POPULAR_NETWORKS.includes(toHex(reference));
+  } catch {
+    // If toHex fails (e.g., for non-decimal references like Bitcoin hashes),
+    // the network is not popular
+    return false;
+  }
+}
+&nbsp;</pre></td></tr></table></pre>
+
+                <div class='push'></div><!-- for sticky footer -->
+            </div><!-- /wrapper -->
+            <div class='footer quiet pad2 space-top1 center small'>
+                Code coverage generated by
+                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
+                at 2025-09-04T23:19:41.552Z
+            </div>
+        <script src="prettify.js"></script>
+        <script>
+            window.onload = function () {
+                prettyPrint();
+            };
+        </script>
+        <script src="sorter.js"></script>
+        <script src="block-navigation.js"></script>
+    </body>
+</html>
+    
\ No newline at end of file
diff --git a/dist/NetworkEnablementController.cjs b/dist/NetworkEnablementController.cjs
index d4a40bea9e4ed3c28e347d96e309efe1ff889e81..43d24c774ad43adc5bb2952c16e8bcc193e998a6 100644
--- a/dist/NetworkEnablementController.cjs
+++ b/dist/NetworkEnablementController.cjs
@@ -12,37 +12,54 @@ const controller_utils_1 = require("@metamask/controller-utils");
 const keyring_api_1 = require("@metamask/keyring-api");
 const utils_1 = require("@metamask/utils");
 const constants_1 = require("./constants.cjs");
+const services_1 = require("./services/index.cjs");
 const utils_2 = require("./utils.cjs");
 const controllerName = 'NetworkEnablementController';
+/**
+ * Builds a native asset identifier in CAIP-19-like format.
+ *
+ * @param caipChainId - The CAIP-2 chain ID (e.g., 'eip155:1', 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp')
+ * @param slip44CoinType - The SLIP-44 coin type number
+ * @returns The native asset identifier string (e.g., 'eip155:1/slip44:60')
+ */
+function buildNativeAssetIdentifier(caipChainId, slip44CoinType) {
+    return `${caipChainId}/slip44:${slip44CoinType}`;
+}
 /**
  * Gets the default state for the NetworkEnablementController.
  *
  * @returns The default state with pre-enabled networks.
  */
-const getDefaultNetworkEnablementControllerState = () => ({
-    enabledNetworkMap: {
-        [utils_1.KnownCaipNamespace.Eip155]: {
-            [controller_utils_1.ChainId[controller_utils_1.BuiltInNetworkName.Mainnet]]: true,
-            [controller_utils_1.ChainId[controller_utils_1.BuiltInNetworkName.LineaMainnet]]: true,
-            [controller_utils_1.ChainId[controller_utils_1.BuiltInNetworkName.BaseMainnet]]: true,
-        },
-        [utils_1.KnownCaipNamespace.Solana]: {
-            [keyring_api_1.SolScope.Mainnet]: true,
-            [keyring_api_1.SolScope.Testnet]: false,
-            [keyring_api_1.SolScope.Devnet]: false,
-        },
-        [utils_1.KnownCaipNamespace.Bip122]: {
-            [keyring_api_1.BtcScope.Mainnet]: true,
-            [keyring_api_1.BtcScope.Testnet]: false,
-            [keyring_api_1.BtcScope.Signet]: false,
-        },
-        [utils_1.KnownCaipNamespace.Tron]: {
-            [keyring_api_1.TrxScope.Mainnet]: true,
-            [keyring_api_1.TrxScope.Nile]: false,
-            [keyring_api_1.TrxScope.Shasta]: false,
+const getDefaultNetworkEnablementControllerState = () => {
+    // Build the enabled EVM networks map from POPULAR_NETWORKS
+    const evmNetworks = constants_1.POPULAR_NETWORKS.reduce((acc, chainId) => {
+        acc[chainId] = true;
+        return acc;
+    }, {});
+    return {
+        enabledNetworkMap: {
+            [utils_1.KnownCaipNamespace.Eip155]: evmNetworks,
+            [utils_1.KnownCaipNamespace.Solana]: {
+                [keyring_api_1.SolScope.Mainnet]: true,
+                [keyring_api_1.SolScope.Testnet]: false,
+                [keyring_api_1.SolScope.Devnet]: false,
+            },
+            [utils_1.KnownCaipNamespace.Bip122]: {
+                [keyring_api_1.BtcScope.Mainnet]: true,
+                [keyring_api_1.BtcScope.Testnet]: false,
+                [keyring_api_1.BtcScope.Signet]: false,
+            },
+            [utils_1.KnownCaipNamespace.Tron]: {
+                [keyring_api_1.TrxScope.Mainnet]: true,
+                [keyring_api_1.TrxScope.Nile]: false,
+                [keyring_api_1.TrxScope.Shasta]: false,
+            },
         },
-    },
-});
+        // nativeAssetIdentifiers is initialized as empty and should be populated
+        // by the client using initNativeAssetIdentifiers() during controller init
+        nativeAssetIdentifiers: {},
+    };
+};
 // Metadata for the controller state
 const metadata = {
     enabledNetworkMap: {
@@ -51,6 +68,12 @@ const metadata = {
         includeInDebugSnapshot: true,
         usedInUi: true,
     },
+    nativeAssetIdentifiers: {
+        includeInStateLogs: true,
+        persist: true,
+        includeInDebugSnapshot: true,
+        usedInUi: true,
+    },
 };
 /**
  * Controller responsible for managing network enablement state across different blockchain networks.
@@ -81,7 +104,8 @@ class NetworkEnablementController extends base_controller_1.BaseController {
         });
         _NetworkEnablementController_instances.add(this);
         messenger.subscribe('NetworkController:networkAdded', ({ chainId }) => {
-            __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_onAddNetwork).call(this, chainId);
+            // eslint-disable-next-line no-void
+            void __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_onAddNetwork).call(this, chainId);
         });
         messenger.subscribe('NetworkController:networkRemoved', ({ chainId }) => {
             __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_removeNetworkEntry).call(this, chainId);
@@ -105,20 +129,20 @@ class NetworkEnablementController extends base_controller_1.BaseController {
      */
     enableNetwork(chainId) {
         const { namespace, storageKey } = (0, utils_2.deriveKeys)(chainId);
-        this.update((s) => {
+        this.update((state) => {
             // disable all networks in all namespaces first
-            Object.keys(s.enabledNetworkMap).forEach((ns) => {
-                Object.keys(s.enabledNetworkMap[ns]).forEach((key) => {
-                    s.enabledNetworkMap[ns][key] = false;
+            Object.keys(state.enabledNetworkMap).forEach((ns) => {
+                Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {
+                    state.enabledNetworkMap[ns][key] = false;
                 });
             });
             // if the namespace bucket does not exist, return
             // new nemespace are added only when a new network is added
-            if (!s.enabledNetworkMap[namespace]) {
+            if (!state.enabledNetworkMap[namespace]) {
                 return;
             }
             // enable the network
-            s.enabledNetworkMap[namespace][storageKey] = true;
+            state.enabledNetworkMap[namespace][storageKey] = true;
         });
     }
     /**
@@ -143,17 +167,17 @@ class NetworkEnablementController extends base_controller_1.BaseController {
         if (derivedNamespace !== namespace) {
             throw new Error(`Chain ID ${chainId} belongs to namespace ${derivedNamespace}, but namespace ${namespace} was specified`);
         }
-        this.update((s) => {
+        this.update((state) => {
             // Ensure the namespace bucket exists
-            __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, namespace);
+            __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, namespace);
             // Disable all networks in the specified namespace first
-            if (s.enabledNetworkMap[namespace]) {
-                Object.keys(s.enabledNetworkMap[namespace]).forEach((key) => {
-                    s.enabledNetworkMap[namespace][key] = false;
+            if (state.enabledNetworkMap[namespace]) {
+                Object.keys(state.enabledNetworkMap[namespace]).forEach((key) => {
+                    state.enabledNetworkMap[namespace][key] = false;
                 });
             }
             // Enable the target network in the specified namespace
-            s.enabledNetworkMap[namespace][storageKey] = true;
+            state.enabledNetworkMap[namespace][storageKey] = true;
         });
     }
     /**
@@ -167,11 +191,11 @@ class NetworkEnablementController extends base_controller_1.BaseController {
      * Popular networks that don't exist in NetworkController or MultichainNetworkController configurations will be skipped silently.
      */
     enableAllPopularNetworks() {
-        this.update((s) => {
+        this.update((state) => {
             // First disable all networks across all namespaces
-            Object.keys(s.enabledNetworkMap).forEach((ns) => {
-                Object.keys(s.enabledNetworkMap[ns]).forEach((key) => {
-                    s.enabledNetworkMap[ns][key] = false;
+            Object.keys(state.enabledNetworkMap).forEach((ns) => {
+                Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {
+                    state.enabledNetworkMap[ns][key] = false;
                 });
             });
             // Get current network configurations to check if networks exist
@@ -183,35 +207,36 @@ class NetworkEnablementController extends base_controller_1.BaseController {
                 // Check if network exists in NetworkController configurations
                 if (networkControllerState.networkConfigurationsByChainId[chainId]) {
                     // Ensure namespace bucket exists
-                    __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, namespace);
+                    __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, namespace);
                     // Enable the network
-                    s.enabledNetworkMap[namespace][storageKey] = true;
+                    state.enabledNetworkMap[namespace][storageKey] = true;
                 }
             });
             // Enable Solana mainnet if it exists in MultichainNetworkController configurations
             const solanaKeys = (0, utils_2.deriveKeys)(keyring_api_1.SolScope.Mainnet);
             if (multichainState.multichainNetworkConfigurationsByChainId[keyring_api_1.SolScope.Mainnet]) {
                 // Ensure namespace bucket exists
-                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, solanaKeys.namespace);
+                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, solanaKeys.namespace);
                 // Enable Solana mainnet
-                s.enabledNetworkMap[solanaKeys.namespace][solanaKeys.storageKey] = true;
+                state.enabledNetworkMap[solanaKeys.namespace][solanaKeys.storageKey] =
+                    true;
             }
             // Enable Bitcoin mainnet if it exists in MultichainNetworkController configurations
             const bitcoinKeys = (0, utils_2.deriveKeys)(keyring_api_1.BtcScope.Mainnet);
             if (multichainState.multichainNetworkConfigurationsByChainId[keyring_api_1.BtcScope.Mainnet]) {
                 // Ensure namespace bucket exists
-                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, bitcoinKeys.namespace);
+                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, bitcoinKeys.namespace);
                 // Enable Bitcoin mainnet
-                s.enabledNetworkMap[bitcoinKeys.namespace][bitcoinKeys.storageKey] =
+                state.enabledNetworkMap[bitcoinKeys.namespace][bitcoinKeys.storageKey] =
                     true;
             }
             // Enable Tron mainnet if it exists in MultichainNetworkController configurations
             const tronKeys = (0, utils_2.deriveKeys)(keyring_api_1.TrxScope.Mainnet);
             if (multichainState.multichainNetworkConfigurationsByChainId[keyring_api_1.TrxScope.Mainnet]) {
                 // Ensure namespace bucket exists
-                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, tronKeys.namespace);
+                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, tronKeys.namespace);
                 // Enable Tron mainnet
-                s.enabledNetworkMap[tronKeys.namespace][tronKeys.storageKey] = true;
+                state.enabledNetworkMap[tronKeys.namespace][tronKeys.storageKey] = true;
             }
         });
     }
@@ -219,39 +244,121 @@ class NetworkEnablementController extends base_controller_1.BaseController {
      * Initializes the network enablement state from network controller configurations.
      *
      * This method reads the current network configurations from both NetworkController
-     * and MultichainNetworkController and syncs the enabled network map accordingly.
+     * and MultichainNetworkController and syncs the enabled network map and nativeAssetIdentifiers accordingly.
      * It ensures proper namespace buckets exist for all configured networks and only
      * adds missing networks with a default value of false, preserving existing user settings.
      *
      * This method should be called after the NetworkController and MultichainNetworkController
      * have been initialized and their configurations are available.
      */
-    init() {
-        this.update((s) => {
-            // Get network configurations from NetworkController (EVM networks)
-            const networkControllerState = this.messenger.call('NetworkController:getState');
-            // Get network configurations from MultichainNetworkController (all networks)
-            const multichainState = this.messenger.call('MultichainNetworkController:getState');
+    async init() {
+        // Get network configurations from NetworkController (EVM networks)
+        const networkControllerState = this.messenger.call('NetworkController:getState');
+        // Get network configurations from MultichainNetworkController (all networks)
+        const multichainState = this.messenger.call('MultichainNetworkController:getState');
+        // Build nativeAssetIdentifiers for EVM networks using chainid.network
+        const evmNativeAssetUpdates = [];
+        for (const [chainId] of Object.entries(networkControllerState.networkConfigurationsByChainId)) {
+            const { caipChainId } = (0, utils_2.deriveKeys)(chainId);
+            // Skip if already in state
+            if (this.state.nativeAssetIdentifiers[caipChainId] !== undefined) {
+                continue;
+            }
+            // Parse hex chainId to number for chainid.network lookup
+            const numericChainId = parseInt(chainId, 16);
+            // EVM networks: use getEvmSlip44 (chainid.network data)
+            const slip44CoinType = await services_1.Slip44Service.getEvmSlip44(numericChainId);
+            evmNativeAssetUpdates.push({
+                caipChainId,
+                identifier: buildNativeAssetIdentifier(caipChainId, slip44CoinType),
+            });
+        }
+        // Update state synchronously
+        this.update((state) => {
             // Initialize namespace buckets for EVM networks from NetworkController
-            Object.keys(networkControllerState.networkConfigurationsByChainId).forEach((chainId) => {
+            Object.entries(networkControllerState.networkConfigurationsByChainId).forEach(([chainId]) => {
+                var _a;
                 const { namespace, storageKey } = (0, utils_2.deriveKeys)(chainId);
-                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, namespace);
+                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, namespace);
                 // Only add network if it doesn't already exist in state (preserves user settings)
-                if (s.enabledNetworkMap[namespace][storageKey] === undefined) {
-                    s.enabledNetworkMap[namespace][storageKey] = false;
-                }
+                (_a = state.enabledNetworkMap[namespace])[storageKey] ?? (_a[storageKey] = false);
             });
+            // Apply nativeAssetIdentifier updates
+            for (const { caipChainId, identifier } of evmNativeAssetUpdates) {
+                state.nativeAssetIdentifiers[caipChainId] = identifier;
+            }
             // Initialize namespace buckets for all networks from MultichainNetworkController
             Object.keys(multichainState.multichainNetworkConfigurationsByChainId).forEach((chainId) => {
+                var _a;
                 const { namespace, storageKey } = (0, utils_2.deriveKeys)(chainId);
-                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, namespace);
+                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, namespace);
                 // Only add network if it doesn't already exist in state (preserves user settings)
-                if (s.enabledNetworkMap[namespace][storageKey] === undefined) {
-                    s.enabledNetworkMap[namespace][storageKey] = false;
-                }
+                (_a = state.enabledNetworkMap[namespace])[storageKey] ?? (_a[storageKey] = false);
             });
         });
     }
+    /**
+     * Initializes the native asset identifiers from network configurations.
+     * This method should be called from the client during controller initialization
+     * to populate the nativeAssetIdentifiers state based on actual network configurations.
+     *
+     * @param networks - Array of network configurations with chainId and nativeCurrency
+     * @example
+     * ```typescript
+     * const evmNetworks = Object.values(networkControllerState.networkConfigurationsByChainId)
+     *   .map(config => ({
+     *     chainId: toEvmCaipChainId(config.chainId),
+     *     nativeCurrency: config.nativeCurrency,
+     *   }));
+     *
+     * const multichainNetworks = Object.values(multichainState.multichainNetworkConfigurationsByChainId)
+     *   .map(config => ({
+     *     chainId: config.chainId,
+     *     nativeCurrency: config.nativeCurrency,
+     *   }));
+     *
+     * await controller.initNativeAssetIdentifiers([...evmNetworks, ...multichainNetworks]);
+     * ```
+     */
+    async initNativeAssetIdentifiers(networks) {
+        // Process networks and collect updates
+        const updates = [];
+        for (const { chainId, nativeCurrency } of networks) {
+            // Check if nativeCurrency is already in CAIP-19 format (e.g., "bip122:.../slip44:0")
+            // Non-EVM networks from MultichainNetworkController use this format
+            if (nativeCurrency.includes('/slip44:')) {
+                updates.push({
+                    chainId,
+                    identifier: nativeCurrency,
+                });
+                continue;
+            }
+            // Extract namespace from CAIP-2 chainId
+            const [namespace, reference] = chainId.split(':');
+            let slip44CoinType;
+            if (namespace === 'eip155') {
+                // EVM networks: use getEvmSlip44 (chainid.network data)
+                const numericChainId = parseInt(reference, 10);
+                slip44CoinType = await services_1.Slip44Service.getEvmSlip44(numericChainId);
+            }
+            else {
+                // Non-EVM networks: use getSlip44BySymbol (@metamask/slip44 package)
+                slip44CoinType = services_1.Slip44Service.getSlip44BySymbol(nativeCurrency);
+            }
+            if (slip44CoinType !== undefined) {
+                updates.push({
+                    chainId,
+                    identifier: buildNativeAssetIdentifier(chainId, slip44CoinType),
+                });
+            }
+        }
+        // Apply all updates synchronously
+        this.update((state) => {
+            for (const { chainId, identifier } of updates) {
+                state.nativeAssetIdentifiers[chainId] = identifier;
+            }
+        });
+    }
     /**
      * Disables a network for the user.
      *
@@ -269,8 +376,8 @@ class NetworkEnablementController extends base_controller_1.BaseController {
     disableNetwork(chainId) {
         const derivedKeys = (0, utils_2.deriveKeys)(chainId);
         const { namespace, storageKey } = derivedKeys;
-        this.update((s) => {
-            s.enabledNetworkMap[namespace][storageKey] = false;
+        this.update((state) => {
+            state.enabledNetworkMap[namespace][storageKey] = false;
         });
     }
     /**
@@ -309,22 +416,40 @@ _NetworkEnablementController_instances = new WeakSet(), _NetworkEnablementContro
     return enabledPopularNetworksCount > 1;
 }, _NetworkEnablementController_removeNetworkEntry = function _NetworkEnablementController_removeNetworkEntry(chainId) {
     const derivedKeys = (0, utils_2.deriveKeys)(chainId);
-    const { namespace, storageKey } = derivedKeys;
-    this.update((s) => {
+    const { namespace, storageKey, caipChainId } = derivedKeys;
+    this.update((state) => {
         // fallback and enable ethereum mainnet
         if ((0, utils_2.isOnlyNetworkEnabledInNamespace)(this.state, derivedKeys)) {
-            s.enabledNetworkMap[namespace][controller_utils_1.ChainId[controller_utils_1.BuiltInNetworkName.Mainnet]] =
-                true;
+            state.enabledNetworkMap[namespace][controller_utils_1.ChainId[controller_utils_1.BuiltInNetworkName.Mainnet]] = true;
         }
-        if (namespace in s.enabledNetworkMap) {
-            delete s.enabledNetworkMap[namespace][storageKey];
+        if (namespace in state.enabledNetworkMap) {
+            delete state.enabledNetworkMap[namespace][storageKey];
         }
+        // Remove from nativeAssetIdentifiers as well
+        delete state.nativeAssetIdentifiers[caipChainId];
     });
-}, _NetworkEnablementController_onAddNetwork = function _NetworkEnablementController_onAddNetwork(chainId) {
-    const { namespace, storageKey, reference } = (0, utils_2.deriveKeys)(chainId);
-    this.update((s) => {
+}, _NetworkEnablementController_onAddNetwork = 
+/**
+ * Handles the addition of a new EVM network to the controller.
+ *
+ * @param chainId - The chain ID to add (Hex format)
+ *
+ * @description
+ * - If in popular networks mode (>2 popular networks enabled) AND adding a popular network:
+ * - Keep current selection (add but don't enable the new network)
+ * - Otherwise:
+ * - Switch to the newly added network (disable all others, enable this one)
+ * - Also updates the nativeAssetIdentifiers with the CAIP-19-like identifier
+ */
+async function _NetworkEnablementController_onAddNetwork(chainId) {
+    const { namespace, storageKey, reference, caipChainId } = (0, utils_2.deriveKeys)(chainId);
+    // Parse reference (decimal string from CAIP-2) to number for chainid.network lookup
+    const numericChainId = parseInt(reference, 10);
+    // EVM networks: use getEvmSlip44 (chainid.network data)
+    const slip44CoinType = await services_1.Slip44Service.getEvmSlip44(numericChainId);
+    this.update((state) => {
         // Ensure the namespace bucket exists
-        __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, namespace);
+        __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, namespace);
         // Check if popular networks mode is active (>2 popular networks enabled)
         const inPopularNetworksMode = __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_isInPopularNetworksMode).call(this);
         // Check if the network being added is a popular network
@@ -333,18 +458,20 @@ _NetworkEnablementController_instances = new WeakSet(), _NetworkEnablementContro
         const shouldKeepCurrentSelection = inPopularNetworksMode && isAddedNetworkPopular;
         if (shouldKeepCurrentSelection) {
             // Add the popular network but don't enable it (keep current selection)
-            s.enabledNetworkMap[namespace][storageKey] = true;
+            state.enabledNetworkMap[namespace][storageKey] = true;
         }
         else {
             // Switch to the newly added network (disable all others, enable this one)
-            Object.keys(s.enabledNetworkMap).forEach((ns) => {
-                Object.keys(s.enabledNetworkMap[ns]).forEach((key) => {
-                    s.enabledNetworkMap[ns][key] = false;
+            Object.keys(state.enabledNetworkMap).forEach((ns) => {
+                Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {
+                    state.enabledNetworkMap[ns][key] = false;
                 });
             });
             // Enable the newly added network
-            s.enabledNetworkMap[namespace][storageKey] = true;
+            state.enabledNetworkMap[namespace][storageKey] = true;
         }
+        // Update nativeAssetIdentifiers with the CAIP-19-like identifier
+        state.nativeAssetIdentifiers[caipChainId] = buildNativeAssetIdentifier(caipChainId, slip44CoinType);
     });
 };
 //# sourceMappingURL=NetworkEnablementController.cjs.map
\ No newline at end of file
diff --git a/dist/NetworkEnablementController.cjs.map b/dist/NetworkEnablementController.cjs.map
index f96a4a7d26979e4880502784158c195a2db0da51..2974e53a32fdcdc9829b2f678fcb9acf2e510cfa 100644
--- a/dist/NetworkEnablementController.cjs.map
+++ b/dist/NetworkEnablementController.cjs.map
@@ -1 +1 @@
-{"version":3,"file":"NetworkEnablementController.cjs","sourceRoot":"","sources":["../src/NetworkEnablementController.ts"],"names":[],"mappings":"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","sourcesContent":["import { BaseController } from '@metamask/base-controller';\nimport type {\n  ControllerGetStateAction,\n  ControllerStateChangeEvent,\n} from '@metamask/base-controller';\nimport { BuiltInNetworkName, ChainId } from '@metamask/controller-utils';\nimport { BtcScope, SolScope, TrxScope } from '@metamask/keyring-api';\nimport type { Messenger } from '@metamask/messenger';\nimport type { MultichainNetworkControllerGetStateAction } from '@metamask/multichain-network-controller';\nimport type {\n  NetworkControllerGetStateAction,\n  NetworkControllerNetworkAddedEvent,\n  NetworkControllerNetworkRemovedEvent,\n  NetworkControllerStateChangeEvent,\n} from '@metamask/network-controller';\nimport type { TransactionControllerTransactionSubmittedEvent } from '@metamask/transaction-controller';\nimport type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';\nimport { KnownCaipNamespace } from '@metamask/utils';\n\nimport { POPULAR_NETWORKS } from './constants';\nimport {\n  deriveKeys,\n  isOnlyNetworkEnabledInNamespace,\n  isPopularNetwork,\n} from './utils';\n\nconst controllerName = 'NetworkEnablementController';\n\n/**\n * Information about an ordered network.\n */\nexport type NetworksInfo = {\n  /**\n   * The network's chain id\n   */\n  networkId: CaipChainId;\n};\n\n/**\n * A map of enabled networks by CAIP namespace and chain ID.\n * For EIP-155 networks, the keys are Hex chain IDs.\n * For other networks, the keys are CAIP chain IDs.\n */\ntype EnabledMap = Record<CaipNamespace, Record<CaipChainId | Hex, boolean>>;\n\n// State shape for NetworkEnablementController\nexport type NetworkEnablementControllerState = {\n  enabledNetworkMap: EnabledMap;\n};\n\nexport type NetworkEnablementControllerGetStateAction =\n  ControllerGetStateAction<\n    typeof controllerName,\n    NetworkEnablementControllerState\n  >;\n\nexport type NetworkEnablementControllerSetEnabledNetworksAction = {\n  type: `${typeof controllerName}:enableNetwork`;\n  handler: NetworkEnablementController['enableNetwork'];\n};\n\nexport type NetworkEnablementControllerDisableNetworkAction = {\n  type: `${typeof controllerName}:disableNetwork`;\n  handler: NetworkEnablementController['disableNetwork'];\n};\n\n/**\n * All actions that {@link NetworkEnablementController} calls internally.\n */\nexport type AllowedActions =\n  | NetworkControllerGetStateAction\n  | MultichainNetworkControllerGetStateAction;\n\nexport type NetworkEnablementControllerActions =\n  | NetworkEnablementControllerGetStateAction\n  | NetworkEnablementControllerSetEnabledNetworksAction\n  | NetworkEnablementControllerDisableNetworkAction;\n\nexport type NetworkEnablementControllerStateChangeEvent =\n  ControllerStateChangeEvent<\n    typeof controllerName,\n    NetworkEnablementControllerState\n  >;\n\nexport type NetworkEnablementControllerEvents =\n  NetworkEnablementControllerStateChangeEvent;\n\n/**\n * All events that {@link NetworkEnablementController} subscribes to internally.\n */\nexport type AllowedEvents =\n  | NetworkControllerNetworkAddedEvent\n  | NetworkControllerNetworkRemovedEvent\n  | NetworkControllerStateChangeEvent\n  | TransactionControllerTransactionSubmittedEvent;\n\nexport type NetworkEnablementControllerMessenger = Messenger<\n  typeof controllerName,\n  NetworkEnablementControllerActions | AllowedActions,\n  NetworkEnablementControllerEvents | AllowedEvents\n>;\n\n/**\n * Gets the default state for the NetworkEnablementController.\n *\n * @returns The default state with pre-enabled networks.\n */\nconst getDefaultNetworkEnablementControllerState =\n  (): NetworkEnablementControllerState => ({\n    enabledNetworkMap: {\n      [KnownCaipNamespace.Eip155]: {\n        [ChainId[BuiltInNetworkName.Mainnet]]: true,\n        [ChainId[BuiltInNetworkName.LineaMainnet]]: true,\n        [ChainId[BuiltInNetworkName.BaseMainnet]]: true,\n      },\n      [KnownCaipNamespace.Solana]: {\n        [SolScope.Mainnet]: true,\n        [SolScope.Testnet]: false,\n        [SolScope.Devnet]: false,\n      },\n      [KnownCaipNamespace.Bip122]: {\n        [BtcScope.Mainnet]: true,\n        [BtcScope.Testnet]: false,\n        [BtcScope.Signet]: false,\n      },\n      [KnownCaipNamespace.Tron]: {\n        [TrxScope.Mainnet]: true,\n        [TrxScope.Nile]: false,\n        [TrxScope.Shasta]: false,\n      },\n    },\n  });\n\n// Metadata for the controller state\nconst metadata = {\n  enabledNetworkMap: {\n    includeInStateLogs: true,\n    persist: true,\n    includeInDebugSnapshot: true,\n    usedInUi: true,\n  },\n};\n\n/**\n * Controller responsible for managing network enablement state across different blockchain networks.\n *\n * This controller tracks which networks are enabled/disabled for the user and provides methods\n * to toggle network states. It supports both EVM (EIP-155) and non-EVM networks like Solana.\n *\n * The controller maintains a map of enabled networks organized by namespace (e.g., 'eip155', 'solana')\n * and provides methods to query and modify network enablement states.\n */\nexport class NetworkEnablementController extends BaseController<\n  typeof controllerName,\n  NetworkEnablementControllerState,\n  NetworkEnablementControllerMessenger\n> {\n  /**\n   * Creates a NetworkEnablementController instance.\n   *\n   * @param args - The arguments to this function.\n   * @param args.messenger - Messenger used to communicate with BaseV2 controller.\n   * @param args.state - Initial state to set on this controller.\n   */\n  constructor({\n    messenger,\n    state,\n  }: {\n    messenger: NetworkEnablementControllerMessenger;\n    state?: Partial<NetworkEnablementControllerState>;\n  }) {\n    super({\n      messenger,\n      metadata,\n      name: controllerName,\n      state: {\n        ...getDefaultNetworkEnablementControllerState(),\n        ...state,\n      },\n    });\n\n    messenger.subscribe('NetworkController:networkAdded', ({ chainId }) => {\n      this.#onAddNetwork(chainId);\n    });\n\n    messenger.subscribe('NetworkController:networkRemoved', ({ chainId }) => {\n      this.#removeNetworkEntry(chainId);\n    });\n  }\n\n  /**\n   * Enables or disables a network for the user.\n   *\n   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n   * (for any blockchain network). The method will automatically convert Hex chain IDs\n   * to CAIP-2 format internally. This dual parameter support allows for backward\n   * compatibility with existing EVM chain ID formats while supporting newer\n   * multi-chain standards.\n   *\n   * When enabling a non-popular network, this method will disable all other networks\n   * to ensure only one network is active at a time (exclusive mode).\n   *\n   * @param chainId - The chain ID of the network to enable or disable. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   */\n  enableNetwork(chainId: Hex | CaipChainId): void {\n    const { namespace, storageKey } = deriveKeys(chainId);\n\n    this.update((s) => {\n      // disable all networks in all namespaces first\n      Object.keys(s.enabledNetworkMap).forEach((ns) => {\n        Object.keys(s.enabledNetworkMap[ns]).forEach((key) => {\n          s.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;\n        });\n      });\n\n      // if the namespace bucket does not exist, return\n      // new nemespace are added only when a new network is added\n      if (!s.enabledNetworkMap[namespace]) {\n        return;\n      }\n\n      // enable the network\n      s.enabledNetworkMap[namespace][storageKey] = true;\n    });\n  }\n\n  /**\n   * Enables a network for the user within a specific namespace.\n   *\n   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n   * (for any blockchain network) and enables it within the specified namespace.\n   * The method validates that the chainId belongs to the specified namespace for safety.\n   *\n   * Before enabling the target network, this method disables all other networks\n   * in the same namespace to ensure exclusive behavior within the namespace.\n   *\n   * @param chainId - The chain ID of the network to enable. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   * @param namespace - The CAIP namespace where the network should be enabled\n   * @throws Error if the chainId's derived namespace doesn't match the provided namespace\n   */\n  enableNetworkInNamespace(\n    chainId: Hex | CaipChainId,\n    namespace: CaipNamespace,\n  ): void {\n    const { namespace: derivedNamespace, storageKey } = deriveKeys(chainId);\n\n    // Validate that the derived namespace matches the provided namespace\n    if (derivedNamespace !== namespace) {\n      throw new Error(\n        `Chain ID ${chainId} belongs to namespace ${derivedNamespace}, but namespace ${namespace} was specified`,\n      );\n    }\n\n    this.update((s) => {\n      // Ensure the namespace bucket exists\n      this.#ensureNamespaceBucket(s, namespace);\n\n      // Disable all networks in the specified namespace first\n      if (s.enabledNetworkMap[namespace]) {\n        Object.keys(s.enabledNetworkMap[namespace]).forEach((key) => {\n          s.enabledNetworkMap[namespace][key as CaipChainId | Hex] = false;\n        });\n      }\n\n      // Enable the target network in the specified namespace\n      s.enabledNetworkMap[namespace][storageKey] = true;\n    });\n  }\n\n  /**\n   * Enables all popular networks and Solana mainnet.\n   *\n   * This method first disables all networks across all namespaces, then enables\n   * all networks defined in POPULAR_NETWORKS (EVM networks), Solana mainnet, and\n   * Bitcoin mainnet. This provides exclusive behavior - only popular networks will\n   * be enabled after calling this method.\n   *\n   * Popular networks that don't exist in NetworkController or MultichainNetworkController configurations will be skipped silently.\n   */\n  enableAllPopularNetworks(): void {\n    this.update((s) => {\n      // First disable all networks across all namespaces\n      Object.keys(s.enabledNetworkMap).forEach((ns) => {\n        Object.keys(s.enabledNetworkMap[ns]).forEach((key) => {\n          s.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;\n        });\n      });\n\n      // Get current network configurations to check if networks exist\n      const networkControllerState = this.messenger.call(\n        'NetworkController:getState',\n      );\n      const multichainState = this.messenger.call(\n        'MultichainNetworkController:getState',\n      );\n\n      // Enable all popular EVM networks that exist in NetworkController configurations\n      POPULAR_NETWORKS.forEach((chainId) => {\n        const { namespace, storageKey } = deriveKeys(chainId as Hex);\n\n        // Check if network exists in NetworkController configurations\n        if (\n          networkControllerState.networkConfigurationsByChainId[chainId as Hex]\n        ) {\n          // Ensure namespace bucket exists\n          this.#ensureNamespaceBucket(s, namespace);\n          // Enable the network\n          s.enabledNetworkMap[namespace][storageKey] = true;\n        }\n      });\n\n      // Enable Solana mainnet if it exists in MultichainNetworkController configurations\n      const solanaKeys = deriveKeys(SolScope.Mainnet as CaipChainId);\n      if (\n        multichainState.multichainNetworkConfigurationsByChainId[\n          SolScope.Mainnet\n        ]\n      ) {\n        // Ensure namespace bucket exists\n        this.#ensureNamespaceBucket(s, solanaKeys.namespace);\n        // Enable Solana mainnet\n        s.enabledNetworkMap[solanaKeys.namespace][solanaKeys.storageKey] = true;\n      }\n\n      // Enable Bitcoin mainnet if it exists in MultichainNetworkController configurations\n      const bitcoinKeys = deriveKeys(BtcScope.Mainnet as CaipChainId);\n      if (\n        multichainState.multichainNetworkConfigurationsByChainId[\n          BtcScope.Mainnet\n        ]\n      ) {\n        // Ensure namespace bucket exists\n        this.#ensureNamespaceBucket(s, bitcoinKeys.namespace);\n        // Enable Bitcoin mainnet\n        s.enabledNetworkMap[bitcoinKeys.namespace][bitcoinKeys.storageKey] =\n          true;\n      }\n\n      // Enable Tron mainnet if it exists in MultichainNetworkController configurations\n      const tronKeys = deriveKeys(TrxScope.Mainnet as CaipChainId);\n      if (\n        multichainState.multichainNetworkConfigurationsByChainId[\n          TrxScope.Mainnet\n        ]\n      ) {\n        // Ensure namespace bucket exists\n        this.#ensureNamespaceBucket(s, tronKeys.namespace);\n        // Enable Tron mainnet\n        s.enabledNetworkMap[tronKeys.namespace][tronKeys.storageKey] = true;\n      }\n    });\n  }\n\n  /**\n   * Initializes the network enablement state from network controller configurations.\n   *\n   * This method reads the current network configurations from both NetworkController\n   * and MultichainNetworkController and syncs the enabled network map accordingly.\n   * It ensures proper namespace buckets exist for all configured networks and only\n   * adds missing networks with a default value of false, preserving existing user settings.\n   *\n   * This method should be called after the NetworkController and MultichainNetworkController\n   * have been initialized and their configurations are available.\n   */\n  init(): void {\n    this.update((s) => {\n      // Get network configurations from NetworkController (EVM networks)\n      const networkControllerState = this.messenger.call(\n        'NetworkController:getState',\n      );\n\n      // Get network configurations from MultichainNetworkController (all networks)\n      const multichainState = this.messenger.call(\n        'MultichainNetworkController:getState',\n      );\n\n      // Initialize namespace buckets for EVM networks from NetworkController\n      Object.keys(\n        networkControllerState.networkConfigurationsByChainId,\n      ).forEach((chainId) => {\n        const { namespace, storageKey } = deriveKeys(chainId as Hex);\n        this.#ensureNamespaceBucket(s, namespace);\n\n        // Only add network if it doesn't already exist in state (preserves user settings)\n        if (s.enabledNetworkMap[namespace][storageKey] === undefined) {\n          s.enabledNetworkMap[namespace][storageKey] = false;\n        }\n      });\n\n      // Initialize namespace buckets for all networks from MultichainNetworkController\n      Object.keys(\n        multichainState.multichainNetworkConfigurationsByChainId,\n      ).forEach((chainId) => {\n        const { namespace, storageKey } = deriveKeys(chainId as CaipChainId);\n        this.#ensureNamespaceBucket(s, namespace);\n\n        // Only add network if it doesn't already exist in state (preserves user settings)\n        if (s.enabledNetworkMap[namespace][storageKey] === undefined) {\n          s.enabledNetworkMap[namespace][storageKey] = false;\n        }\n      });\n    });\n  }\n\n  /**\n   * Disables a network for the user.\n   *\n   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n   * (for any blockchain network). The method will automatically convert Hex chain IDs\n   * to CAIP-2 format internally.\n   *\n   * Note: This method will prevent disabling the last remaining enabled network\n   * to ensure at least one network is always available.\n   *\n   * @param chainId - The chain ID of the network to disable. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   */\n  disableNetwork(chainId: Hex | CaipChainId): void {\n    const derivedKeys = deriveKeys(chainId);\n    const { namespace, storageKey } = derivedKeys;\n\n    this.update((s) => {\n      s.enabledNetworkMap[namespace][storageKey] = false;\n    });\n  }\n\n  /**\n   * Checks if a network is enabled.\n   *\n   * @param chainId - The chain ID of the network to check. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   * @returns True if the network is enabled, false otherwise\n   */\n  isNetworkEnabled(chainId: Hex | CaipChainId): boolean {\n    const derivedKeys = deriveKeys(chainId);\n    const { namespace, storageKey } = derivedKeys;\n    return this.state.enabledNetworkMap[namespace]?.[storageKey] ?? false;\n  }\n\n  /**\n   * Ensures that a namespace bucket exists in the state.\n   *\n   * This method creates the namespace entry in the enabledNetworkMap if it doesn't\n   * already exist. This is used to prepare the state structure before adding\n   * network entries.\n   *\n   * @param state - The current controller state\n   * @param ns - The CAIP namespace to ensure exists\n   */\n  #ensureNamespaceBucket(\n    state: NetworkEnablementControllerState,\n    ns: CaipNamespace,\n  ) {\n    if (!state.enabledNetworkMap[ns]) {\n      state.enabledNetworkMap[ns] = {};\n    }\n  }\n\n  /**\n   * Checks if popular networks mode is active (more than 2 popular networks enabled).\n   *\n   * This method counts how many networks defined in POPULAR_NETWORKS are currently\n   * enabled in the state and returns true if more than 2 are enabled. It only checks\n   * networks that actually exist in the NetworkController configurations.\n   *\n   * @returns True if more than 2 popular networks are enabled, false otherwise\n   */\n  #isInPopularNetworksMode(): boolean {\n    // Get current network configurations to check which popular networks exist\n    const networkControllerState = this.messenger.call(\n      'NetworkController:getState',\n    );\n\n    // Count how many popular networks are enabled\n    const enabledPopularNetworksCount = POPULAR_NETWORKS.reduce(\n      (count, chainId) => {\n        // Only check networks that actually exist in NetworkController configurations\n        if (\n          !networkControllerState.networkConfigurationsByChainId[chainId as Hex]\n        ) {\n          return count; // Skip networks that don't exist\n        }\n\n        const { namespace, storageKey } = deriveKeys(chainId as Hex);\n        const isEnabled = this.state.enabledNetworkMap[namespace]?.[storageKey];\n        return isEnabled ? count + 1 : count;\n      },\n      0,\n    );\n\n    // Return true if more than 2 popular networks are enabled\n    return enabledPopularNetworksCount > 1;\n  }\n\n  /**\n   * Removes a network entry from the state.\n   *\n   * This method is called when a network is removed from the system. It cleans up\n   * the network entry and ensures that at least one network remains enabled.\n   *\n   * @param chainId - The chain ID to remove (Hex or CAIP-2 format)\n   */\n  #removeNetworkEntry(chainId: Hex | CaipChainId): void {\n    const derivedKeys = deriveKeys(chainId);\n    const { namespace, storageKey } = derivedKeys;\n\n    this.update((s) => {\n      // fallback and enable ethereum mainnet\n      if (isOnlyNetworkEnabledInNamespace(this.state, derivedKeys)) {\n        s.enabledNetworkMap[namespace][ChainId[BuiltInNetworkName.Mainnet]] =\n          true;\n      }\n\n      if (namespace in s.enabledNetworkMap) {\n        delete s.enabledNetworkMap[namespace][storageKey];\n      }\n    });\n  }\n\n  /**\n   * Handles the addition of a new network to the controller.\n   *\n   * @param chainId - The chain ID to add (Hex or CAIP-2 format)\n   *\n   * @description\n   * - If in popular networks mode (>2 popular networks enabled) AND adding a popular network:\n   * - Keep current selection (add but don't enable the new network)\n   * - Otherwise:\n   * - Switch to the newly added network (disable all others, enable this one)\n   */\n  #onAddNetwork(chainId: Hex | CaipChainId): void {\n    const { namespace, storageKey, reference } = deriveKeys(chainId);\n\n    this.update((s) => {\n      // Ensure the namespace bucket exists\n      this.#ensureNamespaceBucket(s, namespace);\n\n      // Check if popular networks mode is active (>2 popular networks enabled)\n      const inPopularNetworksMode = this.#isInPopularNetworksMode();\n\n      // Check if the network being added is a popular network\n      const isAddedNetworkPopular = isPopularNetwork(reference);\n\n      // Keep current selection only if in popular networks mode AND adding a popular network\n      const shouldKeepCurrentSelection =\n        inPopularNetworksMode && isAddedNetworkPopular;\n\n      if (shouldKeepCurrentSelection) {\n        // Add the popular network but don't enable it (keep current selection)\n        s.enabledNetworkMap[namespace][storageKey] = true;\n      } else {\n        // Switch to the newly added network (disable all others, enable this one)\n        Object.keys(s.enabledNetworkMap).forEach((ns) => {\n          Object.keys(s.enabledNetworkMap[ns]).forEach((key) => {\n            s.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;\n          });\n        });\n        // Enable the newly added network\n        s.enabledNetworkMap[namespace][storageKey] = true;\n      }\n    });\n  }\n}\n"]}
\ No newline at end of file
+{"version":3,"file":"NetworkEnablementController.cjs","sourceRoot":"","sources":["../src/NetworkEnablementController.ts"],"names":[],"mappings":"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","sourcesContent":["import { BaseController } from '@metamask/base-controller';\nimport type {\n  ControllerGetStateAction,\n  ControllerStateChangeEvent,\n} from '@metamask/base-controller';\nimport { BuiltInNetworkName, ChainId } from '@metamask/controller-utils';\nimport { BtcScope, SolScope, TrxScope } from '@metamask/keyring-api';\nimport type { Messenger } from '@metamask/messenger';\nimport type { MultichainNetworkControllerGetStateAction } from '@metamask/multichain-network-controller';\nimport type {\n  NetworkControllerGetStateAction,\n  NetworkControllerNetworkAddedEvent,\n  NetworkControllerNetworkRemovedEvent,\n  NetworkControllerStateChangeEvent,\n} from '@metamask/network-controller';\nimport type { TransactionControllerTransactionSubmittedEvent } from '@metamask/transaction-controller';\nimport type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';\nimport { KnownCaipNamespace } from '@metamask/utils';\n\nimport { POPULAR_NETWORKS } from './constants';\nimport { Slip44Service } from './services';\nimport {\n  deriveKeys,\n  isOnlyNetworkEnabledInNamespace,\n  isPopularNetwork,\n} from './utils';\n\nconst controllerName = 'NetworkEnablementController';\n\n/**\n * Information about an ordered network.\n */\nexport type NetworksInfo = {\n  /**\n   * The network's chain id\n   */\n  networkId: CaipChainId;\n};\n\n/**\n * A map of enabled networks by CAIP namespace and chain ID.\n * For EIP-155 networks, the keys are Hex chain IDs.\n * For other networks, the keys are CAIP chain IDs.\n */\ntype EnabledMap = Record<CaipNamespace, Record<CaipChainId | Hex, boolean>>;\n\n/**\n * A native asset identifier in CAIP-19-like format.\n * Format: `{caip2ChainId}/slip44:{coinType}`\n *\n * @example\n * - `eip155:1/slip44:60` for Ethereum mainnet (ETH)\n * - `solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp/slip44:501` for Solana mainnet (SOL)\n * - `bip122:000000000019d6689c085ae165831e93/slip44:0` for Bitcoin mainnet (BTC)\n */\nexport type NativeAssetIdentifier = `${CaipChainId}/slip44:${number}`;\n\n/**\n * A map of CAIP-2 chain IDs to their native asset identifiers.\n * Uses CAIP-19-like format to identify the native asset for each chain.\n *\n * @see https://github.com/satoshilabs/slips/blob/master/slip-0044.md\n */\nexport type NativeAssetIdentifiersMap = Record<\n  CaipChainId,\n  NativeAssetIdentifier\n>;\n\n// State shape for NetworkEnablementController\nexport type NetworkEnablementControllerState = {\n  enabledNetworkMap: EnabledMap;\n  nativeAssetIdentifiers: NativeAssetIdentifiersMap;\n};\n\nexport type NetworkEnablementControllerGetStateAction =\n  ControllerGetStateAction<\n    typeof controllerName,\n    NetworkEnablementControllerState\n  >;\n\nexport type NetworkEnablementControllerSetEnabledNetworksAction = {\n  type: `${typeof controllerName}:enableNetwork`;\n  handler: NetworkEnablementController['enableNetwork'];\n};\n\nexport type NetworkEnablementControllerDisableNetworkAction = {\n  type: `${typeof controllerName}:disableNetwork`;\n  handler: NetworkEnablementController['disableNetwork'];\n};\n\n/**\n * All actions that {@link NetworkEnablementController} calls internally.\n */\nexport type AllowedActions =\n  | NetworkControllerGetStateAction\n  | MultichainNetworkControllerGetStateAction;\n\nexport type NetworkEnablementControllerActions =\n  | NetworkEnablementControllerGetStateAction\n  | NetworkEnablementControllerSetEnabledNetworksAction\n  | NetworkEnablementControllerDisableNetworkAction;\n\nexport type NetworkEnablementControllerStateChangeEvent =\n  ControllerStateChangeEvent<\n    typeof controllerName,\n    NetworkEnablementControllerState\n  >;\n\nexport type NetworkEnablementControllerEvents =\n  NetworkEnablementControllerStateChangeEvent;\n\n/**\n * All events that {@link NetworkEnablementController} subscribes to internally.\n */\nexport type AllowedEvents =\n  | NetworkControllerNetworkAddedEvent\n  | NetworkControllerNetworkRemovedEvent\n  | NetworkControllerStateChangeEvent\n  | TransactionControllerTransactionSubmittedEvent;\n\nexport type NetworkEnablementControllerMessenger = Messenger<\n  typeof controllerName,\n  NetworkEnablementControllerActions | AllowedActions,\n  NetworkEnablementControllerEvents | AllowedEvents\n>;\n\n/**\n * Builds a native asset identifier in CAIP-19-like format.\n *\n * @param caipChainId - The CAIP-2 chain ID (e.g., 'eip155:1', 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp')\n * @param slip44CoinType - The SLIP-44 coin type number\n * @returns The native asset identifier string (e.g., 'eip155:1/slip44:60')\n */\nfunction buildNativeAssetIdentifier(\n  caipChainId: CaipChainId,\n  slip44CoinType: number,\n): NativeAssetIdentifier {\n  return `${caipChainId}/slip44:${slip44CoinType}`;\n}\n\n/**\n * Network configuration with chain ID and native currency symbol.\n * Used to initialize native asset identifiers.\n */\nexport type NetworkConfig = {\n  chainId: CaipChainId;\n  nativeCurrency: string;\n};\n\n/**\n * Gets the default state for the NetworkEnablementController.\n *\n * @returns The default state with pre-enabled networks.\n */\nconst getDefaultNetworkEnablementControllerState =\n  (): NetworkEnablementControllerState => {\n    // Build the enabled EVM networks map from POPULAR_NETWORKS\n    const evmNetworks = POPULAR_NETWORKS.reduce<Record<Hex, boolean>>(\n      (acc, chainId) => {\n        acc[chainId as Hex] = true;\n        return acc;\n      },\n      {},\n    );\n\n    return {\n      enabledNetworkMap: {\n        [KnownCaipNamespace.Eip155]: evmNetworks,\n        [KnownCaipNamespace.Solana]: {\n          [SolScope.Mainnet]: true,\n          [SolScope.Testnet]: false,\n          [SolScope.Devnet]: false,\n        },\n        [KnownCaipNamespace.Bip122]: {\n          [BtcScope.Mainnet]: true,\n          [BtcScope.Testnet]: false,\n          [BtcScope.Signet]: false,\n        },\n        [KnownCaipNamespace.Tron]: {\n          [TrxScope.Mainnet]: true,\n          [TrxScope.Nile]: false,\n          [TrxScope.Shasta]: false,\n        },\n      },\n      // nativeAssetIdentifiers is initialized as empty and should be populated\n      // by the client using initNativeAssetIdentifiers() during controller init\n      nativeAssetIdentifiers: {},\n    };\n  };\n\n// Metadata for the controller state\nconst metadata = {\n  enabledNetworkMap: {\n    includeInStateLogs: true,\n    persist: true,\n    includeInDebugSnapshot: true,\n    usedInUi: true,\n  },\n  nativeAssetIdentifiers: {\n    includeInStateLogs: true,\n    persist: true,\n    includeInDebugSnapshot: true,\n    usedInUi: true,\n  },\n};\n\n/**\n * Controller responsible for managing network enablement state across different blockchain networks.\n *\n * This controller tracks which networks are enabled/disabled for the user and provides methods\n * to toggle network states. It supports both EVM (EIP-155) and non-EVM networks like Solana.\n *\n * The controller maintains a map of enabled networks organized by namespace (e.g., 'eip155', 'solana')\n * and provides methods to query and modify network enablement states.\n */\nexport class NetworkEnablementController extends BaseController<\n  typeof controllerName,\n  NetworkEnablementControllerState,\n  NetworkEnablementControllerMessenger\n> {\n  /**\n   * Creates a NetworkEnablementController instance.\n   *\n   * @param args - The arguments to this function.\n   * @param args.messenger - Messenger used to communicate with BaseV2 controller.\n   * @param args.state - Initial state to set on this controller.\n   */\n  constructor({\n    messenger,\n    state,\n  }: {\n    messenger: NetworkEnablementControllerMessenger;\n    state?: Partial<NetworkEnablementControllerState>;\n  }) {\n    super({\n      messenger,\n      metadata,\n      name: controllerName,\n      state: {\n        ...getDefaultNetworkEnablementControllerState(),\n        ...state,\n      },\n    });\n\n    messenger.subscribe('NetworkController:networkAdded', ({ chainId }) => {\n      // eslint-disable-next-line no-void\n      void this.#onAddNetwork(chainId);\n    });\n\n    messenger.subscribe('NetworkController:networkRemoved', ({ chainId }) => {\n      this.#removeNetworkEntry(chainId);\n    });\n  }\n\n  /**\n   * Enables or disables a network for the user.\n   *\n   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n   * (for any blockchain network). The method will automatically convert Hex chain IDs\n   * to CAIP-2 format internally. This dual parameter support allows for backward\n   * compatibility with existing EVM chain ID formats while supporting newer\n   * multi-chain standards.\n   *\n   * When enabling a non-popular network, this method will disable all other networks\n   * to ensure only one network is active at a time (exclusive mode).\n   *\n   * @param chainId - The chain ID of the network to enable or disable. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   */\n  enableNetwork(chainId: Hex | CaipChainId): void {\n    const { namespace, storageKey } = deriveKeys(chainId);\n\n    this.update((state) => {\n      // disable all networks in all namespaces first\n      Object.keys(state.enabledNetworkMap).forEach((ns) => {\n        Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {\n          state.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;\n        });\n      });\n\n      // if the namespace bucket does not exist, return\n      // new nemespace are added only when a new network is added\n      if (!state.enabledNetworkMap[namespace]) {\n        return;\n      }\n\n      // enable the network\n      state.enabledNetworkMap[namespace][storageKey] = true;\n    });\n  }\n\n  /**\n   * Enables a network for the user within a specific namespace.\n   *\n   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n   * (for any blockchain network) and enables it within the specified namespace.\n   * The method validates that the chainId belongs to the specified namespace for safety.\n   *\n   * Before enabling the target network, this method disables all other networks\n   * in the same namespace to ensure exclusive behavior within the namespace.\n   *\n   * @param chainId - The chain ID of the network to enable. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   * @param namespace - The CAIP namespace where the network should be enabled\n   * @throws Error if the chainId's derived namespace doesn't match the provided namespace\n   */\n  enableNetworkInNamespace(\n    chainId: Hex | CaipChainId,\n    namespace: CaipNamespace,\n  ): void {\n    const { namespace: derivedNamespace, storageKey } = deriveKeys(chainId);\n\n    // Validate that the derived namespace matches the provided namespace\n    if (derivedNamespace !== namespace) {\n      throw new Error(\n        `Chain ID ${chainId} belongs to namespace ${derivedNamespace}, but namespace ${namespace} was specified`,\n      );\n    }\n\n    this.update((state) => {\n      // Ensure the namespace bucket exists\n      this.#ensureNamespaceBucket(state, namespace);\n\n      // Disable all networks in the specified namespace first\n      if (state.enabledNetworkMap[namespace]) {\n        Object.keys(state.enabledNetworkMap[namespace]).forEach((key) => {\n          state.enabledNetworkMap[namespace][key as CaipChainId | Hex] = false;\n        });\n      }\n\n      // Enable the target network in the specified namespace\n      state.enabledNetworkMap[namespace][storageKey] = true;\n    });\n  }\n\n  /**\n   * Enables all popular networks and Solana mainnet.\n   *\n   * This method first disables all networks across all namespaces, then enables\n   * all networks defined in POPULAR_NETWORKS (EVM networks), Solana mainnet, and\n   * Bitcoin mainnet. This provides exclusive behavior - only popular networks will\n   * be enabled after calling this method.\n   *\n   * Popular networks that don't exist in NetworkController or MultichainNetworkController configurations will be skipped silently.\n   */\n  enableAllPopularNetworks(): void {\n    this.update((state) => {\n      // First disable all networks across all namespaces\n      Object.keys(state.enabledNetworkMap).forEach((ns) => {\n        Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {\n          state.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;\n        });\n      });\n\n      // Get current network configurations to check if networks exist\n      const networkControllerState = this.messenger.call(\n        'NetworkController:getState',\n      );\n      const multichainState = this.messenger.call(\n        'MultichainNetworkController:getState',\n      );\n\n      // Enable all popular EVM networks that exist in NetworkController configurations\n      POPULAR_NETWORKS.forEach((chainId) => {\n        const { namespace, storageKey } = deriveKeys(chainId as Hex);\n\n        // Check if network exists in NetworkController configurations\n        if (\n          networkControllerState.networkConfigurationsByChainId[chainId as Hex]\n        ) {\n          // Ensure namespace bucket exists\n          this.#ensureNamespaceBucket(state, namespace);\n          // Enable the network\n          state.enabledNetworkMap[namespace][storageKey] = true;\n        }\n      });\n\n      // Enable Solana mainnet if it exists in MultichainNetworkController configurations\n      const solanaKeys = deriveKeys(SolScope.Mainnet as CaipChainId);\n      if (\n        multichainState.multichainNetworkConfigurationsByChainId[\n          SolScope.Mainnet\n        ]\n      ) {\n        // Ensure namespace bucket exists\n        this.#ensureNamespaceBucket(state, solanaKeys.namespace);\n        // Enable Solana mainnet\n        state.enabledNetworkMap[solanaKeys.namespace][solanaKeys.storageKey] =\n          true;\n      }\n\n      // Enable Bitcoin mainnet if it exists in MultichainNetworkController configurations\n      const bitcoinKeys = deriveKeys(BtcScope.Mainnet as CaipChainId);\n      if (\n        multichainState.multichainNetworkConfigurationsByChainId[\n          BtcScope.Mainnet\n        ]\n      ) {\n        // Ensure namespace bucket exists\n        this.#ensureNamespaceBucket(state, bitcoinKeys.namespace);\n        // Enable Bitcoin mainnet\n        state.enabledNetworkMap[bitcoinKeys.namespace][bitcoinKeys.storageKey] =\n          true;\n      }\n\n      // Enable Tron mainnet if it exists in MultichainNetworkController configurations\n      const tronKeys = deriveKeys(TrxScope.Mainnet as CaipChainId);\n      if (\n        multichainState.multichainNetworkConfigurationsByChainId[\n          TrxScope.Mainnet\n        ]\n      ) {\n        // Ensure namespace bucket exists\n        this.#ensureNamespaceBucket(state, tronKeys.namespace);\n        // Enable Tron mainnet\n        state.enabledNetworkMap[tronKeys.namespace][tronKeys.storageKey] = true;\n      }\n    });\n  }\n\n  /**\n   * Initializes the network enablement state from network controller configurations.\n   *\n   * This method reads the current network configurations from both NetworkController\n   * and MultichainNetworkController and syncs the enabled network map and nativeAssetIdentifiers accordingly.\n   * It ensures proper namespace buckets exist for all configured networks and only\n   * adds missing networks with a default value of false, preserving existing user settings.\n   *\n   * This method should be called after the NetworkController and MultichainNetworkController\n   * have been initialized and their configurations are available.\n   */\n  async init(): Promise<void> {\n    // Get network configurations from NetworkController (EVM networks)\n    const networkControllerState = this.messenger.call(\n      'NetworkController:getState',\n    );\n\n    // Get network configurations from MultichainNetworkController (all networks)\n    const multichainState = this.messenger.call(\n      'MultichainNetworkController:getState',\n    );\n\n    // Build nativeAssetIdentifiers for EVM networks using chainid.network\n    const evmNativeAssetUpdates: {\n      caipChainId: CaipChainId;\n      identifier: NativeAssetIdentifier;\n    }[] = [];\n\n    for (const [chainId] of Object.entries(\n      networkControllerState.networkConfigurationsByChainId,\n    )) {\n      const { caipChainId } = deriveKeys(chainId as Hex);\n\n      // Skip if already in state\n      if (this.state.nativeAssetIdentifiers[caipChainId] !== undefined) {\n        continue;\n      }\n\n      // Parse hex chainId to number for chainid.network lookup\n      const numericChainId = parseInt(chainId, 16);\n\n      // EVM networks: use getEvmSlip44 (chainid.network data)\n      const slip44CoinType = await Slip44Service.getEvmSlip44(numericChainId);\n\n      evmNativeAssetUpdates.push({\n        caipChainId,\n        identifier: buildNativeAssetIdentifier(caipChainId, slip44CoinType),\n      });\n    }\n\n    // Update state synchronously\n    this.update((state) => {\n      // Initialize namespace buckets for EVM networks from NetworkController\n      Object.entries(\n        networkControllerState.networkConfigurationsByChainId,\n      ).forEach(([chainId]) => {\n        const { namespace, storageKey } = deriveKeys(chainId as Hex);\n        this.#ensureNamespaceBucket(state, namespace);\n\n        // Only add network if it doesn't already exist in state (preserves user settings)\n        state.enabledNetworkMap[namespace][storageKey] ??= false;\n      });\n\n      // Apply nativeAssetIdentifier updates\n      for (const { caipChainId, identifier } of evmNativeAssetUpdates) {\n        state.nativeAssetIdentifiers[caipChainId] = identifier;\n      }\n\n      // Initialize namespace buckets for all networks from MultichainNetworkController\n      Object.keys(\n        multichainState.multichainNetworkConfigurationsByChainId,\n      ).forEach((chainId) => {\n        const { namespace, storageKey } = deriveKeys(chainId as CaipChainId);\n        this.#ensureNamespaceBucket(state, namespace);\n\n        // Only add network if it doesn't already exist in state (preserves user settings)\n        state.enabledNetworkMap[namespace][storageKey] ??= false;\n      });\n    });\n  }\n\n  /**\n   * Initializes the native asset identifiers from network configurations.\n   * This method should be called from the client during controller initialization\n   * to populate the nativeAssetIdentifiers state based on actual network configurations.\n   *\n   * @param networks - Array of network configurations with chainId and nativeCurrency\n   * @example\n   * ```typescript\n   * const evmNetworks = Object.values(networkControllerState.networkConfigurationsByChainId)\n   *   .map(config => ({\n   *     chainId: toEvmCaipChainId(config.chainId),\n   *     nativeCurrency: config.nativeCurrency,\n   *   }));\n   *\n   * const multichainNetworks = Object.values(multichainState.multichainNetworkConfigurationsByChainId)\n   *   .map(config => ({\n   *     chainId: config.chainId,\n   *     nativeCurrency: config.nativeCurrency,\n   *   }));\n   *\n   * await controller.initNativeAssetIdentifiers([...evmNetworks, ...multichainNetworks]);\n   * ```\n   */\n  async initNativeAssetIdentifiers(networks: NetworkConfig[]): Promise<void> {\n    // Process networks and collect updates\n    const updates: {\n      chainId: CaipChainId;\n      identifier: NativeAssetIdentifier;\n    }[] = [];\n\n    for (const { chainId, nativeCurrency } of networks) {\n      // Check if nativeCurrency is already in CAIP-19 format (e.g., \"bip122:.../slip44:0\")\n      // Non-EVM networks from MultichainNetworkController use this format\n      if (nativeCurrency.includes('/slip44:')) {\n        updates.push({\n          chainId,\n          identifier: nativeCurrency as NativeAssetIdentifier,\n        });\n        continue;\n      }\n\n      // Extract namespace from CAIP-2 chainId\n      const [namespace, reference] = chainId.split(':');\n      let slip44CoinType: number | undefined;\n\n      if (namespace === 'eip155') {\n        // EVM networks: use getEvmSlip44 (chainid.network data)\n        const numericChainId = parseInt(reference, 10);\n        slip44CoinType = await Slip44Service.getEvmSlip44(numericChainId);\n      } else {\n        // Non-EVM networks: use getSlip44BySymbol (@metamask/slip44 package)\n        slip44CoinType = Slip44Service.getSlip44BySymbol(nativeCurrency);\n      }\n\n      if (slip44CoinType !== undefined) {\n        updates.push({\n          chainId,\n          identifier: buildNativeAssetIdentifier(chainId, slip44CoinType),\n        });\n      }\n    }\n\n    // Apply all updates synchronously\n    this.update((state) => {\n      for (const { chainId, identifier } of updates) {\n        state.nativeAssetIdentifiers[chainId] = identifier;\n      }\n    });\n  }\n\n  /**\n   * Disables a network for the user.\n   *\n   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n   * (for any blockchain network). The method will automatically convert Hex chain IDs\n   * to CAIP-2 format internally.\n   *\n   * Note: This method will prevent disabling the last remaining enabled network\n   * to ensure at least one network is always available.\n   *\n   * @param chainId - The chain ID of the network to disable. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   */\n  disableNetwork(chainId: Hex | CaipChainId): void {\n    const derivedKeys = deriveKeys(chainId);\n    const { namespace, storageKey } = derivedKeys;\n\n    this.update((state) => {\n      state.enabledNetworkMap[namespace][storageKey] = false;\n    });\n  }\n\n  /**\n   * Checks if a network is enabled.\n   *\n   * @param chainId - The chain ID of the network to check. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   * @returns True if the network is enabled, false otherwise\n   */\n  isNetworkEnabled(chainId: Hex | CaipChainId): boolean {\n    const derivedKeys = deriveKeys(chainId);\n    const { namespace, storageKey } = derivedKeys;\n    return this.state.enabledNetworkMap[namespace]?.[storageKey] ?? false;\n  }\n\n  /**\n   * Ensures that a namespace bucket exists in the state.\n   *\n   * This method creates the namespace entry in the enabledNetworkMap if it doesn't\n   * already exist. This is used to prepare the state structure before adding\n   * network entries.\n   *\n   * @param state - The current controller state\n   * @param ns - The CAIP namespace to ensure exists\n   */\n  #ensureNamespaceBucket(\n    state: NetworkEnablementControllerState,\n    ns: CaipNamespace,\n  ): void {\n    if (!state.enabledNetworkMap[ns]) {\n      state.enabledNetworkMap[ns] = {};\n    }\n  }\n\n  /**\n   * Checks if popular networks mode is active (more than 2 popular networks enabled).\n   *\n   * This method counts how many networks defined in POPULAR_NETWORKS are currently\n   * enabled in the state and returns true if more than 2 are enabled. It only checks\n   * networks that actually exist in the NetworkController configurations.\n   *\n   * @returns True if more than 2 popular networks are enabled, false otherwise\n   */\n  #isInPopularNetworksMode(): boolean {\n    // Get current network configurations to check which popular networks exist\n    const networkControllerState = this.messenger.call(\n      'NetworkController:getState',\n    );\n\n    // Count how many popular networks are enabled\n    const enabledPopularNetworksCount = POPULAR_NETWORKS.reduce(\n      (count, chainId) => {\n        // Only check networks that actually exist in NetworkController configurations\n        if (\n          !networkControllerState.networkConfigurationsByChainId[chainId as Hex]\n        ) {\n          return count; // Skip networks that don't exist\n        }\n\n        const { namespace, storageKey } = deriveKeys(chainId as Hex);\n        const isEnabled = this.state.enabledNetworkMap[namespace]?.[storageKey];\n        return isEnabled ? count + 1 : count;\n      },\n      0,\n    );\n\n    // Return true if more than 2 popular networks are enabled\n    return enabledPopularNetworksCount > 1;\n  }\n\n  /**\n   * Removes a network entry from the state.\n   *\n   * This method is called when a network is removed from the system. It cleans up\n   * the network entry from both enabledNetworkMap and nativeAssetIdentifiers, and ensures that\n   * at least one network remains enabled.\n   *\n   * @param chainId - The chain ID to remove (Hex or CAIP-2 format)\n   */\n  #removeNetworkEntry(chainId: Hex | CaipChainId): void {\n    const derivedKeys = deriveKeys(chainId);\n    const { namespace, storageKey, caipChainId } = derivedKeys;\n\n    this.update((state) => {\n      // fallback and enable ethereum mainnet\n      if (isOnlyNetworkEnabledInNamespace(this.state, derivedKeys)) {\n        state.enabledNetworkMap[namespace][\n          ChainId[BuiltInNetworkName.Mainnet]\n        ] = true;\n      }\n\n      if (namespace in state.enabledNetworkMap) {\n        delete state.enabledNetworkMap[namespace][storageKey];\n      }\n\n      // Remove from nativeAssetIdentifiers as well\n      delete state.nativeAssetIdentifiers[caipChainId];\n    });\n  }\n\n  /**\n   * Handles the addition of a new EVM network to the controller.\n   *\n   * @param chainId - The chain ID to add (Hex format)\n   *\n   * @description\n   * - If in popular networks mode (>2 popular networks enabled) AND adding a popular network:\n   * - Keep current selection (add but don't enable the new network)\n   * - Otherwise:\n   * - Switch to the newly added network (disable all others, enable this one)\n   * - Also updates the nativeAssetIdentifiers with the CAIP-19-like identifier\n   */\n  async #onAddNetwork(chainId: Hex): Promise<void> {\n    const { namespace, storageKey, reference, caipChainId } =\n      deriveKeys(chainId);\n\n    // Parse reference (decimal string from CAIP-2) to number for chainid.network lookup\n    const numericChainId = parseInt(reference, 10);\n\n    // EVM networks: use getEvmSlip44 (chainid.network data)\n    const slip44CoinType = await Slip44Service.getEvmSlip44(numericChainId);\n\n    this.update((state) => {\n      // Ensure the namespace bucket exists\n      this.#ensureNamespaceBucket(state, namespace);\n\n      // Check if popular networks mode is active (>2 popular networks enabled)\n      const inPopularNetworksMode = this.#isInPopularNetworksMode();\n\n      // Check if the network being added is a popular network\n      const isAddedNetworkPopular = isPopularNetwork(reference);\n\n      // Keep current selection only if in popular networks mode AND adding a popular network\n      const shouldKeepCurrentSelection =\n        inPopularNetworksMode && isAddedNetworkPopular;\n\n      if (shouldKeepCurrentSelection) {\n        // Add the popular network but don't enable it (keep current selection)\n        state.enabledNetworkMap[namespace][storageKey] = true;\n      } else {\n        // Switch to the newly added network (disable all others, enable this one)\n        Object.keys(state.enabledNetworkMap).forEach((ns) => {\n          Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {\n            state.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;\n          });\n        });\n        // Enable the newly added network\n        state.enabledNetworkMap[namespace][storageKey] = true;\n      }\n\n      // Update nativeAssetIdentifiers with the CAIP-19-like identifier\n      state.nativeAssetIdentifiers[caipChainId] = buildNativeAssetIdentifier(\n        caipChainId,\n        slip44CoinType,\n      );\n    });\n  }\n}\n"]}
\ No newline at end of file
diff --git a/dist/NetworkEnablementController.d.cts b/dist/NetworkEnablementController.d.cts
index 14cf8b01427a25ee9d4e5eceee0ca40afc8d39e4..b5aa62130820d2dcb8c46254fe2069afa7f294b2 100644
--- a/dist/NetworkEnablementController.d.cts
+++ b/dist/NetworkEnablementController.d.cts
@@ -21,8 +21,26 @@ export type NetworksInfo = {
  * For other networks, the keys are CAIP chain IDs.
  */
 type EnabledMap = Record<CaipNamespace, Record<CaipChainId | Hex, boolean>>;
+/**
+ * A native asset identifier in CAIP-19-like format.
+ * Format: `{caip2ChainId}/slip44:{coinType}`
+ *
+ * @example
+ * - `eip155:1/slip44:60` for Ethereum mainnet (ETH)
+ * - `solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp/slip44:501` for Solana mainnet (SOL)
+ * - `bip122:000000000019d6689c085ae165831e93/slip44:0` for Bitcoin mainnet (BTC)
+ */
+export type NativeAssetIdentifier = `${CaipChainId}/slip44:${number}`;
+/**
+ * A map of CAIP-2 chain IDs to their native asset identifiers.
+ * Uses CAIP-19-like format to identify the native asset for each chain.
+ *
+ * @see https://github.com/satoshilabs/slips/blob/master/slip-0044.md
+ */
+export type NativeAssetIdentifiersMap = Record<CaipChainId, NativeAssetIdentifier>;
 export type NetworkEnablementControllerState = {
     enabledNetworkMap: EnabledMap;
+    nativeAssetIdentifiers: NativeAssetIdentifiersMap;
 };
 export type NetworkEnablementControllerGetStateAction = ControllerGetStateAction<typeof controllerName, NetworkEnablementControllerState>;
 export type NetworkEnablementControllerSetEnabledNetworksAction = {
@@ -45,6 +63,14 @@ export type NetworkEnablementControllerEvents = NetworkEnablementControllerState
  */
 export type AllowedEvents = NetworkControllerNetworkAddedEvent | NetworkControllerNetworkRemovedEvent | NetworkControllerStateChangeEvent | TransactionControllerTransactionSubmittedEvent;
 export type NetworkEnablementControllerMessenger = Messenger<typeof controllerName, NetworkEnablementControllerActions | AllowedActions, NetworkEnablementControllerEvents | AllowedEvents>;
+/**
+ * Network configuration with chain ID and native currency symbol.
+ * Used to initialize native asset identifiers.
+ */
+export type NetworkConfig = {
+    chainId: CaipChainId;
+    nativeCurrency: string;
+};
 /**
  * Controller responsible for managing network enablement state across different blockchain networks.
  *
@@ -116,14 +142,38 @@ export declare class NetworkEnablementController extends BaseController<typeof c
      * Initializes the network enablement state from network controller configurations.
      *
      * This method reads the current network configurations from both NetworkController
-     * and MultichainNetworkController and syncs the enabled network map accordingly.
+     * and MultichainNetworkController and syncs the enabled network map and nativeAssetIdentifiers accordingly.
      * It ensures proper namespace buckets exist for all configured networks and only
      * adds missing networks with a default value of false, preserving existing user settings.
      *
      * This method should be called after the NetworkController and MultichainNetworkController
      * have been initialized and their configurations are available.
      */
-    init(): void;
+    init(): Promise<void>;
+    /**
+     * Initializes the native asset identifiers from network configurations.
+     * This method should be called from the client during controller initialization
+     * to populate the nativeAssetIdentifiers state based on actual network configurations.
+     *
+     * @param networks - Array of network configurations with chainId and nativeCurrency
+     * @example
+     * ```typescript
+     * const evmNetworks = Object.values(networkControllerState.networkConfigurationsByChainId)
+     *   .map(config => ({
+     *     chainId: toEvmCaipChainId(config.chainId),
+     *     nativeCurrency: config.nativeCurrency,
+     *   }));
+     *
+     * const multichainNetworks = Object.values(multichainState.multichainNetworkConfigurationsByChainId)
+     *   .map(config => ({
+     *     chainId: config.chainId,
+     *     nativeCurrency: config.nativeCurrency,
+     *   }));
+     *
+     * await controller.initNativeAssetIdentifiers([...evmNetworks, ...multichainNetworks]);
+     * ```
+     */
+    initNativeAssetIdentifiers(networks: NetworkConfig[]): Promise<void>;
     /**
      * Disables a network for the user.
      *
diff --git a/dist/NetworkEnablementController.d.cts.map b/dist/NetworkEnablementController.d.cts.map
index ae83d06ac6c69df41d666043f54f3e4b88bf13ad..420ef774f0d6b30c873b139396b8a6e2ba23d6f7 100644
--- a/dist/NetworkEnablementController.d.cts.map
+++ b/dist/NetworkEnablementController.d.cts.map
@@ -1 +1 @@
-{"version":3,"file":"NetworkEnablementController.d.cts","sourceRoot":"","sources":["../src/NetworkEnablementController.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"NetworkEnablementController.d.cts","sourceRoot":"","sources":["../src/NetworkEnablementController.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/dist/NetworkEnablementController.d.mts b/dist/NetworkEnablementController.d.mts
index 3a0fc334a983b94b43ac130297780a15b50917e1..602ebdf928b15bb6279bb4a179e963d819df6b24 100644
--- a/dist/NetworkEnablementController.d.mts
+++ b/dist/NetworkEnablementController.d.mts
@@ -21,8 +21,26 @@ export type NetworksInfo = {
  * For other networks, the keys are CAIP chain IDs.
  */
 type EnabledMap = Record<CaipNamespace, Record<CaipChainId | Hex, boolean>>;
+/**
+ * A native asset identifier in CAIP-19-like format.
+ * Format: `{caip2ChainId}/slip44:{coinType}`
+ *
+ * @example
+ * - `eip155:1/slip44:60` for Ethereum mainnet (ETH)
+ * - `solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp/slip44:501` for Solana mainnet (SOL)
+ * - `bip122:000000000019d6689c085ae165831e93/slip44:0` for Bitcoin mainnet (BTC)
+ */
+export type NativeAssetIdentifier = `${CaipChainId}/slip44:${number}`;
+/**
+ * A map of CAIP-2 chain IDs to their native asset identifiers.
+ * Uses CAIP-19-like format to identify the native asset for each chain.
+ *
+ * @see https://github.com/satoshilabs/slips/blob/master/slip-0044.md
+ */
+export type NativeAssetIdentifiersMap = Record<CaipChainId, NativeAssetIdentifier>;
 export type NetworkEnablementControllerState = {
     enabledNetworkMap: EnabledMap;
+    nativeAssetIdentifiers: NativeAssetIdentifiersMap;
 };
 export type NetworkEnablementControllerGetStateAction = ControllerGetStateAction<typeof controllerName, NetworkEnablementControllerState>;
 export type NetworkEnablementControllerSetEnabledNetworksAction = {
@@ -45,6 +63,14 @@ export type NetworkEnablementControllerEvents = NetworkEnablementControllerState
  */
 export type AllowedEvents = NetworkControllerNetworkAddedEvent | NetworkControllerNetworkRemovedEvent | NetworkControllerStateChangeEvent | TransactionControllerTransactionSubmittedEvent;
 export type NetworkEnablementControllerMessenger = Messenger<typeof controllerName, NetworkEnablementControllerActions | AllowedActions, NetworkEnablementControllerEvents | AllowedEvents>;
+/**
+ * Network configuration with chain ID and native currency symbol.
+ * Used to initialize native asset identifiers.
+ */
+export type NetworkConfig = {
+    chainId: CaipChainId;
+    nativeCurrency: string;
+};
 /**
  * Controller responsible for managing network enablement state across different blockchain networks.
  *
@@ -116,14 +142,38 @@ export declare class NetworkEnablementController extends BaseController<typeof c
      * Initializes the network enablement state from network controller configurations.
      *
      * This method reads the current network configurations from both NetworkController
-     * and MultichainNetworkController and syncs the enabled network map accordingly.
+     * and MultichainNetworkController and syncs the enabled network map and nativeAssetIdentifiers accordingly.
      * It ensures proper namespace buckets exist for all configured networks and only
      * adds missing networks with a default value of false, preserving existing user settings.
      *
      * This method should be called after the NetworkController and MultichainNetworkController
      * have been initialized and their configurations are available.
      */
-    init(): void;
+    init(): Promise<void>;
+    /**
+     * Initializes the native asset identifiers from network configurations.
+     * This method should be called from the client during controller initialization
+     * to populate the nativeAssetIdentifiers state based on actual network configurations.
+     *
+     * @param networks - Array of network configurations with chainId and nativeCurrency
+     * @example
+     * ```typescript
+     * const evmNetworks = Object.values(networkControllerState.networkConfigurationsByChainId)
+     *   .map(config => ({
+     *     chainId: toEvmCaipChainId(config.chainId),
+     *     nativeCurrency: config.nativeCurrency,
+     *   }));
+     *
+     * const multichainNetworks = Object.values(multichainState.multichainNetworkConfigurationsByChainId)
+     *   .map(config => ({
+     *     chainId: config.chainId,
+     *     nativeCurrency: config.nativeCurrency,
+     *   }));
+     *
+     * await controller.initNativeAssetIdentifiers([...evmNetworks, ...multichainNetworks]);
+     * ```
+     */
+    initNativeAssetIdentifiers(networks: NetworkConfig[]): Promise<void>;
     /**
      * Disables a network for the user.
      *
diff --git a/dist/NetworkEnablementController.d.mts.map b/dist/NetworkEnablementController.d.mts.map
index 351117414527d9a22319f7817bc6395ee09a3aca..a37810da79c83a3be249880844e0954dc68db448 100644
--- a/dist/NetworkEnablementController.d.mts.map
+++ b/dist/NetworkEnablementController.d.mts.map
@@ -1 +1 @@
-{"version":3,"file":"NetworkEnablementController.d.mts","sourceRoot":"","sources":["../src/NetworkEnablementController.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"NetworkEnablementController.d.mts","sourceRoot":"","sources":["../src/NetworkEnablementController.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/dist/NetworkEnablementController.mjs b/dist/NetworkEnablementController.mjs
index f0354af26e0aa599a2d580b3e49c6a85eb768a58..0eedd2962e143df1f4c59da32f5b7f6b1419efbd 100644
--- a/dist/NetworkEnablementController.mjs
+++ b/dist/NetworkEnablementController.mjs
@@ -9,37 +9,54 @@ import { BuiltInNetworkName, ChainId } from "@metamask/controller-utils";
 import { BtcScope, SolScope, TrxScope } from "@metamask/keyring-api";
 import { KnownCaipNamespace } from "@metamask/utils";
 import { POPULAR_NETWORKS } from "./constants.mjs";
+import { Slip44Service } from "./services/index.mjs";
 import { deriveKeys, isOnlyNetworkEnabledInNamespace, isPopularNetwork } from "./utils.mjs";
 const controllerName = 'NetworkEnablementController';
+/**
+ * Builds a native asset identifier in CAIP-19-like format.
+ *
+ * @param caipChainId - The CAIP-2 chain ID (e.g., 'eip155:1', 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp')
+ * @param slip44CoinType - The SLIP-44 coin type number
+ * @returns The native asset identifier string (e.g., 'eip155:1/slip44:60')
+ */
+function buildNativeAssetIdentifier(caipChainId, slip44CoinType) {
+    return `${caipChainId}/slip44:${slip44CoinType}`;
+}
 /**
  * Gets the default state for the NetworkEnablementController.
  *
  * @returns The default state with pre-enabled networks.
  */
-const getDefaultNetworkEnablementControllerState = () => ({
-    enabledNetworkMap: {
-        [KnownCaipNamespace.Eip155]: {
-            [ChainId[BuiltInNetworkName.Mainnet]]: true,
-            [ChainId[BuiltInNetworkName.LineaMainnet]]: true,
-            [ChainId[BuiltInNetworkName.BaseMainnet]]: true,
-        },
-        [KnownCaipNamespace.Solana]: {
-            [SolScope.Mainnet]: true,
-            [SolScope.Testnet]: false,
-            [SolScope.Devnet]: false,
-        },
-        [KnownCaipNamespace.Bip122]: {
-            [BtcScope.Mainnet]: true,
-            [BtcScope.Testnet]: false,
-            [BtcScope.Signet]: false,
-        },
-        [KnownCaipNamespace.Tron]: {
-            [TrxScope.Mainnet]: true,
-            [TrxScope.Nile]: false,
-            [TrxScope.Shasta]: false,
+const getDefaultNetworkEnablementControllerState = () => {
+    // Build the enabled EVM networks map from POPULAR_NETWORKS
+    const evmNetworks = POPULAR_NETWORKS.reduce((acc, chainId) => {
+        acc[chainId] = true;
+        return acc;
+    }, {});
+    return {
+        enabledNetworkMap: {
+            [KnownCaipNamespace.Eip155]: evmNetworks,
+            [KnownCaipNamespace.Solana]: {
+                [SolScope.Mainnet]: true,
+                [SolScope.Testnet]: false,
+                [SolScope.Devnet]: false,
+            },
+            [KnownCaipNamespace.Bip122]: {
+                [BtcScope.Mainnet]: true,
+                [BtcScope.Testnet]: false,
+                [BtcScope.Signet]: false,
+            },
+            [KnownCaipNamespace.Tron]: {
+                [TrxScope.Mainnet]: true,
+                [TrxScope.Nile]: false,
+                [TrxScope.Shasta]: false,
+            },
         },
-    },
-});
+        // nativeAssetIdentifiers is initialized as empty and should be populated
+        // by the client using initNativeAssetIdentifiers() during controller init
+        nativeAssetIdentifiers: {},
+    };
+};
 // Metadata for the controller state
 const metadata = {
     enabledNetworkMap: {
@@ -48,6 +65,12 @@ const metadata = {
         includeInDebugSnapshot: true,
         usedInUi: true,
     },
+    nativeAssetIdentifiers: {
+        includeInStateLogs: true,
+        persist: true,
+        includeInDebugSnapshot: true,
+        usedInUi: true,
+    },
 };
 /**
  * Controller responsible for managing network enablement state across different blockchain networks.
@@ -78,7 +101,8 @@ export class NetworkEnablementController extends BaseController {
         });
         _NetworkEnablementController_instances.add(this);
         messenger.subscribe('NetworkController:networkAdded', ({ chainId }) => {
-            __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_onAddNetwork).call(this, chainId);
+            // eslint-disable-next-line no-void
+            void __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_onAddNetwork).call(this, chainId);
         });
         messenger.subscribe('NetworkController:networkRemoved', ({ chainId }) => {
             __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_removeNetworkEntry).call(this, chainId);
@@ -102,20 +126,20 @@ export class NetworkEnablementController extends BaseController {
      */
     enableNetwork(chainId) {
         const { namespace, storageKey } = deriveKeys(chainId);
-        this.update((s) => {
+        this.update((state) => {
             // disable all networks in all namespaces first
-            Object.keys(s.enabledNetworkMap).forEach((ns) => {
-                Object.keys(s.enabledNetworkMap[ns]).forEach((key) => {
-                    s.enabledNetworkMap[ns][key] = false;
+            Object.keys(state.enabledNetworkMap).forEach((ns) => {
+                Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {
+                    state.enabledNetworkMap[ns][key] = false;
                 });
             });
             // if the namespace bucket does not exist, return
             // new nemespace are added only when a new network is added
-            if (!s.enabledNetworkMap[namespace]) {
+            if (!state.enabledNetworkMap[namespace]) {
                 return;
             }
             // enable the network
-            s.enabledNetworkMap[namespace][storageKey] = true;
+            state.enabledNetworkMap[namespace][storageKey] = true;
         });
     }
     /**
@@ -140,17 +164,17 @@ export class NetworkEnablementController extends BaseController {
         if (derivedNamespace !== namespace) {
             throw new Error(`Chain ID ${chainId} belongs to namespace ${derivedNamespace}, but namespace ${namespace} was specified`);
         }
-        this.update((s) => {
+        this.update((state) => {
             // Ensure the namespace bucket exists
-            __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, namespace);
+            __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, namespace);
             // Disable all networks in the specified namespace first
-            if (s.enabledNetworkMap[namespace]) {
-                Object.keys(s.enabledNetworkMap[namespace]).forEach((key) => {
-                    s.enabledNetworkMap[namespace][key] = false;
+            if (state.enabledNetworkMap[namespace]) {
+                Object.keys(state.enabledNetworkMap[namespace]).forEach((key) => {
+                    state.enabledNetworkMap[namespace][key] = false;
                 });
             }
             // Enable the target network in the specified namespace
-            s.enabledNetworkMap[namespace][storageKey] = true;
+            state.enabledNetworkMap[namespace][storageKey] = true;
         });
     }
     /**
@@ -164,11 +188,11 @@ export class NetworkEnablementController extends BaseController {
      * Popular networks that don't exist in NetworkController or MultichainNetworkController configurations will be skipped silently.
      */
     enableAllPopularNetworks() {
-        this.update((s) => {
+        this.update((state) => {
             // First disable all networks across all namespaces
-            Object.keys(s.enabledNetworkMap).forEach((ns) => {
-                Object.keys(s.enabledNetworkMap[ns]).forEach((key) => {
-                    s.enabledNetworkMap[ns][key] = false;
+            Object.keys(state.enabledNetworkMap).forEach((ns) => {
+                Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {
+                    state.enabledNetworkMap[ns][key] = false;
                 });
             });
             // Get current network configurations to check if networks exist
@@ -180,35 +204,36 @@ export class NetworkEnablementController extends BaseController {
                 // Check if network exists in NetworkController configurations
                 if (networkControllerState.networkConfigurationsByChainId[chainId]) {
                     // Ensure namespace bucket exists
-                    __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, namespace);
+                    __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, namespace);
                     // Enable the network
-                    s.enabledNetworkMap[namespace][storageKey] = true;
+                    state.enabledNetworkMap[namespace][storageKey] = true;
                 }
             });
             // Enable Solana mainnet if it exists in MultichainNetworkController configurations
             const solanaKeys = deriveKeys(SolScope.Mainnet);
             if (multichainState.multichainNetworkConfigurationsByChainId[SolScope.Mainnet]) {
                 // Ensure namespace bucket exists
-                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, solanaKeys.namespace);
+                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, solanaKeys.namespace);
                 // Enable Solana mainnet
-                s.enabledNetworkMap[solanaKeys.namespace][solanaKeys.storageKey] = true;
+                state.enabledNetworkMap[solanaKeys.namespace][solanaKeys.storageKey] =
+                    true;
             }
             // Enable Bitcoin mainnet if it exists in MultichainNetworkController configurations
             const bitcoinKeys = deriveKeys(BtcScope.Mainnet);
             if (multichainState.multichainNetworkConfigurationsByChainId[BtcScope.Mainnet]) {
                 // Ensure namespace bucket exists
-                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, bitcoinKeys.namespace);
+                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, bitcoinKeys.namespace);
                 // Enable Bitcoin mainnet
-                s.enabledNetworkMap[bitcoinKeys.namespace][bitcoinKeys.storageKey] =
+                state.enabledNetworkMap[bitcoinKeys.namespace][bitcoinKeys.storageKey] =
                     true;
             }
             // Enable Tron mainnet if it exists in MultichainNetworkController configurations
             const tronKeys = deriveKeys(TrxScope.Mainnet);
             if (multichainState.multichainNetworkConfigurationsByChainId[TrxScope.Mainnet]) {
                 // Ensure namespace bucket exists
-                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, tronKeys.namespace);
+                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, tronKeys.namespace);
                 // Enable Tron mainnet
-                s.enabledNetworkMap[tronKeys.namespace][tronKeys.storageKey] = true;
+                state.enabledNetworkMap[tronKeys.namespace][tronKeys.storageKey] = true;
             }
         });
     }
@@ -216,39 +241,121 @@ export class NetworkEnablementController extends BaseController {
      * Initializes the network enablement state from network controller configurations.
      *
      * This method reads the current network configurations from both NetworkController
-     * and MultichainNetworkController and syncs the enabled network map accordingly.
+     * and MultichainNetworkController and syncs the enabled network map and nativeAssetIdentifiers accordingly.
      * It ensures proper namespace buckets exist for all configured networks and only
      * adds missing networks with a default value of false, preserving existing user settings.
      *
      * This method should be called after the NetworkController and MultichainNetworkController
      * have been initialized and their configurations are available.
      */
-    init() {
-        this.update((s) => {
-            // Get network configurations from NetworkController (EVM networks)
-            const networkControllerState = this.messenger.call('NetworkController:getState');
-            // Get network configurations from MultichainNetworkController (all networks)
-            const multichainState = this.messenger.call('MultichainNetworkController:getState');
+    async init() {
+        // Get network configurations from NetworkController (EVM networks)
+        const networkControllerState = this.messenger.call('NetworkController:getState');
+        // Get network configurations from MultichainNetworkController (all networks)
+        const multichainState = this.messenger.call('MultichainNetworkController:getState');
+        // Build nativeAssetIdentifiers for EVM networks using chainid.network
+        const evmNativeAssetUpdates = [];
+        for (const [chainId] of Object.entries(networkControllerState.networkConfigurationsByChainId)) {
+            const { caipChainId } = deriveKeys(chainId);
+            // Skip if already in state
+            if (this.state.nativeAssetIdentifiers[caipChainId] !== undefined) {
+                continue;
+            }
+            // Parse hex chainId to number for chainid.network lookup
+            const numericChainId = parseInt(chainId, 16);
+            // EVM networks: use getEvmSlip44 (chainid.network data)
+            const slip44CoinType = await Slip44Service.getEvmSlip44(numericChainId);
+            evmNativeAssetUpdates.push({
+                caipChainId,
+                identifier: buildNativeAssetIdentifier(caipChainId, slip44CoinType),
+            });
+        }
+        // Update state synchronously
+        this.update((state) => {
             // Initialize namespace buckets for EVM networks from NetworkController
-            Object.keys(networkControllerState.networkConfigurationsByChainId).forEach((chainId) => {
+            Object.entries(networkControllerState.networkConfigurationsByChainId).forEach(([chainId]) => {
+                var _a;
                 const { namespace, storageKey } = deriveKeys(chainId);
-                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, namespace);
+                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, namespace);
                 // Only add network if it doesn't already exist in state (preserves user settings)
-                if (s.enabledNetworkMap[namespace][storageKey] === undefined) {
-                    s.enabledNetworkMap[namespace][storageKey] = false;
-                }
+                (_a = state.enabledNetworkMap[namespace])[storageKey] ?? (_a[storageKey] = false);
             });
+            // Apply nativeAssetIdentifier updates
+            for (const { caipChainId, identifier } of evmNativeAssetUpdates) {
+                state.nativeAssetIdentifiers[caipChainId] = identifier;
+            }
             // Initialize namespace buckets for all networks from MultichainNetworkController
             Object.keys(multichainState.multichainNetworkConfigurationsByChainId).forEach((chainId) => {
+                var _a;
                 const { namespace, storageKey } = deriveKeys(chainId);
-                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, namespace);
+                __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, namespace);
                 // Only add network if it doesn't already exist in state (preserves user settings)
-                if (s.enabledNetworkMap[namespace][storageKey] === undefined) {
-                    s.enabledNetworkMap[namespace][storageKey] = false;
-                }
+                (_a = state.enabledNetworkMap[namespace])[storageKey] ?? (_a[storageKey] = false);
             });
         });
     }
+    /**
+     * Initializes the native asset identifiers from network configurations.
+     * This method should be called from the client during controller initialization
+     * to populate the nativeAssetIdentifiers state based on actual network configurations.
+     *
+     * @param networks - Array of network configurations with chainId and nativeCurrency
+     * @example
+     * ```typescript
+     * const evmNetworks = Object.values(networkControllerState.networkConfigurationsByChainId)
+     *   .map(config => ({
+     *     chainId: toEvmCaipChainId(config.chainId),
+     *     nativeCurrency: config.nativeCurrency,
+     *   }));
+     *
+     * const multichainNetworks = Object.values(multichainState.multichainNetworkConfigurationsByChainId)
+     *   .map(config => ({
+     *     chainId: config.chainId,
+     *     nativeCurrency: config.nativeCurrency,
+     *   }));
+     *
+     * await controller.initNativeAssetIdentifiers([...evmNetworks, ...multichainNetworks]);
+     * ```
+     */
+    async initNativeAssetIdentifiers(networks) {
+        // Process networks and collect updates
+        const updates = [];
+        for (const { chainId, nativeCurrency } of networks) {
+            // Check if nativeCurrency is already in CAIP-19 format (e.g., "bip122:.../slip44:0")
+            // Non-EVM networks from MultichainNetworkController use this format
+            if (nativeCurrency.includes('/slip44:')) {
+                updates.push({
+                    chainId,
+                    identifier: nativeCurrency,
+                });
+                continue;
+            }
+            // Extract namespace from CAIP-2 chainId
+            const [namespace, reference] = chainId.split(':');
+            let slip44CoinType;
+            if (namespace === 'eip155') {
+                // EVM networks: use getEvmSlip44 (chainid.network data)
+                const numericChainId = parseInt(reference, 10);
+                slip44CoinType = await Slip44Service.getEvmSlip44(numericChainId);
+            }
+            else {
+                // Non-EVM networks: use getSlip44BySymbol (@metamask/slip44 package)
+                slip44CoinType = Slip44Service.getSlip44BySymbol(nativeCurrency);
+            }
+            if (slip44CoinType !== undefined) {
+                updates.push({
+                    chainId,
+                    identifier: buildNativeAssetIdentifier(chainId, slip44CoinType),
+                });
+            }
+        }
+        // Apply all updates synchronously
+        this.update((state) => {
+            for (const { chainId, identifier } of updates) {
+                state.nativeAssetIdentifiers[chainId] = identifier;
+            }
+        });
+    }
     /**
      * Disables a network for the user.
      *
@@ -266,8 +373,8 @@ export class NetworkEnablementController extends BaseController {
     disableNetwork(chainId) {
         const derivedKeys = deriveKeys(chainId);
         const { namespace, storageKey } = derivedKeys;
-        this.update((s) => {
-            s.enabledNetworkMap[namespace][storageKey] = false;
+        this.update((state) => {
+            state.enabledNetworkMap[namespace][storageKey] = false;
         });
     }
     /**
@@ -305,22 +412,40 @@ _NetworkEnablementController_instances = new WeakSet(), _NetworkEnablementContro
     return enabledPopularNetworksCount > 1;
 }, _NetworkEnablementController_removeNetworkEntry = function _NetworkEnablementController_removeNetworkEntry(chainId) {
     const derivedKeys = deriveKeys(chainId);
-    const { namespace, storageKey } = derivedKeys;
-    this.update((s) => {
+    const { namespace, storageKey, caipChainId } = derivedKeys;
+    this.update((state) => {
         // fallback and enable ethereum mainnet
         if (isOnlyNetworkEnabledInNamespace(this.state, derivedKeys)) {
-            s.enabledNetworkMap[namespace][ChainId[BuiltInNetworkName.Mainnet]] =
-                true;
+            state.enabledNetworkMap[namespace][ChainId[BuiltInNetworkName.Mainnet]] = true;
         }
-        if (namespace in s.enabledNetworkMap) {
-            delete s.enabledNetworkMap[namespace][storageKey];
+        if (namespace in state.enabledNetworkMap) {
+            delete state.enabledNetworkMap[namespace][storageKey];
         }
+        // Remove from nativeAssetIdentifiers as well
+        delete state.nativeAssetIdentifiers[caipChainId];
     });
-}, _NetworkEnablementController_onAddNetwork = function _NetworkEnablementController_onAddNetwork(chainId) {
-    const { namespace, storageKey, reference } = deriveKeys(chainId);
-    this.update((s) => {
+}, _NetworkEnablementController_onAddNetwork = 
+/**
+ * Handles the addition of a new EVM network to the controller.
+ *
+ * @param chainId - The chain ID to add (Hex format)
+ *
+ * @description
+ * - If in popular networks mode (>2 popular networks enabled) AND adding a popular network:
+ * - Keep current selection (add but don't enable the new network)
+ * - Otherwise:
+ * - Switch to the newly added network (disable all others, enable this one)
+ * - Also updates the nativeAssetIdentifiers with the CAIP-19-like identifier
+ */
+async function _NetworkEnablementController_onAddNetwork(chainId) {
+    const { namespace, storageKey, reference, caipChainId } = deriveKeys(chainId);
+    // Parse reference (decimal string from CAIP-2) to number for chainid.network lookup
+    const numericChainId = parseInt(reference, 10);
+    // EVM networks: use getEvmSlip44 (chainid.network data)
+    const slip44CoinType = await Slip44Service.getEvmSlip44(numericChainId);
+    this.update((state) => {
         // Ensure the namespace bucket exists
-        __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, s, namespace);
+        __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_ensureNamespaceBucket).call(this, state, namespace);
         // Check if popular networks mode is active (>2 popular networks enabled)
         const inPopularNetworksMode = __classPrivateFieldGet(this, _NetworkEnablementController_instances, "m", _NetworkEnablementController_isInPopularNetworksMode).call(this);
         // Check if the network being added is a popular network
@@ -329,18 +454,20 @@ _NetworkEnablementController_instances = new WeakSet(), _NetworkEnablementContro
         const shouldKeepCurrentSelection = inPopularNetworksMode && isAddedNetworkPopular;
         if (shouldKeepCurrentSelection) {
             // Add the popular network but don't enable it (keep current selection)
-            s.enabledNetworkMap[namespace][storageKey] = true;
+            state.enabledNetworkMap[namespace][storageKey] = true;
         }
         else {
             // Switch to the newly added network (disable all others, enable this one)
-            Object.keys(s.enabledNetworkMap).forEach((ns) => {
-                Object.keys(s.enabledNetworkMap[ns]).forEach((key) => {
-                    s.enabledNetworkMap[ns][key] = false;
+            Object.keys(state.enabledNetworkMap).forEach((ns) => {
+                Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {
+                    state.enabledNetworkMap[ns][key] = false;
                 });
             });
             // Enable the newly added network
-            s.enabledNetworkMap[namespace][storageKey] = true;
+            state.enabledNetworkMap[namespace][storageKey] = true;
         }
+        // Update nativeAssetIdentifiers with the CAIP-19-like identifier
+        state.nativeAssetIdentifiers[caipChainId] = buildNativeAssetIdentifier(caipChainId, slip44CoinType);
     });
 };
 //# sourceMappingURL=NetworkEnablementController.mjs.map
\ No newline at end of file
diff --git a/dist/NetworkEnablementController.mjs.map b/dist/NetworkEnablementController.mjs.map
index a10329453b067507d79594a2dba5a02155235d34..6b6303e176698628286b94196cff1efbdcb0514a 100644
--- a/dist/NetworkEnablementController.mjs.map
+++ b/dist/NetworkEnablementController.mjs.map
@@ -1 +1 @@
-{"version":3,"file":"NetworkEnablementController.mjs","sourceRoot":"","sources":["../src/NetworkEnablementController.ts"],"names":[],"mappings":"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","sourcesContent":["import { BaseController } from '@metamask/base-controller';\nimport type {\n  ControllerGetStateAction,\n  ControllerStateChangeEvent,\n} from '@metamask/base-controller';\nimport { BuiltInNetworkName, ChainId } from '@metamask/controller-utils';\nimport { BtcScope, SolScope, TrxScope } from '@metamask/keyring-api';\nimport type { Messenger } from '@metamask/messenger';\nimport type { MultichainNetworkControllerGetStateAction } from '@metamask/multichain-network-controller';\nimport type {\n  NetworkControllerGetStateAction,\n  NetworkControllerNetworkAddedEvent,\n  NetworkControllerNetworkRemovedEvent,\n  NetworkControllerStateChangeEvent,\n} from '@metamask/network-controller';\nimport type { TransactionControllerTransactionSubmittedEvent } from '@metamask/transaction-controller';\nimport type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';\nimport { KnownCaipNamespace } from '@metamask/utils';\n\nimport { POPULAR_NETWORKS } from './constants';\nimport {\n  deriveKeys,\n  isOnlyNetworkEnabledInNamespace,\n  isPopularNetwork,\n} from './utils';\n\nconst controllerName = 'NetworkEnablementController';\n\n/**\n * Information about an ordered network.\n */\nexport type NetworksInfo = {\n  /**\n   * The network's chain id\n   */\n  networkId: CaipChainId;\n};\n\n/**\n * A map of enabled networks by CAIP namespace and chain ID.\n * For EIP-155 networks, the keys are Hex chain IDs.\n * For other networks, the keys are CAIP chain IDs.\n */\ntype EnabledMap = Record<CaipNamespace, Record<CaipChainId | Hex, boolean>>;\n\n// State shape for NetworkEnablementController\nexport type NetworkEnablementControllerState = {\n  enabledNetworkMap: EnabledMap;\n};\n\nexport type NetworkEnablementControllerGetStateAction =\n  ControllerGetStateAction<\n    typeof controllerName,\n    NetworkEnablementControllerState\n  >;\n\nexport type NetworkEnablementControllerSetEnabledNetworksAction = {\n  type: `${typeof controllerName}:enableNetwork`;\n  handler: NetworkEnablementController['enableNetwork'];\n};\n\nexport type NetworkEnablementControllerDisableNetworkAction = {\n  type: `${typeof controllerName}:disableNetwork`;\n  handler: NetworkEnablementController['disableNetwork'];\n};\n\n/**\n * All actions that {@link NetworkEnablementController} calls internally.\n */\nexport type AllowedActions =\n  | NetworkControllerGetStateAction\n  | MultichainNetworkControllerGetStateAction;\n\nexport type NetworkEnablementControllerActions =\n  | NetworkEnablementControllerGetStateAction\n  | NetworkEnablementControllerSetEnabledNetworksAction\n  | NetworkEnablementControllerDisableNetworkAction;\n\nexport type NetworkEnablementControllerStateChangeEvent =\n  ControllerStateChangeEvent<\n    typeof controllerName,\n    NetworkEnablementControllerState\n  >;\n\nexport type NetworkEnablementControllerEvents =\n  NetworkEnablementControllerStateChangeEvent;\n\n/**\n * All events that {@link NetworkEnablementController} subscribes to internally.\n */\nexport type AllowedEvents =\n  | NetworkControllerNetworkAddedEvent\n  | NetworkControllerNetworkRemovedEvent\n  | NetworkControllerStateChangeEvent\n  | TransactionControllerTransactionSubmittedEvent;\n\nexport type NetworkEnablementControllerMessenger = Messenger<\n  typeof controllerName,\n  NetworkEnablementControllerActions | AllowedActions,\n  NetworkEnablementControllerEvents | AllowedEvents\n>;\n\n/**\n * Gets the default state for the NetworkEnablementController.\n *\n * @returns The default state with pre-enabled networks.\n */\nconst getDefaultNetworkEnablementControllerState =\n  (): NetworkEnablementControllerState => ({\n    enabledNetworkMap: {\n      [KnownCaipNamespace.Eip155]: {\n        [ChainId[BuiltInNetworkName.Mainnet]]: true,\n        [ChainId[BuiltInNetworkName.LineaMainnet]]: true,\n        [ChainId[BuiltInNetworkName.BaseMainnet]]: true,\n      },\n      [KnownCaipNamespace.Solana]: {\n        [SolScope.Mainnet]: true,\n        [SolScope.Testnet]: false,\n        [SolScope.Devnet]: false,\n      },\n      [KnownCaipNamespace.Bip122]: {\n        [BtcScope.Mainnet]: true,\n        [BtcScope.Testnet]: false,\n        [BtcScope.Signet]: false,\n      },\n      [KnownCaipNamespace.Tron]: {\n        [TrxScope.Mainnet]: true,\n        [TrxScope.Nile]: false,\n        [TrxScope.Shasta]: false,\n      },\n    },\n  });\n\n// Metadata for the controller state\nconst metadata = {\n  enabledNetworkMap: {\n    includeInStateLogs: true,\n    persist: true,\n    includeInDebugSnapshot: true,\n    usedInUi: true,\n  },\n};\n\n/**\n * Controller responsible for managing network enablement state across different blockchain networks.\n *\n * This controller tracks which networks are enabled/disabled for the user and provides methods\n * to toggle network states. It supports both EVM (EIP-155) and non-EVM networks like Solana.\n *\n * The controller maintains a map of enabled networks organized by namespace (e.g., 'eip155', 'solana')\n * and provides methods to query and modify network enablement states.\n */\nexport class NetworkEnablementController extends BaseController<\n  typeof controllerName,\n  NetworkEnablementControllerState,\n  NetworkEnablementControllerMessenger\n> {\n  /**\n   * Creates a NetworkEnablementController instance.\n   *\n   * @param args - The arguments to this function.\n   * @param args.messenger - Messenger used to communicate with BaseV2 controller.\n   * @param args.state - Initial state to set on this controller.\n   */\n  constructor({\n    messenger,\n    state,\n  }: {\n    messenger: NetworkEnablementControllerMessenger;\n    state?: Partial<NetworkEnablementControllerState>;\n  }) {\n    super({\n      messenger,\n      metadata,\n      name: controllerName,\n      state: {\n        ...getDefaultNetworkEnablementControllerState(),\n        ...state,\n      },\n    });\n\n    messenger.subscribe('NetworkController:networkAdded', ({ chainId }) => {\n      this.#onAddNetwork(chainId);\n    });\n\n    messenger.subscribe('NetworkController:networkRemoved', ({ chainId }) => {\n      this.#removeNetworkEntry(chainId);\n    });\n  }\n\n  /**\n   * Enables or disables a network for the user.\n   *\n   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n   * (for any blockchain network). The method will automatically convert Hex chain IDs\n   * to CAIP-2 format internally. This dual parameter support allows for backward\n   * compatibility with existing EVM chain ID formats while supporting newer\n   * multi-chain standards.\n   *\n   * When enabling a non-popular network, this method will disable all other networks\n   * to ensure only one network is active at a time (exclusive mode).\n   *\n   * @param chainId - The chain ID of the network to enable or disable. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   */\n  enableNetwork(chainId: Hex | CaipChainId): void {\n    const { namespace, storageKey } = deriveKeys(chainId);\n\n    this.update((s) => {\n      // disable all networks in all namespaces first\n      Object.keys(s.enabledNetworkMap).forEach((ns) => {\n        Object.keys(s.enabledNetworkMap[ns]).forEach((key) => {\n          s.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;\n        });\n      });\n\n      // if the namespace bucket does not exist, return\n      // new nemespace are added only when a new network is added\n      if (!s.enabledNetworkMap[namespace]) {\n        return;\n      }\n\n      // enable the network\n      s.enabledNetworkMap[namespace][storageKey] = true;\n    });\n  }\n\n  /**\n   * Enables a network for the user within a specific namespace.\n   *\n   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n   * (for any blockchain network) and enables it within the specified namespace.\n   * The method validates that the chainId belongs to the specified namespace for safety.\n   *\n   * Before enabling the target network, this method disables all other networks\n   * in the same namespace to ensure exclusive behavior within the namespace.\n   *\n   * @param chainId - The chain ID of the network to enable. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   * @param namespace - The CAIP namespace where the network should be enabled\n   * @throws Error if the chainId's derived namespace doesn't match the provided namespace\n   */\n  enableNetworkInNamespace(\n    chainId: Hex | CaipChainId,\n    namespace: CaipNamespace,\n  ): void {\n    const { namespace: derivedNamespace, storageKey } = deriveKeys(chainId);\n\n    // Validate that the derived namespace matches the provided namespace\n    if (derivedNamespace !== namespace) {\n      throw new Error(\n        `Chain ID ${chainId} belongs to namespace ${derivedNamespace}, but namespace ${namespace} was specified`,\n      );\n    }\n\n    this.update((s) => {\n      // Ensure the namespace bucket exists\n      this.#ensureNamespaceBucket(s, namespace);\n\n      // Disable all networks in the specified namespace first\n      if (s.enabledNetworkMap[namespace]) {\n        Object.keys(s.enabledNetworkMap[namespace]).forEach((key) => {\n          s.enabledNetworkMap[namespace][key as CaipChainId | Hex] = false;\n        });\n      }\n\n      // Enable the target network in the specified namespace\n      s.enabledNetworkMap[namespace][storageKey] = true;\n    });\n  }\n\n  /**\n   * Enables all popular networks and Solana mainnet.\n   *\n   * This method first disables all networks across all namespaces, then enables\n   * all networks defined in POPULAR_NETWORKS (EVM networks), Solana mainnet, and\n   * Bitcoin mainnet. This provides exclusive behavior - only popular networks will\n   * be enabled after calling this method.\n   *\n   * Popular networks that don't exist in NetworkController or MultichainNetworkController configurations will be skipped silently.\n   */\n  enableAllPopularNetworks(): void {\n    this.update((s) => {\n      // First disable all networks across all namespaces\n      Object.keys(s.enabledNetworkMap).forEach((ns) => {\n        Object.keys(s.enabledNetworkMap[ns]).forEach((key) => {\n          s.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;\n        });\n      });\n\n      // Get current network configurations to check if networks exist\n      const networkControllerState = this.messenger.call(\n        'NetworkController:getState',\n      );\n      const multichainState = this.messenger.call(\n        'MultichainNetworkController:getState',\n      );\n\n      // Enable all popular EVM networks that exist in NetworkController configurations\n      POPULAR_NETWORKS.forEach((chainId) => {\n        const { namespace, storageKey } = deriveKeys(chainId as Hex);\n\n        // Check if network exists in NetworkController configurations\n        if (\n          networkControllerState.networkConfigurationsByChainId[chainId as Hex]\n        ) {\n          // Ensure namespace bucket exists\n          this.#ensureNamespaceBucket(s, namespace);\n          // Enable the network\n          s.enabledNetworkMap[namespace][storageKey] = true;\n        }\n      });\n\n      // Enable Solana mainnet if it exists in MultichainNetworkController configurations\n      const solanaKeys = deriveKeys(SolScope.Mainnet as CaipChainId);\n      if (\n        multichainState.multichainNetworkConfigurationsByChainId[\n          SolScope.Mainnet\n        ]\n      ) {\n        // Ensure namespace bucket exists\n        this.#ensureNamespaceBucket(s, solanaKeys.namespace);\n        // Enable Solana mainnet\n        s.enabledNetworkMap[solanaKeys.namespace][solanaKeys.storageKey] = true;\n      }\n\n      // Enable Bitcoin mainnet if it exists in MultichainNetworkController configurations\n      const bitcoinKeys = deriveKeys(BtcScope.Mainnet as CaipChainId);\n      if (\n        multichainState.multichainNetworkConfigurationsByChainId[\n          BtcScope.Mainnet\n        ]\n      ) {\n        // Ensure namespace bucket exists\n        this.#ensureNamespaceBucket(s, bitcoinKeys.namespace);\n        // Enable Bitcoin mainnet\n        s.enabledNetworkMap[bitcoinKeys.namespace][bitcoinKeys.storageKey] =\n          true;\n      }\n\n      // Enable Tron mainnet if it exists in MultichainNetworkController configurations\n      const tronKeys = deriveKeys(TrxScope.Mainnet as CaipChainId);\n      if (\n        multichainState.multichainNetworkConfigurationsByChainId[\n          TrxScope.Mainnet\n        ]\n      ) {\n        // Ensure namespace bucket exists\n        this.#ensureNamespaceBucket(s, tronKeys.namespace);\n        // Enable Tron mainnet\n        s.enabledNetworkMap[tronKeys.namespace][tronKeys.storageKey] = true;\n      }\n    });\n  }\n\n  /**\n   * Initializes the network enablement state from network controller configurations.\n   *\n   * This method reads the current network configurations from both NetworkController\n   * and MultichainNetworkController and syncs the enabled network map accordingly.\n   * It ensures proper namespace buckets exist for all configured networks and only\n   * adds missing networks with a default value of false, preserving existing user settings.\n   *\n   * This method should be called after the NetworkController and MultichainNetworkController\n   * have been initialized and their configurations are available.\n   */\n  init(): void {\n    this.update((s) => {\n      // Get network configurations from NetworkController (EVM networks)\n      const networkControllerState = this.messenger.call(\n        'NetworkController:getState',\n      );\n\n      // Get network configurations from MultichainNetworkController (all networks)\n      const multichainState = this.messenger.call(\n        'MultichainNetworkController:getState',\n      );\n\n      // Initialize namespace buckets for EVM networks from NetworkController\n      Object.keys(\n        networkControllerState.networkConfigurationsByChainId,\n      ).forEach((chainId) => {\n        const { namespace, storageKey } = deriveKeys(chainId as Hex);\n        this.#ensureNamespaceBucket(s, namespace);\n\n        // Only add network if it doesn't already exist in state (preserves user settings)\n        if (s.enabledNetworkMap[namespace][storageKey] === undefined) {\n          s.enabledNetworkMap[namespace][storageKey] = false;\n        }\n      });\n\n      // Initialize namespace buckets for all networks from MultichainNetworkController\n      Object.keys(\n        multichainState.multichainNetworkConfigurationsByChainId,\n      ).forEach((chainId) => {\n        const { namespace, storageKey } = deriveKeys(chainId as CaipChainId);\n        this.#ensureNamespaceBucket(s, namespace);\n\n        // Only add network if it doesn't already exist in state (preserves user settings)\n        if (s.enabledNetworkMap[namespace][storageKey] === undefined) {\n          s.enabledNetworkMap[namespace][storageKey] = false;\n        }\n      });\n    });\n  }\n\n  /**\n   * Disables a network for the user.\n   *\n   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n   * (for any blockchain network). The method will automatically convert Hex chain IDs\n   * to CAIP-2 format internally.\n   *\n   * Note: This method will prevent disabling the last remaining enabled network\n   * to ensure at least one network is always available.\n   *\n   * @param chainId - The chain ID of the network to disable. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   */\n  disableNetwork(chainId: Hex | CaipChainId): void {\n    const derivedKeys = deriveKeys(chainId);\n    const { namespace, storageKey } = derivedKeys;\n\n    this.update((s) => {\n      s.enabledNetworkMap[namespace][storageKey] = false;\n    });\n  }\n\n  /**\n   * Checks if a network is enabled.\n   *\n   * @param chainId - The chain ID of the network to check. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   * @returns True if the network is enabled, false otherwise\n   */\n  isNetworkEnabled(chainId: Hex | CaipChainId): boolean {\n    const derivedKeys = deriveKeys(chainId);\n    const { namespace, storageKey } = derivedKeys;\n    return this.state.enabledNetworkMap[namespace]?.[storageKey] ?? false;\n  }\n\n  /**\n   * Ensures that a namespace bucket exists in the state.\n   *\n   * This method creates the namespace entry in the enabledNetworkMap if it doesn't\n   * already exist. This is used to prepare the state structure before adding\n   * network entries.\n   *\n   * @param state - The current controller state\n   * @param ns - The CAIP namespace to ensure exists\n   */\n  #ensureNamespaceBucket(\n    state: NetworkEnablementControllerState,\n    ns: CaipNamespace,\n  ) {\n    if (!state.enabledNetworkMap[ns]) {\n      state.enabledNetworkMap[ns] = {};\n    }\n  }\n\n  /**\n   * Checks if popular networks mode is active (more than 2 popular networks enabled).\n   *\n   * This method counts how many networks defined in POPULAR_NETWORKS are currently\n   * enabled in the state and returns true if more than 2 are enabled. It only checks\n   * networks that actually exist in the NetworkController configurations.\n   *\n   * @returns True if more than 2 popular networks are enabled, false otherwise\n   */\n  #isInPopularNetworksMode(): boolean {\n    // Get current network configurations to check which popular networks exist\n    const networkControllerState = this.messenger.call(\n      'NetworkController:getState',\n    );\n\n    // Count how many popular networks are enabled\n    const enabledPopularNetworksCount = POPULAR_NETWORKS.reduce(\n      (count, chainId) => {\n        // Only check networks that actually exist in NetworkController configurations\n        if (\n          !networkControllerState.networkConfigurationsByChainId[chainId as Hex]\n        ) {\n          return count; // Skip networks that don't exist\n        }\n\n        const { namespace, storageKey } = deriveKeys(chainId as Hex);\n        const isEnabled = this.state.enabledNetworkMap[namespace]?.[storageKey];\n        return isEnabled ? count + 1 : count;\n      },\n      0,\n    );\n\n    // Return true if more than 2 popular networks are enabled\n    return enabledPopularNetworksCount > 1;\n  }\n\n  /**\n   * Removes a network entry from the state.\n   *\n   * This method is called when a network is removed from the system. It cleans up\n   * the network entry and ensures that at least one network remains enabled.\n   *\n   * @param chainId - The chain ID to remove (Hex or CAIP-2 format)\n   */\n  #removeNetworkEntry(chainId: Hex | CaipChainId): void {\n    const derivedKeys = deriveKeys(chainId);\n    const { namespace, storageKey } = derivedKeys;\n\n    this.update((s) => {\n      // fallback and enable ethereum mainnet\n      if (isOnlyNetworkEnabledInNamespace(this.state, derivedKeys)) {\n        s.enabledNetworkMap[namespace][ChainId[BuiltInNetworkName.Mainnet]] =\n          true;\n      }\n\n      if (namespace in s.enabledNetworkMap) {\n        delete s.enabledNetworkMap[namespace][storageKey];\n      }\n    });\n  }\n\n  /**\n   * Handles the addition of a new network to the controller.\n   *\n   * @param chainId - The chain ID to add (Hex or CAIP-2 format)\n   *\n   * @description\n   * - If in popular networks mode (>2 popular networks enabled) AND adding a popular network:\n   * - Keep current selection (add but don't enable the new network)\n   * - Otherwise:\n   * - Switch to the newly added network (disable all others, enable this one)\n   */\n  #onAddNetwork(chainId: Hex | CaipChainId): void {\n    const { namespace, storageKey, reference } = deriveKeys(chainId);\n\n    this.update((s) => {\n      // Ensure the namespace bucket exists\n      this.#ensureNamespaceBucket(s, namespace);\n\n      // Check if popular networks mode is active (>2 popular networks enabled)\n      const inPopularNetworksMode = this.#isInPopularNetworksMode();\n\n      // Check if the network being added is a popular network\n      const isAddedNetworkPopular = isPopularNetwork(reference);\n\n      // Keep current selection only if in popular networks mode AND adding a popular network\n      const shouldKeepCurrentSelection =\n        inPopularNetworksMode && isAddedNetworkPopular;\n\n      if (shouldKeepCurrentSelection) {\n        // Add the popular network but don't enable it (keep current selection)\n        s.enabledNetworkMap[namespace][storageKey] = true;\n      } else {\n        // Switch to the newly added network (disable all others, enable this one)\n        Object.keys(s.enabledNetworkMap).forEach((ns) => {\n          Object.keys(s.enabledNetworkMap[ns]).forEach((key) => {\n            s.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;\n          });\n        });\n        // Enable the newly added network\n        s.enabledNetworkMap[namespace][storageKey] = true;\n      }\n    });\n  }\n}\n"]}
\ No newline at end of file
+{"version":3,"file":"NetworkEnablementController.mjs","sourceRoot":"","sources":["../src/NetworkEnablementController.ts"],"names":[],"mappings":"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","sourcesContent":["import { BaseController } from '@metamask/base-controller';\nimport type {\n  ControllerGetStateAction,\n  ControllerStateChangeEvent,\n} from '@metamask/base-controller';\nimport { BuiltInNetworkName, ChainId } from '@metamask/controller-utils';\nimport { BtcScope, SolScope, TrxScope } from '@metamask/keyring-api';\nimport type { Messenger } from '@metamask/messenger';\nimport type { MultichainNetworkControllerGetStateAction } from '@metamask/multichain-network-controller';\nimport type {\n  NetworkControllerGetStateAction,\n  NetworkControllerNetworkAddedEvent,\n  NetworkControllerNetworkRemovedEvent,\n  NetworkControllerStateChangeEvent,\n} from '@metamask/network-controller';\nimport type { TransactionControllerTransactionSubmittedEvent } from '@metamask/transaction-controller';\nimport type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';\nimport { KnownCaipNamespace } from '@metamask/utils';\n\nimport { POPULAR_NETWORKS } from './constants';\nimport { Slip44Service } from './services';\nimport {\n  deriveKeys,\n  isOnlyNetworkEnabledInNamespace,\n  isPopularNetwork,\n} from './utils';\n\nconst controllerName = 'NetworkEnablementController';\n\n/**\n * Information about an ordered network.\n */\nexport type NetworksInfo = {\n  /**\n   * The network's chain id\n   */\n  networkId: CaipChainId;\n};\n\n/**\n * A map of enabled networks by CAIP namespace and chain ID.\n * For EIP-155 networks, the keys are Hex chain IDs.\n * For other networks, the keys are CAIP chain IDs.\n */\ntype EnabledMap = Record<CaipNamespace, Record<CaipChainId | Hex, boolean>>;\n\n/**\n * A native asset identifier in CAIP-19-like format.\n * Format: `{caip2ChainId}/slip44:{coinType}`\n *\n * @example\n * - `eip155:1/slip44:60` for Ethereum mainnet (ETH)\n * - `solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp/slip44:501` for Solana mainnet (SOL)\n * - `bip122:000000000019d6689c085ae165831e93/slip44:0` for Bitcoin mainnet (BTC)\n */\nexport type NativeAssetIdentifier = `${CaipChainId}/slip44:${number}`;\n\n/**\n * A map of CAIP-2 chain IDs to their native asset identifiers.\n * Uses CAIP-19-like format to identify the native asset for each chain.\n *\n * @see https://github.com/satoshilabs/slips/blob/master/slip-0044.md\n */\nexport type NativeAssetIdentifiersMap = Record<\n  CaipChainId,\n  NativeAssetIdentifier\n>;\n\n// State shape for NetworkEnablementController\nexport type NetworkEnablementControllerState = {\n  enabledNetworkMap: EnabledMap;\n  nativeAssetIdentifiers: NativeAssetIdentifiersMap;\n};\n\nexport type NetworkEnablementControllerGetStateAction =\n  ControllerGetStateAction<\n    typeof controllerName,\n    NetworkEnablementControllerState\n  >;\n\nexport type NetworkEnablementControllerSetEnabledNetworksAction = {\n  type: `${typeof controllerName}:enableNetwork`;\n  handler: NetworkEnablementController['enableNetwork'];\n};\n\nexport type NetworkEnablementControllerDisableNetworkAction = {\n  type: `${typeof controllerName}:disableNetwork`;\n  handler: NetworkEnablementController['disableNetwork'];\n};\n\n/**\n * All actions that {@link NetworkEnablementController} calls internally.\n */\nexport type AllowedActions =\n  | NetworkControllerGetStateAction\n  | MultichainNetworkControllerGetStateAction;\n\nexport type NetworkEnablementControllerActions =\n  | NetworkEnablementControllerGetStateAction\n  | NetworkEnablementControllerSetEnabledNetworksAction\n  | NetworkEnablementControllerDisableNetworkAction;\n\nexport type NetworkEnablementControllerStateChangeEvent =\n  ControllerStateChangeEvent<\n    typeof controllerName,\n    NetworkEnablementControllerState\n  >;\n\nexport type NetworkEnablementControllerEvents =\n  NetworkEnablementControllerStateChangeEvent;\n\n/**\n * All events that {@link NetworkEnablementController} subscribes to internally.\n */\nexport type AllowedEvents =\n  | NetworkControllerNetworkAddedEvent\n  | NetworkControllerNetworkRemovedEvent\n  | NetworkControllerStateChangeEvent\n  | TransactionControllerTransactionSubmittedEvent;\n\nexport type NetworkEnablementControllerMessenger = Messenger<\n  typeof controllerName,\n  NetworkEnablementControllerActions | AllowedActions,\n  NetworkEnablementControllerEvents | AllowedEvents\n>;\n\n/**\n * Builds a native asset identifier in CAIP-19-like format.\n *\n * @param caipChainId - The CAIP-2 chain ID (e.g., 'eip155:1', 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp')\n * @param slip44CoinType - The SLIP-44 coin type number\n * @returns The native asset identifier string (e.g., 'eip155:1/slip44:60')\n */\nfunction buildNativeAssetIdentifier(\n  caipChainId: CaipChainId,\n  slip44CoinType: number,\n): NativeAssetIdentifier {\n  return `${caipChainId}/slip44:${slip44CoinType}`;\n}\n\n/**\n * Network configuration with chain ID and native currency symbol.\n * Used to initialize native asset identifiers.\n */\nexport type NetworkConfig = {\n  chainId: CaipChainId;\n  nativeCurrency: string;\n};\n\n/**\n * Gets the default state for the NetworkEnablementController.\n *\n * @returns The default state with pre-enabled networks.\n */\nconst getDefaultNetworkEnablementControllerState =\n  (): NetworkEnablementControllerState => {\n    // Build the enabled EVM networks map from POPULAR_NETWORKS\n    const evmNetworks = POPULAR_NETWORKS.reduce<Record<Hex, boolean>>(\n      (acc, chainId) => {\n        acc[chainId as Hex] = true;\n        return acc;\n      },\n      {},\n    );\n\n    return {\n      enabledNetworkMap: {\n        [KnownCaipNamespace.Eip155]: evmNetworks,\n        [KnownCaipNamespace.Solana]: {\n          [SolScope.Mainnet]: true,\n          [SolScope.Testnet]: false,\n          [SolScope.Devnet]: false,\n        },\n        [KnownCaipNamespace.Bip122]: {\n          [BtcScope.Mainnet]: true,\n          [BtcScope.Testnet]: false,\n          [BtcScope.Signet]: false,\n        },\n        [KnownCaipNamespace.Tron]: {\n          [TrxScope.Mainnet]: true,\n          [TrxScope.Nile]: false,\n          [TrxScope.Shasta]: false,\n        },\n      },\n      // nativeAssetIdentifiers is initialized as empty and should be populated\n      // by the client using initNativeAssetIdentifiers() during controller init\n      nativeAssetIdentifiers: {},\n    };\n  };\n\n// Metadata for the controller state\nconst metadata = {\n  enabledNetworkMap: {\n    includeInStateLogs: true,\n    persist: true,\n    includeInDebugSnapshot: true,\n    usedInUi: true,\n  },\n  nativeAssetIdentifiers: {\n    includeInStateLogs: true,\n    persist: true,\n    includeInDebugSnapshot: true,\n    usedInUi: true,\n  },\n};\n\n/**\n * Controller responsible for managing network enablement state across different blockchain networks.\n *\n * This controller tracks which networks are enabled/disabled for the user and provides methods\n * to toggle network states. It supports both EVM (EIP-155) and non-EVM networks like Solana.\n *\n * The controller maintains a map of enabled networks organized by namespace (e.g., 'eip155', 'solana')\n * and provides methods to query and modify network enablement states.\n */\nexport class NetworkEnablementController extends BaseController<\n  typeof controllerName,\n  NetworkEnablementControllerState,\n  NetworkEnablementControllerMessenger\n> {\n  /**\n   * Creates a NetworkEnablementController instance.\n   *\n   * @param args - The arguments to this function.\n   * @param args.messenger - Messenger used to communicate with BaseV2 controller.\n   * @param args.state - Initial state to set on this controller.\n   */\n  constructor({\n    messenger,\n    state,\n  }: {\n    messenger: NetworkEnablementControllerMessenger;\n    state?: Partial<NetworkEnablementControllerState>;\n  }) {\n    super({\n      messenger,\n      metadata,\n      name: controllerName,\n      state: {\n        ...getDefaultNetworkEnablementControllerState(),\n        ...state,\n      },\n    });\n\n    messenger.subscribe('NetworkController:networkAdded', ({ chainId }) => {\n      // eslint-disable-next-line no-void\n      void this.#onAddNetwork(chainId);\n    });\n\n    messenger.subscribe('NetworkController:networkRemoved', ({ chainId }) => {\n      this.#removeNetworkEntry(chainId);\n    });\n  }\n\n  /**\n   * Enables or disables a network for the user.\n   *\n   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n   * (for any blockchain network). The method will automatically convert Hex chain IDs\n   * to CAIP-2 format internally. This dual parameter support allows for backward\n   * compatibility with existing EVM chain ID formats while supporting newer\n   * multi-chain standards.\n   *\n   * When enabling a non-popular network, this method will disable all other networks\n   * to ensure only one network is active at a time (exclusive mode).\n   *\n   * @param chainId - The chain ID of the network to enable or disable. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   */\n  enableNetwork(chainId: Hex | CaipChainId): void {\n    const { namespace, storageKey } = deriveKeys(chainId);\n\n    this.update((state) => {\n      // disable all networks in all namespaces first\n      Object.keys(state.enabledNetworkMap).forEach((ns) => {\n        Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {\n          state.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;\n        });\n      });\n\n      // if the namespace bucket does not exist, return\n      // new nemespace are added only when a new network is added\n      if (!state.enabledNetworkMap[namespace]) {\n        return;\n      }\n\n      // enable the network\n      state.enabledNetworkMap[namespace][storageKey] = true;\n    });\n  }\n\n  /**\n   * Enables a network for the user within a specific namespace.\n   *\n   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n   * (for any blockchain network) and enables it within the specified namespace.\n   * The method validates that the chainId belongs to the specified namespace for safety.\n   *\n   * Before enabling the target network, this method disables all other networks\n   * in the same namespace to ensure exclusive behavior within the namespace.\n   *\n   * @param chainId - The chain ID of the network to enable. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   * @param namespace - The CAIP namespace where the network should be enabled\n   * @throws Error if the chainId's derived namespace doesn't match the provided namespace\n   */\n  enableNetworkInNamespace(\n    chainId: Hex | CaipChainId,\n    namespace: CaipNamespace,\n  ): void {\n    const { namespace: derivedNamespace, storageKey } = deriveKeys(chainId);\n\n    // Validate that the derived namespace matches the provided namespace\n    if (derivedNamespace !== namespace) {\n      throw new Error(\n        `Chain ID ${chainId} belongs to namespace ${derivedNamespace}, but namespace ${namespace} was specified`,\n      );\n    }\n\n    this.update((state) => {\n      // Ensure the namespace bucket exists\n      this.#ensureNamespaceBucket(state, namespace);\n\n      // Disable all networks in the specified namespace first\n      if (state.enabledNetworkMap[namespace]) {\n        Object.keys(state.enabledNetworkMap[namespace]).forEach((key) => {\n          state.enabledNetworkMap[namespace][key as CaipChainId | Hex] = false;\n        });\n      }\n\n      // Enable the target network in the specified namespace\n      state.enabledNetworkMap[namespace][storageKey] = true;\n    });\n  }\n\n  /**\n   * Enables all popular networks and Solana mainnet.\n   *\n   * This method first disables all networks across all namespaces, then enables\n   * all networks defined in POPULAR_NETWORKS (EVM networks), Solana mainnet, and\n   * Bitcoin mainnet. This provides exclusive behavior - only popular networks will\n   * be enabled after calling this method.\n   *\n   * Popular networks that don't exist in NetworkController or MultichainNetworkController configurations will be skipped silently.\n   */\n  enableAllPopularNetworks(): void {\n    this.update((state) => {\n      // First disable all networks across all namespaces\n      Object.keys(state.enabledNetworkMap).forEach((ns) => {\n        Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {\n          state.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;\n        });\n      });\n\n      // Get current network configurations to check if networks exist\n      const networkControllerState = this.messenger.call(\n        'NetworkController:getState',\n      );\n      const multichainState = this.messenger.call(\n        'MultichainNetworkController:getState',\n      );\n\n      // Enable all popular EVM networks that exist in NetworkController configurations\n      POPULAR_NETWORKS.forEach((chainId) => {\n        const { namespace, storageKey } = deriveKeys(chainId as Hex);\n\n        // Check if network exists in NetworkController configurations\n        if (\n          networkControllerState.networkConfigurationsByChainId[chainId as Hex]\n        ) {\n          // Ensure namespace bucket exists\n          this.#ensureNamespaceBucket(state, namespace);\n          // Enable the network\n          state.enabledNetworkMap[namespace][storageKey] = true;\n        }\n      });\n\n      // Enable Solana mainnet if it exists in MultichainNetworkController configurations\n      const solanaKeys = deriveKeys(SolScope.Mainnet as CaipChainId);\n      if (\n        multichainState.multichainNetworkConfigurationsByChainId[\n          SolScope.Mainnet\n        ]\n      ) {\n        // Ensure namespace bucket exists\n        this.#ensureNamespaceBucket(state, solanaKeys.namespace);\n        // Enable Solana mainnet\n        state.enabledNetworkMap[solanaKeys.namespace][solanaKeys.storageKey] =\n          true;\n      }\n\n      // Enable Bitcoin mainnet if it exists in MultichainNetworkController configurations\n      const bitcoinKeys = deriveKeys(BtcScope.Mainnet as CaipChainId);\n      if (\n        multichainState.multichainNetworkConfigurationsByChainId[\n          BtcScope.Mainnet\n        ]\n      ) {\n        // Ensure namespace bucket exists\n        this.#ensureNamespaceBucket(state, bitcoinKeys.namespace);\n        // Enable Bitcoin mainnet\n        state.enabledNetworkMap[bitcoinKeys.namespace][bitcoinKeys.storageKey] =\n          true;\n      }\n\n      // Enable Tron mainnet if it exists in MultichainNetworkController configurations\n      const tronKeys = deriveKeys(TrxScope.Mainnet as CaipChainId);\n      if (\n        multichainState.multichainNetworkConfigurationsByChainId[\n          TrxScope.Mainnet\n        ]\n      ) {\n        // Ensure namespace bucket exists\n        this.#ensureNamespaceBucket(state, tronKeys.namespace);\n        // Enable Tron mainnet\n        state.enabledNetworkMap[tronKeys.namespace][tronKeys.storageKey] = true;\n      }\n    });\n  }\n\n  /**\n   * Initializes the network enablement state from network controller configurations.\n   *\n   * This method reads the current network configurations from both NetworkController\n   * and MultichainNetworkController and syncs the enabled network map and nativeAssetIdentifiers accordingly.\n   * It ensures proper namespace buckets exist for all configured networks and only\n   * adds missing networks with a default value of false, preserving existing user settings.\n   *\n   * This method should be called after the NetworkController and MultichainNetworkController\n   * have been initialized and their configurations are available.\n   */\n  async init(): Promise<void> {\n    // Get network configurations from NetworkController (EVM networks)\n    const networkControllerState = this.messenger.call(\n      'NetworkController:getState',\n    );\n\n    // Get network configurations from MultichainNetworkController (all networks)\n    const multichainState = this.messenger.call(\n      'MultichainNetworkController:getState',\n    );\n\n    // Build nativeAssetIdentifiers for EVM networks using chainid.network\n    const evmNativeAssetUpdates: {\n      caipChainId: CaipChainId;\n      identifier: NativeAssetIdentifier;\n    }[] = [];\n\n    for (const [chainId] of Object.entries(\n      networkControllerState.networkConfigurationsByChainId,\n    )) {\n      const { caipChainId } = deriveKeys(chainId as Hex);\n\n      // Skip if already in state\n      if (this.state.nativeAssetIdentifiers[caipChainId] !== undefined) {\n        continue;\n      }\n\n      // Parse hex chainId to number for chainid.network lookup\n      const numericChainId = parseInt(chainId, 16);\n\n      // EVM networks: use getEvmSlip44 (chainid.network data)\n      const slip44CoinType = await Slip44Service.getEvmSlip44(numericChainId);\n\n      evmNativeAssetUpdates.push({\n        caipChainId,\n        identifier: buildNativeAssetIdentifier(caipChainId, slip44CoinType),\n      });\n    }\n\n    // Update state synchronously\n    this.update((state) => {\n      // Initialize namespace buckets for EVM networks from NetworkController\n      Object.entries(\n        networkControllerState.networkConfigurationsByChainId,\n      ).forEach(([chainId]) => {\n        const { namespace, storageKey } = deriveKeys(chainId as Hex);\n        this.#ensureNamespaceBucket(state, namespace);\n\n        // Only add network if it doesn't already exist in state (preserves user settings)\n        state.enabledNetworkMap[namespace][storageKey] ??= false;\n      });\n\n      // Apply nativeAssetIdentifier updates\n      for (const { caipChainId, identifier } of evmNativeAssetUpdates) {\n        state.nativeAssetIdentifiers[caipChainId] = identifier;\n      }\n\n      // Initialize namespace buckets for all networks from MultichainNetworkController\n      Object.keys(\n        multichainState.multichainNetworkConfigurationsByChainId,\n      ).forEach((chainId) => {\n        const { namespace, storageKey } = deriveKeys(chainId as CaipChainId);\n        this.#ensureNamespaceBucket(state, namespace);\n\n        // Only add network if it doesn't already exist in state (preserves user settings)\n        state.enabledNetworkMap[namespace][storageKey] ??= false;\n      });\n    });\n  }\n\n  /**\n   * Initializes the native asset identifiers from network configurations.\n   * This method should be called from the client during controller initialization\n   * to populate the nativeAssetIdentifiers state based on actual network configurations.\n   *\n   * @param networks - Array of network configurations with chainId and nativeCurrency\n   * @example\n   * ```typescript\n   * const evmNetworks = Object.values(networkControllerState.networkConfigurationsByChainId)\n   *   .map(config => ({\n   *     chainId: toEvmCaipChainId(config.chainId),\n   *     nativeCurrency: config.nativeCurrency,\n   *   }));\n   *\n   * const multichainNetworks = Object.values(multichainState.multichainNetworkConfigurationsByChainId)\n   *   .map(config => ({\n   *     chainId: config.chainId,\n   *     nativeCurrency: config.nativeCurrency,\n   *   }));\n   *\n   * await controller.initNativeAssetIdentifiers([...evmNetworks, ...multichainNetworks]);\n   * ```\n   */\n  async initNativeAssetIdentifiers(networks: NetworkConfig[]): Promise<void> {\n    // Process networks and collect updates\n    const updates: {\n      chainId: CaipChainId;\n      identifier: NativeAssetIdentifier;\n    }[] = [];\n\n    for (const { chainId, nativeCurrency } of networks) {\n      // Check if nativeCurrency is already in CAIP-19 format (e.g., \"bip122:.../slip44:0\")\n      // Non-EVM networks from MultichainNetworkController use this format\n      if (nativeCurrency.includes('/slip44:')) {\n        updates.push({\n          chainId,\n          identifier: nativeCurrency as NativeAssetIdentifier,\n        });\n        continue;\n      }\n\n      // Extract namespace from CAIP-2 chainId\n      const [namespace, reference] = chainId.split(':');\n      let slip44CoinType: number | undefined;\n\n      if (namespace === 'eip155') {\n        // EVM networks: use getEvmSlip44 (chainid.network data)\n        const numericChainId = parseInt(reference, 10);\n        slip44CoinType = await Slip44Service.getEvmSlip44(numericChainId);\n      } else {\n        // Non-EVM networks: use getSlip44BySymbol (@metamask/slip44 package)\n        slip44CoinType = Slip44Service.getSlip44BySymbol(nativeCurrency);\n      }\n\n      if (slip44CoinType !== undefined) {\n        updates.push({\n          chainId,\n          identifier: buildNativeAssetIdentifier(chainId, slip44CoinType),\n        });\n      }\n    }\n\n    // Apply all updates synchronously\n    this.update((state) => {\n      for (const { chainId, identifier } of updates) {\n        state.nativeAssetIdentifiers[chainId] = identifier;\n      }\n    });\n  }\n\n  /**\n   * Disables a network for the user.\n   *\n   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n   * (for any blockchain network). The method will automatically convert Hex chain IDs\n   * to CAIP-2 format internally.\n   *\n   * Note: This method will prevent disabling the last remaining enabled network\n   * to ensure at least one network is always available.\n   *\n   * @param chainId - The chain ID of the network to disable. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   */\n  disableNetwork(chainId: Hex | CaipChainId): void {\n    const derivedKeys = deriveKeys(chainId);\n    const { namespace, storageKey } = derivedKeys;\n\n    this.update((state) => {\n      state.enabledNetworkMap[namespace][storageKey] = false;\n    });\n  }\n\n  /**\n   * Checks if a network is enabled.\n   *\n   * @param chainId - The chain ID of the network to check. Can be either:\n   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks\n   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)\n   * @returns True if the network is enabled, false otherwise\n   */\n  isNetworkEnabled(chainId: Hex | CaipChainId): boolean {\n    const derivedKeys = deriveKeys(chainId);\n    const { namespace, storageKey } = derivedKeys;\n    return this.state.enabledNetworkMap[namespace]?.[storageKey] ?? false;\n  }\n\n  /**\n   * Ensures that a namespace bucket exists in the state.\n   *\n   * This method creates the namespace entry in the enabledNetworkMap if it doesn't\n   * already exist. This is used to prepare the state structure before adding\n   * network entries.\n   *\n   * @param state - The current controller state\n   * @param ns - The CAIP namespace to ensure exists\n   */\n  #ensureNamespaceBucket(\n    state: NetworkEnablementControllerState,\n    ns: CaipNamespace,\n  ): void {\n    if (!state.enabledNetworkMap[ns]) {\n      state.enabledNetworkMap[ns] = {};\n    }\n  }\n\n  /**\n   * Checks if popular networks mode is active (more than 2 popular networks enabled).\n   *\n   * This method counts how many networks defined in POPULAR_NETWORKS are currently\n   * enabled in the state and returns true if more than 2 are enabled. It only checks\n   * networks that actually exist in the NetworkController configurations.\n   *\n   * @returns True if more than 2 popular networks are enabled, false otherwise\n   */\n  #isInPopularNetworksMode(): boolean {\n    // Get current network configurations to check which popular networks exist\n    const networkControllerState = this.messenger.call(\n      'NetworkController:getState',\n    );\n\n    // Count how many popular networks are enabled\n    const enabledPopularNetworksCount = POPULAR_NETWORKS.reduce(\n      (count, chainId) => {\n        // Only check networks that actually exist in NetworkController configurations\n        if (\n          !networkControllerState.networkConfigurationsByChainId[chainId as Hex]\n        ) {\n          return count; // Skip networks that don't exist\n        }\n\n        const { namespace, storageKey } = deriveKeys(chainId as Hex);\n        const isEnabled = this.state.enabledNetworkMap[namespace]?.[storageKey];\n        return isEnabled ? count + 1 : count;\n      },\n      0,\n    );\n\n    // Return true if more than 2 popular networks are enabled\n    return enabledPopularNetworksCount > 1;\n  }\n\n  /**\n   * Removes a network entry from the state.\n   *\n   * This method is called when a network is removed from the system. It cleans up\n   * the network entry from both enabledNetworkMap and nativeAssetIdentifiers, and ensures that\n   * at least one network remains enabled.\n   *\n   * @param chainId - The chain ID to remove (Hex or CAIP-2 format)\n   */\n  #removeNetworkEntry(chainId: Hex | CaipChainId): void {\n    const derivedKeys = deriveKeys(chainId);\n    const { namespace, storageKey, caipChainId } = derivedKeys;\n\n    this.update((state) => {\n      // fallback and enable ethereum mainnet\n      if (isOnlyNetworkEnabledInNamespace(this.state, derivedKeys)) {\n        state.enabledNetworkMap[namespace][\n          ChainId[BuiltInNetworkName.Mainnet]\n        ] = true;\n      }\n\n      if (namespace in state.enabledNetworkMap) {\n        delete state.enabledNetworkMap[namespace][storageKey];\n      }\n\n      // Remove from nativeAssetIdentifiers as well\n      delete state.nativeAssetIdentifiers[caipChainId];\n    });\n  }\n\n  /**\n   * Handles the addition of a new EVM network to the controller.\n   *\n   * @param chainId - The chain ID to add (Hex format)\n   *\n   * @description\n   * - If in popular networks mode (>2 popular networks enabled) AND adding a popular network:\n   * - Keep current selection (add but don't enable the new network)\n   * - Otherwise:\n   * - Switch to the newly added network (disable all others, enable this one)\n   * - Also updates the nativeAssetIdentifiers with the CAIP-19-like identifier\n   */\n  async #onAddNetwork(chainId: Hex): Promise<void> {\n    const { namespace, storageKey, reference, caipChainId } =\n      deriveKeys(chainId);\n\n    // Parse reference (decimal string from CAIP-2) to number for chainid.network lookup\n    const numericChainId = parseInt(reference, 10);\n\n    // EVM networks: use getEvmSlip44 (chainid.network data)\n    const slip44CoinType = await Slip44Service.getEvmSlip44(numericChainId);\n\n    this.update((state) => {\n      // Ensure the namespace bucket exists\n      this.#ensureNamespaceBucket(state, namespace);\n\n      // Check if popular networks mode is active (>2 popular networks enabled)\n      const inPopularNetworksMode = this.#isInPopularNetworksMode();\n\n      // Check if the network being added is a popular network\n      const isAddedNetworkPopular = isPopularNetwork(reference);\n\n      // Keep current selection only if in popular networks mode AND adding a popular network\n      const shouldKeepCurrentSelection =\n        inPopularNetworksMode && isAddedNetworkPopular;\n\n      if (shouldKeepCurrentSelection) {\n        // Add the popular network but don't enable it (keep current selection)\n        state.enabledNetworkMap[namespace][storageKey] = true;\n      } else {\n        // Switch to the newly added network (disable all others, enable this one)\n        Object.keys(state.enabledNetworkMap).forEach((ns) => {\n          Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {\n            state.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;\n          });\n        });\n        // Enable the newly added network\n        state.enabledNetworkMap[namespace][storageKey] = true;\n      }\n\n      // Update nativeAssetIdentifiers with the CAIP-19-like identifier\n      state.nativeAssetIdentifiers[caipChainId] = buildNativeAssetIdentifier(\n        caipChainId,\n        slip44CoinType,\n      );\n    });\n  }\n}\n"]}
\ No newline at end of file
diff --git a/dist/constants.cjs b/dist/constants.cjs
index d45d861dd20777a9c767ef6a4272d0b4fd53f895..5ddc5f772d0948e1b13cb34d5366535eb24d3c96 100644
--- a/dist/constants.cjs
+++ b/dist/constants.cjs
@@ -2,18 +2,25 @@
 Object.defineProperty(exports, "__esModule", { value: true });
 exports.POPULAR_NETWORKS = void 0;
 exports.POPULAR_NETWORKS = [
-    '0x1',
-    '0xe708',
-    '0x2105',
-    '0xa4b1',
-    '0xa86a',
-    '0x38',
-    '0xa',
-    '0x89',
-    '0x531',
-    '0x144',
-    '0x2a15c308d',
-    '0x3e7',
+    '0x1', // Ethereum Mainnet
+    '0xe708', // Linea (59144)
+    '0x2105', // Base (8453)
+    '0xa4b1', // Arbitrum One (42161)
+    '0xa86a', // Avalanche C-Chain (43114)
+    '0x38', // BNB Smart Chain (56)
+    '0xa', // Optimism (10)
+    '0x89', // Polygon (137)
+    '0x531', // Sei (Assuming 1329 used in EVM context)
+    '0x144', // zkSync Era (324)
+    '0x2a15c308d', // Palm (11297108109)
+    '0x3e7', // HyperEVM (999)
     '0x8f', // Monad (143)
+    '0x10e6', // MegaETH (4326)
+    // Environment 3: Power User test networks (25 total)
+    '0xfa', // Fantom Opera (250)
+    '0x64', // Gnosis (100)
+    '0x19', // Cronos (25)
+    '0x504', // Moonbeam (1284)
+    '0x505', // Moonriver (1285)
 ];
 //# sourceMappingURL=constants.cjs.map
\ No newline at end of file
diff --git a/dist/constants.cjs.map b/dist/constants.cjs.map
index 92b2b9be006aa6110700d765e0d6e0f9ace32169..2a76267d1f5f1f6cb73f9fa6eb2d79589f5be081 100644
--- a/dist/constants.cjs.map
+++ b/dist/constants.cjs.map
@@ -1 +1 @@
-{"version":3,"file":"constants.cjs","sourceRoot":"","sources":["../src/constants.ts"],"names":[],"mappings":";;;AAAa,QAAA,gBAAgB,GAAG;IAC9B,KAAK;IACL,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,MAAM;IACN,KAAK;IACL,MAAM;IACN,OAAO;IACP,OAAO;IACP,aAAa;IACb,OAAO;IACP,MAAM,EAAE,cAAc;CACvB,CAAC","sourcesContent":["export const POPULAR_NETWORKS = [\n  '0x1', // Ethereum Mainnet\n  '0xe708', // Linea (59144)\n  '0x2105', // Base (8453)\n  '0xa4b1', // Arbitrum One (42161)\n  '0xa86a', // Avalanche C-Chain (43114)\n  '0x38', // BNB Smart Chain (56)\n  '0xa', // Optimism (10)\n  '0x89', // Polygon (137)\n  '0x531', // Sei (Assuming 1329 used in EVM context)\n  '0x144', // zkSync Era (324)\n  '0x2a15c308d', // Palm (11297108109)\n  '0x3e7', // HyperEVM (999)\n  '0x8f', // Monad (143)\n];\n"]}
\ No newline at end of file
+{"version":3,"file":"constants.cjs","sourceRoot":"","sources":["../src/constants.ts"],"names":[],"mappings":";;;AAAa,QAAA,gBAAgB,GAAG;IAC9B,KAAK,EAAE,mBAAmB;IAC1B,QAAQ,EAAE,gBAAgB;IAC1B,QAAQ,EAAE,cAAc;IACxB,QAAQ,EAAE,uBAAuB;IACjC,QAAQ,EAAE,4BAA4B;IACtC,MAAM,EAAE,uBAAuB;IAC/B,KAAK,EAAE,gBAAgB;IACvB,MAAM,EAAE,gBAAgB;IACxB,OAAO,EAAE,0CAA0C;IACnD,OAAO,EAAE,mBAAmB;IAC5B,aAAa,EAAE,qBAAqB;IACpC,OAAO,EAAE,iBAAiB;IAC1B,MAAM,EAAE,cAAc;IACtB,QAAQ,EAAE,iBAAiB;IAC3B,qDAAqD;IACrD,MAAM,EAAE,qBAAqB;IAC7B,MAAM,EAAE,eAAe;IACvB,MAAM,EAAE,cAAc;IACtB,OAAO,EAAE,kBAAkB;IAC3B,OAAO,EAAE,mBAAmB;CAC7B,CAAC","sourcesContent":["export const POPULAR_NETWORKS = [\n  '0x1', // Ethereum Mainnet\n  '0xe708', // Linea (59144)\n  '0x2105', // Base (8453)\n  '0xa4b1', // Arbitrum One (42161)\n  '0xa86a', // Avalanche C-Chain (43114)\n  '0x38', // BNB Smart Chain (56)\n  '0xa', // Optimism (10)\n  '0x89', // Polygon (137)\n  '0x531', // Sei (Assuming 1329 used in EVM context)\n  '0x144', // zkSync Era (324)\n  '0x2a15c308d', // Palm (11297108109)\n  '0x3e7', // HyperEVM (999)\n  '0x8f', // Monad (143)\n  '0x10e6', // MegaETH (4326)\n  // Environment 3: Power User test networks (25 total)\n  '0xfa', // Fantom Opera (250)\n  '0x64', // Gnosis (100)\n  '0x19', // Cronos (25)\n  '0x504', // Moonbeam (1284)\n  '0x505', // Moonriver (1285)\n];\n"]}
\ No newline at end of file
diff --git a/dist/constants.d.cts.map b/dist/constants.d.cts.map
index 5b7ce36f03b6405a4c74100bc18efbbcf126a1e5..aead7db7c2b8145d8aa32fdaf0c9036f4fa3785f 100644
--- a/dist/constants.d.cts.map
+++ b/dist/constants.d.cts.map
@@ -1 +1 @@
-{"version":3,"file":"constants.d.cts","sourceRoot":"","sources":["../src/constants.ts"],"names":[],"mappings":"AAAA,eAAO,MAAM,gBAAgB,UAc5B,CAAC"}
\ No newline at end of file
+{"version":3,"file":"constants.d.cts","sourceRoot":"","sources":["../src/constants.ts"],"names":[],"mappings":"AAAA,eAAO,MAAM,gBAAgB,UAqB5B,CAAC"}
\ No newline at end of file
diff --git a/dist/constants.d.mts.map b/dist/constants.d.mts.map
index feed158293ac264ddf2c05f42abbd97fa38381b9..22226a7336342e95f09948906785f23ce35cb317 100644
--- a/dist/constants.d.mts.map
+++ b/dist/constants.d.mts.map
@@ -1 +1 @@
-{"version":3,"file":"constants.d.mts","sourceRoot":"","sources":["../src/constants.ts"],"names":[],"mappings":"AAAA,eAAO,MAAM,gBAAgB,UAc5B,CAAC"}
\ No newline at end of file
+{"version":3,"file":"constants.d.mts","sourceRoot":"","sources":["../src/constants.ts"],"names":[],"mappings":"AAAA,eAAO,MAAM,gBAAgB,UAqB5B,CAAC"}
\ No newline at end of file
diff --git a/dist/constants.mjs b/dist/constants.mjs
index 2631e864148964ade93979ab4b17e936865288c7..fead0535831a3fa6489d86252d29e72292464ea9 100644
--- a/dist/constants.mjs
+++ b/dist/constants.mjs
@@ -1,16 +1,23 @@
 export const POPULAR_NETWORKS = [
-    '0x1',
-    '0xe708',
-    '0x2105',
-    '0xa4b1',
-    '0xa86a',
-    '0x38',
-    '0xa',
-    '0x89',
-    '0x531',
-    '0x144',
-    '0x2a15c308d',
-    '0x3e7',
+    '0x1', // Ethereum Mainnet
+    '0xe708', // Linea (59144)
+    '0x2105', // Base (8453)
+    '0xa4b1', // Arbitrum One (42161)
+    '0xa86a', // Avalanche C-Chain (43114)
+    '0x38', // BNB Smart Chain (56)
+    '0xa', // Optimism (10)
+    '0x89', // Polygon (137)
+    '0x531', // Sei (Assuming 1329 used in EVM context)
+    '0x144', // zkSync Era (324)
+    '0x2a15c308d', // Palm (11297108109)
+    '0x3e7', // HyperEVM (999)
     '0x8f', // Monad (143)
+    '0x10e6', // MegaETH (4326)
+    // Environment 3: Power User test networks (25 total)
+    '0xfa', // Fantom Opera (250)
+    '0x64', // Gnosis (100)
+    '0x19', // Cronos (25)
+    '0x504', // Moonbeam (1284)
+    '0x505', // Moonriver (1285)
 ];
 //# sourceMappingURL=constants.mjs.map
\ No newline at end of file
diff --git a/dist/constants.mjs.map b/dist/constants.mjs.map
index 57b316c53cddf757c78d59e33a48b64deb50c172..3886cc808328ee32b5e44b5d5c8070771cc05707 100644
--- a/dist/constants.mjs.map
+++ b/dist/constants.mjs.map
@@ -1 +1 @@
-{"version":3,"file":"constants.mjs","sourceRoot":"","sources":["../src/constants.ts"],"names":[],"mappings":"AAAA,MAAM,CAAC,MAAM,gBAAgB,GAAG;IAC9B,KAAK;IACL,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,MAAM;IACN,KAAK;IACL,MAAM;IACN,OAAO;IACP,OAAO;IACP,aAAa;IACb,OAAO;IACP,MAAM,EAAE,cAAc;CACvB,CAAC","sourcesContent":["export const POPULAR_NETWORKS = [\n  '0x1', // Ethereum Mainnet\n  '0xe708', // Linea (59144)\n  '0x2105', // Base (8453)\n  '0xa4b1', // Arbitrum One (42161)\n  '0xa86a', // Avalanche C-Chain (43114)\n  '0x38', // BNB Smart Chain (56)\n  '0xa', // Optimism (10)\n  '0x89', // Polygon (137)\n  '0x531', // Sei (Assuming 1329 used in EVM context)\n  '0x144', // zkSync Era (324)\n  '0x2a15c308d', // Palm (11297108109)\n  '0x3e7', // HyperEVM (999)\n  '0x8f', // Monad (143)\n];\n"]}
\ No newline at end of file
+{"version":3,"file":"constants.mjs","sourceRoot":"","sources":["../src/constants.ts"],"names":[],"mappings":"AAAA,MAAM,CAAC,MAAM,gBAAgB,GAAG;IAC9B,KAAK,EAAE,mBAAmB;IAC1B,QAAQ,EAAE,gBAAgB;IAC1B,QAAQ,EAAE,cAAc;IACxB,QAAQ,EAAE,uBAAuB;IACjC,QAAQ,EAAE,4BAA4B;IACtC,MAAM,EAAE,uBAAuB;IAC/B,KAAK,EAAE,gBAAgB;IACvB,MAAM,EAAE,gBAAgB;IACxB,OAAO,EAAE,0CAA0C;IACnD,OAAO,EAAE,mBAAmB;IAC5B,aAAa,EAAE,qBAAqB;IACpC,OAAO,EAAE,iBAAiB;IAC1B,MAAM,EAAE,cAAc;IACtB,QAAQ,EAAE,iBAAiB;IAC3B,qDAAqD;IACrD,MAAM,EAAE,qBAAqB;IAC7B,MAAM,EAAE,eAAe;IACvB,MAAM,EAAE,cAAc;IACtB,OAAO,EAAE,kBAAkB;IAC3B,OAAO,EAAE,mBAAmB;CAC7B,CAAC","sourcesContent":["export const POPULAR_NETWORKS = [\n  '0x1', // Ethereum Mainnet\n  '0xe708', // Linea (59144)\n  '0x2105', // Base (8453)\n  '0xa4b1', // Arbitrum One (42161)\n  '0xa86a', // Avalanche C-Chain (43114)\n  '0x38', // BNB Smart Chain (56)\n  '0xa', // Optimism (10)\n  '0x89', // Polygon (137)\n  '0x531', // Sei (Assuming 1329 used in EVM context)\n  '0x144', // zkSync Era (324)\n  '0x2a15c308d', // Palm (11297108109)\n  '0x3e7', // HyperEVM (999)\n  '0x8f', // Monad (143)\n  '0x10e6', // MegaETH (4326)\n  // Environment 3: Power User test networks (25 total)\n  '0xfa', // Fantom Opera (250)\n  '0x64', // Gnosis (100)\n  '0x19', // Cronos (25)\n  '0x504', // Moonbeam (1284)\n  '0x505', // Moonriver (1285)\n];\n"]}
\ No newline at end of file
diff --git a/dist/index.cjs b/dist/index.cjs
index 092a998d9d68656edd350d17c1aa33700f83aa4b..3b6e48e64dfd4c2365468f8699b3eacd7321535f 100644
--- a/dist/index.cjs
+++ b/dist/index.cjs
@@ -1,6 +1,6 @@
 "use strict";
 Object.defineProperty(exports, "__esModule", { value: true });
-exports.selectEnabledSolanaNetworks = exports.selectEnabledEvmNetworks = exports.selectEnabledNetworksCount = exports.selectAllEnabledNetworks = exports.createSelectorForEnabledNetworksForNamespace = exports.selectIsNetworkEnabled = exports.selectEnabledNetworkMap = exports.NetworkEnablementController = void 0;
+exports.getSlip44BySymbol = exports.getEvmSlip44 = exports.Slip44Service = exports.selectEnabledSolanaNetworks = exports.selectEnabledEvmNetworks = exports.selectEnabledNetworksCount = exports.selectAllEnabledNetworks = exports.createSelectorForEnabledNetworksForNamespace = exports.selectIsNetworkEnabled = exports.selectEnabledNetworkMap = exports.NetworkEnablementController = void 0;
 var NetworkEnablementController_1 = require("./NetworkEnablementController.cjs");
 Object.defineProperty(exports, "NetworkEnablementController", { enumerable: true, get: function () { return NetworkEnablementController_1.NetworkEnablementController; } });
 var selectors_1 = require("./selectors.cjs");
@@ -11,4 +11,8 @@ Object.defineProperty(exports, "selectAllEnabledNetworks", { enumerable: true, g
 Object.defineProperty(exports, "selectEnabledNetworksCount", { enumerable: true, get: function () { return selectors_1.selectEnabledNetworksCount; } });
 Object.defineProperty(exports, "selectEnabledEvmNetworks", { enumerable: true, get: function () { return selectors_1.selectEnabledEvmNetworks; } });
 Object.defineProperty(exports, "selectEnabledSolanaNetworks", { enumerable: true, get: function () { return selectors_1.selectEnabledSolanaNetworks; } });
+var services_1 = require("./services/index.cjs");
+Object.defineProperty(exports, "Slip44Service", { enumerable: true, get: function () { return services_1.Slip44Service; } });
+Object.defineProperty(exports, "getEvmSlip44", { enumerable: true, get: function () { return services_1.getEvmSlip44; } });
+Object.defineProperty(exports, "getSlip44BySymbol", { enumerable: true, get: function () { return services_1.getSlip44BySymbol; } });
 //# sourceMappingURL=index.cjs.map
\ No newline at end of file
diff --git a/dist/index.cjs.map b/dist/index.cjs.map
index f41e878084f4243c4a43de9d4adb96a66d882acb..3e0fbc53a6fcd2fcdcca497e2a30d99954afdc0d 100644
--- a/dist/index.cjs.map
+++ b/dist/index.cjs.map
@@ -1 +1 @@
-{"version":3,"file":"index.cjs","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":";;;AAAA,iFAA4E;AAAnE,0IAAA,2BAA2B,OAAA;AAUpC,6CAQqB;AAPnB,oHAAA,uBAAuB,OAAA;AACvB,mHAAA,sBAAsB,OAAA;AACtB,yIAAA,4CAA4C,OAAA;AAC5C,qHAAA,wBAAwB,OAAA;AACxB,uHAAA,0BAA0B,OAAA;AAC1B,qHAAA,wBAAwB,OAAA;AACxB,wHAAA,2BAA2B,OAAA","sourcesContent":["export { NetworkEnablementController } from './NetworkEnablementController';\n\nexport type {\n  NetworkEnablementControllerState,\n  NetworkEnablementControllerGetStateAction,\n  NetworkEnablementControllerActions,\n  NetworkEnablementControllerEvents,\n  NetworkEnablementControllerMessenger,\n} from './NetworkEnablementController';\n\nexport {\n  selectEnabledNetworkMap,\n  selectIsNetworkEnabled,\n  createSelectorForEnabledNetworksForNamespace,\n  selectAllEnabledNetworks,\n  selectEnabledNetworksCount,\n  selectEnabledEvmNetworks,\n  selectEnabledSolanaNetworks,\n} from './selectors';\n"]}
\ No newline at end of file
+{"version":3,"file":"index.cjs","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":";;;AAAA,iFAA4E;AAAnE,0IAAA,2BAA2B,OAAA;AAapC,6CAQqB;AAPnB,oHAAA,uBAAuB,OAAA;AACvB,mHAAA,sBAAsB,OAAA;AACtB,yIAAA,4CAA4C,OAAA;AAC5C,qHAAA,wBAAwB,OAAA;AACxB,uHAAA,0BAA0B,OAAA;AAC1B,qHAAA,wBAAwB,OAAA;AACxB,wHAAA,2BAA2B,OAAA;AAG7B,iDAA4E;AAAnE,yGAAA,aAAa,OAAA;AAAE,wGAAA,YAAY,OAAA;AAAE,6GAAA,iBAAiB,OAAA","sourcesContent":["export { NetworkEnablementController } from './NetworkEnablementController';\n\nexport type {\n  NetworkEnablementControllerState,\n  NetworkEnablementControllerGetStateAction,\n  NetworkEnablementControllerActions,\n  NetworkEnablementControllerEvents,\n  NetworkEnablementControllerMessenger,\n  NativeAssetIdentifier,\n  NativeAssetIdentifiersMap,\n  NetworkConfig,\n} from './NetworkEnablementController';\n\nexport {\n  selectEnabledNetworkMap,\n  selectIsNetworkEnabled,\n  createSelectorForEnabledNetworksForNamespace,\n  selectAllEnabledNetworks,\n  selectEnabledNetworksCount,\n  selectEnabledEvmNetworks,\n  selectEnabledSolanaNetworks,\n} from './selectors';\n\nexport { Slip44Service, getEvmSlip44, getSlip44BySymbol } from './services';\n"]}
\ No newline at end of file
diff --git a/dist/index.d.cts b/dist/index.d.cts
index 60f1262cdcddfb68c80b56e22e2db1fa436d1a22..4015aea6e8d7fdaa1048c5320d62ca9152cd1be9 100644
--- a/dist/index.d.cts
+++ b/dist/index.d.cts
@@ -1,4 +1,5 @@
 export { NetworkEnablementController } from "./NetworkEnablementController.cjs";
-export type { NetworkEnablementControllerState, NetworkEnablementControllerGetStateAction, NetworkEnablementControllerActions, NetworkEnablementControllerEvents, NetworkEnablementControllerMessenger, } from "./NetworkEnablementController.cjs";
+export type { NetworkEnablementControllerState, NetworkEnablementControllerGetStateAction, NetworkEnablementControllerActions, NetworkEnablementControllerEvents, NetworkEnablementControllerMessenger, NativeAssetIdentifier, NativeAssetIdentifiersMap, NetworkConfig, } from "./NetworkEnablementController.cjs";
 export { selectEnabledNetworkMap, selectIsNetworkEnabled, createSelectorForEnabledNetworksForNamespace, selectAllEnabledNetworks, selectEnabledNetworksCount, selectEnabledEvmNetworks, selectEnabledSolanaNetworks, } from "./selectors.cjs";
+export { Slip44Service, getEvmSlip44, getSlip44BySymbol } from "./services/index.cjs";
 //# sourceMappingURL=index.d.cts.map
\ No newline at end of file
diff --git a/dist/index.d.cts.map b/dist/index.d.cts.map
index bfb5195ef32d1fc4047670f6a0c525e49fcc4e3e..b51330964f446069d4be4c29344a3b2f8e081d95 100644
--- a/dist/index.d.cts.map
+++ b/dist/index.d.cts.map
@@ -1 +1 @@
-{"version":3,"file":"index.d.cts","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,2BAA2B,EAAE,0CAAsC;AAE5E,YAAY,EACV,gCAAgC,EAChC,yCAAyC,EACzC,kCAAkC,EAClC,iCAAiC,EACjC,oCAAoC,GACrC,0CAAsC;AAEvC,OAAO,EACL,uBAAuB,EACvB,sBAAsB,EACtB,4CAA4C,EAC5C,wBAAwB,EACxB,0BAA0B,EAC1B,wBAAwB,EACxB,2BAA2B,GAC5B,wBAAoB"}
\ No newline at end of file
+{"version":3,"file":"index.d.cts","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,2BAA2B,EAAE,0CAAsC;AAE5E,YAAY,EACV,gCAAgC,EAChC,yCAAyC,EACzC,kCAAkC,EAClC,iCAAiC,EACjC,oCAAoC,EACpC,qBAAqB,EACrB,yBAAyB,EACzB,aAAa,GACd,0CAAsC;AAEvC,OAAO,EACL,uBAAuB,EACvB,sBAAsB,EACtB,4CAA4C,EAC5C,wBAAwB,EACxB,0BAA0B,EAC1B,wBAAwB,EACxB,2BAA2B,GAC5B,wBAAoB;AAErB,OAAO,EAAE,aAAa,EAAE,YAAY,EAAE,iBAAiB,EAAE,6BAAmB"}
\ No newline at end of file
diff --git a/dist/index.d.mts b/dist/index.d.mts
index a9c2578b75338c0ab6214d33bba53ee78fc7adf6..c3283481c4a58a99e370a89715cc19527d25cfcc 100644
--- a/dist/index.d.mts
+++ b/dist/index.d.mts
@@ -1,4 +1,5 @@
 export { NetworkEnablementController } from "./NetworkEnablementController.mjs";
-export type { NetworkEnablementControllerState, NetworkEnablementControllerGetStateAction, NetworkEnablementControllerActions, NetworkEnablementControllerEvents, NetworkEnablementControllerMessenger, } from "./NetworkEnablementController.mjs";
+export type { NetworkEnablementControllerState, NetworkEnablementControllerGetStateAction, NetworkEnablementControllerActions, NetworkEnablementControllerEvents, NetworkEnablementControllerMessenger, NativeAssetIdentifier, NativeAssetIdentifiersMap, NetworkConfig, } from "./NetworkEnablementController.mjs";
 export { selectEnabledNetworkMap, selectIsNetworkEnabled, createSelectorForEnabledNetworksForNamespace, selectAllEnabledNetworks, selectEnabledNetworksCount, selectEnabledEvmNetworks, selectEnabledSolanaNetworks, } from "./selectors.mjs";
+export { Slip44Service, getEvmSlip44, getSlip44BySymbol } from "./services/index.mjs";
 //# sourceMappingURL=index.d.mts.map
\ No newline at end of file
diff --git a/dist/index.d.mts.map b/dist/index.d.mts.map
index 0002aa5effc5f5d8ef7fb3dd989a497efd8f099d..93fff368eb718f0c65e39cd3d20b749f1b5d5735 100644
--- a/dist/index.d.mts.map
+++ b/dist/index.d.mts.map
@@ -1 +1 @@
-{"version":3,"file":"index.d.mts","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,2BAA2B,EAAE,0CAAsC;AAE5E,YAAY,EACV,gCAAgC,EAChC,yCAAyC,EACzC,kCAAkC,EAClC,iCAAiC,EACjC,oCAAoC,GACrC,0CAAsC;AAEvC,OAAO,EACL,uBAAuB,EACvB,sBAAsB,EACtB,4CAA4C,EAC5C,wBAAwB,EACxB,0BAA0B,EAC1B,wBAAwB,EACxB,2BAA2B,GAC5B,wBAAoB"}
\ No newline at end of file
+{"version":3,"file":"index.d.mts","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,2BAA2B,EAAE,0CAAsC;AAE5E,YAAY,EACV,gCAAgC,EAChC,yCAAyC,EACzC,kCAAkC,EAClC,iCAAiC,EACjC,oCAAoC,EACpC,qBAAqB,EACrB,yBAAyB,EACzB,aAAa,GACd,0CAAsC;AAEvC,OAAO,EACL,uBAAuB,EACvB,sBAAsB,EACtB,4CAA4C,EAC5C,wBAAwB,EACxB,0BAA0B,EAC1B,wBAAwB,EACxB,2BAA2B,GAC5B,wBAAoB;AAErB,OAAO,EAAE,aAAa,EAAE,YAAY,EAAE,iBAAiB,EAAE,6BAAmB"}
\ No newline at end of file
diff --git a/dist/index.mjs b/dist/index.mjs
index e4ad0e28bac9c5227d84380f2887bc7e8e4b701a..03101c367829ef6f179d09f12f8cb5708d8dbbbd 100644
--- a/dist/index.mjs
+++ b/dist/index.mjs
@@ -1,3 +1,4 @@
 export { NetworkEnablementController } from "./NetworkEnablementController.mjs";
 export { selectEnabledNetworkMap, selectIsNetworkEnabled, createSelectorForEnabledNetworksForNamespace, selectAllEnabledNetworks, selectEnabledNetworksCount, selectEnabledEvmNetworks, selectEnabledSolanaNetworks } from "./selectors.mjs";
+export { Slip44Service, getEvmSlip44, getSlip44BySymbol } from "./services/index.mjs";
 //# sourceMappingURL=index.mjs.map
\ No newline at end of file
diff --git a/dist/index.mjs.map b/dist/index.mjs.map
index ae3d924ba8af720221c59978007ecf6f823a8fb7..1efc21f1fd5741e624b31da5cf32360a302a5e01 100644
--- a/dist/index.mjs.map
+++ b/dist/index.mjs.map
@@ -1 +1 @@
-{"version":3,"file":"index.mjs","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,2BAA2B,EAAE,0CAAsC;AAU5E,OAAO,EACL,uBAAuB,EACvB,sBAAsB,EACtB,4CAA4C,EAC5C,wBAAwB,EACxB,0BAA0B,EAC1B,wBAAwB,EACxB,2BAA2B,EAC5B,wBAAoB","sourcesContent":["export { NetworkEnablementController } from './NetworkEnablementController';\n\nexport type {\n  NetworkEnablementControllerState,\n  NetworkEnablementControllerGetStateAction,\n  NetworkEnablementControllerActions,\n  NetworkEnablementControllerEvents,\n  NetworkEnablementControllerMessenger,\n} from './NetworkEnablementController';\n\nexport {\n  selectEnabledNetworkMap,\n  selectIsNetworkEnabled,\n  createSelectorForEnabledNetworksForNamespace,\n  selectAllEnabledNetworks,\n  selectEnabledNetworksCount,\n  selectEnabledEvmNetworks,\n  selectEnabledSolanaNetworks,\n} from './selectors';\n"]}
\ No newline at end of file
+{"version":3,"file":"index.mjs","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,2BAA2B,EAAE,0CAAsC;AAa5E,OAAO,EACL,uBAAuB,EACvB,sBAAsB,EACtB,4CAA4C,EAC5C,wBAAwB,EACxB,0BAA0B,EAC1B,wBAAwB,EACxB,2BAA2B,EAC5B,wBAAoB;AAErB,OAAO,EAAE,aAAa,EAAE,YAAY,EAAE,iBAAiB,EAAE,6BAAmB","sourcesContent":["export { NetworkEnablementController } from './NetworkEnablementController';\n\nexport type {\n  NetworkEnablementControllerState,\n  NetworkEnablementControllerGetStateAction,\n  NetworkEnablementControllerActions,\n  NetworkEnablementControllerEvents,\n  NetworkEnablementControllerMessenger,\n  NativeAssetIdentifier,\n  NativeAssetIdentifiersMap,\n  NetworkConfig,\n} from './NetworkEnablementController';\n\nexport {\n  selectEnabledNetworkMap,\n  selectIsNetworkEnabled,\n  createSelectorForEnabledNetworksForNamespace,\n  selectAllEnabledNetworks,\n  selectEnabledNetworksCount,\n  selectEnabledEvmNetworks,\n  selectEnabledSolanaNetworks,\n} from './selectors';\n\nexport { Slip44Service, getEvmSlip44, getSlip44BySymbol } from './services';\n"]}
\ No newline at end of file
diff --git a/dist/selectors.cjs.map b/dist/selectors.cjs.map
index b02aa11d08c743b47d24e5c072be8e30b41a5b5d..ae25153fcfb89c05c59b08ebc28dfd660b35f7c7 100644
--- a/dist/selectors.cjs.map
+++ b/dist/selectors.cjs.map
@@ -1 +1 @@
-{"version":3,"file":"selectors.cjs","sourceRoot":"","sources":["../src/selectors.ts"],"names":[],"mappings":";;;AACA,2CAAqD;AACrD,uCAA0C;AAG1C,uCAAqC;AAErC;;;;;GAKG;AACI,MAAM,uBAAuB,GAAG,CACrC,KAAuC,EACvC,EAAE,CAAC,KAAK,CAAC,iBAAiB,CAAC;AAFhB,QAAA,uBAAuB,2BAEP;AAE7B;;;;;;;;;GASG;AACI,MAAM,sBAAsB,GAAG,CAAC,OAA0B,EAAE,EAAE,CACnE,IAAA,yBAAc,EAAC,+BAAuB,EAAE,CAAC,iBAAiB,EAAE,EAAE;IAC5D,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,IAAA,kBAAU,EAAC,OAAO,CAAC,CAAC;IAEtD,OAAO,CACL,SAAS,IAAI,iBAAiB;QAC9B,UAAU,IAAI,iBAAiB,CAAC,SAAS,CAAC;QAC1C,iBAAiB,CAAC,SAAS,CAAC,CAAC,UAAU,CAAC,CACzC,CAAC;AACJ,CAAC,CAAC,CAAC;AATQ,QAAA,sBAAsB,0BAS9B;AAEL;;;;;;;;GAQG;AACI,MAAM,4CAA4C,GAAG,CAC1D,SAAwB,EACxB,EAAE,CACF,IAAA,yBAAc,EAAC,+BAAuB,EAAE,CAAC,iBAAiB,EAAE,EAAE;IAC5D,OAAO,MAAM,CAAC,OAAO,CAAC,iBAAiB,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;SACtD,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC;SAChC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;AACvB,CAAC,CAAC,CAAC;AAPQ,QAAA,4CAA4C,gDAOpD;AAEL;;;;;;;GAOG;AACU,QAAA,wBAAwB,GAAG,IAAA,yBAAc,EACpD,+BAAuB,EACvB,CAAC,iBAAiB,EAAE,EAAE;IACpB,OAAQ,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAqB,CAAC,MAAM,CAC/D,CAAC,GAAG,EAAE,EAAE,EAAE,EAAE;QACV,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;aAC5C,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC;aAChC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;QACrB,OAAO,GAAG,CAAC;IACb,CAAC,EACD,EAAqC,CACtC,CAAC;AACJ,CAAC,CACF,CAAC;AAEF;;;;GAIG;AACU,QAAA,0BAA0B,GAAG,IAAA,yBAAc,EACtD,gCAAwB,EACxB,CAAC,kBAAkB,EAAE,EAAE;IACrB,OAAO,MAAM,CAAC,MAAM,CAAC,kBAAkB,CAAC,CAAC,IAAI,EAAE,CAAC,MAAM,CAAC;AACzD,CAAC,CACF,CAAC;AAEF;;;;;;GAMG;AACU,QAAA,wBAAwB,GAAG,IAAA,yBAAc,EACpD,IAAA,oDAA4C,EAAC,0BAAkB,CAAC,MAAM,CAAC,EACvE,CAAC,kBAAkB,EAAE,EAAE,CAAC,kBAAkB,CAC3C,CAAC;AAEF;;;;;;GAMG;AACU,QAAA,2BAA2B,GAAG,IAAA,yBAAc,EACvD,IAAA,oDAA4C,EAAC,0BAAkB,CAAC,MAAM,CAAC,EACvE,CAAC,qBAAqB,EAAE,EAAE,CAAC,qBAAqB,CACjD,CAAC","sourcesContent":["import type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';\nimport { KnownCaipNamespace } from '@metamask/utils';\nimport { createSelector } from 'reselect';\n\nimport type { NetworkEnablementControllerState } from './NetworkEnablementController';\nimport { deriveKeys } from './utils';\n\n/**\n * Base selector to get the enabled network map from the controller state.\n *\n * @param state - The NetworkEnablementController state\n * @returns The enabled network map\n */\nexport const selectEnabledNetworkMap = (\n  state: NetworkEnablementControllerState,\n) => state.enabledNetworkMap;\n\n/**\n * Selector to check if a specific network is enabled.\n *\n * This selector accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n * (for any blockchain network) and returns whether the network is currently enabled.\n * It returns false for unknown networks or if there's an error parsing the chain ID.\n *\n * @param chainId - The chain ID to check (Hex or CAIP-2 format)\n * @returns A selector function that returns true if the network is enabled, false otherwise\n */\nexport const selectIsNetworkEnabled = (chainId: Hex | CaipChainId) =>\n  createSelector(selectEnabledNetworkMap, (enabledNetworkMap) => {\n    const { namespace, storageKey } = deriveKeys(chainId);\n\n    return (\n      namespace in enabledNetworkMap &&\n      storageKey in enabledNetworkMap[namespace] &&\n      enabledNetworkMap[namespace][storageKey]\n    );\n  });\n\n/**\n * Selector builder to get all enabled networks for a specific namespace.\n *\n * The selector returned by this function returns an array of chain IDs (as strings) for all enabled networks\n * within the specified namespace (e.g., 'eip155' for EVM networks, 'solana' for Solana).\n *\n * @param namespace - The CAIP namespace to get enabled networks for (e.g., 'eip155', 'solana')\n * @returns A selector function that returns an array of chain ID strings for enabled networks in the namespace\n */\nexport const createSelectorForEnabledNetworksForNamespace = (\n  namespace: CaipNamespace,\n) =>\n  createSelector(selectEnabledNetworkMap, (enabledNetworkMap) => {\n    return Object.entries(enabledNetworkMap[namespace] ?? {})\n      .filter(([, enabled]) => enabled)\n      .map(([id]) => id);\n  });\n\n/**\n * Selector to get all enabled networks across all namespaces.\n *\n * This selector returns a record where keys are CAIP namespaces and values are arrays\n * of enabled chain IDs within each namespace.\n *\n * @returns A selector function that returns a record mapping namespace to array of enabled chain IDs\n */\nexport const selectAllEnabledNetworks = createSelector(\n  selectEnabledNetworkMap,\n  (enabledNetworkMap) => {\n    return (Object.keys(enabledNetworkMap) as CaipNamespace[]).reduce(\n      (acc, ns) => {\n        acc[ns] = Object.entries(enabledNetworkMap[ns])\n          .filter(([, enabled]) => enabled)\n          .map(([id]) => id);\n        return acc;\n      },\n      {} as Record<CaipNamespace, string[]>,\n    );\n  },\n);\n\n/**\n * Selector to get the total count of enabled networks across all namespaces.\n *\n * @returns A selector function that returns the total number of enabled networks\n */\nexport const selectEnabledNetworksCount = createSelector(\n  selectAllEnabledNetworks,\n  (allEnabledNetworks) => {\n    return Object.values(allEnabledNetworks).flat().length;\n  },\n);\n\n/**\n * Selector to get all enabled EVM networks.\n *\n * This is a convenience selector that specifically targets EIP-155 networks.\n *\n * @returns A selector function that returns an array of enabled EVM chain IDs\n */\nexport const selectEnabledEvmNetworks = createSelector(\n  createSelectorForEnabledNetworksForNamespace(KnownCaipNamespace.Eip155),\n  (enabledEvmNetworks) => enabledEvmNetworks,\n);\n\n/**\n * Selector to get all enabled Solana networks.\n *\n * This is a convenience selector that specifically targets Solana networks.\n *\n * @returns A selector function that returns an array of enabled Solana chain IDs\n */\nexport const selectEnabledSolanaNetworks = createSelector(\n  createSelectorForEnabledNetworksForNamespace(KnownCaipNamespace.Solana),\n  (enabledSolanaNetworks) => enabledSolanaNetworks,\n);\n"]}
\ No newline at end of file
+{"version":3,"file":"selectors.cjs","sourceRoot":"","sources":["../src/selectors.ts"],"names":[],"mappings":";;;AACA,2CAAqD;AACrD,uCAA0C;AAG1C,uCAAqC;AAErC;;;;;GAKG;AACI,MAAM,uBAAuB,GAAG,CACrC,KAAuC,EACvC,EAAE,CAAC,KAAK,CAAC,iBAAiB,CAAC;AAFhB,QAAA,uBAAuB,2BAEP;AAE7B;;;;;;;;;GASG;AACI,MAAM,sBAAsB,GAAG,CAAC,OAA0B,EAAE,EAAE,CACnE,IAAA,yBAAc,EAAC,+BAAuB,EAAE,CAAC,iBAAiB,EAAE,EAAE;IAC5D,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,IAAA,kBAAU,EAAC,OAAO,CAAC,CAAC;IAEtD,OAAO,CACL,SAAS,IAAI,iBAAiB;QAC9B,UAAU,IAAI,iBAAiB,CAAC,SAAS,CAAC;QAC1C,iBAAiB,CAAC,SAAS,CAAC,CAAC,UAAU,CAAC,CACzC,CAAC;AACJ,CAAC,CAAC,CAAC;AATQ,QAAA,sBAAsB,0BAS9B;AAEL;;;;;;;;GAQG;AACI,MAAM,4CAA4C,GAAG,CAC1D,SAAwB,EACxB,EAAE,CACF,IAAA,yBAAc,EAAC,+BAAuB,EAAE,CAAC,iBAAiB,EAAE,EAAE;IAC5D,OAAO,MAAM,CAAC,OAAO,CAAC,iBAAiB,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;SACtD,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC;SAChC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;AACvB,CAAC,CAAC,CAAC;AAPQ,QAAA,4CAA4C,gDAOpD;AAEL;;;;;;;GAOG;AACU,QAAA,wBAAwB,GAAG,IAAA,yBAAc,EACpD,+BAAuB,EACvB,CAAC,iBAAiB,EAAE,EAAE;IACpB,OAAO,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,MAAM,CAE1C,CAAC,GAAG,EAAE,EAAE,EAAE,EAAE;QACZ,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;aAC5C,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC;aAChC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;QACrB,OAAO,GAAG,CAAC;IACb,CAAC,EAAE,EAAE,CAAC,CAAC;AACT,CAAC,CACF,CAAC;AAEF;;;;GAIG;AACU,QAAA,0BAA0B,GAAG,IAAA,yBAAc,EACtD,gCAAwB,EACxB,CAAC,kBAAkB,EAAE,EAAE;IACrB,OAAO,MAAM,CAAC,MAAM,CAAC,kBAAkB,CAAC,CAAC,IAAI,EAAE,CAAC,MAAM,CAAC;AACzD,CAAC,CACF,CAAC;AAEF;;;;;;GAMG;AACU,QAAA,wBAAwB,GAAG,IAAA,yBAAc,EACpD,IAAA,oDAA4C,EAAC,0BAAkB,CAAC,MAAM,CAAC,EACvE,CAAC,kBAAkB,EAAE,EAAE,CAAC,kBAAkB,CAC3C,CAAC;AAEF;;;;;;GAMG;AACU,QAAA,2BAA2B,GAAG,IAAA,yBAAc,EACvD,IAAA,oDAA4C,EAAC,0BAAkB,CAAC,MAAM,CAAC,EACvE,CAAC,qBAAqB,EAAE,EAAE,CAAC,qBAAqB,CACjD,CAAC","sourcesContent":["import type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';\nimport { KnownCaipNamespace } from '@metamask/utils';\nimport { createSelector } from 'reselect';\n\nimport type { NetworkEnablementControllerState } from './NetworkEnablementController';\nimport { deriveKeys } from './utils';\n\n/**\n * Base selector to get the enabled network map from the controller state.\n *\n * @param state - The NetworkEnablementController state\n * @returns The enabled network map\n */\nexport const selectEnabledNetworkMap = (\n  state: NetworkEnablementControllerState,\n) => state.enabledNetworkMap;\n\n/**\n * Selector to check if a specific network is enabled.\n *\n * This selector accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n * (for any blockchain network) and returns whether the network is currently enabled.\n * It returns false for unknown networks or if there's an error parsing the chain ID.\n *\n * @param chainId - The chain ID to check (Hex or CAIP-2 format)\n * @returns A selector function that returns true if the network is enabled, false otherwise\n */\nexport const selectIsNetworkEnabled = (chainId: Hex | CaipChainId) =>\n  createSelector(selectEnabledNetworkMap, (enabledNetworkMap) => {\n    const { namespace, storageKey } = deriveKeys(chainId);\n\n    return (\n      namespace in enabledNetworkMap &&\n      storageKey in enabledNetworkMap[namespace] &&\n      enabledNetworkMap[namespace][storageKey]\n    );\n  });\n\n/**\n * Selector builder to get all enabled networks for a specific namespace.\n *\n * The selector returned by this function returns an array of chain IDs (as strings) for all enabled networks\n * within the specified namespace (e.g., 'eip155' for EVM networks, 'solana' for Solana).\n *\n * @param namespace - The CAIP namespace to get enabled networks for (e.g., 'eip155', 'solana')\n * @returns A selector function that returns an array of chain ID strings for enabled networks in the namespace\n */\nexport const createSelectorForEnabledNetworksForNamespace = (\n  namespace: CaipNamespace,\n) =>\n  createSelector(selectEnabledNetworkMap, (enabledNetworkMap) => {\n    return Object.entries(enabledNetworkMap[namespace] ?? {})\n      .filter(([, enabled]) => enabled)\n      .map(([id]) => id);\n  });\n\n/**\n * Selector to get all enabled networks across all namespaces.\n *\n * This selector returns a record where keys are CAIP namespaces and values are arrays\n * of enabled chain IDs within each namespace.\n *\n * @returns A selector function that returns a record mapping namespace to array of enabled chain IDs\n */\nexport const selectAllEnabledNetworks = createSelector(\n  selectEnabledNetworkMap,\n  (enabledNetworkMap) => {\n    return Object.keys(enabledNetworkMap).reduce<\n      Record<CaipNamespace, string[]>\n    >((acc, ns) => {\n      acc[ns] = Object.entries(enabledNetworkMap[ns])\n        .filter(([, enabled]) => enabled)\n        .map(([id]) => id);\n      return acc;\n    }, {});\n  },\n);\n\n/**\n * Selector to get the total count of enabled networks across all namespaces.\n *\n * @returns A selector function that returns the total number of enabled networks\n */\nexport const selectEnabledNetworksCount = createSelector(\n  selectAllEnabledNetworks,\n  (allEnabledNetworks) => {\n    return Object.values(allEnabledNetworks).flat().length;\n  },\n);\n\n/**\n * Selector to get all enabled EVM networks.\n *\n * This is a convenience selector that specifically targets EIP-155 networks.\n *\n * @returns A selector function that returns an array of enabled EVM chain IDs\n */\nexport const selectEnabledEvmNetworks = createSelector(\n  createSelectorForEnabledNetworksForNamespace(KnownCaipNamespace.Eip155),\n  (enabledEvmNetworks) => enabledEvmNetworks,\n);\n\n/**\n * Selector to get all enabled Solana networks.\n *\n * This is a convenience selector that specifically targets Solana networks.\n *\n * @returns A selector function that returns an array of enabled Solana chain IDs\n */\nexport const selectEnabledSolanaNetworks = createSelector(\n  createSelectorForEnabledNetworksForNamespace(KnownCaipNamespace.Solana),\n  (enabledSolanaNetworks) => enabledSolanaNetworks,\n);\n"]}
\ No newline at end of file
diff --git a/dist/selectors.d.cts.map b/dist/selectors.d.cts.map
index 7047b64d1e86fd588d7049be293e46f243de47b9..e2d0059af0488203d543833af04530b33bc0c827 100644
--- a/dist/selectors.d.cts.map
+++ b/dist/selectors.d.cts.map
@@ -1 +1 @@
-{"version":3,"file":"selectors.d.cts","sourceRoot":"","sources":["../src/selectors.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,WAAW,EAAE,aAAa,EAAE,GAAG,EAAE,wBAAwB;AAIvE,OAAO,KAAK,EAAE,gCAAgC,EAAE,0CAAsC;AAGtF;;;;;GAKG;AACH,eAAO,MAAM,uBAAuB,UAC3B,gCAAgC;;CACb,CAAC;AAE7B;;;;;;;;;GASG;AACH,eAAO,MAAM,sBAAsB,YAAa,GAAG,GAAG,WAAW;;;;;;;;;;;;;;;;2BAbxD,gCAAgC;;;;;;;;;;CAsBrC,CAAC;AAEL;;;;;;;;GAQG;AACH,eAAO,MAAM,4CAA4C,cAC5C,aAAa;;;;;;;;;;;;;;;;2BAlCjB,gCAAgC;;;;;;;;;;CAwCrC,CAAC;AAEL;;;;;;;GAOG;AACH,eAAO,MAAM,wBAAwB;;;;;;;;;;;;;;;;2BAlD5B,gCAAgC;;;;;;;;;;CA+DxC,CAAC;AAEF;;;;GAIG;AACH,eAAO,MAAM,0BAA0B;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BAtE9B,gCAAgC;;;;;;;;;;;;;;;;;;CA2ExC,CAAC;AAEF;;;;;;GAMG;AACH,eAAO,MAAM,wBAAwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BApF5B,gCAAgC;;;;;;;;;;;;;;;;;;CAuFxC,CAAC;AAEF;;;;;;GAMG;AACH,eAAO,MAAM,2BAA2B;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BAhG/B,gCAAgC;;;;;;;;;;;;;;;;;;CAmGxC,CAAC"}
\ No newline at end of file
+{"version":3,"file":"selectors.d.cts","sourceRoot":"","sources":["../src/selectors.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,WAAW,EAAE,aAAa,EAAE,GAAG,EAAE,wBAAwB;AAIvE,OAAO,KAAK,EAAE,gCAAgC,EAAE,0CAAsC;AAGtF;;;;;GAKG;AACH,eAAO,MAAM,uBAAuB,UAC3B,gCAAgC;;CACb,CAAC;AAE7B;;;;;;;;;GASG;AACH,eAAO,MAAM,sBAAsB,YAAa,GAAG,GAAG,WAAW;;;;;;;;;;;;;;;;2BAbxD,gCAAgC;;;;;;;;;;CAsBrC,CAAC;AAEL;;;;;;;;GAQG;AACH,eAAO,MAAM,4CAA4C,cAC5C,aAAa;;;;;;;;;;;;;;;;2BAlCjB,gCAAgC;;;;;;;;;;CAwCrC,CAAC;AAEL;;;;;;;GAOG;AACH,eAAO,MAAM,wBAAwB;;;;;;;;;;;;;;;;2BAlD5B,gCAAgC;;;;;;;;;;CA8DxC,CAAC;AAEF;;;;GAIG;AACH,eAAO,MAAM,0BAA0B;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BArE9B,gCAAgC;;;;;;;;;;;;;;;;;;CA0ExC,CAAC;AAEF;;;;;;GAMG;AACH,eAAO,MAAM,wBAAwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BAnF5B,gCAAgC;;;;;;;;;;;;;;;;;;CAsFxC,CAAC;AAEF;;;;;;GAMG;AACH,eAAO,MAAM,2BAA2B;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BA/F/B,gCAAgC;;;;;;;;;;;;;;;;;;CAkGxC,CAAC"}
\ No newline at end of file
diff --git a/dist/selectors.d.mts.map b/dist/selectors.d.mts.map
index 5d972c1441d6020630d74df815802c31d2f1747d..95e92db5ccfc4365e7b4f77d804d2dbb819826f1 100644
--- a/dist/selectors.d.mts.map
+++ b/dist/selectors.d.mts.map
@@ -1 +1 @@
-{"version":3,"file":"selectors.d.mts","sourceRoot":"","sources":["../src/selectors.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,WAAW,EAAE,aAAa,EAAE,GAAG,EAAE,wBAAwB;AAIvE,OAAO,KAAK,EAAE,gCAAgC,EAAE,0CAAsC;AAGtF;;;;;GAKG;AACH,eAAO,MAAM,uBAAuB,UAC3B,gCAAgC;;CACb,CAAC;AAE7B;;;;;;;;;GASG;AACH,eAAO,MAAM,sBAAsB,YAAa,GAAG,GAAG,WAAW;;;;;;;;;;;;;;;;2BAbxD,gCAAgC;;;;;;;;;;CAsBrC,CAAC;AAEL;;;;;;;;GAQG;AACH,eAAO,MAAM,4CAA4C,cAC5C,aAAa;;;;;;;;;;;;;;;;2BAlCjB,gCAAgC;;;;;;;;;;CAwCrC,CAAC;AAEL;;;;;;;GAOG;AACH,eAAO,MAAM,wBAAwB;;;;;;;;;;;;;;;;2BAlD5B,gCAAgC;;;;;;;;;;CA+DxC,CAAC;AAEF;;;;GAIG;AACH,eAAO,MAAM,0BAA0B;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BAtE9B,gCAAgC;;;;;;;;;;;;;;;;;;CA2ExC,CAAC;AAEF;;;;;;GAMG;AACH,eAAO,MAAM,wBAAwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BApF5B,gCAAgC;;;;;;;;;;;;;;;;;;CAuFxC,CAAC;AAEF;;;;;;GAMG;AACH,eAAO,MAAM,2BAA2B;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BAhG/B,gCAAgC;;;;;;;;;;;;;;;;;;CAmGxC,CAAC"}
\ No newline at end of file
+{"version":3,"file":"selectors.d.mts","sourceRoot":"","sources":["../src/selectors.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,WAAW,EAAE,aAAa,EAAE,GAAG,EAAE,wBAAwB;AAIvE,OAAO,KAAK,EAAE,gCAAgC,EAAE,0CAAsC;AAGtF;;;;;GAKG;AACH,eAAO,MAAM,uBAAuB,UAC3B,gCAAgC;;CACb,CAAC;AAE7B;;;;;;;;;GASG;AACH,eAAO,MAAM,sBAAsB,YAAa,GAAG,GAAG,WAAW;;;;;;;;;;;;;;;;2BAbxD,gCAAgC;;;;;;;;;;CAsBrC,CAAC;AAEL;;;;;;;;GAQG;AACH,eAAO,MAAM,4CAA4C,cAC5C,aAAa;;;;;;;;;;;;;;;;2BAlCjB,gCAAgC;;;;;;;;;;CAwCrC,CAAC;AAEL;;;;;;;GAOG;AACH,eAAO,MAAM,wBAAwB;;;;;;;;;;;;;;;;2BAlD5B,gCAAgC;;;;;;;;;;CA8DxC,CAAC;AAEF;;;;GAIG;AACH,eAAO,MAAM,0BAA0B;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BArE9B,gCAAgC;;;;;;;;;;;;;;;;;;CA0ExC,CAAC;AAEF;;;;;;GAMG;AACH,eAAO,MAAM,wBAAwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BAnF5B,gCAAgC;;;;;;;;;;;;;;;;;;CAsFxC,CAAC;AAEF;;;;;;GAMG;AACH,eAAO,MAAM,2BAA2B;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BA/F/B,gCAAgC;;;;;;;;;;;;;;;;;;CAkGxC,CAAC"}
\ No newline at end of file
diff --git a/dist/selectors.mjs.map b/dist/selectors.mjs.map
index 3f7630ef01bc68019868a3907d3d3e777f6e8262..0e817ca30ca395837f7623fab800366db957f530 100644
--- a/dist/selectors.mjs.map
+++ b/dist/selectors.mjs.map
@@ -1 +1 @@
-{"version":3,"file":"selectors.mjs","sourceRoot":"","sources":["../src/selectors.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,kBAAkB,EAAE,wBAAwB;AACrD,OAAO,EAAE,cAAc,EAAE,iBAAiB;AAG1C,OAAO,EAAE,UAAU,EAAE,oBAAgB;AAErC;;;;;GAKG;AACH,MAAM,CAAC,MAAM,uBAAuB,GAAG,CACrC,KAAuC,EACvC,EAAE,CAAC,KAAK,CAAC,iBAAiB,CAAC;AAE7B;;;;;;;;;GASG;AACH,MAAM,CAAC,MAAM,sBAAsB,GAAG,CAAC,OAA0B,EAAE,EAAE,CACnE,cAAc,CAAC,uBAAuB,EAAE,CAAC,iBAAiB,EAAE,EAAE;IAC5D,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,UAAU,CAAC,OAAO,CAAC,CAAC;IAEtD,OAAO,CACL,SAAS,IAAI,iBAAiB;QAC9B,UAAU,IAAI,iBAAiB,CAAC,SAAS,CAAC;QAC1C,iBAAiB,CAAC,SAAS,CAAC,CAAC,UAAU,CAAC,CACzC,CAAC;AACJ,CAAC,CAAC,CAAC;AAEL;;;;;;;;GAQG;AACH,MAAM,CAAC,MAAM,4CAA4C,GAAG,CAC1D,SAAwB,EACxB,EAAE,CACF,cAAc,CAAC,uBAAuB,EAAE,CAAC,iBAAiB,EAAE,EAAE;IAC5D,OAAO,MAAM,CAAC,OAAO,CAAC,iBAAiB,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;SACtD,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC;SAChC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;AACvB,CAAC,CAAC,CAAC;AAEL;;;;;;;GAOG;AACH,MAAM,CAAC,MAAM,wBAAwB,GAAG,cAAc,CACpD,uBAAuB,EACvB,CAAC,iBAAiB,EAAE,EAAE;IACpB,OAAQ,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAqB,CAAC,MAAM,CAC/D,CAAC,GAAG,EAAE,EAAE,EAAE,EAAE;QACV,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;aAC5C,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC;aAChC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;QACrB,OAAO,GAAG,CAAC;IACb,CAAC,EACD,EAAqC,CACtC,CAAC;AACJ,CAAC,CACF,CAAC;AAEF;;;;GAIG;AACH,MAAM,CAAC,MAAM,0BAA0B,GAAG,cAAc,CACtD,wBAAwB,EACxB,CAAC,kBAAkB,EAAE,EAAE;IACrB,OAAO,MAAM,CAAC,MAAM,CAAC,kBAAkB,CAAC,CAAC,IAAI,EAAE,CAAC,MAAM,CAAC;AACzD,CAAC,CACF,CAAC;AAEF;;;;;;GAMG;AACH,MAAM,CAAC,MAAM,wBAAwB,GAAG,cAAc,CACpD,4CAA4C,CAAC,kBAAkB,CAAC,MAAM,CAAC,EACvE,CAAC,kBAAkB,EAAE,EAAE,CAAC,kBAAkB,CAC3C,CAAC;AAEF;;;;;;GAMG;AACH,MAAM,CAAC,MAAM,2BAA2B,GAAG,cAAc,CACvD,4CAA4C,CAAC,kBAAkB,CAAC,MAAM,CAAC,EACvE,CAAC,qBAAqB,EAAE,EAAE,CAAC,qBAAqB,CACjD,CAAC","sourcesContent":["import type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';\nimport { KnownCaipNamespace } from '@metamask/utils';\nimport { createSelector } from 'reselect';\n\nimport type { NetworkEnablementControllerState } from './NetworkEnablementController';\nimport { deriveKeys } from './utils';\n\n/**\n * Base selector to get the enabled network map from the controller state.\n *\n * @param state - The NetworkEnablementController state\n * @returns The enabled network map\n */\nexport const selectEnabledNetworkMap = (\n  state: NetworkEnablementControllerState,\n) => state.enabledNetworkMap;\n\n/**\n * Selector to check if a specific network is enabled.\n *\n * This selector accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n * (for any blockchain network) and returns whether the network is currently enabled.\n * It returns false for unknown networks or if there's an error parsing the chain ID.\n *\n * @param chainId - The chain ID to check (Hex or CAIP-2 format)\n * @returns A selector function that returns true if the network is enabled, false otherwise\n */\nexport const selectIsNetworkEnabled = (chainId: Hex | CaipChainId) =>\n  createSelector(selectEnabledNetworkMap, (enabledNetworkMap) => {\n    const { namespace, storageKey } = deriveKeys(chainId);\n\n    return (\n      namespace in enabledNetworkMap &&\n      storageKey in enabledNetworkMap[namespace] &&\n      enabledNetworkMap[namespace][storageKey]\n    );\n  });\n\n/**\n * Selector builder to get all enabled networks for a specific namespace.\n *\n * The selector returned by this function returns an array of chain IDs (as strings) for all enabled networks\n * within the specified namespace (e.g., 'eip155' for EVM networks, 'solana' for Solana).\n *\n * @param namespace - The CAIP namespace to get enabled networks for (e.g., 'eip155', 'solana')\n * @returns A selector function that returns an array of chain ID strings for enabled networks in the namespace\n */\nexport const createSelectorForEnabledNetworksForNamespace = (\n  namespace: CaipNamespace,\n) =>\n  createSelector(selectEnabledNetworkMap, (enabledNetworkMap) => {\n    return Object.entries(enabledNetworkMap[namespace] ?? {})\n      .filter(([, enabled]) => enabled)\n      .map(([id]) => id);\n  });\n\n/**\n * Selector to get all enabled networks across all namespaces.\n *\n * This selector returns a record where keys are CAIP namespaces and values are arrays\n * of enabled chain IDs within each namespace.\n *\n * @returns A selector function that returns a record mapping namespace to array of enabled chain IDs\n */\nexport const selectAllEnabledNetworks = createSelector(\n  selectEnabledNetworkMap,\n  (enabledNetworkMap) => {\n    return (Object.keys(enabledNetworkMap) as CaipNamespace[]).reduce(\n      (acc, ns) => {\n        acc[ns] = Object.entries(enabledNetworkMap[ns])\n          .filter(([, enabled]) => enabled)\n          .map(([id]) => id);\n        return acc;\n      },\n      {} as Record<CaipNamespace, string[]>,\n    );\n  },\n);\n\n/**\n * Selector to get the total count of enabled networks across all namespaces.\n *\n * @returns A selector function that returns the total number of enabled networks\n */\nexport const selectEnabledNetworksCount = createSelector(\n  selectAllEnabledNetworks,\n  (allEnabledNetworks) => {\n    return Object.values(allEnabledNetworks).flat().length;\n  },\n);\n\n/**\n * Selector to get all enabled EVM networks.\n *\n * This is a convenience selector that specifically targets EIP-155 networks.\n *\n * @returns A selector function that returns an array of enabled EVM chain IDs\n */\nexport const selectEnabledEvmNetworks = createSelector(\n  createSelectorForEnabledNetworksForNamespace(KnownCaipNamespace.Eip155),\n  (enabledEvmNetworks) => enabledEvmNetworks,\n);\n\n/**\n * Selector to get all enabled Solana networks.\n *\n * This is a convenience selector that specifically targets Solana networks.\n *\n * @returns A selector function that returns an array of enabled Solana chain IDs\n */\nexport const selectEnabledSolanaNetworks = createSelector(\n  createSelectorForEnabledNetworksForNamespace(KnownCaipNamespace.Solana),\n  (enabledSolanaNetworks) => enabledSolanaNetworks,\n);\n"]}
\ No newline at end of file
+{"version":3,"file":"selectors.mjs","sourceRoot":"","sources":["../src/selectors.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,kBAAkB,EAAE,wBAAwB;AACrD,OAAO,EAAE,cAAc,EAAE,iBAAiB;AAG1C,OAAO,EAAE,UAAU,EAAE,oBAAgB;AAErC;;;;;GAKG;AACH,MAAM,CAAC,MAAM,uBAAuB,GAAG,CACrC,KAAuC,EACvC,EAAE,CAAC,KAAK,CAAC,iBAAiB,CAAC;AAE7B;;;;;;;;;GASG;AACH,MAAM,CAAC,MAAM,sBAAsB,GAAG,CAAC,OAA0B,EAAE,EAAE,CACnE,cAAc,CAAC,uBAAuB,EAAE,CAAC,iBAAiB,EAAE,EAAE;IAC5D,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,UAAU,CAAC,OAAO,CAAC,CAAC;IAEtD,OAAO,CACL,SAAS,IAAI,iBAAiB;QAC9B,UAAU,IAAI,iBAAiB,CAAC,SAAS,CAAC;QAC1C,iBAAiB,CAAC,SAAS,CAAC,CAAC,UAAU,CAAC,CACzC,CAAC;AACJ,CAAC,CAAC,CAAC;AAEL;;;;;;;;GAQG;AACH,MAAM,CAAC,MAAM,4CAA4C,GAAG,CAC1D,SAAwB,EACxB,EAAE,CACF,cAAc,CAAC,uBAAuB,EAAE,CAAC,iBAAiB,EAAE,EAAE;IAC5D,OAAO,MAAM,CAAC,OAAO,CAAC,iBAAiB,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;SACtD,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC;SAChC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;AACvB,CAAC,CAAC,CAAC;AAEL;;;;;;;GAOG;AACH,MAAM,CAAC,MAAM,wBAAwB,GAAG,cAAc,CACpD,uBAAuB,EACvB,CAAC,iBAAiB,EAAE,EAAE;IACpB,OAAO,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,MAAM,CAE1C,CAAC,GAAG,EAAE,EAAE,EAAE,EAAE;QACZ,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;aAC5C,MAAM,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC;aAChC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;QACrB,OAAO,GAAG,CAAC;IACb,CAAC,EAAE,EAAE,CAAC,CAAC;AACT,CAAC,CACF,CAAC;AAEF;;;;GAIG;AACH,MAAM,CAAC,MAAM,0BAA0B,GAAG,cAAc,CACtD,wBAAwB,EACxB,CAAC,kBAAkB,EAAE,EAAE;IACrB,OAAO,MAAM,CAAC,MAAM,CAAC,kBAAkB,CAAC,CAAC,IAAI,EAAE,CAAC,MAAM,CAAC;AACzD,CAAC,CACF,CAAC;AAEF;;;;;;GAMG;AACH,MAAM,CAAC,MAAM,wBAAwB,GAAG,cAAc,CACpD,4CAA4C,CAAC,kBAAkB,CAAC,MAAM,CAAC,EACvE,CAAC,kBAAkB,EAAE,EAAE,CAAC,kBAAkB,CAC3C,CAAC;AAEF;;;;;;GAMG;AACH,MAAM,CAAC,MAAM,2BAA2B,GAAG,cAAc,CACvD,4CAA4C,CAAC,kBAAkB,CAAC,MAAM,CAAC,EACvE,CAAC,qBAAqB,EAAE,EAAE,CAAC,qBAAqB,CACjD,CAAC","sourcesContent":["import type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';\nimport { KnownCaipNamespace } from '@metamask/utils';\nimport { createSelector } from 'reselect';\n\nimport type { NetworkEnablementControllerState } from './NetworkEnablementController';\nimport { deriveKeys } from './utils';\n\n/**\n * Base selector to get the enabled network map from the controller state.\n *\n * @param state - The NetworkEnablementController state\n * @returns The enabled network map\n */\nexport const selectEnabledNetworkMap = (\n  state: NetworkEnablementControllerState,\n) => state.enabledNetworkMap;\n\n/**\n * Selector to check if a specific network is enabled.\n *\n * This selector accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID\n * (for any blockchain network) and returns whether the network is currently enabled.\n * It returns false for unknown networks or if there's an error parsing the chain ID.\n *\n * @param chainId - The chain ID to check (Hex or CAIP-2 format)\n * @returns A selector function that returns true if the network is enabled, false otherwise\n */\nexport const selectIsNetworkEnabled = (chainId: Hex | CaipChainId) =>\n  createSelector(selectEnabledNetworkMap, (enabledNetworkMap) => {\n    const { namespace, storageKey } = deriveKeys(chainId);\n\n    return (\n      namespace in enabledNetworkMap &&\n      storageKey in enabledNetworkMap[namespace] &&\n      enabledNetworkMap[namespace][storageKey]\n    );\n  });\n\n/**\n * Selector builder to get all enabled networks for a specific namespace.\n *\n * The selector returned by this function returns an array of chain IDs (as strings) for all enabled networks\n * within the specified namespace (e.g., 'eip155' for EVM networks, 'solana' for Solana).\n *\n * @param namespace - The CAIP namespace to get enabled networks for (e.g., 'eip155', 'solana')\n * @returns A selector function that returns an array of chain ID strings for enabled networks in the namespace\n */\nexport const createSelectorForEnabledNetworksForNamespace = (\n  namespace: CaipNamespace,\n) =>\n  createSelector(selectEnabledNetworkMap, (enabledNetworkMap) => {\n    return Object.entries(enabledNetworkMap[namespace] ?? {})\n      .filter(([, enabled]) => enabled)\n      .map(([id]) => id);\n  });\n\n/**\n * Selector to get all enabled networks across all namespaces.\n *\n * This selector returns a record where keys are CAIP namespaces and values are arrays\n * of enabled chain IDs within each namespace.\n *\n * @returns A selector function that returns a record mapping namespace to array of enabled chain IDs\n */\nexport const selectAllEnabledNetworks = createSelector(\n  selectEnabledNetworkMap,\n  (enabledNetworkMap) => {\n    return Object.keys(enabledNetworkMap).reduce<\n      Record<CaipNamespace, string[]>\n    >((acc, ns) => {\n      acc[ns] = Object.entries(enabledNetworkMap[ns])\n        .filter(([, enabled]) => enabled)\n        .map(([id]) => id);\n      return acc;\n    }, {});\n  },\n);\n\n/**\n * Selector to get the total count of enabled networks across all namespaces.\n *\n * @returns A selector function that returns the total number of enabled networks\n */\nexport const selectEnabledNetworksCount = createSelector(\n  selectAllEnabledNetworks,\n  (allEnabledNetworks) => {\n    return Object.values(allEnabledNetworks).flat().length;\n  },\n);\n\n/**\n * Selector to get all enabled EVM networks.\n *\n * This is a convenience selector that specifically targets EIP-155 networks.\n *\n * @returns A selector function that returns an array of enabled EVM chain IDs\n */\nexport const selectEnabledEvmNetworks = createSelector(\n  createSelectorForEnabledNetworksForNamespace(KnownCaipNamespace.Eip155),\n  (enabledEvmNetworks) => enabledEvmNetworks,\n);\n\n/**\n * Selector to get all enabled Solana networks.\n *\n * This is a convenience selector that specifically targets Solana networks.\n *\n * @returns A selector function that returns an array of enabled Solana chain IDs\n */\nexport const selectEnabledSolanaNetworks = createSelector(\n  createSelectorForEnabledNetworksForNamespace(KnownCaipNamespace.Solana),\n  (enabledSolanaNetworks) => enabledSolanaNetworks,\n);\n"]}
\ No newline at end of file
diff --git a/dist/services/Slip44Service.cjs b/dist/services/Slip44Service.cjs
new file mode 100644
index 0000000000000000000000000000000000000000..6fd0d5e377734ab320d7253887f3e2e0613256a7
--- /dev/null
+++ b/dist/services/Slip44Service.cjs
@@ -0,0 +1,171 @@
+"use strict";
+var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
+    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
+    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
+    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
+};
+var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
+    if (kind === "m") throw new TypeError("Private method is not writable");
+    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
+    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
+    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
+};
+var __importDefault = (this && this.__importDefault) || function (mod) {
+    return (mod && mod.__esModule) ? mod : { "default": mod };
+};
+var _a, _Slip44Service_chainIdCache, _Slip44Service_fetchPromise, _Slip44Service_symbolCache, _Slip44Service_fetchChainData;
+Object.defineProperty(exports, "__esModule", { value: true });
+exports.Slip44Service = void 0;
+const controller_utils_1 = require("@metamask/controller-utils");
+// @ts-expect-error: No type definitions for '@metamask/slip44'
+const slip44_1 = __importDefault(require("@metamask/slip44"));
+const CHAINID_NETWORK_URL = 'https://chainid.network/chains.json';
+/**
+ * Service for looking up SLIP-44 coin type identifiers.
+ *
+ * SLIP-44 defines registered coin types used in BIP-44 derivation paths.
+ *
+ * This service provides two lookup methods:
+ * 1. `getEvmSlip44` - For EVM networks, uses chainid.network data (recommended for eip155)
+ * 2. `getSlip44BySymbol` - Fallback method using @metamask/slip44 package
+ *
+ * @see https://github.com/satoshilabs/slips/blob/master/slip-0044.md
+ * @see https://chainid.network/chains.json
+ */
+class Slip44Service {
+    /**
+     * Gets the SLIP-44 coin type identifier for an EVM network by chain ID.
+     *
+     * **IMPORTANT: This method is for EVM networks only (eip155 namespace).**
+     * For non-EVM networks (Bitcoin, Solana, Tron, etc.), use `getSlip44BySymbol`.
+     *
+     * This method checks chainid.network data (which maps chainId directly
+     * to slip44). If not found, defaults to 60 (Ethereum).
+     *
+     * @param chainId - The EVM chain ID as a number (e.g., 1 for Ethereum, 56 for BNB Chain)
+     * @returns The SLIP-44 coin type number (defaults to 60 if not found)
+     * @example
+     * ```typescript
+     * // For EVM networks only
+     * const ethCoinType = await Slip44Service.getEvmSlip44(1);
+     * // Returns 60
+     *
+     * const bnbCoinType = await Slip44Service.getEvmSlip44(56);
+     * // Returns 714
+     *
+     * const unknownEvmChain = await Slip44Service.getEvmSlip44(99999);
+     * // Returns 60 (default for EVM)
+     * ```
+     */
+    static async getEvmSlip44(chainId) {
+        // Ensure chain data is loaded
+        await __classPrivateFieldGet(this, _a, "m", _Slip44Service_fetchChainData).call(this);
+        // Check chainId cache first
+        const cached = __classPrivateFieldGet(this, _a, "f", _Slip44Service_chainIdCache)?.get(chainId);
+        if (cached !== undefined) {
+            return cached;
+        }
+        // Default to 60 (Ethereum) for EVM networks without specific mapping
+        return 60;
+    }
+    /**
+     * Gets the SLIP-44 coin type identifier for a non-EVM network by symbol.
+     *
+     * **IMPORTANT: This method is for non-EVM networks only (Bitcoin, Solana, Tron, etc.).**
+     * For EVM networks (eip155 namespace), use `getEvmSlip44` instead.
+     *
+     * Note: Symbol lookup may return incorrect results for duplicate symbols
+     * (e.g., CPC is both CPChain and Capricoin).
+     *
+     * @param symbol - The network symbol (e.g., 'ETH', 'BTC', 'SOL')
+     * @returns The SLIP-44 coin type number, or undefined if not found
+     * @example
+     * ```typescript
+     * const ethCoinType = Slip44Service.getSlip44BySymbol('ETH');
+     * // Returns 60
+     *
+     * const btcCoinType = Slip44Service.getSlip44BySymbol('BTC');
+     * // Returns 0
+     * ```
+     */
+    static getSlip44BySymbol(symbol) {
+        // Check cache first
+        if (__classPrivateFieldGet(this, _a, "f", _Slip44Service_symbolCache).has(symbol)) {
+            return __classPrivateFieldGet(this, _a, "f", _Slip44Service_symbolCache).get(symbol);
+        }
+        const slip44Data = slip44_1.default;
+        const upperSymbol = symbol.toUpperCase();
+        // Iterate through all entries to find matching symbol
+        // Note: Object.keys returns numeric keys in ascending order,
+        // so for duplicate symbols we get the lowest coin type first
+        // (which is the convention for resolving duplicates)
+        for (const key of Object.keys(slip44Data)) {
+            const entry = slip44Data[key];
+            if (entry.symbol.toUpperCase() === upperSymbol) {
+                const coinType = parseInt(key, 10);
+                __classPrivateFieldGet(this, _a, "f", _Slip44Service_symbolCache).set(symbol, coinType);
+                return coinType;
+            }
+        }
+        // Cache the miss as well to avoid repeated lookups
+        __classPrivateFieldGet(this, _a, "f", _Slip44Service_symbolCache).set(symbol, undefined);
+        return undefined;
+    }
+    /**
+     * Clears all internal caches.
+     * Useful for testing or if the underlying data might change.
+     */
+    static clearCache() {
+        __classPrivateFieldGet(this, _a, "f", _Slip44Service_symbolCache).clear();
+        __classPrivateFieldSet(this, _a, null, "f", _Slip44Service_chainIdCache);
+        __classPrivateFieldSet(this, _a, null, "f", _Slip44Service_fetchPromise);
+    }
+}
+exports.Slip44Service = Slip44Service;
+_a = Slip44Service, _Slip44Service_fetchChainData = async function _Slip44Service_fetchChainData() {
+    if (__classPrivateFieldGet(this, _a, "f", _Slip44Service_chainIdCache) !== null) {
+        return;
+    }
+    // Avoid duplicate fetches
+    if (__classPrivateFieldGet(this, _a, "f", _Slip44Service_fetchPromise)) {
+        await __classPrivateFieldGet(this, _a, "f", _Slip44Service_fetchPromise);
+        return;
+    }
+    __classPrivateFieldSet(this, _a, (async () => {
+        try {
+            const chains = await (0, controller_utils_1.fetchWithErrorHandling)({
+                url: CHAINID_NETWORK_URL,
+                timeout: 10000,
+            });
+            if (chains && Array.isArray(chains)) {
+                __classPrivateFieldSet(this, _a, new Map(chains
+                    .filter((chain) => chain.slip44 !== undefined)
+                    .map((chain) => [chain.chainId, chain.slip44])), "f", _Slip44Service_chainIdCache);
+            }
+            else {
+                // Invalid response, initialize empty cache
+                __classPrivateFieldSet(this, _a, new Map(), "f", _Slip44Service_chainIdCache);
+            }
+        }
+        catch {
+            // Network failed, initialize empty cache so we fall back to symbol lookup
+            __classPrivateFieldSet(this, _a, new Map(), "f", _Slip44Service_chainIdCache);
+        }
+    })(), "f", _Slip44Service_fetchPromise);
+    await __classPrivateFieldGet(this, _a, "f", _Slip44Service_fetchPromise);
+    __classPrivateFieldSet(this, _a, null, "f", _Slip44Service_fetchPromise);
+};
+/**
+ * Cache for chainId to slip44 lookups from chainid.network.
+ */
+_Slip44Service_chainIdCache = { value: null };
+/**
+ * Whether a fetch is currently in progress.
+ */
+_Slip44Service_fetchPromise = { value: null };
+/**
+ * Cache for symbol to slip44 index lookups.
+ * This avoids iterating through all entries on repeated lookups.
+ */
+_Slip44Service_symbolCache = { value: new Map() };
+//# sourceMappingURL=Slip44Service.cjs.map
\ No newline at end of file
diff --git a/dist/services/Slip44Service.cjs.map b/dist/services/Slip44Service.cjs.map
new file mode 100644
index 0000000000000000000000000000000000000000..a38ce96601de41962a8b5c3708b5f6e557bf4a60
--- /dev/null
+++ b/dist/services/Slip44Service.cjs.map
@@ -0,0 +1 @@
+{"version":3,"file":"Slip44Service.cjs","sourceRoot":"","sources":["../../src/services/Slip44Service.ts"],"names":[],"mappings":"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","sourcesContent":["import { fetchWithErrorHandling } from '@metamask/controller-utils';\n// @ts-expect-error: No type definitions for '@metamask/slip44'\nimport slip44 from '@metamask/slip44';\n\nconst CHAINID_NETWORK_URL = 'https://chainid.network/chains.json';\n\n/**\n * Represents a single SLIP-44 entry with its metadata.\n */\nexport type Slip44Entry = {\n  index: string;\n  symbol: string;\n  name: string;\n};\n\n/**\n * Chain data from chainid.network\n */\ntype ChainIdNetworkEntry = {\n  chainId: number;\n  slip44?: number;\n  nativeCurrency?: {\n    symbol: string;\n  };\n};\n\n/**\n * Internal type for SLIP-44 data from the @metamask/slip44 package.\n * Includes the hex field which we don't expose externally.\n */\ntype Slip44DataEntry = Slip44Entry & {\n  // eslint-disable-next-line id-denylist\n  hex: `0x${string}`;\n};\n\n/**\n * The SLIP-44 mapping type from the @metamask/slip44 package.\n */\ntype Slip44Data = Record<string, Slip44DataEntry>;\n\n/**\n * Service for looking up SLIP-44 coin type identifiers.\n *\n * SLIP-44 defines registered coin types used in BIP-44 derivation paths.\n *\n * This service provides two lookup methods:\n * 1. `getEvmSlip44` - For EVM networks, uses chainid.network data (recommended for eip155)\n * 2. `getSlip44BySymbol` - Fallback method using @metamask/slip44 package\n *\n * @see https://github.com/satoshilabs/slips/blob/master/slip-0044.md\n * @see https://chainid.network/chains.json\n */\nexport class Slip44Service {\n  /**\n   * Cache for chainId to slip44 lookups from chainid.network.\n   */\n  static #chainIdCache: Map<number, number> | null = null;\n\n  /**\n   * Whether a fetch is currently in progress.\n   */\n  static #fetchPromise: Promise<void> | null = null;\n\n  /**\n   * Cache for symbol to slip44 index lookups.\n   * This avoids iterating through all entries on repeated lookups.\n   */\n  static readonly #symbolCache: Map<string, number | undefined> = new Map();\n\n  /**\n   * Fetches and caches chain data from chainid.network.\n   * This is called automatically by getEvmSlip44.\n   */\n  static async #fetchChainData(): Promise<void> {\n    if (this.#chainIdCache !== null) {\n      return;\n    }\n\n    // Avoid duplicate fetches\n    if (this.#fetchPromise) {\n      await this.#fetchPromise;\n      return;\n    }\n\n    this.#fetchPromise = (async (): Promise<void> => {\n      try {\n        const chains: ChainIdNetworkEntry[] | undefined =\n          await fetchWithErrorHandling({\n            url: CHAINID_NETWORK_URL,\n            timeout: 10000,\n          });\n\n        if (chains && Array.isArray(chains)) {\n          this.#chainIdCache = new Map(\n            chains\n              .filter(\n                (chain): chain is ChainIdNetworkEntry & { slip44: number } =>\n                  chain.slip44 !== undefined,\n              )\n              .map((chain) => [chain.chainId, chain.slip44]),\n          );\n        } else {\n          // Invalid response, initialize empty cache\n          this.#chainIdCache = new Map();\n        }\n      } catch {\n        // Network failed, initialize empty cache so we fall back to symbol lookup\n        this.#chainIdCache = new Map();\n      }\n    })();\n\n    await this.#fetchPromise;\n    this.#fetchPromise = null;\n  }\n\n  /**\n   * Gets the SLIP-44 coin type identifier for an EVM network by chain ID.\n   *\n   * **IMPORTANT: This method is for EVM networks only (eip155 namespace).**\n   * For non-EVM networks (Bitcoin, Solana, Tron, etc.), use `getSlip44BySymbol`.\n   *\n   * This method checks chainid.network data (which maps chainId directly\n   * to slip44). If not found, defaults to 60 (Ethereum).\n   *\n   * @param chainId - The EVM chain ID as a number (e.g., 1 for Ethereum, 56 for BNB Chain)\n   * @returns The SLIP-44 coin type number (defaults to 60 if not found)\n   * @example\n   * ```typescript\n   * // For EVM networks only\n   * const ethCoinType = await Slip44Service.getEvmSlip44(1);\n   * // Returns 60\n   *\n   * const bnbCoinType = await Slip44Service.getEvmSlip44(56);\n   * // Returns 714\n   *\n   * const unknownEvmChain = await Slip44Service.getEvmSlip44(99999);\n   * // Returns 60 (default for EVM)\n   * ```\n   */\n  static async getEvmSlip44(chainId: number): Promise<number> {\n    // Ensure chain data is loaded\n    await this.#fetchChainData();\n\n    // Check chainId cache first\n    const cached = this.#chainIdCache?.get(chainId);\n    if (cached !== undefined) {\n      return cached;\n    }\n\n    // Default to 60 (Ethereum) for EVM networks without specific mapping\n    return 60;\n  }\n\n  /**\n   * Gets the SLIP-44 coin type identifier for a non-EVM network by symbol.\n   *\n   * **IMPORTANT: This method is for non-EVM networks only (Bitcoin, Solana, Tron, etc.).**\n   * For EVM networks (eip155 namespace), use `getEvmSlip44` instead.\n   *\n   * Note: Symbol lookup may return incorrect results for duplicate symbols\n   * (e.g., CPC is both CPChain and Capricoin).\n   *\n   * @param symbol - The network symbol (e.g., 'ETH', 'BTC', 'SOL')\n   * @returns The SLIP-44 coin type number, or undefined if not found\n   * @example\n   * ```typescript\n   * const ethCoinType = Slip44Service.getSlip44BySymbol('ETH');\n   * // Returns 60\n   *\n   * const btcCoinType = Slip44Service.getSlip44BySymbol('BTC');\n   * // Returns 0\n   * ```\n   */\n  static getSlip44BySymbol(symbol: string): number | undefined {\n    // Check cache first\n    if (this.#symbolCache.has(symbol)) {\n      return this.#symbolCache.get(symbol);\n    }\n\n    const slip44Data = slip44 as Slip44Data;\n    const upperSymbol = symbol.toUpperCase();\n\n    // Iterate through all entries to find matching symbol\n    // Note: Object.keys returns numeric keys in ascending order,\n    // so for duplicate symbols we get the lowest coin type first\n    // (which is the convention for resolving duplicates)\n    for (const key of Object.keys(slip44Data)) {\n      const entry = slip44Data[key];\n      if (entry.symbol.toUpperCase() === upperSymbol) {\n        const coinType = parseInt(key, 10);\n        this.#symbolCache.set(symbol, coinType);\n        return coinType;\n      }\n    }\n\n    // Cache the miss as well to avoid repeated lookups\n    this.#symbolCache.set(symbol, undefined);\n    return undefined;\n  }\n\n  /**\n   * Clears all internal caches.\n   * Useful for testing or if the underlying data might change.\n   */\n  static clearCache(): void {\n    this.#symbolCache.clear();\n    this.#chainIdCache = null;\n    this.#fetchPromise = null;\n  }\n}\n"]}
\ No newline at end of file
diff --git a/dist/services/Slip44Service.d.cts b/dist/services/Slip44Service.d.cts
new file mode 100644
index 0000000000000000000000000000000000000000..0a6b7912e50647c8d3489f45d50600e088f4e812
--- /dev/null
+++ b/dist/services/Slip44Service.d.cts
@@ -0,0 +1,75 @@
+/**
+ * Represents a single SLIP-44 entry with its metadata.
+ */
+export type Slip44Entry = {
+    index: string;
+    symbol: string;
+    name: string;
+};
+/**
+ * Service for looking up SLIP-44 coin type identifiers.
+ *
+ * SLIP-44 defines registered coin types used in BIP-44 derivation paths.
+ *
+ * This service provides two lookup methods:
+ * 1. `getEvmSlip44` - For EVM networks, uses chainid.network data (recommended for eip155)
+ * 2. `getSlip44BySymbol` - Fallback method using @metamask/slip44 package
+ *
+ * @see https://github.com/satoshilabs/slips/blob/master/slip-0044.md
+ * @see https://chainid.network/chains.json
+ */
+export declare class Slip44Service {
+    #private;
+    /**
+     * Gets the SLIP-44 coin type identifier for an EVM network by chain ID.
+     *
+     * **IMPORTANT: This method is for EVM networks only (eip155 namespace).**
+     * For non-EVM networks (Bitcoin, Solana, Tron, etc.), use `getSlip44BySymbol`.
+     *
+     * This method checks chainid.network data (which maps chainId directly
+     * to slip44). If not found, defaults to 60 (Ethereum).
+     *
+     * @param chainId - The EVM chain ID as a number (e.g., 1 for Ethereum, 56 for BNB Chain)
+     * @returns The SLIP-44 coin type number (defaults to 60 if not found)
+     * @example
+     * ```typescript
+     * // For EVM networks only
+     * const ethCoinType = await Slip44Service.getEvmSlip44(1);
+     * // Returns 60
+     *
+     * const bnbCoinType = await Slip44Service.getEvmSlip44(56);
+     * // Returns 714
+     *
+     * const unknownEvmChain = await Slip44Service.getEvmSlip44(99999);
+     * // Returns 60 (default for EVM)
+     * ```
+     */
+    static getEvmSlip44(chainId: number): Promise<number>;
+    /**
+     * Gets the SLIP-44 coin type identifier for a non-EVM network by symbol.
+     *
+     * **IMPORTANT: This method is for non-EVM networks only (Bitcoin, Solana, Tron, etc.).**
+     * For EVM networks (eip155 namespace), use `getEvmSlip44` instead.
+     *
+     * Note: Symbol lookup may return incorrect results for duplicate symbols
+     * (e.g., CPC is both CPChain and Capricoin).
+     *
+     * @param symbol - The network symbol (e.g., 'ETH', 'BTC', 'SOL')
+     * @returns The SLIP-44 coin type number, or undefined if not found
+     * @example
+     * ```typescript
+     * const ethCoinType = Slip44Service.getSlip44BySymbol('ETH');
+     * // Returns 60
+     *
+     * const btcCoinType = Slip44Service.getSlip44BySymbol('BTC');
+     * // Returns 0
+     * ```
+     */
+    static getSlip44BySymbol(symbol: string): number | undefined;
+    /**
+     * Clears all internal caches.
+     * Useful for testing or if the underlying data might change.
+     */
+    static clearCache(): void;
+}
+//# sourceMappingURL=Slip44Service.d.cts.map
\ No newline at end of file
diff --git a/dist/services/Slip44Service.d.cts.map b/dist/services/Slip44Service.d.cts.map
new file mode 100644
index 0000000000000000000000000000000000000000..b145586b42e868b7d302009a486e09b9058b5ea7
--- /dev/null
+++ b/dist/services/Slip44Service.d.cts.map
@@ -0,0 +1 @@
+{"version":3,"file":"Slip44Service.d.cts","sourceRoot":"","sources":["../../src/services/Slip44Service.ts"],"names":[],"mappings":"AAMA;;GAEG;AACH,MAAM,MAAM,WAAW,GAAG;IACxB,KAAK,EAAE,MAAM,CAAC;IACd,MAAM,EAAE,MAAM,CAAC;IACf,IAAI,EAAE,MAAM,CAAC;CACd,CAAC;AA2BF;;;;;;;;;;;GAWG;AACH,qBAAa,aAAa;;IA+DxB;;;;;;;;;;;;;;;;;;;;;;;OAuBG;WACU,YAAY,CAAC,OAAO,EAAE,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;IAc3D;;;;;;;;;;;;;;;;;;;OAmBG;IACH,MAAM,CAAC,iBAAiB,CAAC,MAAM,EAAE,MAAM,GAAG,MAAM,GAAG,SAAS;IA2B5D;;;OAGG;IACH,MAAM,CAAC,UAAU,IAAI,IAAI;CAK1B"}
\ No newline at end of file
diff --git a/dist/services/Slip44Service.d.mts b/dist/services/Slip44Service.d.mts
new file mode 100644
index 0000000000000000000000000000000000000000..26dc90936a5dfb7c043a9aa5ef4e449fdd517486
--- /dev/null
+++ b/dist/services/Slip44Service.d.mts
@@ -0,0 +1,75 @@
+/**
+ * Represents a single SLIP-44 entry with its metadata.
+ */
+export type Slip44Entry = {
+    index: string;
+    symbol: string;
+    name: string;
+};
+/**
+ * Service for looking up SLIP-44 coin type identifiers.
+ *
+ * SLIP-44 defines registered coin types used in BIP-44 derivation paths.
+ *
+ * This service provides two lookup methods:
+ * 1. `getEvmSlip44` - For EVM networks, uses chainid.network data (recommended for eip155)
+ * 2. `getSlip44BySymbol` - Fallback method using @metamask/slip44 package
+ *
+ * @see https://github.com/satoshilabs/slips/blob/master/slip-0044.md
+ * @see https://chainid.network/chains.json
+ */
+export declare class Slip44Service {
+    #private;
+    /**
+     * Gets the SLIP-44 coin type identifier for an EVM network by chain ID.
+     *
+     * **IMPORTANT: This method is for EVM networks only (eip155 namespace).**
+     * For non-EVM networks (Bitcoin, Solana, Tron, etc.), use `getSlip44BySymbol`.
+     *
+     * This method checks chainid.network data (which maps chainId directly
+     * to slip44). If not found, defaults to 60 (Ethereum).
+     *
+     * @param chainId - The EVM chain ID as a number (e.g., 1 for Ethereum, 56 for BNB Chain)
+     * @returns The SLIP-44 coin type number (defaults to 60 if not found)
+     * @example
+     * ```typescript
+     * // For EVM networks only
+     * const ethCoinType = await Slip44Service.getEvmSlip44(1);
+     * // Returns 60
+     *
+     * const bnbCoinType = await Slip44Service.getEvmSlip44(56);
+     * // Returns 714
+     *
+     * const unknownEvmChain = await Slip44Service.getEvmSlip44(99999);
+     * // Returns 60 (default for EVM)
+     * ```
+     */
+    static getEvmSlip44(chainId: number): Promise<number>;
+    /**
+     * Gets the SLIP-44 coin type identifier for a non-EVM network by symbol.
+     *
+     * **IMPORTANT: This method is for non-EVM networks only (Bitcoin, Solana, Tron, etc.).**
+     * For EVM networks (eip155 namespace), use `getEvmSlip44` instead.
+     *
+     * Note: Symbol lookup may return incorrect results for duplicate symbols
+     * (e.g., CPC is both CPChain and Capricoin).
+     *
+     * @param symbol - The network symbol (e.g., 'ETH', 'BTC', 'SOL')
+     * @returns The SLIP-44 coin type number, or undefined if not found
+     * @example
+     * ```typescript
+     * const ethCoinType = Slip44Service.getSlip44BySymbol('ETH');
+     * // Returns 60
+     *
+     * const btcCoinType = Slip44Service.getSlip44BySymbol('BTC');
+     * // Returns 0
+     * ```
+     */
+    static getSlip44BySymbol(symbol: string): number | undefined;
+    /**
+     * Clears all internal caches.
+     * Useful for testing or if the underlying data might change.
+     */
+    static clearCache(): void;
+}
+//# sourceMappingURL=Slip44Service.d.mts.map
\ No newline at end of file
diff --git a/dist/services/Slip44Service.d.mts.map b/dist/services/Slip44Service.d.mts.map
new file mode 100644
index 0000000000000000000000000000000000000000..ac0cec2bd52d7627b434187d90d2e55774fe65f9
--- /dev/null
+++ b/dist/services/Slip44Service.d.mts.map
@@ -0,0 +1 @@
+{"version":3,"file":"Slip44Service.d.mts","sourceRoot":"","sources":["../../src/services/Slip44Service.ts"],"names":[],"mappings":"AAMA;;GAEG;AACH,MAAM,MAAM,WAAW,GAAG;IACxB,KAAK,EAAE,MAAM,CAAC;IACd,MAAM,EAAE,MAAM,CAAC;IACf,IAAI,EAAE,MAAM,CAAC;CACd,CAAC;AA2BF;;;;;;;;;;;GAWG;AACH,qBAAa,aAAa;;IA+DxB;;;;;;;;;;;;;;;;;;;;;;;OAuBG;WACU,YAAY,CAAC,OAAO,EAAE,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;IAc3D;;;;;;;;;;;;;;;;;;;OAmBG;IACH,MAAM,CAAC,iBAAiB,CAAC,MAAM,EAAE,MAAM,GAAG,MAAM,GAAG,SAAS;IA2B5D;;;OAGG;IACH,MAAM,CAAC,UAAU,IAAI,IAAI;CAK1B"}
\ No newline at end of file
diff --git a/dist/services/Slip44Service.mjs b/dist/services/Slip44Service.mjs
new file mode 100644
index 0000000000000000000000000000000000000000..782a18888f545764690624ea69c5c0fe439a623b
--- /dev/null
+++ b/dist/services/Slip44Service.mjs
@@ -0,0 +1,164 @@
+var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
+    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
+    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
+    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
+};
+var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
+    if (kind === "m") throw new TypeError("Private method is not writable");
+    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
+    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
+    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
+};
+var _a, _Slip44Service_chainIdCache, _Slip44Service_fetchPromise, _Slip44Service_symbolCache, _Slip44Service_fetchChainData;
+import { fetchWithErrorHandling } from "@metamask/controller-utils";
+// @ts-expect-error: No type definitions for '@metamask/slip44'
+import slip44 from "@metamask/slip44" with { type: "json" };
+const CHAINID_NETWORK_URL = 'https://chainid.network/chains.json';
+/**
+ * Service for looking up SLIP-44 coin type identifiers.
+ *
+ * SLIP-44 defines registered coin types used in BIP-44 derivation paths.
+ *
+ * This service provides two lookup methods:
+ * 1. `getEvmSlip44` - For EVM networks, uses chainid.network data (recommended for eip155)
+ * 2. `getSlip44BySymbol` - Fallback method using @metamask/slip44 package
+ *
+ * @see https://github.com/satoshilabs/slips/blob/master/slip-0044.md
+ * @see https://chainid.network/chains.json
+ */
+export class Slip44Service {
+    /**
+     * Gets the SLIP-44 coin type identifier for an EVM network by chain ID.
+     *
+     * **IMPORTANT: This method is for EVM networks only (eip155 namespace).**
+     * For non-EVM networks (Bitcoin, Solana, Tron, etc.), use `getSlip44BySymbol`.
+     *
+     * This method checks chainid.network data (which maps chainId directly
+     * to slip44). If not found, defaults to 60 (Ethereum).
+     *
+     * @param chainId - The EVM chain ID as a number (e.g., 1 for Ethereum, 56 for BNB Chain)
+     * @returns The SLIP-44 coin type number (defaults to 60 if not found)
+     * @example
+     * ```typescript
+     * // For EVM networks only
+     * const ethCoinType = await Slip44Service.getEvmSlip44(1);
+     * // Returns 60
+     *
+     * const bnbCoinType = await Slip44Service.getEvmSlip44(56);
+     * // Returns 714
+     *
+     * const unknownEvmChain = await Slip44Service.getEvmSlip44(99999);
+     * // Returns 60 (default for EVM)
+     * ```
+     */
+    static async getEvmSlip44(chainId) {
+        // Ensure chain data is loaded
+        await __classPrivateFieldGet(this, _a, "m", _Slip44Service_fetchChainData).call(this);
+        // Check chainId cache first
+        const cached = __classPrivateFieldGet(this, _a, "f", _Slip44Service_chainIdCache)?.get(chainId);
+        if (cached !== undefined) {
+            return cached;
+        }
+        // Default to 60 (Ethereum) for EVM networks without specific mapping
+        return 60;
+    }
+    /**
+     * Gets the SLIP-44 coin type identifier for a non-EVM network by symbol.
+     *
+     * **IMPORTANT: This method is for non-EVM networks only (Bitcoin, Solana, Tron, etc.).**
+     * For EVM networks (eip155 namespace), use `getEvmSlip44` instead.
+     *
+     * Note: Symbol lookup may return incorrect results for duplicate symbols
+     * (e.g., CPC is both CPChain and Capricoin).
+     *
+     * @param symbol - The network symbol (e.g., 'ETH', 'BTC', 'SOL')
+     * @returns The SLIP-44 coin type number, or undefined if not found
+     * @example
+     * ```typescript
+     * const ethCoinType = Slip44Service.getSlip44BySymbol('ETH');
+     * // Returns 60
+     *
+     * const btcCoinType = Slip44Service.getSlip44BySymbol('BTC');
+     * // Returns 0
+     * ```
+     */
+    static getSlip44BySymbol(symbol) {
+        // Check cache first
+        if (__classPrivateFieldGet(this, _a, "f", _Slip44Service_symbolCache).has(symbol)) {
+            return __classPrivateFieldGet(this, _a, "f", _Slip44Service_symbolCache).get(symbol);
+        }
+        const slip44Data = slip44;
+        const upperSymbol = symbol.toUpperCase();
+        // Iterate through all entries to find matching symbol
+        // Note: Object.keys returns numeric keys in ascending order,
+        // so for duplicate symbols we get the lowest coin type first
+        // (which is the convention for resolving duplicates)
+        for (const key of Object.keys(slip44Data)) {
+            const entry = slip44Data[key];
+            if (entry.symbol.toUpperCase() === upperSymbol) {
+                const coinType = parseInt(key, 10);
+                __classPrivateFieldGet(this, _a, "f", _Slip44Service_symbolCache).set(symbol, coinType);
+                return coinType;
+            }
+        }
+        // Cache the miss as well to avoid repeated lookups
+        __classPrivateFieldGet(this, _a, "f", _Slip44Service_symbolCache).set(symbol, undefined);
+        return undefined;
+    }
+    /**
+     * Clears all internal caches.
+     * Useful for testing or if the underlying data might change.
+     */
+    static clearCache() {
+        __classPrivateFieldGet(this, _a, "f", _Slip44Service_symbolCache).clear();
+        __classPrivateFieldSet(this, _a, null, "f", _Slip44Service_chainIdCache);
+        __classPrivateFieldSet(this, _a, null, "f", _Slip44Service_fetchPromise);
+    }
+}
+_a = Slip44Service, _Slip44Service_fetchChainData = async function _Slip44Service_fetchChainData() {
+    if (__classPrivateFieldGet(this, _a, "f", _Slip44Service_chainIdCache) !== null) {
+        return;
+    }
+    // Avoid duplicate fetches
+    if (__classPrivateFieldGet(this, _a, "f", _Slip44Service_fetchPromise)) {
+        await __classPrivateFieldGet(this, _a, "f", _Slip44Service_fetchPromise);
+        return;
+    }
+    __classPrivateFieldSet(this, _a, (async () => {
+        try {
+            const chains = await fetchWithErrorHandling({
+                url: CHAINID_NETWORK_URL,
+                timeout: 10000,
+            });
+            if (chains && Array.isArray(chains)) {
+                __classPrivateFieldSet(this, _a, new Map(chains
+                    .filter((chain) => chain.slip44 !== undefined)
+                    .map((chain) => [chain.chainId, chain.slip44])), "f", _Slip44Service_chainIdCache);
+            }
+            else {
+                // Invalid response, initialize empty cache
+                __classPrivateFieldSet(this, _a, new Map(), "f", _Slip44Service_chainIdCache);
+            }
+        }
+        catch {
+            // Network failed, initialize empty cache so we fall back to symbol lookup
+            __classPrivateFieldSet(this, _a, new Map(), "f", _Slip44Service_chainIdCache);
+        }
+    })(), "f", _Slip44Service_fetchPromise);
+    await __classPrivateFieldGet(this, _a, "f", _Slip44Service_fetchPromise);
+    __classPrivateFieldSet(this, _a, null, "f", _Slip44Service_fetchPromise);
+};
+/**
+ * Cache for chainId to slip44 lookups from chainid.network.
+ */
+_Slip44Service_chainIdCache = { value: null };
+/**
+ * Whether a fetch is currently in progress.
+ */
+_Slip44Service_fetchPromise = { value: null };
+/**
+ * Cache for symbol to slip44 index lookups.
+ * This avoids iterating through all entries on repeated lookups.
+ */
+_Slip44Service_symbolCache = { value: new Map() };
+//# sourceMappingURL=Slip44Service.mjs.map
\ No newline at end of file
diff --git a/dist/services/Slip44Service.mjs.map b/dist/services/Slip44Service.mjs.map
new file mode 100644
index 0000000000000000000000000000000000000000..380e7e7db9b38526a7aaca6806308fedcb04d083
--- /dev/null
+++ b/dist/services/Slip44Service.mjs.map
@@ -0,0 +1 @@
+{"version":3,"file":"Slip44Service.mjs","sourceRoot":"","sources":["../../src/services/Slip44Service.ts"],"names":[],"mappings":"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","sourcesContent":["import { fetchWithErrorHandling } from '@metamask/controller-utils';\n// @ts-expect-error: No type definitions for '@metamask/slip44'\nimport slip44 from '@metamask/slip44';\n\nconst CHAINID_NETWORK_URL = 'https://chainid.network/chains.json';\n\n/**\n * Represents a single SLIP-44 entry with its metadata.\n */\nexport type Slip44Entry = {\n  index: string;\n  symbol: string;\n  name: string;\n};\n\n/**\n * Chain data from chainid.network\n */\ntype ChainIdNetworkEntry = {\n  chainId: number;\n  slip44?: number;\n  nativeCurrency?: {\n    symbol: string;\n  };\n};\n\n/**\n * Internal type for SLIP-44 data from the @metamask/slip44 package.\n * Includes the hex field which we don't expose externally.\n */\ntype Slip44DataEntry = Slip44Entry & {\n  // eslint-disable-next-line id-denylist\n  hex: `0x${string}`;\n};\n\n/**\n * The SLIP-44 mapping type from the @metamask/slip44 package.\n */\ntype Slip44Data = Record<string, Slip44DataEntry>;\n\n/**\n * Service for looking up SLIP-44 coin type identifiers.\n *\n * SLIP-44 defines registered coin types used in BIP-44 derivation paths.\n *\n * This service provides two lookup methods:\n * 1. `getEvmSlip44` - For EVM networks, uses chainid.network data (recommended for eip155)\n * 2. `getSlip44BySymbol` - Fallback method using @metamask/slip44 package\n *\n * @see https://github.com/satoshilabs/slips/blob/master/slip-0044.md\n * @see https://chainid.network/chains.json\n */\nexport class Slip44Service {\n  /**\n   * Cache for chainId to slip44 lookups from chainid.network.\n   */\n  static #chainIdCache: Map<number, number> | null = null;\n\n  /**\n   * Whether a fetch is currently in progress.\n   */\n  static #fetchPromise: Promise<void> | null = null;\n\n  /**\n   * Cache for symbol to slip44 index lookups.\n   * This avoids iterating through all entries on repeated lookups.\n   */\n  static readonly #symbolCache: Map<string, number | undefined> = new Map();\n\n  /**\n   * Fetches and caches chain data from chainid.network.\n   * This is called automatically by getEvmSlip44.\n   */\n  static async #fetchChainData(): Promise<void> {\n    if (this.#chainIdCache !== null) {\n      return;\n    }\n\n    // Avoid duplicate fetches\n    if (this.#fetchPromise) {\n      await this.#fetchPromise;\n      return;\n    }\n\n    this.#fetchPromise = (async (): Promise<void> => {\n      try {\n        const chains: ChainIdNetworkEntry[] | undefined =\n          await fetchWithErrorHandling({\n            url: CHAINID_NETWORK_URL,\n            timeout: 10000,\n          });\n\n        if (chains && Array.isArray(chains)) {\n          this.#chainIdCache = new Map(\n            chains\n              .filter(\n                (chain): chain is ChainIdNetworkEntry & { slip44: number } =>\n                  chain.slip44 !== undefined,\n              )\n              .map((chain) => [chain.chainId, chain.slip44]),\n          );\n        } else {\n          // Invalid response, initialize empty cache\n          this.#chainIdCache = new Map();\n        }\n      } catch {\n        // Network failed, initialize empty cache so we fall back to symbol lookup\n        this.#chainIdCache = new Map();\n      }\n    })();\n\n    await this.#fetchPromise;\n    this.#fetchPromise = null;\n  }\n\n  /**\n   * Gets the SLIP-44 coin type identifier for an EVM network by chain ID.\n   *\n   * **IMPORTANT: This method is for EVM networks only (eip155 namespace).**\n   * For non-EVM networks (Bitcoin, Solana, Tron, etc.), use `getSlip44BySymbol`.\n   *\n   * This method checks chainid.network data (which maps chainId directly\n   * to slip44). If not found, defaults to 60 (Ethereum).\n   *\n   * @param chainId - The EVM chain ID as a number (e.g., 1 for Ethereum, 56 for BNB Chain)\n   * @returns The SLIP-44 coin type number (defaults to 60 if not found)\n   * @example\n   * ```typescript\n   * // For EVM networks only\n   * const ethCoinType = await Slip44Service.getEvmSlip44(1);\n   * // Returns 60\n   *\n   * const bnbCoinType = await Slip44Service.getEvmSlip44(56);\n   * // Returns 714\n   *\n   * const unknownEvmChain = await Slip44Service.getEvmSlip44(99999);\n   * // Returns 60 (default for EVM)\n   * ```\n   */\n  static async getEvmSlip44(chainId: number): Promise<number> {\n    // Ensure chain data is loaded\n    await this.#fetchChainData();\n\n    // Check chainId cache first\n    const cached = this.#chainIdCache?.get(chainId);\n    if (cached !== undefined) {\n      return cached;\n    }\n\n    // Default to 60 (Ethereum) for EVM networks without specific mapping\n    return 60;\n  }\n\n  /**\n   * Gets the SLIP-44 coin type identifier for a non-EVM network by symbol.\n   *\n   * **IMPORTANT: This method is for non-EVM networks only (Bitcoin, Solana, Tron, etc.).**\n   * For EVM networks (eip155 namespace), use `getEvmSlip44` instead.\n   *\n   * Note: Symbol lookup may return incorrect results for duplicate symbols\n   * (e.g., CPC is both CPChain and Capricoin).\n   *\n   * @param symbol - The network symbol (e.g., 'ETH', 'BTC', 'SOL')\n   * @returns The SLIP-44 coin type number, or undefined if not found\n   * @example\n   * ```typescript\n   * const ethCoinType = Slip44Service.getSlip44BySymbol('ETH');\n   * // Returns 60\n   *\n   * const btcCoinType = Slip44Service.getSlip44BySymbol('BTC');\n   * // Returns 0\n   * ```\n   */\n  static getSlip44BySymbol(symbol: string): number | undefined {\n    // Check cache first\n    if (this.#symbolCache.has(symbol)) {\n      return this.#symbolCache.get(symbol);\n    }\n\n    const slip44Data = slip44 as Slip44Data;\n    const upperSymbol = symbol.toUpperCase();\n\n    // Iterate through all entries to find matching symbol\n    // Note: Object.keys returns numeric keys in ascending order,\n    // so for duplicate symbols we get the lowest coin type first\n    // (which is the convention for resolving duplicates)\n    for (const key of Object.keys(slip44Data)) {\n      const entry = slip44Data[key];\n      if (entry.symbol.toUpperCase() === upperSymbol) {\n        const coinType = parseInt(key, 10);\n        this.#symbolCache.set(symbol, coinType);\n        return coinType;\n      }\n    }\n\n    // Cache the miss as well to avoid repeated lookups\n    this.#symbolCache.set(symbol, undefined);\n    return undefined;\n  }\n\n  /**\n   * Clears all internal caches.\n   * Useful for testing or if the underlying data might change.\n   */\n  static clearCache(): void {\n    this.#symbolCache.clear();\n    this.#chainIdCache = null;\n    this.#fetchPromise = null;\n  }\n}\n"]}
\ No newline at end of file
diff --git a/dist/services/index.cjs b/dist/services/index.cjs
new file mode 100644
index 0000000000000000000000000000000000000000..4d5b66e8284548400bd2ecaaf841559c9de2129a
--- /dev/null
+++ b/dist/services/index.cjs
@@ -0,0 +1,11 @@
+"use strict";
+Object.defineProperty(exports, "__esModule", { value: true });
+exports.getSlip44BySymbol = exports.getEvmSlip44 = exports.Slip44Service = void 0;
+const Slip44Service_1 = require("./Slip44Service.cjs");
+Object.defineProperty(exports, "Slip44Service", { enumerable: true, get: function () { return Slip44Service_1.Slip44Service; } });
+// Re-export static methods as standalone functions for convenience
+// getEvmSlip44: For EVM networks (eip155) - uses chainId lookup, defaults to 60
+exports.getEvmSlip44 = Slip44Service_1.Slip44Service.getEvmSlip44.bind(Slip44Service_1.Slip44Service);
+// getSlip44BySymbol: For non-EVM networks (Bitcoin, Solana, Tron) - uses symbol lookup
+exports.getSlip44BySymbol = Slip44Service_1.Slip44Service.getSlip44BySymbol.bind(Slip44Service_1.Slip44Service);
+//# sourceMappingURL=index.cjs.map
\ No newline at end of file
diff --git a/dist/services/index.cjs.map b/dist/services/index.cjs.map
new file mode 100644
index 0000000000000000000000000000000000000000..967e2344f923fb6d63fe2d2237eec0ec3730b5e6
--- /dev/null
+++ b/dist/services/index.cjs.map
@@ -0,0 +1 @@
+{"version":3,"file":"index.cjs","sourceRoot":"","sources":["../../src/services/index.ts"],"names":[],"mappings":";;;AAAA,uDAAgD;AAEvC,8FAFA,6BAAa,OAEA;AAEtB,mEAAmE;AACnE,gFAAgF;AACnE,QAAA,YAAY,GAAG,6BAAa,CAAC,YAAY,CAAC,IAAI,CAAC,6BAAa,CAAC,CAAC;AAC3E,uFAAuF;AAC1E,QAAA,iBAAiB,GAC5B,6BAAa,CAAC,iBAAiB,CAAC,IAAI,CAAC,6BAAa,CAAC,CAAC","sourcesContent":["import { Slip44Service } from './Slip44Service';\n\nexport { Slip44Service };\n\n// Re-export static methods as standalone functions for convenience\n// getEvmSlip44: For EVM networks (eip155) - uses chainId lookup, defaults to 60\nexport const getEvmSlip44 = Slip44Service.getEvmSlip44.bind(Slip44Service);\n// getSlip44BySymbol: For non-EVM networks (Bitcoin, Solana, Tron) - uses symbol lookup\nexport const getSlip44BySymbol =\n  Slip44Service.getSlip44BySymbol.bind(Slip44Service);\n"]}
\ No newline at end of file
diff --git a/dist/services/index.d.cts b/dist/services/index.d.cts
new file mode 100644
index 0000000000000000000000000000000000000000..69e75a9dc750afb2e42a2688e073b4d01485f36a
--- /dev/null
+++ b/dist/services/index.d.cts
@@ -0,0 +1,5 @@
+import { Slip44Service } from "./Slip44Service.cjs";
+export { Slip44Service };
+export declare const getEvmSlip44: typeof Slip44Service.getEvmSlip44;
+export declare const getSlip44BySymbol: typeof Slip44Service.getSlip44BySymbol;
+//# sourceMappingURL=index.d.cts.map
\ No newline at end of file
diff --git a/dist/services/index.d.cts.map b/dist/services/index.d.cts.map
new file mode 100644
index 0000000000000000000000000000000000000000..f65b6f808ffdf1b9e171275208f7cc63508983d3
--- /dev/null
+++ b/dist/services/index.d.cts.map
@@ -0,0 +1 @@
+{"version":3,"file":"index.d.cts","sourceRoot":"","sources":["../../src/services/index.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,aAAa,EAAE,4BAAwB;AAEhD,OAAO,EAAE,aAAa,EAAE,CAAC;AAIzB,eAAO,MAAM,YAAY,mCAAiD,CAAC;AAE3E,eAAO,MAAM,iBAAiB,wCACuB,CAAC"}
\ No newline at end of file
diff --git a/dist/services/index.d.mts b/dist/services/index.d.mts
new file mode 100644
index 0000000000000000000000000000000000000000..b9c62eaa34265b6f994a09c052dd1bd4b3a663d1
--- /dev/null
+++ b/dist/services/index.d.mts
@@ -0,0 +1,5 @@
+import { Slip44Service } from "./Slip44Service.mjs";
+export { Slip44Service };
+export declare const getEvmSlip44: typeof Slip44Service.getEvmSlip44;
+export declare const getSlip44BySymbol: typeof Slip44Service.getSlip44BySymbol;
+//# sourceMappingURL=index.d.mts.map
\ No newline at end of file
diff --git a/dist/services/index.d.mts.map b/dist/services/index.d.mts.map
new file mode 100644
index 0000000000000000000000000000000000000000..8ae138b460118fc29c8b89a1fd402c15e4ea2cfc
--- /dev/null
+++ b/dist/services/index.d.mts.map
@@ -0,0 +1 @@
+{"version":3,"file":"index.d.mts","sourceRoot":"","sources":["../../src/services/index.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,aAAa,EAAE,4BAAwB;AAEhD,OAAO,EAAE,aAAa,EAAE,CAAC;AAIzB,eAAO,MAAM,YAAY,mCAAiD,CAAC;AAE3E,eAAO,MAAM,iBAAiB,wCACuB,CAAC"}
\ No newline at end of file
diff --git a/dist/services/index.mjs b/dist/services/index.mjs
new file mode 100644
index 0000000000000000000000000000000000000000..fae225176442696f809fb3d6713756e623cc8ed5
--- /dev/null
+++ b/dist/services/index.mjs
@@ -0,0 +1,8 @@
+import { Slip44Service } from "./Slip44Service.mjs";
+export { Slip44Service };
+// Re-export static methods as standalone functions for convenience
+// getEvmSlip44: For EVM networks (eip155) - uses chainId lookup, defaults to 60
+export const getEvmSlip44 = Slip44Service.getEvmSlip44.bind(Slip44Service);
+// getSlip44BySymbol: For non-EVM networks (Bitcoin, Solana, Tron) - uses symbol lookup
+export const getSlip44BySymbol = Slip44Service.getSlip44BySymbol.bind(Slip44Service);
+//# sourceMappingURL=index.mjs.map
\ No newline at end of file
diff --git a/dist/services/index.mjs.map b/dist/services/index.mjs.map
new file mode 100644
index 0000000000000000000000000000000000000000..fb8bc0517e7311d5c310c16efd52086da8cbc675
--- /dev/null
+++ b/dist/services/index.mjs.map
@@ -0,0 +1 @@
+{"version":3,"file":"index.mjs","sourceRoot":"","sources":["../../src/services/index.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,aAAa,EAAE,4BAAwB;AAEhD,OAAO,EAAE,aAAa,EAAE,CAAC;AAEzB,mEAAmE;AACnE,gFAAgF;AAChF,MAAM,CAAC,MAAM,YAAY,GAAG,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;AAC3E,uFAAuF;AACvF,MAAM,CAAC,MAAM,iBAAiB,GAC5B,aAAa,CAAC,iBAAiB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC","sourcesContent":["import { Slip44Service } from './Slip44Service';\n\nexport { Slip44Service };\n\n// Re-export static methods as standalone functions for convenience\n// getEvmSlip44: For EVM networks (eip155) - uses chainId lookup, defaults to 60\nexport const getEvmSlip44 = Slip44Service.getEvmSlip44.bind(Slip44Service);\n// getSlip44BySymbol: For non-EVM networks (Bitcoin, Solana, Tron) - uses symbol lookup\nexport const getSlip44BySymbol =\n  Slip44Service.getSlip44BySymbol.bind(Slip44Service);\n"]}
\ No newline at end of file
diff --git a/dist/utils.cjs.map b/dist/utils.cjs.map
index 363ac953fa9bc4d94a26a16552b1a0945ce836de..226a8a3b4c35c52a0a461885529eea2b6f30b9d6 100644
--- a/dist/utils.cjs.map
+++ b/dist/utils.cjs.map
@@ -1 +1 @@
-{"version":3,"file":"utils.cjs","sourceRoot":"","sources":["../src/utils.ts"],"names":[],"mappings":";;;AAAA,iEAAmD;AACnD,2FAA2E;AAE3E,2CAKyB;AAEzB,+CAA+C;AAa/C;;;;;;;;;;;GAWG;AACH,SAAgB,UAAU,CAAC,OAA0B;IACnD,MAAM,WAAW,GAAG,IAAA,qBAAa,EAAC,OAAO,CAAC;QACxC,CAAC,CAAC,OAAO;QACT,CAAC,CAAC,IAAA,gDAAgB,EAAC,OAAO,CAAC,CAAC;IAE9B,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG,IAAA,wBAAgB,EAAC,WAAW,CAAC,CAAC;IAC/D,IAAI,UAAU,CAAC;IACf,IAAI,SAAS,KAAM,0BAAkB,CAAC,MAAiB,EAAE;QACvD,UAAU,GAAG,IAAA,mBAAW,EAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,IAAA,wBAAK,EAAC,SAAS,CAAC,CAAC;KAChE;SAAM;QACL,UAAU,GAAG,WAAW,CAAC;KAC1B;IACD,OAAO,EAAE,SAAS,EAAE,UAAU,EAAE,WAAW,EAAE,SAAS,EAAE,CAAC;AAC3D,CAAC;AAbD,gCAaC;AAED;;;;;;;;;GASG;AACH,SAAgB,+BAA+B,CAC7C,KAAuC,EACvC,WAAwB;IAExB,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,WAAW,CAAC;IAE9C,0CAA0C;IAC1C,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE;QACvC,OAAO,KAAK,CAAC;KACd;IAED,MAAM,QAAQ,GAAG,KAAK,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;IAEpD,6CAA6C;IAC7C,MAAM,eAAe,GAAG,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,MAAM,CACrD,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC,OAAO,CAC1B,CAAC;IAEF,yEAAyE;IACzE,IAAI,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE;QAChC,MAAM,CAAC,cAAc,CAAC,GAAG,eAAe,CAAC,CAAC,CAAC,CAAC;QAC5C,OAAO,cAAc,KAAK,UAAU,CAAC;KACtC;IAED,8DAA8D;IAC9D,OAAO,KAAK,CAAC;AACf,CAAC;AA1BD,0EA0BC;AAED;;;;;GAKG;AACH,SAAgB,gBAAgB,CAAC,SAAiB;IAChD,IAAI;QACF,OAAO,4BAAgB,CAAC,QAAQ,CAAC,IAAA,wBAAK,EAAC,SAAS,CAAC,CAAC,CAAC;KACpD;IAAC,MAAM;QACN,yEAAyE;QACzE,6BAA6B;QAC7B,OAAO,KAAK,CAAC;KACd;AACH,CAAC;AARD,4CAQC","sourcesContent":["import { toHex } from '@metamask/controller-utils';\nimport { toEvmCaipChainId } from '@metamask/multichain-network-controller';\nimport type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';\nimport {\n  isCaipChainId,\n  isHexString,\n  KnownCaipNamespace,\n  parseCaipChainId,\n} from '@metamask/utils';\n\nimport { POPULAR_NETWORKS } from './constants';\nimport type { NetworkEnablementControllerState } from './NetworkEnablementController';\n\n/**\n * Represents the parsed keys derived from a chain ID.\n */\nexport type DerivedKeys = {\n  namespace: CaipNamespace;\n  storageKey: Hex | CaipChainId;\n  caipChainId: CaipChainId;\n  reference: string;\n};\n\n/**\n * Derives the namespace, storage key, and CAIP chain ID from a given chain ID.\n *\n * This utility function handles the conversion between different chain ID formats.\n * For EVM networks, it converts Hex chain IDs to CAIP-2 format and determines\n * the appropriate storage key. For non-EVM networks, it parses the CAIP-2 chain ID\n * and uses the full chain ID as the storage key.\n *\n * @param chainId - The chain ID to derive keys from (Hex or CAIP-2 format)\n * @returns An object containing namespace, storageKey, and caipId\n * @throws Error if the chain ID cannot be parsed\n */\nexport function deriveKeys(chainId: Hex | CaipChainId): DerivedKeys {\n  const caipChainId = isCaipChainId(chainId)\n    ? chainId\n    : toEvmCaipChainId(chainId);\n\n  const { namespace, reference } = parseCaipChainId(caipChainId);\n  let storageKey;\n  if (namespace === (KnownCaipNamespace.Eip155 as string)) {\n    storageKey = isHexString(chainId) ? chainId : toHex(reference);\n  } else {\n    storageKey = caipChainId;\n  }\n  return { namespace, storageKey, caipChainId, reference };\n}\n\n/**\n * Checks if the specified network is the only enabled network in its namespace.\n *\n * This function is used to prevent unnecessary state updates when trying to enable\n * This method is used to prevent the last network in a namespace from being removed.\n *\n * @param state - The current controller state\n * @param derivedKeys - The parsed keys object containing namespace and storageKey\n * @returns True if the network is the only enabled network in the namespace, false otherwise\n */\nexport function isOnlyNetworkEnabledInNamespace(\n  state: NetworkEnablementControllerState,\n  derivedKeys: DerivedKeys,\n): boolean {\n  const { namespace, storageKey } = derivedKeys;\n\n  // Early return if namespace doesn't exist\n  if (!state.enabledNetworkMap[namespace]) {\n    return false;\n  }\n\n  const networks = state.enabledNetworkMap[namespace];\n\n  // Get all enabled networks in this namespace\n  const enabledNetworks = Object.entries(networks).filter(\n    ([_, enabled]) => enabled,\n  );\n\n  // Check if there's exactly one enabled network and it matches our target\n  if (enabledNetworks.length === 1) {\n    const [onlyEnabledKey] = enabledNetworks[0];\n    return onlyEnabledKey === storageKey;\n  }\n\n  // Return false if there are zero or multiple enabled networks\n  return false;\n}\n\n/**\n * Checks if a network is considered popular based on its reference.\n *\n * @param reference - The network reference (typically the chain ID reference part)\n * @returns True if the network is popular, false otherwise\n */\nexport function isPopularNetwork(reference: string): boolean {\n  try {\n    return POPULAR_NETWORKS.includes(toHex(reference));\n  } catch {\n    // If toHex fails (e.g., for non-decimal references like Bitcoin hashes),\n    // the network is not popular\n    return false;\n  }\n}\n"]}
\ No newline at end of file
+{"version":3,"file":"utils.cjs","sourceRoot":"","sources":["../src/utils.ts"],"names":[],"mappings":";;;AAAA,iEAAmD;AACnD,2FAA2E;AAE3E,2CAKyB;AAEzB,+CAA+C;AAa/C;;;;;;;;;;;GAWG;AACH,SAAgB,UAAU,CAAC,OAA0B;IACnD,MAAM,WAAW,GAAG,IAAA,qBAAa,EAAC,OAAO,CAAC;QACxC,CAAC,CAAC,OAAO;QACT,CAAC,CAAC,IAAA,gDAAgB,EAAC,OAAO,CAAC,CAAC;IAE9B,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG,IAAA,wBAAgB,EAAC,WAAW,CAAC,CAAC;IAC/D,IAAI,UAAU,CAAC;IACf,IAAI,SAAS,KAAM,0BAAkB,CAAC,MAAiB,EAAE,CAAC;QACxD,UAAU,GAAG,IAAA,mBAAW,EAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,IAAA,wBAAK,EAAC,SAAS,CAAC,CAAC;IACjE,CAAC;SAAM,CAAC;QACN,UAAU,GAAG,WAAW,CAAC;IAC3B,CAAC;IACD,OAAO,EAAE,SAAS,EAAE,UAAU,EAAE,WAAW,EAAE,SAAS,EAAE,CAAC;AAC3D,CAAC;AAbD,gCAaC;AAED;;;;;;;;;GASG;AACH,SAAgB,+BAA+B,CAC7C,KAAuC,EACvC,WAAwB;IAExB,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,WAAW,CAAC;IAE9C,0CAA0C;IAC1C,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE,CAAC;QACxC,OAAO,KAAK,CAAC;IACf,CAAC;IAED,MAAM,QAAQ,GAAG,KAAK,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;IAEpD,6CAA6C;IAC7C,MAAM,eAAe,GAAG,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,MAAM,CACrD,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC,OAAO,CAC1B,CAAC;IAEF,yEAAyE;IACzE,IAAI,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;QACjC,MAAM,CAAC,cAAc,CAAC,GAAG,eAAe,CAAC,CAAC,CAAC,CAAC;QAC5C,OAAO,cAAc,KAAK,UAAU,CAAC;IACvC,CAAC;IAED,8DAA8D;IAC9D,OAAO,KAAK,CAAC;AACf,CAAC;AA1BD,0EA0BC;AAED;;;;;GAKG;AACH,SAAgB,gBAAgB,CAAC,SAAiB;IAChD,IAAI,CAAC;QACH,OAAO,4BAAgB,CAAC,QAAQ,CAAC,IAAA,wBAAK,EAAC,SAAS,CAAC,CAAC,CAAC;IACrD,CAAC;IAAC,MAAM,CAAC;QACP,yEAAyE;QACzE,6BAA6B;QAC7B,OAAO,KAAK,CAAC;IACf,CAAC;AACH,CAAC;AARD,4CAQC","sourcesContent":["import { toHex } from '@metamask/controller-utils';\nimport { toEvmCaipChainId } from '@metamask/multichain-network-controller';\nimport type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';\nimport {\n  isCaipChainId,\n  isHexString,\n  KnownCaipNamespace,\n  parseCaipChainId,\n} from '@metamask/utils';\n\nimport { POPULAR_NETWORKS } from './constants';\nimport type { NetworkEnablementControllerState } from './NetworkEnablementController';\n\n/**\n * Represents the parsed keys derived from a chain ID.\n */\nexport type DerivedKeys = {\n  namespace: CaipNamespace;\n  storageKey: Hex | CaipChainId;\n  caipChainId: CaipChainId;\n  reference: string;\n};\n\n/**\n * Derives the namespace, storage key, and CAIP chain ID from a given chain ID.\n *\n * This utility function handles the conversion between different chain ID formats.\n * For EVM networks, it converts Hex chain IDs to CAIP-2 format and determines\n * the appropriate storage key. For non-EVM networks, it parses the CAIP-2 chain ID\n * and uses the full chain ID as the storage key.\n *\n * @param chainId - The chain ID to derive keys from (Hex or CAIP-2 format)\n * @returns An object containing namespace, storageKey, and caipId\n * @throws Error if the chain ID cannot be parsed\n */\nexport function deriveKeys(chainId: Hex | CaipChainId): DerivedKeys {\n  const caipChainId = isCaipChainId(chainId)\n    ? chainId\n    : toEvmCaipChainId(chainId);\n\n  const { namespace, reference } = parseCaipChainId(caipChainId);\n  let storageKey;\n  if (namespace === (KnownCaipNamespace.Eip155 as string)) {\n    storageKey = isHexString(chainId) ? chainId : toHex(reference);\n  } else {\n    storageKey = caipChainId;\n  }\n  return { namespace, storageKey, caipChainId, reference };\n}\n\n/**\n * Checks if the specified network is the only enabled network in its namespace.\n *\n * This function is used to prevent unnecessary state updates when trying to enable\n * This method is used to prevent the last network in a namespace from being removed.\n *\n * @param state - The current controller state\n * @param derivedKeys - The parsed keys object containing namespace and storageKey\n * @returns True if the network is the only enabled network in the namespace, false otherwise\n */\nexport function isOnlyNetworkEnabledInNamespace(\n  state: NetworkEnablementControllerState,\n  derivedKeys: DerivedKeys,\n): boolean {\n  const { namespace, storageKey } = derivedKeys;\n\n  // Early return if namespace doesn't exist\n  if (!state.enabledNetworkMap[namespace]) {\n    return false;\n  }\n\n  const networks = state.enabledNetworkMap[namespace];\n\n  // Get all enabled networks in this namespace\n  const enabledNetworks = Object.entries(networks).filter(\n    ([_, enabled]) => enabled,\n  );\n\n  // Check if there's exactly one enabled network and it matches our target\n  if (enabledNetworks.length === 1) {\n    const [onlyEnabledKey] = enabledNetworks[0];\n    return onlyEnabledKey === storageKey;\n  }\n\n  // Return false if there are zero or multiple enabled networks\n  return false;\n}\n\n/**\n * Checks if a network is considered popular based on its reference.\n *\n * @param reference - The network reference (typically the chain ID reference part)\n * @returns True if the network is popular, false otherwise\n */\nexport function isPopularNetwork(reference: string): boolean {\n  try {\n    return POPULAR_NETWORKS.includes(toHex(reference));\n  } catch {\n    // If toHex fails (e.g., for non-decimal references like Bitcoin hashes),\n    // the network is not popular\n    return false;\n  }\n}\n"]}
\ No newline at end of file
diff --git a/dist/utils.mjs.map b/dist/utils.mjs.map
index b6738fe729cb88615d0306594ccb3265eb060ca7..cf52104d40785c36a8d69ef5400a84ba5d38366e 100644
--- a/dist/utils.mjs.map
+++ b/dist/utils.mjs.map
@@ -1 +1 @@
-{"version":3,"file":"utils.mjs","sourceRoot":"","sources":["../src/utils.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,KAAK,EAAE,mCAAmC;AACnD,OAAO,EAAE,gBAAgB,EAAE,gDAAgD;AAE3E,OAAO,EACL,aAAa,EACb,WAAW,EACX,kBAAkB,EAClB,gBAAgB,EACjB,wBAAwB;AAEzB,OAAO,EAAE,gBAAgB,EAAE,wBAAoB;AAa/C;;;;;;;;;;;GAWG;AACH,MAAM,UAAU,UAAU,CAAC,OAA0B;IACnD,MAAM,WAAW,GAAG,aAAa,CAAC,OAAO,CAAC;QACxC,CAAC,CAAC,OAAO;QACT,CAAC,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;IAE9B,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG,gBAAgB,CAAC,WAAW,CAAC,CAAC;IAC/D,IAAI,UAAU,CAAC;IACf,IAAI,SAAS,KAAM,kBAAkB,CAAC,MAAiB,EAAE;QACvD,UAAU,GAAG,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;KAChE;SAAM;QACL,UAAU,GAAG,WAAW,CAAC;KAC1B;IACD,OAAO,EAAE,SAAS,EAAE,UAAU,EAAE,WAAW,EAAE,SAAS,EAAE,CAAC;AAC3D,CAAC;AAED;;;;;;;;;GASG;AACH,MAAM,UAAU,+BAA+B,CAC7C,KAAuC,EACvC,WAAwB;IAExB,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,WAAW,CAAC;IAE9C,0CAA0C;IAC1C,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE;QACvC,OAAO,KAAK,CAAC;KACd;IAED,MAAM,QAAQ,GAAG,KAAK,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;IAEpD,6CAA6C;IAC7C,MAAM,eAAe,GAAG,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,MAAM,CACrD,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC,OAAO,CAC1B,CAAC;IAEF,yEAAyE;IACzE,IAAI,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE;QAChC,MAAM,CAAC,cAAc,CAAC,GAAG,eAAe,CAAC,CAAC,CAAC,CAAC;QAC5C,OAAO,cAAc,KAAK,UAAU,CAAC;KACtC;IAED,8DAA8D;IAC9D,OAAO,KAAK,CAAC;AACf,CAAC;AAED;;;;;GAKG;AACH,MAAM,UAAU,gBAAgB,CAAC,SAAiB;IAChD,IAAI;QACF,OAAO,gBAAgB,CAAC,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;KACpD;IAAC,MAAM;QACN,yEAAyE;QACzE,6BAA6B;QAC7B,OAAO,KAAK,CAAC;KACd;AACH,CAAC","sourcesContent":["import { toHex } from '@metamask/controller-utils';\nimport { toEvmCaipChainId } from '@metamask/multichain-network-controller';\nimport type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';\nimport {\n  isCaipChainId,\n  isHexString,\n  KnownCaipNamespace,\n  parseCaipChainId,\n} from '@metamask/utils';\n\nimport { POPULAR_NETWORKS } from './constants';\nimport type { NetworkEnablementControllerState } from './NetworkEnablementController';\n\n/**\n * Represents the parsed keys derived from a chain ID.\n */\nexport type DerivedKeys = {\n  namespace: CaipNamespace;\n  storageKey: Hex | CaipChainId;\n  caipChainId: CaipChainId;\n  reference: string;\n};\n\n/**\n * Derives the namespace, storage key, and CAIP chain ID from a given chain ID.\n *\n * This utility function handles the conversion between different chain ID formats.\n * For EVM networks, it converts Hex chain IDs to CAIP-2 format and determines\n * the appropriate storage key. For non-EVM networks, it parses the CAIP-2 chain ID\n * and uses the full chain ID as the storage key.\n *\n * @param chainId - The chain ID to derive keys from (Hex or CAIP-2 format)\n * @returns An object containing namespace, storageKey, and caipId\n * @throws Error if the chain ID cannot be parsed\n */\nexport function deriveKeys(chainId: Hex | CaipChainId): DerivedKeys {\n  const caipChainId = isCaipChainId(chainId)\n    ? chainId\n    : toEvmCaipChainId(chainId);\n\n  const { namespace, reference } = parseCaipChainId(caipChainId);\n  let storageKey;\n  if (namespace === (KnownCaipNamespace.Eip155 as string)) {\n    storageKey = isHexString(chainId) ? chainId : toHex(reference);\n  } else {\n    storageKey = caipChainId;\n  }\n  return { namespace, storageKey, caipChainId, reference };\n}\n\n/**\n * Checks if the specified network is the only enabled network in its namespace.\n *\n * This function is used to prevent unnecessary state updates when trying to enable\n * This method is used to prevent the last network in a namespace from being removed.\n *\n * @param state - The current controller state\n * @param derivedKeys - The parsed keys object containing namespace and storageKey\n * @returns True if the network is the only enabled network in the namespace, false otherwise\n */\nexport function isOnlyNetworkEnabledInNamespace(\n  state: NetworkEnablementControllerState,\n  derivedKeys: DerivedKeys,\n): boolean {\n  const { namespace, storageKey } = derivedKeys;\n\n  // Early return if namespace doesn't exist\n  if (!state.enabledNetworkMap[namespace]) {\n    return false;\n  }\n\n  const networks = state.enabledNetworkMap[namespace];\n\n  // Get all enabled networks in this namespace\n  const enabledNetworks = Object.entries(networks).filter(\n    ([_, enabled]) => enabled,\n  );\n\n  // Check if there's exactly one enabled network and it matches our target\n  if (enabledNetworks.length === 1) {\n    const [onlyEnabledKey] = enabledNetworks[0];\n    return onlyEnabledKey === storageKey;\n  }\n\n  // Return false if there are zero or multiple enabled networks\n  return false;\n}\n\n/**\n * Checks if a network is considered popular based on its reference.\n *\n * @param reference - The network reference (typically the chain ID reference part)\n * @returns True if the network is popular, false otherwise\n */\nexport function isPopularNetwork(reference: string): boolean {\n  try {\n    return POPULAR_NETWORKS.includes(toHex(reference));\n  } catch {\n    // If toHex fails (e.g., for non-decimal references like Bitcoin hashes),\n    // the network is not popular\n    return false;\n  }\n}\n"]}
\ No newline at end of file
+{"version":3,"file":"utils.mjs","sourceRoot":"","sources":["../src/utils.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,KAAK,EAAE,mCAAmC;AACnD,OAAO,EAAE,gBAAgB,EAAE,gDAAgD;AAE3E,OAAO,EACL,aAAa,EACb,WAAW,EACX,kBAAkB,EAClB,gBAAgB,EACjB,wBAAwB;AAEzB,OAAO,EAAE,gBAAgB,EAAE,wBAAoB;AAa/C;;;;;;;;;;;GAWG;AACH,MAAM,UAAU,UAAU,CAAC,OAA0B;IACnD,MAAM,WAAW,GAAG,aAAa,CAAC,OAAO,CAAC;QACxC,CAAC,CAAC,OAAO;QACT,CAAC,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;IAE9B,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG,gBAAgB,CAAC,WAAW,CAAC,CAAC;IAC/D,IAAI,UAAU,CAAC;IACf,IAAI,SAAS,KAAM,kBAAkB,CAAC,MAAiB,EAAE,CAAC;QACxD,UAAU,GAAG,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;IACjE,CAAC;SAAM,CAAC;QACN,UAAU,GAAG,WAAW,CAAC;IAC3B,CAAC;IACD,OAAO,EAAE,SAAS,EAAE,UAAU,EAAE,WAAW,EAAE,SAAS,EAAE,CAAC;AAC3D,CAAC;AAED;;;;;;;;;GASG;AACH,MAAM,UAAU,+BAA+B,CAC7C,KAAuC,EACvC,WAAwB;IAExB,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,WAAW,CAAC;IAE9C,0CAA0C;IAC1C,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE,CAAC;QACxC,OAAO,KAAK,CAAC;IACf,CAAC;IAED,MAAM,QAAQ,GAAG,KAAK,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;IAEpD,6CAA6C;IAC7C,MAAM,eAAe,GAAG,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,MAAM,CACrD,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC,OAAO,CAC1B,CAAC;IAEF,yEAAyE;IACzE,IAAI,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;QACjC,MAAM,CAAC,cAAc,CAAC,GAAG,eAAe,CAAC,CAAC,CAAC,CAAC;QAC5C,OAAO,cAAc,KAAK,UAAU,CAAC;IACvC,CAAC;IAED,8DAA8D;IAC9D,OAAO,KAAK,CAAC;AACf,CAAC;AAED;;;;;GAKG;AACH,MAAM,UAAU,gBAAgB,CAAC,SAAiB;IAChD,IAAI,CAAC;QACH,OAAO,gBAAgB,CAAC,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;IACrD,CAAC;IAAC,MAAM,CAAC;QACP,yEAAyE;QACzE,6BAA6B;QAC7B,OAAO,KAAK,CAAC;IACf,CAAC;AACH,CAAC","sourcesContent":["import { toHex } from '@metamask/controller-utils';\nimport { toEvmCaipChainId } from '@metamask/multichain-network-controller';\nimport type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';\nimport {\n  isCaipChainId,\n  isHexString,\n  KnownCaipNamespace,\n  parseCaipChainId,\n} from '@metamask/utils';\n\nimport { POPULAR_NETWORKS } from './constants';\nimport type { NetworkEnablementControllerState } from './NetworkEnablementController';\n\n/**\n * Represents the parsed keys derived from a chain ID.\n */\nexport type DerivedKeys = {\n  namespace: CaipNamespace;\n  storageKey: Hex | CaipChainId;\n  caipChainId: CaipChainId;\n  reference: string;\n};\n\n/**\n * Derives the namespace, storage key, and CAIP chain ID from a given chain ID.\n *\n * This utility function handles the conversion between different chain ID formats.\n * For EVM networks, it converts Hex chain IDs to CAIP-2 format and determines\n * the appropriate storage key. For non-EVM networks, it parses the CAIP-2 chain ID\n * and uses the full chain ID as the storage key.\n *\n * @param chainId - The chain ID to derive keys from (Hex or CAIP-2 format)\n * @returns An object containing namespace, storageKey, and caipId\n * @throws Error if the chain ID cannot be parsed\n */\nexport function deriveKeys(chainId: Hex | CaipChainId): DerivedKeys {\n  const caipChainId = isCaipChainId(chainId)\n    ? chainId\n    : toEvmCaipChainId(chainId);\n\n  const { namespace, reference } = parseCaipChainId(caipChainId);\n  let storageKey;\n  if (namespace === (KnownCaipNamespace.Eip155 as string)) {\n    storageKey = isHexString(chainId) ? chainId : toHex(reference);\n  } else {\n    storageKey = caipChainId;\n  }\n  return { namespace, storageKey, caipChainId, reference };\n}\n\n/**\n * Checks if the specified network is the only enabled network in its namespace.\n *\n * This function is used to prevent unnecessary state updates when trying to enable\n * This method is used to prevent the last network in a namespace from being removed.\n *\n * @param state - The current controller state\n * @param derivedKeys - The parsed keys object containing namespace and storageKey\n * @returns True if the network is the only enabled network in the namespace, false otherwise\n */\nexport function isOnlyNetworkEnabledInNamespace(\n  state: NetworkEnablementControllerState,\n  derivedKeys: DerivedKeys,\n): boolean {\n  const { namespace, storageKey } = derivedKeys;\n\n  // Early return if namespace doesn't exist\n  if (!state.enabledNetworkMap[namespace]) {\n    return false;\n  }\n\n  const networks = state.enabledNetworkMap[namespace];\n\n  // Get all enabled networks in this namespace\n  const enabledNetworks = Object.entries(networks).filter(\n    ([_, enabled]) => enabled,\n  );\n\n  // Check if there's exactly one enabled network and it matches our target\n  if (enabledNetworks.length === 1) {\n    const [onlyEnabledKey] = enabledNetworks[0];\n    return onlyEnabledKey === storageKey;\n  }\n\n  // Return false if there are zero or multiple enabled networks\n  return false;\n}\n\n/**\n * Checks if a network is considered popular based on its reference.\n *\n * @param reference - The network reference (typically the chain ID reference part)\n * @returns True if the network is popular, false otherwise\n */\nexport function isPopularNetwork(reference: string): boolean {\n  try {\n    return POPULAR_NETWORKS.includes(toHex(reference));\n  } catch {\n    // If toHex fails (e.g., for non-decimal references like Bitcoin hashes),\n    // the network is not popular\n    return false;\n  }\n}\n"]}
\ No newline at end of file
diff --git a/jest.config.js b/jest.config.js
new file mode 100644
index 0000000000000000000000000000000000000000..ca084133399f5d5fcaa3367066031b5b4fa7936b
--- /dev/null
+++ b/jest.config.js
@@ -0,0 +1,26 @@
+/*
+ * For a detailed explanation regarding each configuration property and type check, visit:
+ * https://jestjs.io/docs/configuration
+ */
+
+const merge = require('deepmerge');
+const path = require('path');
+
+const baseConfig = require('../../jest.config.packages');
+
+const displayName = path.basename(__dirname);
+
+module.exports = merge(baseConfig, {
+  // The display name when running multiple projects
+  displayName,
+
+  // An object that configures minimum threshold enforcement for coverage results
+  coverageThreshold: {
+    global: {
+      branches: 100,
+      functions: 100,
+      lines: 100,
+      statements: 100,
+    },
+  },
+});
diff --git a/package.json b/package.json
index 32d9f8f420c506e3ea7f2f3ec7bffa694117c13c..9bcfce25e03da097daa6a3ea92cf06107fba4908 100644
--- a/package.json
+++ b/package.json
@@ -1,6 +1,6 @@
 {
   "name": "@metamask/network-enablement-controller",
-  "version": "3.1.0",
+  "version": "4.1.0",
   "description": "Provides an interface to the currently enabled network using a MetaMask-compatible provider object",
   "keywords": [
     "MetaMask",
@@ -36,6 +36,7 @@
   ],
   "scripts": {
     "build": "ts-bridge --project tsconfig.build.json --verbose --clean --no-references",
+    "build:all": "ts-bridge --project tsconfig.build.json --verbose --clean",
     "build:docs": "typedoc",
     "changelog:update": "../../scripts/update-changelog.sh @metamask/network-enablement-controller",
     "changelog:validate": "../../scripts/validate-changelog.sh @metamask/network-enablement-controller",
@@ -46,11 +47,21 @@
     "test:verbose": "NODE_OPTIONS=--experimental-vm-modules jest --verbose",
     "test:watch": "NODE_OPTIONS=--experimental-vm-modules jest --watch"
   },
+  "dependencies": {
+    "@metamask/base-controller": "^9.0.0",
+    "@metamask/controller-utils": "^11.18.0",
+    "@metamask/keyring-api": "^21.0.0",
+    "@metamask/messenger": "^0.3.0",
+    "@metamask/multichain-network-controller": "^3.0.2",
+    "@metamask/network-controller": "^29.0.0",
+    "@metamask/slip44": "^4.3.0",
+    "@metamask/transaction-controller": "^62.9.2",
+    "@metamask/utils": "^11.9.0",
+    "reselect": "^5.1.1"
+  },
   "devDependencies": {
     "@metamask/auto-changelog": "^3.4.4",
-    "@metamask/multichain-network-controller": "^2.0.0",
-    "@metamask/network-controller": "^25.0.0",
-    "@metamask/transaction-controller": "^61.0.0",
+    "@ts-bridge/cli": "^0.6.4",
     "@types/jest": "^27.4.1",
     "deepmerge": "^4.2.2",
     "jest": "^27.5.1",
@@ -58,20 +69,7 @@
     "ts-jest": "^27.1.4",
     "typedoc": "^0.24.8",
     "typedoc-plugin-missing-exports": "^2.0.0",
-    "typescript": "~5.2.2"
-  },
-  "dependencies": {
-    "@metamask/base-controller": "^9.0.0",
-    "@metamask/controller-utils": "^11.14.1",
-    "@metamask/keyring-api": "^21.0.0",
-    "@metamask/messenger": "^0.3.0",
-    "@metamask/utils": "^11.8.1",
-    "reselect": "^5.1.1"
-  },
-  "peerDependencies": {
-    "@metamask/multichain-network-controller": "^2.0.0",
-    "@metamask/network-controller": "^25.0.0",
-    "@metamask/transaction-controller": "^61.0.0"
+    "typescript": "~5.3.3"
   },
   "engines": {
     "node": "^18.18 || >=20"
diff --git a/src/NetworkEnablementController.test.ts b/src/NetworkEnablementController.test.ts
new file mode 100644
index 0000000000000000000000000000000000000000..00ba58fccaa5bd684e6ef61a0112707a363c9221
--- /dev/null
+++ b/src/NetworkEnablementController.test.ts
@@ -0,0 +1,3016 @@
+import { deriveStateFromMetadata } from '@metamask/base-controller';
+import { BuiltInNetworkName, ChainId } from '@metamask/controller-utils';
+import { BtcScope, SolScope, TrxScope } from '@metamask/keyring-api';
+import { Messenger, MOCK_ANY_NAMESPACE } from '@metamask/messenger';
+import type {
+  MessengerActions,
+  MessengerEvents,
+  MockAnyNamespace,
+} from '@metamask/messenger';
+import { toEvmCaipChainId } from '@metamask/multichain-network-controller';
+import { RpcEndpointType } from '@metamask/network-controller';
+import { TransactionStatus } from '@metamask/transaction-controller';
+import type { TransactionMeta } from '@metamask/transaction-controller';
+import { KnownCaipNamespace } from '@metamask/utils';
+import type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';
+import { useFakeTimers } from 'sinon';
+
+import { POPULAR_NETWORKS } from './constants';
+import { NetworkEnablementController } from './NetworkEnablementController';
+import type {
+  NetworkEnablementControllerMessenger,
+  NativeAssetIdentifiersMap,
+} from './NetworkEnablementController';
+import { Slip44Service } from './services';
+import { advanceTime } from '../../../tests/helpers';
+
+// Known chainId mappings from chainid.network for mocking
+const chainIdToSlip44: Record<number, number> = {
+  1: 60, // Ethereum
+  10: 60, // Optimism
+  56: 714, // BNB Chain
+  137: 966, // Polygon
+  43114: 9000, // Avalanche
+  42161: 60, // Arbitrum
+  8453: 60, // Base
+  59144: 60, // Linea
+  1329: 60, // Sei (uses ETH as native)
+};
+
+const controllerName = 'NetworkEnablementController';
+
+/**
+ * Returns the default nativeAssetIdentifiers state for testing.
+ *
+ * @returns The default nativeAssetIdentifiers with all pre-configured networks.
+ */
+// Default nativeAssetIdentifiers is empty - should be populated by client using initNativeAssetIdentifiers()
+function getDefaultNativeAssetIdentifiers(): NativeAssetIdentifiersMap {
+  return {};
+}
+
+type AllNetworkEnablementControllerActions =
+  MessengerActions<NetworkEnablementControllerMessenger>;
+
+type AllNetworkEnablementControllerEvents =
+  MessengerEvents<NetworkEnablementControllerMessenger>;
+
+type RootMessenger = Messenger<
+  MockAnyNamespace,
+  AllNetworkEnablementControllerActions,
+  AllNetworkEnablementControllerEvents
+>;
+
+/**
+ * Creates and returns a root messenger for testing
+ *
+ * @returns A messenger instance
+ */
+function getRootMessenger(): RootMessenger {
+  return new Messenger({
+    namespace: MOCK_ANY_NAMESPACE,
+  });
+}
+
+const setupController = ({
+  config,
+}: {
+  config?: Partial<
+    ConstructorParameters<typeof NetworkEnablementController>[0]
+  >;
+} = {}): {
+  controller: NetworkEnablementController;
+  rootMessenger: RootMessenger;
+  messenger: NetworkEnablementControllerMessenger;
+} => {
+  const rootMessenger = getRootMessenger();
+
+  const networkEnablementControllerMessenger = new Messenger<
+    typeof controllerName,
+    AllNetworkEnablementControllerActions,
+    AllNetworkEnablementControllerEvents,
+    RootMessenger
+  >({
+    namespace: controllerName,
+    parent: rootMessenger,
+  });
+
+  rootMessenger.delegate({
+    messenger: networkEnablementControllerMessenger,
+    actions: [
+      'NetworkController:getState',
+      'MultichainNetworkController:getState',
+    ],
+    events: [
+      'NetworkController:networkAdded',
+      'NetworkController:networkRemoved',
+      'NetworkController:stateChange',
+      'TransactionController:transactionSubmitted',
+    ],
+  });
+
+  rootMessenger.registerActionHandler(
+    'NetworkController:getState',
+    jest.fn().mockImplementation(() => ({
+      networkConfigurationsByChainId: {
+        '0x1': {
+          defaultRpcEndpointIndex: 0,
+          rpcEndpoints: [{}],
+        },
+        '0xe708': {
+          defaultRpcEndpointIndex: 0,
+          rpcEndpoints: [{}],
+        },
+        '0x2105': {
+          defaultRpcEndpointIndex: 0,
+          rpcEndpoints: [{}],
+        },
+      },
+    })),
+  );
+
+  const controller = new NetworkEnablementController({
+    messenger: networkEnablementControllerMessenger,
+    ...config,
+  });
+
+  return {
+    controller,
+    rootMessenger,
+    messenger: networkEnablementControllerMessenger,
+  };
+};
+
+describe('NetworkEnablementController', () => {
+  let clock: sinon.SinonFakeTimers;
+
+  beforeEach(() => {
+    clock = useFakeTimers();
+    // Mock Slip44Service.getEvmSlip44 to avoid network calls
+    jest
+      .spyOn(Slip44Service, 'getEvmSlip44')
+      .mockImplementation(async (chainId) => {
+        return chainIdToSlip44[chainId] ?? 60;
+      });
+  });
+
+  afterEach(() => {
+    clock.restore();
+    jest.restoreAllMocks();
+  });
+
+  it('initializes with default state', () => {
+    const { controller } = setupController();
+
+    expect(controller.state).toStrictEqual({
+      enabledNetworkMap: {
+        [KnownCaipNamespace.Eip155]: {
+          [ChainId[BuiltInNetworkName.Mainnet]]: true,
+          [ChainId[BuiltInNetworkName.LineaMainnet]]: true,
+          [ChainId[BuiltInNetworkName.BaseMainnet]]: true,
+          [ChainId[BuiltInNetworkName.ArbitrumOne]]: true,
+          [ChainId[BuiltInNetworkName.BscMainnet]]: true,
+          [ChainId[BuiltInNetworkName.OptimismMainnet]]: true,
+          [ChainId[BuiltInNetworkName.PolygonMainnet]]: true,
+          [ChainId[BuiltInNetworkName.SeiMainnet]]: true,
+        },
+        [KnownCaipNamespace.Solana]: {
+          [SolScope.Mainnet]: true,
+          [SolScope.Testnet]: false,
+          [SolScope.Devnet]: false,
+        },
+        [KnownCaipNamespace.Bip122]: {
+          [BtcScope.Mainnet]: true,
+          [BtcScope.Testnet]: false,
+          [BtcScope.Signet]: false,
+        },
+        [KnownCaipNamespace.Tron]: {
+          [TrxScope.Mainnet]: true,
+          [TrxScope.Nile]: false,
+          [TrxScope.Shasta]: false,
+        },
+      },
+      nativeAssetIdentifiers: getDefaultNativeAssetIdentifiers(),
+    });
+  });
+
+  it('subscribes to NetworkController:networkAdded', async () => {
+    const { controller, rootMessenger } = setupController();
+
+    // Publish an update with avax network added
+    // Avalanche is a popular network, and we already have >2 popular networks enabled
+    // So the new behavior should keep current selection (add but don't enable)
+    rootMessenger.publish('NetworkController:networkAdded', {
+      chainId: '0xa86a',
+      blockExplorerUrls: [],
+      defaultRpcEndpointIndex: 0,
+      name: 'Avalanche',
+      nativeCurrency: 'AVAX',
+      rpcEndpoints: [
+        {
+          url: 'https://api.avax.network/ext/bc/C/rpc',
+          networkClientId: 'id',
+          type: RpcEndpointType.Custom,
+        },
+      ],
+    });
+
+    await advanceTime({ clock, duration: 1 });
+
+    expect(controller.state).toStrictEqual({
+      enabledNetworkMap: {
+        [KnownCaipNamespace.Eip155]: {
+          [ChainId[BuiltInNetworkName.Mainnet]]: true, // Ethereum Mainnet
+          [ChainId[BuiltInNetworkName.LineaMainnet]]: true, // Linea Mainnet
+          [ChainId[BuiltInNetworkName.BaseMainnet]]: true, // Base Mainnet
+          [ChainId[BuiltInNetworkName.ArbitrumOne]]: true,
+          [ChainId[BuiltInNetworkName.BscMainnet]]: true,
+          [ChainId[BuiltInNetworkName.OptimismMainnet]]: true,
+          [ChainId[BuiltInNetworkName.PolygonMainnet]]: true,
+          [ChainId[BuiltInNetworkName.SeiMainnet]]: true,
+          '0xa86a': true, // Avalanche network added and enabled (keeps current selection)
+        },
+        [KnownCaipNamespace.Solana]: {
+          [SolScope.Mainnet]: true,
+          [SolScope.Testnet]: false,
+          [SolScope.Devnet]: false,
+        },
+        [KnownCaipNamespace.Bip122]: {
+          [BtcScope.Mainnet]: true,
+          [BtcScope.Testnet]: false,
+          [BtcScope.Signet]: false,
+        },
+        [KnownCaipNamespace.Tron]: {
+          [TrxScope.Mainnet]: true,
+          [TrxScope.Nile]: false,
+          [TrxScope.Shasta]: false,
+        },
+      },
+      nativeAssetIdentifiers: {
+        ...getDefaultNativeAssetIdentifiers(),
+        'eip155:43114': 'eip155:43114/slip44:9000', // AVAX
+      },
+    });
+  });
+
+  it('subscribes to NetworkController:networkRemoved', async () => {
+    const { controller, rootMessenger } = setupController();
+
+    // Publish an update with linea network removed
+    rootMessenger.publish('NetworkController:networkRemoved', {
+      chainId: '0xe708', // Linea Mainnet
+      blockExplorerUrls: [],
+      defaultRpcEndpointIndex: 0,
+      name: 'Linea',
+      nativeCurrency: 'ETH',
+      rpcEndpoints: [
+        {
+          url: 'https://linea-mainnet.infura.io/v3/1234567890',
+          networkClientId: 'id',
+          type: RpcEndpointType.Custom,
+        },
+      ],
+    });
+
+    await advanceTime({ clock, duration: 1 });
+
+    // Create expected nativeAssetIdentifiers without Linea
+    const expectedNativeAssetIdentifiers = {
+      ...getDefaultNativeAssetIdentifiers(),
+    };
+    delete expectedNativeAssetIdentifiers[
+      toEvmCaipChainId(ChainId[BuiltInNetworkName.LineaMainnet])
+    ];
+
+    expect(controller.state).toStrictEqual({
+      enabledNetworkMap: {
+        [KnownCaipNamespace.Eip155]: {
+          [ChainId[BuiltInNetworkName.Mainnet]]: true, // Ethereum Mainnet
+          [ChainId[BuiltInNetworkName.BaseMainnet]]: true, // Base Mainnet (Linea removed)
+          [ChainId[BuiltInNetworkName.ArbitrumOne]]: true,
+          [ChainId[BuiltInNetworkName.BscMainnet]]: true,
+          [ChainId[BuiltInNetworkName.OptimismMainnet]]: true,
+          [ChainId[BuiltInNetworkName.PolygonMainnet]]: true,
+          [ChainId[BuiltInNetworkName.SeiMainnet]]: true,
+        },
+        [KnownCaipNamespace.Solana]: {
+          [SolScope.Mainnet]: true,
+          [SolScope.Testnet]: false,
+          [SolScope.Devnet]: false,
+        },
+        [KnownCaipNamespace.Bip122]: {
+          [BtcScope.Mainnet]: true,
+          [BtcScope.Testnet]: false,
+          [BtcScope.Signet]: false,
+        },
+        [KnownCaipNamespace.Tron]: {
+          [TrxScope.Mainnet]: true,
+          [TrxScope.Nile]: false,
+          [TrxScope.Shasta]: false,
+        },
+      },
+      nativeAssetIdentifiers: expectedNativeAssetIdentifiers,
+    });
+  });
+
+  it('handles TransactionController:transactionSubmitted with missing chainId gracefully', async () => {
+    const { controller, rootMessenger } = setupController();
+
+    const initialState = { ...controller.state };
+
+    // Publish a transaction submitted event without chainId
+    rootMessenger.publish('TransactionController:transactionSubmitted', {
+      transactionMeta: {
+        networkClientId: 'test-network',
+        id: 'test-tx-id',
+        status: TransactionStatus.submitted,
+        time: Date.now(),
+        txParams: {
+          from: '0x123',
+          to: '0x456',
+          value: '0x0',
+        },
+        // chainId is missing
+      } as TransactionMeta, // Simplified structure for testing
+    });
+
+    await advanceTime({ clock, duration: 1 });
+
+    // State should remain unchanged
+    expect(controller.state).toStrictEqual(initialState);
+  });
+
+  it('handles TransactionController:transactionSubmitted with malformed structure gracefully', async () => {
+    const { controller, rootMessenger } = setupController();
+
+    const initialState = { ...controller.state };
+
+    // Publish a transaction submitted event with malformed structure
+    // @ts-expect-error - Testing runtime safety for malformed payload
+    rootMessenger.publish('TransactionController:transactionSubmitted', {
+      // Missing transactionMeta entirely
+    });
+
+    await advanceTime({ clock, duration: 1 });
+
+    // State should remain unchanged
+    expect(controller.state).toStrictEqual(initialState);
+  });
+
+  it('handles TransactionController:transactionSubmitted with null/undefined transactionMeta gracefully', async () => {
+    const { controller, rootMessenger } = setupController();
+
+    const initialState = { ...controller.state };
+
+    // Test with null transactionMeta
+    rootMessenger.publish('TransactionController:transactionSubmitted', {
+      // @ts-expect-error - Testing runtime safety for null transactionMeta
+      transactionMeta: null,
+    });
+
+    await advanceTime({ clock, duration: 1 });
+
+    // State should remain unchanged
+    expect(controller.state).toStrictEqual(initialState);
+
+    // Test with undefined transactionMeta
+    rootMessenger.publish('TransactionController:transactionSubmitted', {
+      // @ts-expect-error - Testing runtime safety for undefined transactionMeta
+      transactionMeta: undefined,
+    });
+
+    await advanceTime({ clock, duration: 1 });
+
+    // State should still remain unchanged
+    expect(controller.state).toStrictEqual(initialState);
+  });
+
+  it('does fallback to ethereum when removing the last enabled network', async () => {
+    const { controller, rootMessenger } = setupController();
+
+    // disable all networks except linea
+    controller.disableNetwork('0x1'); // Ethereum Mainnet
+    controller.disableNetwork('0x2105'); // Base Mainnet
+    controller.disableNetwork('0xa4b1'); // Arbitrum One
+    controller.disableNetwork('0x38'); // BSC Mainnet
+    controller.disableNetwork('0xa'); // Optimism Mainnet
+    controller.disableNetwork('0x89'); // Polygon Mainnet
+    controller.disableNetwork('0x531'); // Sei Mainnet
+
+    // Publish an update with linea network removed
+    rootMessenger.publish('NetworkController:networkRemoved', {
+      chainId: '0xe708', // Linea Mainnet
+      blockExplorerUrls: [],
+      defaultRpcEndpointIndex: 0,
+      name: 'Linea',
+      nativeCurrency: 'ETH',
+      rpcEndpoints: [
+        {
+          url: 'https://linea-mainnet.infura.io/v3/1234567890',
+          networkClientId: 'id',
+          type: RpcEndpointType.Custom,
+        },
+      ],
+    });
+
+    await advanceTime({ clock, duration: 1 });
+
+    // Create expected nativeAssetIdentifiers without Linea
+    const expectedNativeAssetIdentifiersForFallback = {
+      ...getDefaultNativeAssetIdentifiers(),
+    };
+    delete expectedNativeAssetIdentifiersForFallback[
+      toEvmCaipChainId(ChainId[BuiltInNetworkName.LineaMainnet])
+    ];
+
+    expect(controller.state).toStrictEqual({
+      enabledNetworkMap: {
+        [KnownCaipNamespace.Eip155]: {
+          [ChainId[BuiltInNetworkName.Mainnet]]: true, // Ethereum Mainnet (fallback enabled)
+          [ChainId[BuiltInNetworkName.BaseMainnet]]: false, // Base Mainnet (still disabled)
+          [ChainId[BuiltInNetworkName.ArbitrumOne]]: false,
+          [ChainId[BuiltInNetworkName.BscMainnet]]: false,
+          [ChainId[BuiltInNetworkName.OptimismMainnet]]: false,
+          [ChainId[BuiltInNetworkName.PolygonMainnet]]: false,
+          [ChainId[BuiltInNetworkName.SeiMainnet]]: false,
+        },
+        [KnownCaipNamespace.Solana]: {
+          [SolScope.Mainnet]: true,
+          [SolScope.Testnet]: false,
+          [SolScope.Devnet]: false,
+        },
+        [KnownCaipNamespace.Bip122]: {
+          [BtcScope.Mainnet]: true,
+          [BtcScope.Testnet]: false,
+          [BtcScope.Signet]: false,
+        },
+        [KnownCaipNamespace.Tron]: {
+          [TrxScope.Mainnet]: true,
+          [TrxScope.Nile]: false,
+          [TrxScope.Shasta]: false,
+        },
+      },
+      nativeAssetIdentifiers: expectedNativeAssetIdentifiersForFallback,
+    });
+  });
+
+  describe('init', () => {
+    it('initializes network enablement state from controller configurations', async () => {
+      const { controller, messenger } = setupController();
+
+      jest
+        .spyOn(messenger, 'call')
+        // eslint-disable-next-line @typescript-eslint/no-explicit-any
+        .mockImplementation((actionType: string, ..._args: any[]): any => {
+          if (actionType === 'NetworkController:getState') {
+            return {
+              selectedNetworkClientId: 'mainnet',
+              networkConfigurationsByChainId: {
+                '0x1': {
+                  chainId: '0x1',
+                  name: 'Ethereum Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                '0xe708': {
+                  chainId: '0xe708',
+                  name: 'Linea Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                '0x2105': {
+                  chainId: '0x2105',
+                  name: 'Base Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+              },
+              networksMetadata: {},
+            };
+          }
+          if (actionType === 'MultichainNetworkController:getState') {
+            return {
+              multichainNetworkConfigurationsByChainId: {
+                'eip155:1': {
+                  chainId: 'eip155:1',
+                  name: 'Ethereum Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                'eip155:59144': {
+                  chainId: 'eip155:59144',
+                  name: 'Linea Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                'eip155:8453': {
+                  chainId: 'eip155:8453',
+                  name: 'Base Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp': {
+                  chainId: 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+                  name: 'Solana Mainnet',
+                  nativeCurrency: 'SOL',
+                },
+              },
+              selectedMultichainNetworkChainId: 'eip155:1',
+              isEvmSelected: true,
+              networksWithTransactionActivity: {},
+            };
+          }
+          throw new Error(`Unexpected action type: ${actionType}`);
+        });
+
+      // Initialize from configurations
+      await controller.init();
+
+      // Should only enable popular networks that exist in NetworkController config
+      // (0x1, 0xe708, 0x2105 exist in default NetworkController mock)
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: {
+            [ChainId[BuiltInNetworkName.Mainnet]]: true, // Ethereum Mainnet (exists in default config)
+            [ChainId[BuiltInNetworkName.LineaMainnet]]: true, // Linea Mainnet (exists in default config)
+            [ChainId[BuiltInNetworkName.BaseMainnet]]: true, // Base Mainnet (exists in default config)
+            [ChainId[BuiltInNetworkName.ArbitrumOne]]: true,
+            [ChainId[BuiltInNetworkName.BscMainnet]]: true,
+            [ChainId[BuiltInNetworkName.OptimismMainnet]]: true,
+            [ChainId[BuiltInNetworkName.PolygonMainnet]]: true,
+            [ChainId[BuiltInNetworkName.SeiMainnet]]: true,
+          },
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: true, // Solana Mainnet (exists in multichain config)
+            [SolScope.Testnet]: false,
+            [SolScope.Devnet]: false,
+          },
+          [KnownCaipNamespace.Bip122]: {
+            [BtcScope.Mainnet]: true,
+            [BtcScope.Testnet]: false,
+            [BtcScope.Signet]: false,
+          },
+          [KnownCaipNamespace.Tron]: {
+            [TrxScope.Mainnet]: true,
+            [TrxScope.Nile]: false,
+            [TrxScope.Shasta]: false,
+          },
+        },
+        // init() populates nativeAssetIdentifiers from NetworkController (EVM networks only)
+        nativeAssetIdentifiers: {
+          'eip155:1': 'eip155:1/slip44:60',
+          'eip155:59144': 'eip155:59144/slip44:60',
+          'eip155:8453': 'eip155:8453/slip44:60',
+        },
+      });
+    });
+
+    it('only enables popular networks that exist in NetworkController configurations', async () => {
+      // Create a separate controller setup for this test to avoid handler conflicts
+      const { controller, messenger } = setupController({
+        config: {
+          state: {
+            enabledNetworkMap: {
+              [KnownCaipNamespace.Eip155]: {},
+              [KnownCaipNamespace.Solana]: {},
+            },
+            nativeAssetIdentifiers: {},
+          },
+        },
+      });
+
+      jest.spyOn(messenger, 'call').mockImplementation(
+        // eslint-disable-next-line @typescript-eslint/no-explicit-any
+        (actionType: string, ..._args: any[]): any => {
+          if (actionType === 'NetworkController:getState') {
+            return {
+              selectedNetworkClientId: 'mainnet',
+              networkConfigurationsByChainId: {
+                '0x1': {
+                  chainId: '0x1',
+                  name: 'Ethereum Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                '0xe708': {
+                  chainId: '0xe708',
+                  name: 'Linea Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                // Missing other popular networks
+              },
+              networksMetadata: {},
+            };
+          }
+          if (actionType === 'MultichainNetworkController:getState') {
+            return {
+              multichainNetworkConfigurationsByChainId: {
+                'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp': {
+                  chainId: 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+                  name: 'Solana Mainnet',
+                  nativeCurrency: 'SOL',
+                },
+              },
+              selectedMultichainNetworkChainId:
+                'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+              isEvmSelected: false,
+              networksWithTransactionActivity: {},
+            };
+          }
+          throw new Error(`Unexpected action type: ${actionType}`);
+        },
+      );
+
+      // Initialize from configurations
+      await controller.init();
+
+      // Should only enable networks that exist in configurations
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': false, // Ethereum Mainnet (exists in config)
+            '0xe708': false, // Linea Mainnet (exists in config)
+            // Other popular networks not enabled because they don't exist in config
+          },
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: false, // Solana Mainnet (exists in config)
+          },
+        },
+        nativeAssetIdentifiers: {
+          'eip155:1': 'eip155:1/slip44:60', // ETH
+          'eip155:59144': 'eip155:59144/slip44:60', // ETH (Linea uses ETH)
+          // Multichain networks don't populate nativeAssetIdentifiers in init() because
+          // the mock doesn't include the required nativeCurrency for non-EVM networks
+        },
+      });
+    });
+
+    it('handles missing MultichainNetworkController gracefully', async () => {
+      const { controller, messenger } = setupController();
+
+      jest
+        .spyOn(messenger, 'call')
+        // eslint-disable-next-line @typescript-eslint/no-explicit-any
+        .mockImplementation((actionType: string, ..._args: any[]): any => {
+          if (actionType === 'NetworkController:getState') {
+            return {
+              selectedNetworkClientId: 'mainnet',
+              networkConfigurationsByChainId: {
+                '0x1': {
+                  chainId: '0x1',
+                  name: 'Ethereum Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                '0xe708': {
+                  chainId: '0xe708',
+                  name: 'Linea Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                '0x2105': {
+                  chainId: '0x2105',
+                  name: 'Base Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+              },
+              networksMetadata: {},
+            };
+          }
+          if (actionType === 'MultichainNetworkController:getState') {
+            return {
+              multichainNetworkConfigurationsByChainId: {},
+              selectedMultichainNetworkChainId: 'eip155:1',
+              isEvmSelected: true,
+              networksWithTransactionActivity: {},
+            };
+          }
+          throw new Error(`Unexpected action type: ${actionType}`);
+        });
+
+      // Should not throw
+      await controller.init();
+
+      // Should still enable popular networks from NetworkController
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(true);
+    });
+
+    it('creates namespace buckets for all configured networks', async () => {
+      const { controller, messenger } = setupController();
+
+      jest
+        .spyOn(messenger, 'call')
+        // eslint-disable-next-line @typescript-eslint/no-explicit-any
+        .mockImplementation((actionType: string, ..._args: any[]): any => {
+          if (actionType === 'NetworkController:getState') {
+            return {
+              selectedNetworkClientId: 'mainnet',
+              networkConfigurationsByChainId: {
+                '0x1': {
+                  chainId: '0x1',
+                  name: 'Ethereum',
+                  nativeCurrency: 'ETH',
+                },
+                '0x89': {
+                  chainId: '0x89',
+                  name: 'Polygon',
+                  nativeCurrency: 'MATIC',
+                },
+              },
+              networksMetadata: {},
+            };
+          }
+          if (actionType === 'MultichainNetworkController:getState') {
+            return {
+              multichainNetworkConfigurationsByChainId: {
+                'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp': {
+                  chainId: 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+                  name: 'Solana',
+                  nativeCurrency: 'SOL',
+                },
+                'bip122:000000000019d6689c085ae165831e93': {
+                  chainId: 'bip122:000000000019d6689c085ae165831e93',
+                  name: 'Bitcoin',
+                  nativeCurrency: 'BTC',
+                },
+              },
+              selectedMultichainNetworkChainId:
+                'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+              isEvmSelected: false,
+              networksWithTransactionActivity: {},
+            };
+          }
+          throw new Error(`Unexpected action type: ${actionType}`);
+        });
+
+      await controller.init();
+
+      // Should have created namespace buckets for all network types
+      expect(controller.state.enabledNetworkMap).toHaveProperty(
+        KnownCaipNamespace.Eip155,
+      );
+      expect(controller.state.enabledNetworkMap).toHaveProperty(
+        KnownCaipNamespace.Solana,
+      );
+      expect(controller.state.enabledNetworkMap).toHaveProperty(
+        KnownCaipNamespace.Bip122,
+      );
+    });
+
+    it('creates new namespace buckets for networks that do not exist', async () => {
+      const { controller, messenger } = setupController();
+
+      // Start with empty state to test namespace bucket creation
+      // eslint-disable-next-line dot-notation
+      controller['update']((state) => {
+        state.enabledNetworkMap = {};
+      });
+
+      jest
+        .spyOn(messenger, 'call')
+        // eslint-disable-next-line @typescript-eslint/no-explicit-any
+        .mockImplementation((actionType: string, ..._args: unknown[]): any => {
+          const responses = {
+            'NetworkController:getState': {
+              selectedNetworkClientId: 'mainnet',
+              networkConfigurationsByChainId: {
+                '0x1': {
+                  chainId: '0x1' as Hex,
+                  name: 'Ethereum',
+                  blockExplorerUrls: [],
+                  defaultRpcEndpointIndex: 0,
+                  nativeCurrency: 'ETH',
+                  rpcEndpoints: [],
+                },
+              },
+              networksMetadata: {},
+            },
+            'MultichainNetworkController:getState': {
+              multichainNetworkConfigurationsByChainId: {
+                'cosmos:cosmoshub-4': {
+                  chainId: 'cosmos:cosmoshub-4' as CaipChainId,
+                  name: 'Cosmos Hub',
+                  isEvm: false as const,
+                  nativeCurrency:
+                    'cosmos:cosmoshub-4/slip44:118' as `${string}:${string}/${string}:${string}`,
+                },
+              },
+              selectedMultichainNetworkChainId:
+                'cosmos:cosmoshub-4' as CaipChainId,
+              isEvmSelected: false,
+              networksWithTransactionActivity: {},
+            },
+          };
+          return responses[actionType as keyof typeof responses];
+        });
+
+      await controller.init();
+
+      // Should have created namespace buckets for both EIP-155 and Cosmos
+      expect(controller.state.enabledNetworkMap).toHaveProperty(
+        KnownCaipNamespace.Eip155,
+      );
+      expect(controller.state.enabledNetworkMap).toHaveProperty('cosmos');
+    });
+
+    it('sets Bitcoin testnet to false when it exists in MultichainNetworkController configurations', async () => {
+      const { controller, messenger } = setupController();
+
+      // Mock MultichainNetworkController to include Bitcoin testnet BEFORE calling init
+      jest
+        .spyOn(messenger, 'call')
+        // eslint-disable-next-line @typescript-eslint/no-explicit-any
+        .mockImplementation((actionType: string, ..._args: any[]): any => {
+          if (actionType === 'NetworkController:getState') {
+            return {
+              selectedNetworkClientId: 'mainnet',
+              networkConfigurationsByChainId: {
+                '0x1': {
+                  chainId: '0x1',
+                  name: 'Ethereum Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+              },
+              networksMetadata: {},
+            };
+          }
+          if (actionType === 'MultichainNetworkController:getState') {
+            return {
+              multichainNetworkConfigurationsByChainId: {
+                [BtcScope.Mainnet]: {
+                  chainId: BtcScope.Mainnet,
+                  name: 'Bitcoin Mainnet',
+                },
+                [BtcScope.Testnet]: {
+                  chainId: BtcScope.Testnet,
+                  name: 'Bitcoin Testnet',
+                },
+              },
+              selectedMultichainNetworkChainId: BtcScope.Mainnet,
+              isEvmSelected: false,
+              networksWithTransactionActivity: {},
+            };
+          }
+          throw new Error(`Unexpected action type: ${actionType}`);
+        });
+
+      // Initialize the controller to trigger line 378 (init() method sets testnet to false)
+      await controller.init();
+
+      // Verify Bitcoin testnet is set to false by init() - line 378
+      expect(controller.isNetworkEnabled(BtcScope.Testnet)).toBe(false);
+      expect(
+        controller.state.enabledNetworkMap[KnownCaipNamespace.Bip122][
+          BtcScope.Testnet
+        ],
+      ).toBe(false);
+    });
+
+    it('sets Bitcoin signet to false when it exists in MultichainNetworkController configurations', async () => {
+      const { controller, messenger } = setupController();
+
+      // Mock MultichainNetworkController to include Bitcoin signet BEFORE calling init
+      jest
+        .spyOn(messenger, 'call')
+        // eslint-disable-next-line @typescript-eslint/no-explicit-any
+        .mockImplementation((actionType: string, ..._args: any[]): any => {
+          if (actionType === 'NetworkController:getState') {
+            return {
+              selectedNetworkClientId: 'mainnet',
+              networkConfigurationsByChainId: {
+                '0x1': {
+                  chainId: '0x1',
+                  name: 'Ethereum Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+              },
+              networksMetadata: {},
+            };
+          }
+          if (actionType === 'MultichainNetworkController:getState') {
+            return {
+              multichainNetworkConfigurationsByChainId: {
+                [BtcScope.Mainnet]: {
+                  chainId: BtcScope.Mainnet,
+                  name: 'Bitcoin Mainnet',
+                  nativeCurrency: 'BTC',
+                },
+                [BtcScope.Signet]: {
+                  chainId: BtcScope.Signet,
+                  name: 'Bitcoin Signet',
+                  nativeCurrency: 'BTC',
+                },
+              },
+              selectedMultichainNetworkChainId: BtcScope.Mainnet,
+              isEvmSelected: false,
+              networksWithTransactionActivity: {},
+            };
+          }
+          throw new Error(`Unexpected action type: ${actionType}`);
+        });
+
+      // Initialize the controller to trigger line 391 (init() method sets signet to false)
+      await controller.init();
+
+      // Verify Bitcoin signet is set to false by init() - line 391
+      expect(controller.isNetworkEnabled(BtcScope.Signet)).toBe(false);
+      expect(
+        controller.state.enabledNetworkMap[KnownCaipNamespace.Bip122][
+          BtcScope.Signet
+        ],
+      ).toBe(false);
+    });
+
+    it('skips networks that already have nativeAssetIdentifiers in state', async () => {
+      // Create controller with existing nativeAssetIdentifiers
+      const { controller, messenger } = setupController({
+        config: {
+          state: {
+            enabledNetworkMap: {
+              [KnownCaipNamespace.Eip155]: {},
+            },
+            nativeAssetIdentifiers: {
+              // Pre-existing nativeAssetIdentifier with custom value
+              'eip155:1': 'eip155:1/slip44:999' as const,
+            },
+          },
+        },
+      });
+
+      jest
+        .spyOn(messenger, 'call')
+        // eslint-disable-next-line @typescript-eslint/no-explicit-any
+        .mockImplementation((actionType: string, ..._args: any[]): any => {
+          if (actionType === 'NetworkController:getState') {
+            return {
+              selectedNetworkClientId: 'mainnet',
+              networkConfigurationsByChainId: {
+                '0x1': {
+                  chainId: '0x1',
+                  name: 'Ethereum Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                '0x38': {
+                  chainId: '0x38',
+                  name: 'BNB Chain',
+                  nativeCurrency: 'BNB',
+                },
+              },
+              networksMetadata: {},
+            };
+          }
+          if (actionType === 'MultichainNetworkController:getState') {
+            return {
+              multichainNetworkConfigurationsByChainId: {},
+              selectedMultichainNetworkChainId: 'eip155:1',
+              isEvmSelected: true,
+              networksWithTransactionActivity: {},
+            };
+          }
+          throw new Error(`Unexpected action type: ${actionType}`);
+        });
+
+      await controller.init();
+
+      // Existing nativeAssetIdentifier should be preserved (not overwritten)
+      expect(controller.state.nativeAssetIdentifiers['eip155:1']).toBe(
+        'eip155:1/slip44:999',
+      );
+
+      // New network should be added
+      expect(controller.state.nativeAssetIdentifiers['eip155:56']).toBe(
+        'eip155:56/slip44:714',
+      );
+    });
+
+    it('defaults to slip44:60 for EVM networks with unknown chainId and symbol', async () => {
+      const { controller, messenger } = setupController();
+
+      jest
+        .spyOn(messenger, 'call')
+        // eslint-disable-next-line @typescript-eslint/no-explicit-any
+        .mockImplementation((actionType: string, ..._args: any[]): any => {
+          if (actionType === 'NetworkController:getState') {
+            return {
+              selectedNetworkClientId: 'mainnet',
+              networkConfigurationsByChainId: {
+                // Use an unknown chainId (99999 = 0x1869F) and unknown symbol
+                '0x1869f': {
+                  chainId: '0x1869f',
+                  name: 'Unknown Network',
+                  nativeCurrency: 'UNKNOWN_SYMBOL_XYZ',
+                },
+              },
+              networksMetadata: {},
+            };
+          }
+          if (actionType === 'MultichainNetworkController:getState') {
+            return {
+              multichainNetworkConfigurationsByChainId: {},
+              selectedMultichainNetworkChainId: 'eip155:1',
+              isEvmSelected: true,
+              networksWithTransactionActivity: {},
+            };
+          }
+          throw new Error(`Unexpected action type: ${actionType}`);
+        });
+
+      await controller.init();
+
+      // Should default to slip44:60 when no mapping is found
+      expect(controller.state.nativeAssetIdentifiers['eip155:99999']).toBe(
+        'eip155:99999/slip44:60',
+      );
+    });
+  });
+
+  describe('initNativeAssetIdentifiers', () => {
+    it('populates nativeAssetIdentifiers from network configurations', async () => {
+      const { controller } = setupController();
+
+      const networks = [
+        { chainId: 'eip155:1' as const, nativeCurrency: 'ETH' },
+        { chainId: 'eip155:56' as const, nativeCurrency: 'BNB' },
+        {
+          chainId: 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp' as const,
+          nativeCurrency: 'SOL',
+        },
+      ];
+
+      await controller.initNativeAssetIdentifiers(networks);
+
+      expect(controller.state.nativeAssetIdentifiers).toStrictEqual({
+        'eip155:1': 'eip155:1/slip44:60',
+        'eip155:56': 'eip155:56/slip44:714',
+        'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp':
+          'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp/slip44:501',
+      });
+    });
+
+    it('defaults to slip44:60 for EVM networks with unknown symbols', async () => {
+      const { controller } = setupController();
+
+      const networks = [
+        { chainId: 'eip155:1' as const, nativeCurrency: 'ETH' },
+        { chainId: 'eip155:999' as const, nativeCurrency: 'UNKNOWN_XYZ' },
+      ];
+
+      await controller.initNativeAssetIdentifiers(networks);
+
+      expect(controller.state.nativeAssetIdentifiers['eip155:1']).toBe(
+        'eip155:1/slip44:60',
+      );
+      // EVM networks default to slip44:60 (Ethereum) when no specific mapping is found
+      expect(controller.state.nativeAssetIdentifiers['eip155:999']).toBe(
+        'eip155:999/slip44:60',
+      );
+    });
+
+    it('does not modify state for empty input', async () => {
+      const { controller } = setupController();
+
+      await controller.initNativeAssetIdentifiers([]);
+
+      expect(controller.state.nativeAssetIdentifiers).toStrictEqual({});
+    });
+
+    it('handles CAIP-19 format nativeCurrency from MultichainNetworkController', async () => {
+      const { controller } = setupController();
+
+      // Non-EVM networks from MultichainNetworkController use CAIP-19 format for nativeCurrency
+      const networks = [
+        // EVM networks use simple symbols
+        { chainId: 'eip155:1' as const, nativeCurrency: 'ETH' },
+        // Non-EVM networks use full CAIP-19 format
+        {
+          chainId: 'bip122:000000000019d6689c085ae165831e93' as const,
+          nativeCurrency: 'bip122:000000000019d6689c085ae165831e93/slip44:0',
+        },
+        {
+          chainId: 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp' as const,
+          nativeCurrency: 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp/slip44:501',
+        },
+        {
+          chainId: 'tron:728126428' as const,
+          nativeCurrency: 'tron:728126428/slip44:195',
+        },
+      ];
+
+      await controller.initNativeAssetIdentifiers(networks);
+
+      expect(controller.state.nativeAssetIdentifiers).toStrictEqual({
+        'eip155:1': 'eip155:1/slip44:60',
+        'bip122:000000000019d6689c085ae165831e93':
+          'bip122:000000000019d6689c085ae165831e93/slip44:0',
+        'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp':
+          'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp/slip44:501',
+        'tron:728126428': 'tron:728126428/slip44:195',
+      });
+    });
+  });
+
+  describe('enableAllPopularNetworks', () => {
+    it('enables all popular networks that exist in controller configurations and Solana mainnet', () => {
+      const { controller, messenger } = setupController();
+
+      // Mock the network configurations
+      jest
+        .spyOn(messenger, 'call')
+        // eslint-disable-next-line @typescript-eslint/no-explicit-any
+        .mockImplementation((actionType: string, ..._args: any[]): any => {
+          if (actionType === 'NetworkController:getState') {
+            return {
+              selectedNetworkClientId: 'mainnet',
+              networkConfigurationsByChainId: {
+                '0x1': {
+                  chainId: '0x1',
+                  name: 'Ethereum Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                '0xe708': {
+                  chainId: '0xe708',
+                  name: 'Linea Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                '0x2105': {
+                  chainId: '0x2105',
+                  name: 'Base Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+              },
+              networksMetadata: {},
+            };
+          }
+          if (actionType === 'MultichainNetworkController:getState') {
+            return {
+              multichainNetworkConfigurationsByChainId: {
+                'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp': {
+                  chainId: 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+                  name: 'Solana Mainnet',
+                  nativeCurrency: 'SOL',
+                },
+                [BtcScope.Mainnet]: {
+                  chainId: BtcScope.Mainnet,
+                  name: 'Bitcoin Mainnet',
+                },
+                [TrxScope.Mainnet]: {
+                  chainId: TrxScope.Mainnet,
+                  name: 'Tron Mainnet',
+                },
+              },
+              selectedMultichainNetworkChainId:
+                'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+              isEvmSelected: false,
+              networksWithTransactionActivity: {},
+            };
+          }
+          throw new Error(`Unexpected action type: ${actionType}`);
+        });
+
+      // Initially disable some networks
+      controller.disableNetwork('0xe708'); // Linea
+      controller.disableNetwork('0x2105'); // Base
+
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': true, // Ethereum Mainnet
+            '0xe708': false, // Linea Mainnet (disabled)
+            '0x2105': false, // Base Mainnet (disabled)
+            [ChainId[BuiltInNetworkName.ArbitrumOne]]: true,
+            [ChainId[BuiltInNetworkName.BscMainnet]]: true,
+            [ChainId[BuiltInNetworkName.OptimismMainnet]]: true,
+            [ChainId[BuiltInNetworkName.PolygonMainnet]]: true,
+            [ChainId[BuiltInNetworkName.SeiMainnet]]: true,
+          },
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: true,
+            [SolScope.Testnet]: false,
+            [SolScope.Devnet]: false,
+          },
+          [KnownCaipNamespace.Bip122]: {
+            [BtcScope.Mainnet]: true,
+            [BtcScope.Testnet]: false,
+            [BtcScope.Signet]: false,
+          },
+          [KnownCaipNamespace.Tron]: {
+            [TrxScope.Mainnet]: true,
+            [TrxScope.Nile]: false,
+            [TrxScope.Shasta]: false,
+          },
+        },
+        nativeAssetIdentifiers: getDefaultNativeAssetIdentifiers(),
+      });
+
+      // Enable all popular networks
+      controller.enableAllPopularNetworks();
+
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': true, // Ethereum Mainnet
+            '0xe708': true, // Linea Mainnet
+            '0x2105': true, // Base Mainnet
+            [ChainId[BuiltInNetworkName.ArbitrumOne]]: false, // Not in mocked config
+            [ChainId[BuiltInNetworkName.BscMainnet]]: false, // Not in mocked config
+            [ChainId[BuiltInNetworkName.OptimismMainnet]]: false, // Not in mocked config
+            [ChainId[BuiltInNetworkName.PolygonMainnet]]: false, // Not in mocked config
+            [ChainId[BuiltInNetworkName.SeiMainnet]]: false, // Not in mocked config
+          },
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: true, // Solana
+            [SolScope.Testnet]: false,
+            [SolScope.Devnet]: false,
+          },
+          [KnownCaipNamespace.Bip122]: {
+            [BtcScope.Mainnet]: true,
+            [BtcScope.Testnet]: false,
+            [BtcScope.Signet]: false,
+          },
+          [KnownCaipNamespace.Tron]: {
+            [TrxScope.Mainnet]: true,
+            [TrxScope.Nile]: false,
+            [TrxScope.Shasta]: false,
+          },
+        },
+        nativeAssetIdentifiers: getDefaultNativeAssetIdentifiers(),
+      });
+    });
+
+    it('enables all popular networks from constants', () => {
+      const { controller, messenger } = setupController();
+
+      // Mock all popular networks to be available in configurations
+      jest.spyOn(messenger, 'call').mockImplementation(
+        // eslint-disable-next-line @typescript-eslint/no-explicit-any
+        (actionType: string, ..._args: any[]): any => {
+          if (actionType === 'NetworkController:getState') {
+            // Create mock configurations for all popular networks
+            const networkConfigurationsByChainId = POPULAR_NETWORKS.reduce(
+              // eslint-disable-next-line @typescript-eslint/no-explicit-any
+              (acc: any, chainId: string) => {
+                acc[chainId] = { chainId, name: `Network ${chainId}` };
+                return acc;
+              },
+              {},
+            );
+            return {
+              selectedNetworkClientId: 'mainnet',
+              networkConfigurationsByChainId,
+              networksMetadata: {},
+            };
+          }
+          if (actionType === 'MultichainNetworkController:getState') {
+            return {
+              multichainNetworkConfigurationsByChainId: {
+                'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp': {
+                  chainId: 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+                  name: 'Solana Mainnet',
+                  nativeCurrency: 'SOL',
+                },
+                [BtcScope.Mainnet]: {
+                  chainId: BtcScope.Mainnet,
+                  name: 'Bitcoin Mainnet',
+                },
+              },
+              selectedMultichainNetworkChainId:
+                'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+              isEvmSelected: false,
+              networksWithTransactionActivity: {},
+            };
+          }
+          throw new Error(`Unexpected action type: ${actionType}`);
+        },
+      );
+
+      // The function should enable all popular networks defined in constants
+      expect(() => controller.enableAllPopularNetworks()).not.toThrow();
+
+      // Should enable all popular networks and Solana
+      const expectedEip155Networks = POPULAR_NETWORKS.reduce(
+        // eslint-disable-next-line @typescript-eslint/no-explicit-any
+        (acc: any, chainId: string) => {
+          acc[chainId] = true;
+          return acc;
+        },
+        {},
+      );
+
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: expectedEip155Networks,
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: true, // Solana Mainnet
+            [SolScope.Testnet]: false,
+            [SolScope.Devnet]: false,
+          },
+          [KnownCaipNamespace.Bip122]: {
+            [BtcScope.Mainnet]: true,
+            [BtcScope.Testnet]: false,
+            [BtcScope.Signet]: false,
+          },
+          [KnownCaipNamespace.Tron]: {
+            [TrxScope.Mainnet]: false,
+            [TrxScope.Nile]: false,
+            [TrxScope.Shasta]: false,
+          },
+        },
+        nativeAssetIdentifiers: getDefaultNativeAssetIdentifiers(),
+      });
+    });
+
+    it('disables existing networks and enables only popular networks (exclusive behavior)', async () => {
+      const { controller, rootMessenger, messenger } = setupController();
+
+      // Mock the network configurations to include popular networks
+      jest
+        .spyOn(messenger, 'call')
+        // eslint-disable-next-line @typescript-eslint/no-explicit-any
+        .mockImplementation((actionType: string, ..._args: any[]): any => {
+          if (actionType === 'NetworkController:getState') {
+            return {
+              selectedNetworkClientId: 'mainnet',
+              networkConfigurationsByChainId: {
+                '0x1': {
+                  chainId: '0x1',
+                  name: 'Ethereum Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                '0xe708': {
+                  chainId: '0xe708',
+                  name: 'Linea Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                '0x2105': {
+                  chainId: '0x2105',
+                  name: 'Base Mainnet',
+                  nativeCurrency: 'ETH',
+                },
+                '0x2': { chainId: '0x2', name: 'Test Network' }, // Non-popular network
+              },
+              networksMetadata: {},
+            };
+          }
+          if (actionType === 'MultichainNetworkController:getState') {
+            return {
+              multichainNetworkConfigurationsByChainId: {
+                'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp': {
+                  chainId: 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+                  name: 'Solana Mainnet',
+                  nativeCurrency: 'SOL',
+                },
+                [BtcScope.Mainnet]: {
+                  chainId: BtcScope.Mainnet,
+                  name: 'Bitcoin Mainnet',
+                },
+              },
+              selectedMultichainNetworkChainId:
+                'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+              isEvmSelected: false,
+              networksWithTransactionActivity: {},
+            };
+          }
+          throw new Error(`Unexpected action type: ${actionType}`);
+        });
+
+      // Add a non-popular network
+      rootMessenger.publish('NetworkController:networkAdded', {
+        chainId: '0x2', // A network not in POPULAR_NETWORKS
+        blockExplorerUrls: [],
+        defaultRpcEndpointIndex: 0,
+        name: 'Test Network',
+        nativeCurrency: 'TEST',
+        rpcEndpoints: [
+          {
+            url: 'https://test.network/rpc',
+            networkClientId: 'test-id',
+            type: RpcEndpointType.Custom,
+          },
+        ],
+      });
+
+      await advanceTime({ clock, duration: 1 });
+
+      // The added network should be enabled (exclusive behavior of network addition)
+      expect(controller.isNetworkEnabled('0x2')).toBe(true);
+      // Popular networks should be disabled due to exclusive behavior
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+
+      // Enable all popular networks - this should disable the non-popular network (exclusive behavior)
+      controller.enableAllPopularNetworks();
+
+      // All popular networks should now be enabled (with exclusive behavior)
+      expect(controller.isNetworkEnabled('0x1')).toBe(true); // Ethereum
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true); // Linea
+      expect(controller.isNetworkEnabled('0x2105')).toBe(true); // Base
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(true); // Solana
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(true); // Bitcoin
+      // The non-popular network should be disabled due to exclusive behavior
+      expect(controller.isNetworkEnabled('0x2')).toBe(false); // Test network
+    });
+
+    it('enables Bitcoin mainnet when configured in MultichainNetworkController', () => {
+      const { controller, messenger } = setupController();
+
+      // Mock the network configurations to include Bitcoin
+      jest
+        .spyOn(messenger, 'call')
+        // eslint-disable-next-line @typescript-eslint/no-explicit-any
+        .mockImplementation((actionType: string, ..._args: unknown[]): any => {
+          const responses = {
+            'NetworkController:getState': {
+              selectedNetworkClientId: 'mainnet',
+              networkConfigurationsByChainId: {},
+              networksMetadata: {},
+            },
+            'MultichainNetworkController:getState': {
+              multichainNetworkConfigurationsByChainId: {
+                [BtcScope.Mainnet]: {
+                  chainId: BtcScope.Mainnet,
+                  name: 'Bitcoin Mainnet',
+                  isEvm: false as const,
+                  nativeCurrency:
+                    'bip122:000000000019d6689c085ae165831e93/slip44:0' as `${string}:${string}/${string}:${string}`,
+                },
+              },
+              selectedMultichainNetworkChainId: BtcScope.Mainnet,
+              isEvmSelected: false,
+              networksWithTransactionActivity: {},
+            },
+          };
+          return responses[actionType as keyof typeof responses];
+        });
+
+      // Initially disable Bitcoin to test enablement
+      // eslint-disable-next-line dot-notation
+      controller['update']((state) => {
+        state.enabledNetworkMap[KnownCaipNamespace.Bip122][BtcScope.Mainnet] =
+          false;
+      });
+
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+
+      // enableAllPopularNetworks should re-enable Bitcoin when it exists in config
+      controller.enableAllPopularNetworks();
+
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(true);
+    });
+  });
+
+  describe('enableNetwork', () => {
+    it('enables a network and clears all others in all namespaces', () => {
+      const { controller } = setupController();
+
+      // Disable a popular network (Ethereum Mainnet)
+      controller.disableNetwork('0x1');
+
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': false, // Ethereum Mainnet (disabled)
+            '0xe708': true, // Linea Mainnet
+            '0x2105': true, // Base Mainnet
+            [ChainId[BuiltInNetworkName.ArbitrumOne]]: true,
+            [ChainId[BuiltInNetworkName.BscMainnet]]: true,
+            [ChainId[BuiltInNetworkName.OptimismMainnet]]: true,
+            [ChainId[BuiltInNetworkName.PolygonMainnet]]: true,
+            [ChainId[BuiltInNetworkName.SeiMainnet]]: true,
+          },
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: true,
+            [SolScope.Testnet]: false,
+            [SolScope.Devnet]: false,
+          },
+          [KnownCaipNamespace.Bip122]: {
+            [BtcScope.Mainnet]: true,
+            [BtcScope.Testnet]: false,
+            [BtcScope.Signet]: false,
+          },
+          [KnownCaipNamespace.Tron]: {
+            [TrxScope.Mainnet]: true,
+            [TrxScope.Nile]: false,
+            [TrxScope.Shasta]: false,
+          },
+        },
+        nativeAssetIdentifiers: getDefaultNativeAssetIdentifiers(),
+      });
+
+      // Enable the network again - this should disable all others in all namespaces
+      controller.enableNetwork('0x1');
+
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: {
+            [ChainId[BuiltInNetworkName.Mainnet]]: true, // Ethereum Mainnet (re-enabled)
+            [ChainId[BuiltInNetworkName.LineaMainnet]]: false, // Linea Mainnet (disabled)
+            [ChainId[BuiltInNetworkName.BaseMainnet]]: false, // Base Mainnet (disabled)
+            [ChainId[BuiltInNetworkName.ArbitrumOne]]: false,
+            [ChainId[BuiltInNetworkName.BscMainnet]]: false,
+            [ChainId[BuiltInNetworkName.OptimismMainnet]]: false,
+            [ChainId[BuiltInNetworkName.PolygonMainnet]]: false,
+            [ChainId[BuiltInNetworkName.SeiMainnet]]: false,
+          },
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: false, // Now disabled (cross-namespace behavior)
+            [SolScope.Testnet]: false,
+            [SolScope.Devnet]: false,
+          },
+          [KnownCaipNamespace.Bip122]: {
+            [BtcScope.Mainnet]: false, // Now disabled (cross-namespace behavior)
+            [BtcScope.Testnet]: false,
+            [BtcScope.Signet]: false,
+          },
+          [KnownCaipNamespace.Tron]: {
+            [TrxScope.Mainnet]: false,
+            [TrxScope.Nile]: false,
+            [TrxScope.Shasta]: false,
+          },
+        },
+        nativeAssetIdentifiers: getDefaultNativeAssetIdentifiers(),
+      });
+    });
+
+    it('enables any network and clears all others (exclusive behavior)', async () => {
+      const { controller, rootMessenger } = setupController();
+
+      // Add a non-popular network
+      rootMessenger.publish('NetworkController:networkAdded', {
+        chainId: '0x2',
+        blockExplorerUrls: [],
+        defaultRpcEndpointIndex: 0,
+        name: 'Polygon',
+        nativeCurrency: 'MATIC',
+        rpcEndpoints: [
+          {
+            url: 'https://polygon-mainnet.infura.io/v3/1234567890',
+            networkClientId: 'id',
+            type: RpcEndpointType.Custom,
+          },
+        ],
+      });
+
+      await advanceTime({ clock, duration: 1 });
+
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': false,
+            '0xe708': false,
+            '0x2105': false,
+            '0x2': true,
+            [ChainId[BuiltInNetworkName.ArbitrumOne]]: false,
+            [ChainId[BuiltInNetworkName.BscMainnet]]: false,
+            [ChainId[BuiltInNetworkName.OptimismMainnet]]: false,
+            [ChainId[BuiltInNetworkName.PolygonMainnet]]: false,
+            [ChainId[BuiltInNetworkName.SeiMainnet]]: false,
+          },
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: false, // Disabled due to cross-namespace behavior
+            [SolScope.Testnet]: false,
+            [SolScope.Devnet]: false,
+          },
+          [KnownCaipNamespace.Bip122]: {
+            [BtcScope.Mainnet]: false, // Disabled due to cross-namespace behavior
+            [BtcScope.Testnet]: false,
+            [BtcScope.Signet]: false,
+          },
+          [KnownCaipNamespace.Tron]: {
+            [TrxScope.Mainnet]: false,
+            [TrxScope.Nile]: false,
+            [TrxScope.Shasta]: false,
+          },
+        },
+        nativeAssetIdentifiers: {
+          ...getDefaultNativeAssetIdentifiers(),
+          'eip155:2': 'eip155:2/slip44:60', // Defaults to 60 as chainId 2 is not in chainid.network
+        },
+      });
+
+      // Enable one of the popular networks - only this one will be enabled
+      controller.enableNetwork('0x2105');
+
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': false,
+            '0xe708': false,
+            '0x2105': true,
+            '0x2': false,
+            [ChainId[BuiltInNetworkName.ArbitrumOne]]: false,
+            [ChainId[BuiltInNetworkName.BscMainnet]]: false,
+            [ChainId[BuiltInNetworkName.OptimismMainnet]]: false,
+            [ChainId[BuiltInNetworkName.PolygonMainnet]]: false,
+            [ChainId[BuiltInNetworkName.SeiMainnet]]: false,
+          },
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: false, // Now disabled (cross-namespace behavior)
+            [SolScope.Testnet]: false,
+            [SolScope.Devnet]: false,
+          },
+          [KnownCaipNamespace.Bip122]: {
+            [BtcScope.Mainnet]: false, // Now disabled (cross-namespace behavior)
+            [BtcScope.Testnet]: false,
+            [BtcScope.Signet]: false,
+          },
+          [KnownCaipNamespace.Tron]: {
+            [TrxScope.Mainnet]: false,
+            [TrxScope.Nile]: false,
+            [TrxScope.Shasta]: false,
+          },
+        },
+        nativeAssetIdentifiers: {
+          ...getDefaultNativeAssetIdentifiers(),
+          'eip155:2': 'eip155:2/slip44:60', // Defaults to 60 as chainId 2 is not in chainid.network
+        },
+      });
+
+      // Enable the non-popular network again - it will disable all others
+      controller.enableNetwork('0x2');
+
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': false,
+            '0xe708': false,
+            '0x2105': false,
+            '0x2': true,
+            [ChainId[BuiltInNetworkName.ArbitrumOne]]: false,
+            [ChainId[BuiltInNetworkName.BscMainnet]]: false,
+            [ChainId[BuiltInNetworkName.OptimismMainnet]]: false,
+            [ChainId[BuiltInNetworkName.PolygonMainnet]]: false,
+            [ChainId[BuiltInNetworkName.SeiMainnet]]: false,
+          },
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: false, // Now disabled (cross-namespace behavior)
+            [SolScope.Testnet]: false,
+            [SolScope.Devnet]: false,
+          },
+          [KnownCaipNamespace.Bip122]: {
+            [BtcScope.Mainnet]: false, // Now disabled (cross-namespace behavior)
+            [BtcScope.Testnet]: false,
+            [BtcScope.Signet]: false,
+          },
+          [KnownCaipNamespace.Tron]: {
+            [TrxScope.Mainnet]: false,
+            [TrxScope.Nile]: false,
+            [TrxScope.Shasta]: false,
+          },
+        },
+        nativeAssetIdentifiers: {
+          ...getDefaultNativeAssetIdentifiers(),
+          'eip155:2': 'eip155:2/slip44:60', // Defaults to 60 as chainId 2 is not in chainid.network
+        },
+      });
+    });
+
+    it('handles invalid chain ID gracefully', () => {
+      const { controller } = setupController();
+
+      // @ts-expect-error Intentionally passing an invalid chain ID
+      expect(() => controller.enableNetwork('invalid')).toThrow(
+        'Value must be a hexadecimal string.',
+      );
+    });
+
+    it('handles enabling a network that is not added', () => {
+      const { controller } = setupController();
+
+      controller.enableNetwork('bip122:000000000019d6689c085ae165831e93');
+
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: {
+            [ChainId[BuiltInNetworkName.Mainnet]]: false, // Disabled due to cross-namespace behavior
+            [ChainId[BuiltInNetworkName.LineaMainnet]]: false, // Disabled due to cross-namespace behavior
+            [ChainId[BuiltInNetworkName.BaseMainnet]]: false, // Disabled due to cross-namespace behavior
+            [ChainId[BuiltInNetworkName.ArbitrumOne]]: false,
+            [ChainId[BuiltInNetworkName.BscMainnet]]: false,
+            [ChainId[BuiltInNetworkName.OptimismMainnet]]: false,
+            [ChainId[BuiltInNetworkName.PolygonMainnet]]: false,
+            [ChainId[BuiltInNetworkName.SeiMainnet]]: false,
+          },
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: false, // Disabled due to cross-namespace behavior
+            [SolScope.Testnet]: false,
+            [SolScope.Devnet]: false,
+          },
+          [KnownCaipNamespace.Bip122]: {
+            [BtcScope.Mainnet]: true, // This network was enabled (even though namespace doesn't exist)
+            [BtcScope.Testnet]: false,
+            [BtcScope.Signet]: false,
+          },
+          [KnownCaipNamespace.Tron]: {
+            [TrxScope.Mainnet]: false,
+            [TrxScope.Nile]: false,
+            [TrxScope.Shasta]: false,
+          },
+        },
+        nativeAssetIdentifiers: getDefaultNativeAssetIdentifiers(),
+      });
+    });
+
+    it('handles enabling a network in non-existent namespace gracefully', () => {
+      const { controller } = setupController();
+
+      // Remove the BIP122 namespace to test the early return
+      // eslint-disable-next-line dot-notation
+      controller['update']((state) => {
+        delete state.enabledNetworkMap[KnownCaipNamespace.Bip122];
+      });
+
+      // Try to enable a Bitcoin network when the namespace doesn't exist
+      controller.enableNetwork('bip122:000000000933ea01ad0ee984209779ba');
+
+      // All existing networks should be disabled due to cross-namespace behavior, even though target network couldn't be enabled
+      // slip44Map is not affected by enabledNetworkMap changes, so it still contains all the original entries
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: {
+            [ChainId[BuiltInNetworkName.Mainnet]]: false,
+            [ChainId[BuiltInNetworkName.LineaMainnet]]: false,
+            [ChainId[BuiltInNetworkName.BaseMainnet]]: false,
+            [ChainId[BuiltInNetworkName.ArbitrumOne]]: false,
+            [ChainId[BuiltInNetworkName.BscMainnet]]: false,
+            [ChainId[BuiltInNetworkName.OptimismMainnet]]: false,
+            [ChainId[BuiltInNetworkName.PolygonMainnet]]: false,
+            [ChainId[BuiltInNetworkName.SeiMainnet]]: false,
+          },
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: false,
+            [SolScope.Testnet]: false,
+            [SolScope.Devnet]: false,
+          },
+          [KnownCaipNamespace.Tron]: {
+            [TrxScope.Mainnet]: false,
+            [TrxScope.Nile]: false,
+            [TrxScope.Shasta]: false,
+          },
+        },
+        nativeAssetIdentifiers: getDefaultNativeAssetIdentifiers(),
+      });
+    });
+
+    it('handle no namespace bucket', async () => {
+      const { controller, rootMessenger } = setupController();
+
+      // add new network with no namespace bucket
+      rootMessenger.publish('NetworkController:networkAdded', {
+        // @ts-expect-error Intentionally passing an invalid chain ID
+        chainId: 'bip122:000000000019d6689c085ae165831e93',
+        blockExplorerUrls: [],
+        defaultRpcEndpointIndex: 0,
+        name: 'Bitcoin',
+        nativeCurrency: 'BTC',
+        rpcEndpoints: [
+          {
+            url: 'https://api.blockcypher.com/v1/btc/main',
+            networkClientId: 'id',
+            type: RpcEndpointType.Custom,
+          },
+        ],
+      });
+
+      await advanceTime({ clock, duration: 1 });
+
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: {
+            [ChainId[BuiltInNetworkName.Mainnet]]: false, // Disabled due to cross-namespace behavior
+            [ChainId[BuiltInNetworkName.LineaMainnet]]: false, // Disabled due to cross-namespace behavior
+            [ChainId[BuiltInNetworkName.BaseMainnet]]: false, // Disabled due to cross-namespace behavior
+            [ChainId[BuiltInNetworkName.ArbitrumOne]]: false,
+            [ChainId[BuiltInNetworkName.BscMainnet]]: false,
+            [ChainId[BuiltInNetworkName.OptimismMainnet]]: false,
+            [ChainId[BuiltInNetworkName.PolygonMainnet]]: false,
+            [ChainId[BuiltInNetworkName.SeiMainnet]]: false,
+          },
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: false, // Disabled due to cross-namespace behavior
+            [SolScope.Testnet]: false,
+            [SolScope.Devnet]: false,
+          },
+          [KnownCaipNamespace.Bip122]: {
+            'bip122:000000000019d6689c085ae165831e93': true,
+            [BtcScope.Testnet]: false,
+            [BtcScope.Signet]: false,
+          },
+          [KnownCaipNamespace.Tron]: {
+            [TrxScope.Mainnet]: false,
+            [TrxScope.Nile]: false,
+            [TrxScope.Shasta]: false,
+          },
+        },
+        nativeAssetIdentifiers: {
+          ...getDefaultNativeAssetIdentifiers(),
+          // Note: This is testing invalid input (non-EVM chainId to EVM event handler)
+          // getEvmSlip44 defaults to 60 for unknown chainIds
+          'bip122:000000000019d6689c085ae165831e93':
+            'bip122:000000000019d6689c085ae165831e93/slip44:60',
+        },
+      });
+    });
+  });
+
+  describe('disableNetwork', () => {
+    it('disables an EVM network using hex chain ID', () => {
+      const { controller } = setupController();
+
+      // Disable a network (but not the last one)
+      controller.disableNetwork('0xe708'); // Linea Mainnet
+
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': true,
+            '0xe708': false,
+            '0x2105': true,
+            [ChainId[BuiltInNetworkName.ArbitrumOne]]: true,
+            [ChainId[BuiltInNetworkName.BscMainnet]]: true,
+            [ChainId[BuiltInNetworkName.OptimismMainnet]]: true,
+            [ChainId[BuiltInNetworkName.PolygonMainnet]]: true,
+            [ChainId[BuiltInNetworkName.SeiMainnet]]: true,
+          },
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: true,
+            [SolScope.Testnet]: false,
+            [SolScope.Devnet]: false,
+          },
+          [KnownCaipNamespace.Bip122]: {
+            [BtcScope.Mainnet]: true,
+            [BtcScope.Testnet]: false,
+            [BtcScope.Signet]: false,
+          },
+          [KnownCaipNamespace.Tron]: {
+            [TrxScope.Mainnet]: true,
+            [TrxScope.Nile]: false,
+            [TrxScope.Shasta]: false,
+          },
+        },
+        nativeAssetIdentifiers: getDefaultNativeAssetIdentifiers(),
+      });
+    });
+
+    it('does disable a Solana network using CAIP chain ID as it is the only enabled network on the namespace', () => {
+      const { controller } = setupController();
+
+      // Try to disable a Solana network using CAIP chain ID
+      expect(() =>
+        controller.disableNetwork('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).not.toThrow();
+    });
+
+    it('disables the last active network for an EVM namespace', () => {
+      const { controller } = setupController();
+
+      // disable all networks except one
+      controller.disableNetwork('0xe708'); // Linea Mainnet
+      controller.disableNetwork('0x2105'); // Base Mainnet
+
+      expect(controller.state).toStrictEqual({
+        enabledNetworkMap: {
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': true,
+            '0xe708': false,
+            '0x2105': false,
+            [ChainId[BuiltInNetworkName.ArbitrumOne]]: true,
+            [ChainId[BuiltInNetworkName.BscMainnet]]: true,
+            [ChainId[BuiltInNetworkName.OptimismMainnet]]: true,
+            [ChainId[BuiltInNetworkName.PolygonMainnet]]: true,
+            [ChainId[BuiltInNetworkName.SeiMainnet]]: true,
+          },
+          [KnownCaipNamespace.Solana]: {
+            [SolScope.Mainnet]: true,
+            [SolScope.Testnet]: false,
+            [SolScope.Devnet]: false,
+          },
+          [KnownCaipNamespace.Bip122]: {
+            [BtcScope.Mainnet]: true,
+            [BtcScope.Testnet]: false,
+            [BtcScope.Signet]: false,
+          },
+          [KnownCaipNamespace.Tron]: {
+            [TrxScope.Mainnet]: true,
+            [TrxScope.Nile]: false,
+            [TrxScope.Shasta]: false,
+          },
+        },
+        nativeAssetIdentifiers: getDefaultNativeAssetIdentifiers(),
+      });
+
+      // Try to disable the last active network
+      expect(() => controller.disableNetwork('0x1')).not.toThrow();
+    });
+
+    it('handles disabling non-existent network gracefully', () => {
+      const { controller } = setupController();
+
+      // Try to disable a non-existent network
+      expect(() => controller.disableNetwork('0x999')).not.toThrow();
+    });
+
+    it('handles invalid chain ID gracefully', () => {
+      const { controller } = setupController();
+
+      // @ts-expect-error Intentionally passing an invalid chain ID
+      expect(() => controller.disableNetwork('invalid')).toThrow(
+        'Value must be a hexadecimal string.',
+      );
+    });
+  });
+
+  describe('isNetworkEnabled', () => {
+    it('returns true for enabled networks using hex chain ID', () => {
+      const { controller } = setupController();
+
+      // Test default enabled networks
+      expect(controller.isNetworkEnabled('0x1')).toBe(true); // Ethereum Mainnet
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true); // Linea Mainnet
+      expect(controller.isNetworkEnabled('0x2105')).toBe(true); // Base Mainnet
+    });
+
+    it('returns false for disabled networks using hex chain ID', () => {
+      const { controller } = setupController();
+
+      // Disable a network and test
+      controller.disableNetwork('0xe708'); // Linea Mainnet (not the last one)
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+
+      // Test networks that were never enabled
+      expect(controller.isNetworkEnabled('0xa86a')).toBe(false); // Avalanche (not in default state)
+      expect(controller.isNetworkEnabled('0x999')).toBe(false); // Non-existent network
+    });
+
+    it('returns true for enabled networks using CAIP chain ID', () => {
+      const { controller } = setupController();
+
+      // Test EVM networks with CAIP format
+      expect(controller.isNetworkEnabled('eip155:1')).toBe(true); // Ethereum Mainnet
+      expect(controller.isNetworkEnabled('eip155:59144')).toBe(true); // Linea Mainnet
+      expect(controller.isNetworkEnabled('eip155:8453')).toBe(true); // Base Mainnet
+
+      // Test Solana network
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(true);
+    });
+
+    it('returns false for disabled networks using CAIP chain ID', () => {
+      const { controller } = setupController();
+
+      // Disable a network using hex and test with CAIP
+      controller.disableNetwork('0xe708'); // Linea Mainnet (not the last one)
+      expect(controller.isNetworkEnabled('eip155:59144')).toBe(false);
+
+      // Test networks that were never enabled
+      expect(controller.isNetworkEnabled('eip155:43114')).toBe(false); // Avalanche (not in default state)
+      expect(controller.isNetworkEnabled('eip155:999')).toBe(false); // Non-existent network
+    });
+
+    it('handles non-existent networks gracefully', () => {
+      const { controller } = setupController();
+
+      // Test networks that don't exist in the state
+      expect(controller.isNetworkEnabled('0x999')).toBe(false);
+      expect(controller.isNetworkEnabled('eip155:999')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('bip122:000000000019d6689c085ae165831e93'),
+      ).toBe(true);
+    });
+
+    it('returns false for networks in non-existent namespaces', () => {
+      const { controller } = setupController();
+
+      // Test a network in a namespace that doesn't exist yet
+      expect(controller.isNetworkEnabled('cosmos:cosmoshub-4')).toBe(false);
+      expect(
+        controller.isNetworkEnabled(
+          'polkadot:91b171bb158e2d3848fa23a9f1c25182',
+        ),
+      ).toBe(false);
+    });
+
+    it('works correctly after enabling/disabling networks', () => {
+      const { controller } = setupController();
+
+      // Initially enabled
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true);
+
+      // Disable and check (not the last network)
+      controller.disableNetwork('0xe708');
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+
+      // Re-enable and check
+      controller.enableNetwork('0xe708');
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true);
+    });
+
+    it('maintains consistency between hex and CAIP formats for same network', () => {
+      const { controller } = setupController();
+
+      // Both formats should return the same result for the same network
+      expect(controller.isNetworkEnabled('0x1')).toBe(
+        controller.isNetworkEnabled('eip155:1'),
+      );
+      expect(controller.isNetworkEnabled('0xe708')).toBe(
+        controller.isNetworkEnabled('eip155:59144'),
+      );
+      expect(controller.isNetworkEnabled('0x2105')).toBe(
+        controller.isNetworkEnabled('eip155:8453'),
+      );
+
+      // Test after disabling (not the last network)
+      controller.disableNetwork('0xe708');
+      expect(controller.isNetworkEnabled('0xe708')).toBe(
+        controller.isNetworkEnabled('eip155:59144'),
+      );
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+    });
+
+    it('works with dynamically added networks', async () => {
+      const { controller, rootMessenger } = setupController();
+
+      // Initially, Avalanche network should not be enabled (doesn't exist)
+      expect(controller.isNetworkEnabled('0xa86a')).toBe(false);
+
+      // Add Avalanche network (popular network in popular mode)
+      // Should keep current selection (add but don't enable)
+      rootMessenger.publish('NetworkController:networkAdded', {
+        chainId: '0xa86a',
+        blockExplorerUrls: [],
+        defaultRpcEndpointIndex: 0,
+        name: 'Avalanche',
+        nativeCurrency: 'AVAX',
+        rpcEndpoints: [
+          {
+            url: 'https://api.avax.network/ext/bc/C/rpc',
+            networkClientId: 'id',
+            type: RpcEndpointType.Custom,
+          },
+        ],
+      });
+
+      await advanceTime({ clock, duration: 1 });
+
+      // Now it should be added but not enabled (keeps current selection in popular mode)
+      expect(controller.isNetworkEnabled('0xa86a')).toBe(true);
+      expect(controller.isNetworkEnabled('eip155:43114')).toBe(true);
+    });
+
+    it('handles disabling networks across different namespaces independently, but adding networks has exclusive behavior', async () => {
+      const { controller, rootMessenger } = setupController();
+
+      // EVM networks should not affect Solana network status when disabling
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(true);
+
+      // Disable all EVM networks (should not affect Solana)
+      controller.disableNetwork('0xe708'); // Linea
+      controller.disableNetwork('0x2105'); // Base
+
+      // Solana should still be enabled
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(true);
+
+      // Add a Bitcoin network (this triggers enabling, which disables all others)
+      rootMessenger.publish('NetworkController:networkAdded', {
+        // @ts-expect-error Intentionally testing with Bitcoin network
+        chainId: 'bip122:000000000019d6689c085ae165831e93',
+        blockExplorerUrls: [],
+        defaultRpcEndpointIndex: 0,
+        name: 'Bitcoin',
+        nativeCurrency: 'BTC',
+        rpcEndpoints: [
+          {
+            url: 'https://api.blockcypher.com/v1/btc/main',
+            networkClientId: 'id',
+            type: RpcEndpointType.Custom,
+          },
+        ],
+      });
+
+      await advanceTime({ clock, duration: 1 });
+
+      // Bitcoin should be enabled, all others should be disabled due to exclusive behavior
+      expect(
+        controller.isNetworkEnabled('bip122:000000000019d6689c085ae165831e93'),
+      ).toBe(true);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false); // Now disabled due to exclusive behavior
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+    });
+
+    it('handles invalid chain IDs gracefully', () => {
+      const { controller } = setupController();
+
+      // @ts-expect-error Intentionally passing invalid chain IDs
+      expect(() => controller.isNetworkEnabled('invalid')).toThrow(
+        'Value must be a hexadecimal string.',
+      );
+
+      // @ts-expect-error Intentionally passing undefined
+      expect(() => controller.isNetworkEnabled(undefined)).toThrow(
+        'Value must be a hexadecimal string.',
+      );
+
+      // @ts-expect-error Intentionally passing null
+      expect(() => controller.isNetworkEnabled(null)).toThrow(
+        'Value must be a hexadecimal string.',
+      );
+    });
+  });
+
+  describe('Bitcoin Support', () => {
+    it('initializes with only Bitcoin mainnet enabled by default', () => {
+      const { controller } = setupController();
+
+      // Only Bitcoin mainnet should be enabled by default
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Testnet)).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Signet)).toBe(false);
+
+      expect(
+        controller.state.enabledNetworkMap[KnownCaipNamespace.Bip122],
+      ).toStrictEqual({
+        [BtcScope.Mainnet]: true,
+        [BtcScope.Testnet]: false,
+        [BtcScope.Signet]: false,
+      });
+    });
+
+    it('enables and disables Bitcoin networks using CAIP chain IDs with exclusive behavior', () => {
+      const { controller } = setupController();
+
+      // Initially only Bitcoin mainnet is enabled
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Testnet)).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Signet)).toBe(false);
+
+      // Enable Bitcoin testnet (should disable all others in all namespaces due to exclusive behavior)
+      controller.enableNetwork(BtcScope.Testnet);
+      expect(controller.isNetworkEnabled(BtcScope.Testnet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Signet)).toBe(false);
+      // Check that EVM and Solana networks are also disabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false);
+
+      // Enable Bitcoin signet (should disable testnet and all other networks)
+      controller.enableNetwork(BtcScope.Signet);
+      expect(controller.isNetworkEnabled(BtcScope.Signet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Testnet)).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+      // EVM and Solana networks should remain disabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false);
+
+      // Re-enable mainnet (should disable signet and all other networks)
+      controller.enableNetwork(BtcScope.Mainnet);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Signet)).toBe(false);
+      // EVM and Solana networks should remain disabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false);
+    });
+
+    it('allows disabling Bitcoin networks when multiple are enabled', () => {
+      const { controller } = setupController();
+
+      // Initially only Bitcoin mainnet is enabled
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Testnet)).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Signet)).toBe(false);
+
+      // Enable testnet (this will disable mainnet and all other networks due to exclusive behavior)
+      controller.enableNetwork(BtcScope.Testnet);
+      expect(controller.isNetworkEnabled(BtcScope.Testnet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+      // EVM and Solana networks should also be disabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false);
+
+      // Now enable mainnet again (this will disable testnet and all other networks)
+      controller.enableNetwork(BtcScope.Mainnet);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Testnet)).toBe(false);
+      // EVM and Solana networks should remain disabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false);
+
+      // Enable signet (this will disable mainnet and all other networks)
+      controller.enableNetwork(BtcScope.Signet);
+      expect(controller.isNetworkEnabled(BtcScope.Signet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+      // EVM and Solana networks should remain disabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false);
+    });
+
+    it('prevents disabling the last remaining Bitcoin network', () => {
+      const { controller } = setupController();
+
+      // Only Bitcoin mainnet is enabled by default
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Testnet)).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Signet)).toBe(false);
+
+      // Should not be able to disable the last remaining Bitcoin network
+      expect(() => controller.disableNetwork(BtcScope.Mainnet)).not.toThrow();
+    });
+
+    it('allows disabling the last Bitcoin network', () => {
+      const { controller } = setupController();
+
+      // Only Bitcoin mainnet is enabled by default in the BIP122 namespace
+      expect(() => controller.disableNetwork(BtcScope.Mainnet)).not.toThrow();
+    });
+
+    it('handles all Bitcoin testnet variants', () => {
+      const { controller } = setupController();
+
+      // Test each Bitcoin testnet variant
+      const testnets = [
+        { scope: BtcScope.Testnet, name: 'Testnet' },
+        { scope: BtcScope.Signet, name: 'Signet' },
+      ];
+
+      testnets.forEach(({ scope }) => {
+        // Enable the testnet (should disable all others in all namespaces due to exclusive behavior)
+        controller.enableNetwork(scope);
+        expect(controller.isNetworkEnabled(scope)).toBe(true);
+        expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+
+        // Check that EVM and Solana networks are also disabled
+        expect(controller.isNetworkEnabled('0x1')).toBe(false);
+        expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+        expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+        expect(
+          controller.isNetworkEnabled(
+            'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+          ),
+        ).toBe(false);
+
+        // Verify other testnets are also disabled
+        testnets.forEach(({ scope: otherScope }) => {
+          expect(controller.isNetworkEnabled(otherScope)).toBe(
+            otherScope === scope,
+          );
+        });
+      });
+    });
+
+    it('handles Bitcoin network addition dynamically', async () => {
+      const { controller, rootMessenger } = setupController();
+
+      // Add Bitcoin testnet dynamically
+      rootMessenger.publish('NetworkController:networkAdded', {
+        // @ts-expect-error Testing with Bitcoin network
+        chainId: BtcScope.Testnet,
+        blockExplorerUrls: [],
+        defaultRpcEndpointIndex: 0,
+        name: 'Bitcoin Testnet',
+        nativeCurrency: 'tBTC',
+        rpcEndpoints: [
+          {
+            url: 'https://api.blockcypher.com/v1/btc/test3',
+            networkClientId: 'btc-testnet',
+            type: RpcEndpointType.Custom,
+          },
+        ],
+      });
+
+      await advanceTime({ clock, duration: 1 });
+
+      // Bitcoin testnet should be enabled, others should be disabled (exclusive behavior across all namespaces)
+      expect(controller.isNetworkEnabled(BtcScope.Testnet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Signet)).toBe(false);
+      // EVM and Solana networks should also be disabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false);
+    });
+
+    it('maintains Bitcoin network state independently when disabling networks from other namespaces', () => {
+      const { controller } = setupController();
+
+      // Disable EVM networks (disableNetwork should not affect other namespaces)
+      controller.disableNetwork('0x1');
+      controller.disableNetwork('0xe708');
+
+      // Bitcoin mainnet should still be enabled, testnets remain disabled
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Testnet)).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Signet)).toBe(false);
+
+      // Disable Solana network - this should not affect Bitcoin networks
+      expect(() =>
+        controller.disableNetwork('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).not.toThrow();
+
+      // Bitcoin mainnet should still be enabled, testnets remain disabled
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Testnet)).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Signet)).toBe(false);
+    });
+
+    it('validates Bitcoin network chain IDs are correct', () => {
+      const { controller } = setupController();
+
+      // Test that Bitcoin networks have the correct chain IDs and default states
+      expect(
+        controller.isNetworkEnabled('bip122:000000000019d6689c085ae165831e93'),
+      ).toBe(true); // Mainnet (enabled by default)
+      expect(
+        controller.isNetworkEnabled('bip122:000000000933ea01ad0ee984209779ba'),
+      ).toBe(false); // Testnet (disabled by default)
+      expect(
+        controller.isNetworkEnabled('bip122:00000008819873e925422c1ff0f99f7c'),
+      ).toBe(false); // Signet (disabled by default)
+    });
+  });
+
+  describe('Tron Support', () => {
+    it('initializes with only Tron mainnet enabled by default', () => {
+      const { controller } = setupController();
+
+      // Only Tron mainnet should be enabled by default
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Nile)).toBe(false);
+      expect(controller.isNetworkEnabled(TrxScope.Shasta)).toBe(false);
+
+      expect(
+        controller.state.enabledNetworkMap[KnownCaipNamespace.Tron],
+      ).toStrictEqual({
+        [TrxScope.Mainnet]: true,
+        [TrxScope.Nile]: false,
+        [TrxScope.Shasta]: false,
+      });
+    });
+
+    it('enables and disables Tron networks using CAIP chain IDs with exclusive behavior', () => {
+      const { controller } = setupController();
+
+      // Initially only Tron mainnet is enabled
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Nile)).toBe(false);
+      expect(controller.isNetworkEnabled(TrxScope.Shasta)).toBe(false);
+
+      // Enable Tron Nile (should disable all others in all namespaces due to exclusive behavior)
+      controller.enableNetwork(TrxScope.Nile);
+      expect(controller.isNetworkEnabled(TrxScope.Nile)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(false);
+      expect(controller.isNetworkEnabled(TrxScope.Shasta)).toBe(false);
+      // Check that EVM, Solana, and Bitcoin networks are also disabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+
+      // Enable Tron Shasta (should disable Nile and all other networks)
+      controller.enableNetwork(TrxScope.Shasta);
+      expect(controller.isNetworkEnabled(TrxScope.Shasta)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Nile)).toBe(false);
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(false);
+      // EVM, Solana, and Bitcoin networks should remain disabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+
+      // Re-enable mainnet (should disable Shasta and all other networks)
+      controller.enableNetwork(TrxScope.Mainnet);
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Shasta)).toBe(false);
+      // EVM, Solana, and Bitcoin networks should remain disabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+    });
+
+    it('allows disabling Tron networks when multiple are enabled', () => {
+      const { controller } = setupController();
+
+      // Initially only Tron mainnet is enabled
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Nile)).toBe(false);
+      expect(controller.isNetworkEnabled(TrxScope.Shasta)).toBe(false);
+
+      // Enable Nile (this will disable mainnet and all other networks due to exclusive behavior)
+      controller.enableNetwork(TrxScope.Nile);
+      expect(controller.isNetworkEnabled(TrxScope.Nile)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(false);
+      // EVM, Solana, and Bitcoin networks should also be disabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+
+      // Now enable mainnet again (this will disable Nile and all other networks)
+      controller.enableNetwork(TrxScope.Mainnet);
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Nile)).toBe(false);
+      // EVM, Solana, and Bitcoin networks should remain disabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+
+      // Enable Shasta (this will disable mainnet and all other networks)
+      controller.enableNetwork(TrxScope.Shasta);
+      expect(controller.isNetworkEnabled(TrxScope.Shasta)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(false);
+      // EVM, Solana, and Bitcoin networks should remain disabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+    });
+
+    it('prevents disabling the last remaining Tron network', () => {
+      const { controller } = setupController();
+
+      // Only Tron mainnet is enabled by default
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Nile)).toBe(false);
+      expect(controller.isNetworkEnabled(TrxScope.Shasta)).toBe(false);
+
+      // Should not be able to disable the last remaining Tron network
+      expect(() => controller.disableNetwork(TrxScope.Mainnet)).not.toThrow();
+    });
+
+    it('allows disabling the last Tron network', () => {
+      const { controller } = setupController();
+
+      // Only Tron mainnet is enabled by default in the Tron namespace
+      expect(() => controller.disableNetwork(TrxScope.Mainnet)).not.toThrow();
+    });
+
+    it('handles all Tron testnet variants', () => {
+      const { controller } = setupController();
+
+      // Test each Tron testnet variant
+      const testnets = [
+        { scope: TrxScope.Nile, name: 'Nile' },
+        { scope: TrxScope.Shasta, name: 'Shasta' },
+      ];
+
+      testnets.forEach(({ scope }) => {
+        // Enable the testnet (should disable all others in all namespaces due to exclusive behavior)
+        controller.enableNetwork(scope);
+        expect(controller.isNetworkEnabled(scope)).toBe(true);
+        expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(false);
+
+        // Check that EVM, Solana, and Bitcoin networks are also disabled
+        expect(controller.isNetworkEnabled('0x1')).toBe(false);
+        expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+        expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+        expect(
+          controller.isNetworkEnabled(
+            'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+          ),
+        ).toBe(false);
+        expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+
+        // Verify other testnets are also disabled
+        testnets.forEach(({ scope: otherScope }) => {
+          expect(controller.isNetworkEnabled(otherScope)).toBe(
+            otherScope === scope,
+          );
+        });
+      });
+    });
+
+    it('handles Tron network addition dynamically', async () => {
+      const { controller, rootMessenger } = setupController();
+
+      // Add Tron Nile dynamically
+      rootMessenger.publish('NetworkController:networkAdded', {
+        // @ts-expect-error Testing with Tron network
+        chainId: TrxScope.Nile,
+        blockExplorerUrls: [],
+        defaultRpcEndpointIndex: 0,
+        name: 'Tron Nile',
+        nativeCurrency: 'TRX',
+        rpcEndpoints: [
+          {
+            url: 'https://nile.trongrid.io',
+            networkClientId: 'trx-nile',
+            type: RpcEndpointType.Custom,
+          },
+        ],
+      });
+
+      await advanceTime({ clock, duration: 1 });
+
+      // Tron Nile should be enabled, others should be disabled (exclusive behavior across all namespaces)
+      expect(controller.isNetworkEnabled(TrxScope.Nile)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(false);
+      expect(controller.isNetworkEnabled(TrxScope.Shasta)).toBe(false);
+      // EVM, Solana, and Bitcoin networks should also be disabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+      expect(
+        controller.isNetworkEnabled('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+    });
+
+    it('maintains Tron network state independently when disabling networks from other namespaces', () => {
+      const { controller } = setupController();
+
+      // Disable EVM networks (disableNetwork should not affect other namespaces)
+      controller.disableNetwork('0x1');
+      controller.disableNetwork('0xe708');
+
+      // Tron mainnet should still be enabled, testnets remain disabled
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Nile)).toBe(false);
+      expect(controller.isNetworkEnabled(TrxScope.Shasta)).toBe(false);
+
+      // Disable Solana network - this should not affect Tron networks
+      expect(() =>
+        controller.disableNetwork('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp'),
+      ).not.toThrow();
+
+      // Tron mainnet should still be enabled, testnets remain disabled
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Nile)).toBe(false);
+      expect(controller.isNetworkEnabled(TrxScope.Shasta)).toBe(false);
+    });
+
+    it('validates Tron network chain IDs are correct', () => {
+      const { controller } = setupController();
+
+      // Test that Tron networks have the correct chain IDs and default states
+      expect(controller.isNetworkEnabled('tron:728126428')).toBe(true); // Mainnet (enabled by default)
+      expect(controller.isNetworkEnabled('tron:3448148188')).toBe(false); // Nile (disabled by default)
+      expect(controller.isNetworkEnabled('tron:2494104990')).toBe(false); // Shasta (disabled by default)
+    });
+
+    it('enables a Tron network in the Tron namespace', () => {
+      const { controller } = setupController();
+
+      // Enable Tron Nile in the Tron namespace
+      controller.enableNetworkInNamespace(
+        TrxScope.Nile,
+        KnownCaipNamespace.Tron,
+      );
+
+      // Only Tron Nile should be enabled in Tron namespace
+      expect(controller.isNetworkEnabled(TrxScope.Nile)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(false);
+      expect(controller.isNetworkEnabled(TrxScope.Shasta)).toBe(false);
+
+      // Other namespaces should remain unchanged
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(true);
+      expect(controller.isNetworkEnabled(SolScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(true);
+    });
+
+    it('throws error when Tron chainId namespace does not match provided namespace', () => {
+      const { controller } = setupController();
+
+      // Try to enable Tron network in Solana namespace
+      expect(() => {
+        controller.enableNetworkInNamespace(
+          TrxScope.Mainnet,
+          KnownCaipNamespace.Solana,
+        );
+      }).toThrow(
+        `Chain ID ${TrxScope.Mainnet} belongs to namespace tron, but namespace solana was specified`,
+      );
+
+      // Try to enable Ethereum network in Tron namespace
+      expect(() => {
+        controller.enableNetworkInNamespace('0x1', KnownCaipNamespace.Tron);
+      }).toThrow(
+        'Chain ID 0x1 belongs to namespace eip155, but namespace tron was specified',
+      );
+    });
+  });
+
+  describe('enableNetworkInNamespace', () => {
+    it('enables a network in the specified namespace and disables others in same namespace', () => {
+      const { controller } = setupController();
+
+      // Initially multiple EVM networks are enabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(true);
+
+      // Enable only Ethereum mainnet in EIP-155 namespace
+      controller.enableNetworkInNamespace('0x1', KnownCaipNamespace.Eip155);
+
+      // Only Ethereum mainnet should be enabled in EIP-155 namespace
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+
+      // Other namespaces should remain unchanged
+      expect(controller.isNetworkEnabled(SolScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(true);
+      expect(controller.isNetworkEnabled(TrxScope.Mainnet)).toBe(true);
+    });
+
+    it('enables a network using CAIP chain ID in the specified namespace', () => {
+      const { controller } = setupController();
+
+      // Enable Ethereum mainnet using CAIP format
+      controller.enableNetworkInNamespace(
+        'eip155:1',
+        KnownCaipNamespace.Eip155,
+      );
+
+      // Only Ethereum mainnet should be enabled in EIP-155 namespace
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+    });
+
+    it('enables a Solana network in the Solana namespace', () => {
+      const { controller } = setupController();
+
+      // Enable Solana testnet in the Solana namespace
+      controller.enableNetworkInNamespace(
+        SolScope.Testnet,
+        KnownCaipNamespace.Solana,
+      );
+
+      // Only Solana testnet should be enabled in Solana namespace
+      expect(controller.isNetworkEnabled(SolScope.Testnet)).toBe(true);
+      expect(controller.isNetworkEnabled(SolScope.Mainnet)).toBe(false);
+      expect(controller.isNetworkEnabled(SolScope.Devnet)).toBe(false);
+
+      // Other namespaces should remain unchanged
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(true);
+    });
+
+    it('enables a Bitcoin network in the Bitcoin namespace', () => {
+      const { controller } = setupController();
+
+      // Enable Bitcoin testnet in the Bitcoin namespace
+      controller.enableNetworkInNamespace(
+        BtcScope.Testnet,
+        KnownCaipNamespace.Bip122,
+      );
+
+      // Only Bitcoin testnet should be enabled in Bitcoin namespace
+      expect(controller.isNetworkEnabled(BtcScope.Testnet)).toBe(true);
+      expect(controller.isNetworkEnabled(BtcScope.Mainnet)).toBe(false);
+      expect(controller.isNetworkEnabled(BtcScope.Signet)).toBe(false);
+
+      // Other namespaces should remain unchanged
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(true);
+      expect(controller.isNetworkEnabled(SolScope.Mainnet)).toBe(true);
+    });
+
+    it('throws error when chainId namespace does not match provided namespace', () => {
+      const { controller } = setupController();
+
+      // Try to enable Ethereum network in Solana namespace
+      expect(() => {
+        controller.enableNetworkInNamespace('0x1', KnownCaipNamespace.Solana);
+      }).toThrow(
+        'Chain ID 0x1 belongs to namespace eip155, but namespace solana was specified',
+      );
+
+      // Try to enable Solana network in EIP-155 namespace
+      expect(() => {
+        controller.enableNetworkInNamespace(
+          SolScope.Mainnet,
+          KnownCaipNamespace.Eip155,
+        );
+      }).toThrow(
+        `Chain ID ${SolScope.Mainnet} belongs to namespace solana, but namespace eip155 was specified`,
+      );
+
+      // Try to enable Bitcoin network in Solana namespace
+      expect(() => {
+        controller.enableNetworkInNamespace(
+          BtcScope.Mainnet,
+          KnownCaipNamespace.Solana,
+        );
+      }).toThrow(
+        `Chain ID ${BtcScope.Mainnet} belongs to namespace bip122, but namespace solana was specified`,
+      );
+    });
+
+    it('throws error with CAIP chain ID when namespace does not match', () => {
+      const { controller } = setupController();
+
+      // Try to enable Ethereum network using CAIP format in Solana namespace
+      expect(() => {
+        controller.enableNetworkInNamespace(
+          'eip155:1',
+          KnownCaipNamespace.Solana,
+        );
+      }).toThrow(
+        'Chain ID eip155:1 belongs to namespace eip155, but namespace solana was specified',
+      );
+    });
+    it('handles enabling an already enabled network', () => {
+      const { controller } = setupController();
+
+      // Ethereum mainnet is already enabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+
+      const initialState = { ...controller.state };
+
+      // Enable it again - should disable other networks in the namespace
+      controller.enableNetworkInNamespace('0x1', KnownCaipNamespace.Eip155);
+
+      // Only Ethereum mainnet should be enabled in EIP-155 namespace
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+
+      // Should be different from initial state due to disabling other networks
+      expect(controller.state).not.toStrictEqual(initialState);
+    });
+
+    it('enables network that does not exist in current state', () => {
+      const { controller } = setupController();
+
+      // Try to enable a network that doesn't exist in the state yet
+      controller.enableNetworkInNamespace('0x89', KnownCaipNamespace.Eip155);
+
+      // Network should be enabled (namespace bucket should be created)
+      expect(controller.isNetworkEnabled('0x89')).toBe(true);
+      expect(
+        controller.state.enabledNetworkMap[KnownCaipNamespace.Eip155]['0x89'],
+      ).toBe(true);
+    });
+
+    it('maintains consistency between hex and CAIP formats', () => {
+      const { controller } = setupController();
+
+      // Enable using hex format
+      controller.enableNetworkInNamespace('0x1', KnownCaipNamespace.Eip155);
+
+      // Both formats should show the same result
+      expect(controller.isNetworkEnabled('0x1')).toBe(
+        controller.isNetworkEnabled('eip155:1'),
+      );
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+
+      // Enable using CAIP format
+      controller.enableNetworkInNamespace(
+        'eip155:59144',
+        KnownCaipNamespace.Eip155,
+      );
+
+      // Both formats should show the same result
+      expect(controller.isNetworkEnabled('0xe708')).toBe(
+        controller.isNetworkEnabled('eip155:59144'),
+      );
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true);
+      expect(controller.isNetworkEnabled('0x1')).toBe(false); // Should be disabled
+    });
+
+    it('handles custom namespace creation for new blockchain', () => {
+      const { controller } = setupController();
+
+      // Try to enable a network in a custom namespace that doesn't exist yet
+      const customChainId = 'cosmos:cosmoshub-4' as CaipChainId;
+      const customNamespace = 'cosmos' as CaipNamespace;
+
+      controller.enableNetworkInNamespace(customChainId, customNamespace);
+
+      // Custom namespace should be created and network enabled
+      expect(controller.state.enabledNetworkMap[customNamespace]).toBeDefined();
+      expect(
+        controller.state.enabledNetworkMap[customNamespace][customChainId],
+      ).toBe(true);
+      expect(controller.isNetworkEnabled(customChainId)).toBe(true);
+    });
+  });
+
+  describe('metadata', () => {
+    it('includes expected state in debug snapshots', () => {
+      const { controller } = setupController();
+
+      const derivedState = deriveStateFromMetadata(
+        controller.state,
+        controller.metadata,
+        'includeInDebugSnapshot',
+      );
+
+      expect(derivedState).toHaveProperty('enabledNetworkMap');
+      expect(derivedState).toHaveProperty('nativeAssetIdentifiers');
+    });
+
+    it('includes expected state in state logs', () => {
+      const { controller } = setupController();
+
+      const derivedState = deriveStateFromMetadata(
+        controller.state,
+        controller.metadata,
+        'includeInStateLogs',
+      );
+
+      expect(derivedState).toHaveProperty('enabledNetworkMap');
+      expect(derivedState).toHaveProperty('nativeAssetIdentifiers');
+    });
+
+    it('persists expected state', () => {
+      const { controller } = setupController();
+
+      const derivedState = deriveStateFromMetadata(
+        controller.state,
+        controller.metadata,
+        'persist',
+      );
+
+      expect(derivedState).toHaveProperty('enabledNetworkMap');
+      expect(derivedState).toHaveProperty('nativeAssetIdentifiers');
+    });
+
+    it('exposes expected state to UI', () => {
+      const { controller } = setupController();
+
+      const derivedState = deriveStateFromMetadata(
+        controller.state,
+        controller.metadata,
+        'usedInUi',
+      );
+
+      expect(derivedState).toHaveProperty('enabledNetworkMap');
+      expect(derivedState).toHaveProperty('nativeAssetIdentifiers');
+    });
+  });
+
+  describe('new onAddNetwork behavior', () => {
+    it('switches to newly added popular network when NOT in popular networks mode', async () => {
+      const { controller, rootMessenger } = setupController();
+
+      // Start with only 1 popular network enabled (not in popular networks mode)
+      controller.disableNetwork('0xe708'); // Disable Linea
+      controller.disableNetwork('0x2105'); // Disable Base
+      // Now only Ethereum is enabled (1 popular network < 3 threshold)
+
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+
+      // Add Avalanche (popular network) when NOT in popular networks mode
+      rootMessenger.publish('NetworkController:networkAdded', {
+        chainId: '0xa86a', // Avalanche - popular network
+        blockExplorerUrls: [],
+        defaultRpcEndpointIndex: 0,
+        name: 'Avalanche',
+        nativeCurrency: 'AVAX',
+        rpcEndpoints: [
+          {
+            url: 'https://api.avax.network/ext/bc/C/rpc',
+            networkClientId: 'id',
+            type: RpcEndpointType.Custom,
+          },
+        ],
+      });
+
+      await advanceTime({ clock, duration: 1 });
+
+      // Should switch to Avalanche (disable all others, enable Avalanche)
+      expect(controller.isNetworkEnabled('0xa86a')).toBe(true);
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+    });
+
+    it('switches to newly added non-popular network even when in popular networks mode', async () => {
+      const { controller, rootMessenger } = setupController();
+
+      // Default state has 3 popular networks enabled (in popular networks mode)
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(true);
+
+      // Add a non-popular network when in popular networks mode
+      rootMessenger.publish('NetworkController:networkAdded', {
+        chainId: '0x999', // Non-popular network
+        blockExplorerUrls: [],
+        defaultRpcEndpointIndex: 0,
+        name: 'Custom Network',
+        nativeCurrency: 'CUSTOM',
+        rpcEndpoints: [
+          {
+            url: 'https://custom.network/rpc',
+            networkClientId: 'id',
+            type: RpcEndpointType.Custom,
+          },
+        ],
+      });
+
+      await advanceTime({ clock, duration: 1 });
+
+      // Should switch to the non-popular network (disable all others, enable new one)
+      expect(controller.isNetworkEnabled('0x999')).toBe(true);
+      expect(controller.isNetworkEnabled('0x1')).toBe(false);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(false);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+    });
+
+    it('keeps current selection when adding popular network in popular networks mode', async () => {
+      const { controller, rootMessenger } = setupController();
+
+      // Default state has 3 popular networks enabled (in popular networks mode)
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(true);
+
+      // Add another popular network when in popular networks mode
+      rootMessenger.publish('NetworkController:networkAdded', {
+        chainId: '0x89', // Polygon - popular network
+        blockExplorerUrls: [],
+        defaultRpcEndpointIndex: 0,
+        name: 'Polygon',
+        nativeCurrency: 'MATIC',
+        rpcEndpoints: [
+          {
+            url: 'https://polygon-mainnet.infura.io/v3/1234567890',
+            networkClientId: 'id',
+            type: RpcEndpointType.Custom,
+          },
+        ],
+      });
+
+      await advanceTime({ clock, duration: 1 });
+
+      // Should keep current selection (add Polygon but don't enable it)
+      expect(controller.isNetworkEnabled('0x89')).toBe(true); // Polygon enabled
+      expect(controller.isNetworkEnabled('0x1')).toBe(true); // Ethereum still enabled
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true); // Linea still enabled
+      expect(controller.isNetworkEnabled('0x2105')).toBe(true); // Base still enabled
+    });
+
+    it('handles edge case: exactly 2 popular networks enabled (not in popular mode)', async () => {
+      const { controller, rootMessenger } = setupController();
+
+      // Start with exactly 2 popular networks enabled (not >2, so not in popular mode)
+      controller.disableNetwork('0x2105'); // Disable Base, keep only Ethereum and Linea
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+
+      // Add another popular network when NOT in popular networks mode (exactly 2 enabled)
+      rootMessenger.publish('NetworkController:networkAdded', {
+        chainId: '0xa86a', // Avalanche - popular network
+        blockExplorerUrls: [],
+        defaultRpcEndpointIndex: 0,
+        name: 'Avalanche',
+        nativeCurrency: 'AVAX',
+        rpcEndpoints: [
+          {
+            url: 'https://api.avax.network/ext/bc/C/rpc',
+            networkClientId: 'id',
+            type: RpcEndpointType.Custom,
+          },
+        ],
+      });
+
+      await advanceTime({ clock, duration: 1 });
+
+      // Should switch to Avalanche since we're not in popular networks mode (2  2, not >2)
+      expect(controller.isNetworkEnabled('0xa86a')).toBe(true);
+      expect(controller.isNetworkEnabled('0x1')).toBe(true);
+      expect(controller.isNetworkEnabled('0xe708')).toBe(true);
+      expect(controller.isNetworkEnabled('0x2105')).toBe(false);
+    });
+  });
+});
diff --git a/src/NetworkEnablementController.ts b/src/NetworkEnablementController.ts
new file mode 100644
index 0000000000000000000000000000000000000000..e941d7e4dbcff93737e295eedded80bc102ecebc
--- /dev/null
+++ b/src/NetworkEnablementController.ts
@@ -0,0 +1,753 @@
+import { BaseController } from '@metamask/base-controller';
+import type {
+  ControllerGetStateAction,
+  ControllerStateChangeEvent,
+} from '@metamask/base-controller';
+import { BuiltInNetworkName, ChainId } from '@metamask/controller-utils';
+import { BtcScope, SolScope, TrxScope } from '@metamask/keyring-api';
+import type { Messenger } from '@metamask/messenger';
+import type { MultichainNetworkControllerGetStateAction } from '@metamask/multichain-network-controller';
+import type {
+  NetworkControllerGetStateAction,
+  NetworkControllerNetworkAddedEvent,
+  NetworkControllerNetworkRemovedEvent,
+  NetworkControllerStateChangeEvent,
+} from '@metamask/network-controller';
+import type { TransactionControllerTransactionSubmittedEvent } from '@metamask/transaction-controller';
+import type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';
+import { KnownCaipNamespace } from '@metamask/utils';
+
+import { POPULAR_NETWORKS } from './constants';
+import { Slip44Service } from './services';
+import {
+  deriveKeys,
+  isOnlyNetworkEnabledInNamespace,
+  isPopularNetwork,
+} from './utils';
+
+const controllerName = 'NetworkEnablementController';
+
+/**
+ * Information about an ordered network.
+ */
+export type NetworksInfo = {
+  /**
+   * The network's chain id
+   */
+  networkId: CaipChainId;
+};
+
+/**
+ * A map of enabled networks by CAIP namespace and chain ID.
+ * For EIP-155 networks, the keys are Hex chain IDs.
+ * For other networks, the keys are CAIP chain IDs.
+ */
+type EnabledMap = Record<CaipNamespace, Record<CaipChainId | Hex, boolean>>;
+
+/**
+ * A native asset identifier in CAIP-19-like format.
+ * Format: `{caip2ChainId}/slip44:{coinType}`
+ *
+ * @example
+ * - `eip155:1/slip44:60` for Ethereum mainnet (ETH)
+ * - `solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp/slip44:501` for Solana mainnet (SOL)
+ * - `bip122:000000000019d6689c085ae165831e93/slip44:0` for Bitcoin mainnet (BTC)
+ */
+export type NativeAssetIdentifier = `${CaipChainId}/slip44:${number}`;
+
+/**
+ * A map of CAIP-2 chain IDs to their native asset identifiers.
+ * Uses CAIP-19-like format to identify the native asset for each chain.
+ *
+ * @see https://github.com/satoshilabs/slips/blob/master/slip-0044.md
+ */
+export type NativeAssetIdentifiersMap = Record<
+  CaipChainId,
+  NativeAssetIdentifier
+>;
+
+// State shape for NetworkEnablementController
+export type NetworkEnablementControllerState = {
+  enabledNetworkMap: EnabledMap;
+  nativeAssetIdentifiers: NativeAssetIdentifiersMap;
+};
+
+export type NetworkEnablementControllerGetStateAction =
+  ControllerGetStateAction<
+    typeof controllerName,
+    NetworkEnablementControllerState
+  >;
+
+export type NetworkEnablementControllerSetEnabledNetworksAction = {
+  type: `${typeof controllerName}:enableNetwork`;
+  handler: NetworkEnablementController['enableNetwork'];
+};
+
+export type NetworkEnablementControllerDisableNetworkAction = {
+  type: `${typeof controllerName}:disableNetwork`;
+  handler: NetworkEnablementController['disableNetwork'];
+};
+
+/**
+ * All actions that {@link NetworkEnablementController} calls internally.
+ */
+export type AllowedActions =
+  | NetworkControllerGetStateAction
+  | MultichainNetworkControllerGetStateAction;
+
+export type NetworkEnablementControllerActions =
+  | NetworkEnablementControllerGetStateAction
+  | NetworkEnablementControllerSetEnabledNetworksAction
+  | NetworkEnablementControllerDisableNetworkAction;
+
+export type NetworkEnablementControllerStateChangeEvent =
+  ControllerStateChangeEvent<
+    typeof controllerName,
+    NetworkEnablementControllerState
+  >;
+
+export type NetworkEnablementControllerEvents =
+  NetworkEnablementControllerStateChangeEvent;
+
+/**
+ * All events that {@link NetworkEnablementController} subscribes to internally.
+ */
+export type AllowedEvents =
+  | NetworkControllerNetworkAddedEvent
+  | NetworkControllerNetworkRemovedEvent
+  | NetworkControllerStateChangeEvent
+  | TransactionControllerTransactionSubmittedEvent;
+
+export type NetworkEnablementControllerMessenger = Messenger<
+  typeof controllerName,
+  NetworkEnablementControllerActions | AllowedActions,
+  NetworkEnablementControllerEvents | AllowedEvents
+>;
+
+/**
+ * Builds a native asset identifier in CAIP-19-like format.
+ *
+ * @param caipChainId - The CAIP-2 chain ID (e.g., 'eip155:1', 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp')
+ * @param slip44CoinType - The SLIP-44 coin type number
+ * @returns The native asset identifier string (e.g., 'eip155:1/slip44:60')
+ */
+function buildNativeAssetIdentifier(
+  caipChainId: CaipChainId,
+  slip44CoinType: number,
+): NativeAssetIdentifier {
+  return `${caipChainId}/slip44:${slip44CoinType}`;
+}
+
+/**
+ * Network configuration with chain ID and native currency symbol.
+ * Used to initialize native asset identifiers.
+ */
+export type NetworkConfig = {
+  chainId: CaipChainId;
+  nativeCurrency: string;
+};
+
+/**
+ * Gets the default state for the NetworkEnablementController.
+ *
+ * @returns The default state with pre-enabled networks.
+ */
+const getDefaultNetworkEnablementControllerState =
+  (): NetworkEnablementControllerState => {
+    // Build the enabled EVM networks map from POPULAR_NETWORKS
+    const evmNetworks = POPULAR_NETWORKS.reduce<Record<Hex, boolean>>(
+      (acc, chainId) => {
+        acc[chainId as Hex] = true;
+        return acc;
+      },
+      {},
+    );
+
+    return {
+      enabledNetworkMap: {
+        [KnownCaipNamespace.Eip155]: evmNetworks,
+        [KnownCaipNamespace.Solana]: {
+          [SolScope.Mainnet]: true,
+          [SolScope.Testnet]: false,
+          [SolScope.Devnet]: false,
+        },
+        [KnownCaipNamespace.Bip122]: {
+          [BtcScope.Mainnet]: true,
+          [BtcScope.Testnet]: false,
+          [BtcScope.Signet]: false,
+        },
+        [KnownCaipNamespace.Tron]: {
+          [TrxScope.Mainnet]: true,
+          [TrxScope.Nile]: false,
+          [TrxScope.Shasta]: false,
+        },
+      },
+      // nativeAssetIdentifiers is initialized as empty and should be populated
+      // by the client using initNativeAssetIdentifiers() during controller init
+      nativeAssetIdentifiers: {},
+    };
+  };
+
+// Metadata for the controller state
+const metadata = {
+  enabledNetworkMap: {
+    includeInStateLogs: true,
+    persist: true,
+    includeInDebugSnapshot: true,
+    usedInUi: true,
+  },
+  nativeAssetIdentifiers: {
+    includeInStateLogs: true,
+    persist: true,
+    includeInDebugSnapshot: true,
+    usedInUi: true,
+  },
+};
+
+/**
+ * Controller responsible for managing network enablement state across different blockchain networks.
+ *
+ * This controller tracks which networks are enabled/disabled for the user and provides methods
+ * to toggle network states. It supports both EVM (EIP-155) and non-EVM networks like Solana.
+ *
+ * The controller maintains a map of enabled networks organized by namespace (e.g., 'eip155', 'solana')
+ * and provides methods to query and modify network enablement states.
+ */
+export class NetworkEnablementController extends BaseController<
+  typeof controllerName,
+  NetworkEnablementControllerState,
+  NetworkEnablementControllerMessenger
+> {
+  /**
+   * Creates a NetworkEnablementController instance.
+   *
+   * @param args - The arguments to this function.
+   * @param args.messenger - Messenger used to communicate with BaseV2 controller.
+   * @param args.state - Initial state to set on this controller.
+   */
+  constructor({
+    messenger,
+    state,
+  }: {
+    messenger: NetworkEnablementControllerMessenger;
+    state?: Partial<NetworkEnablementControllerState>;
+  }) {
+    super({
+      messenger,
+      metadata,
+      name: controllerName,
+      state: {
+        ...getDefaultNetworkEnablementControllerState(),
+        ...state,
+      },
+    });
+
+    messenger.subscribe('NetworkController:networkAdded', ({ chainId }) => {
+      // eslint-disable-next-line no-void
+      void this.#onAddNetwork(chainId);
+    });
+
+    messenger.subscribe('NetworkController:networkRemoved', ({ chainId }) => {
+      this.#removeNetworkEntry(chainId);
+    });
+  }
+
+  /**
+   * Enables or disables a network for the user.
+   *
+   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID
+   * (for any blockchain network). The method will automatically convert Hex chain IDs
+   * to CAIP-2 format internally. This dual parameter support allows for backward
+   * compatibility with existing EVM chain ID formats while supporting newer
+   * multi-chain standards.
+   *
+   * When enabling a non-popular network, this method will disable all other networks
+   * to ensure only one network is active at a time (exclusive mode).
+   *
+   * @param chainId - The chain ID of the network to enable or disable. Can be either:
+   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks
+   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)
+   */
+  enableNetwork(chainId: Hex | CaipChainId): void {
+    const { namespace, storageKey } = deriveKeys(chainId);
+
+    this.update((state) => {
+      // disable all networks in all namespaces first
+      Object.keys(state.enabledNetworkMap).forEach((ns) => {
+        Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {
+          state.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;
+        });
+      });
+
+      // if the namespace bucket does not exist, return
+      // new nemespace are added only when a new network is added
+      if (!state.enabledNetworkMap[namespace]) {
+        return;
+      }
+
+      // enable the network
+      state.enabledNetworkMap[namespace][storageKey] = true;
+    });
+  }
+
+  /**
+   * Enables a network for the user within a specific namespace.
+   *
+   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID
+   * (for any blockchain network) and enables it within the specified namespace.
+   * The method validates that the chainId belongs to the specified namespace for safety.
+   *
+   * Before enabling the target network, this method disables all other networks
+   * in the same namespace to ensure exclusive behavior within the namespace.
+   *
+   * @param chainId - The chain ID of the network to enable. Can be either:
+   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks
+   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)
+   * @param namespace - The CAIP namespace where the network should be enabled
+   * @throws Error if the chainId's derived namespace doesn't match the provided namespace
+   */
+  enableNetworkInNamespace(
+    chainId: Hex | CaipChainId,
+    namespace: CaipNamespace,
+  ): void {
+    const { namespace: derivedNamespace, storageKey } = deriveKeys(chainId);
+
+    // Validate that the derived namespace matches the provided namespace
+    if (derivedNamespace !== namespace) {
+      throw new Error(
+        `Chain ID ${chainId} belongs to namespace ${derivedNamespace}, but namespace ${namespace} was specified`,
+      );
+    }
+
+    this.update((state) => {
+      // Ensure the namespace bucket exists
+      this.#ensureNamespaceBucket(state, namespace);
+
+      // Disable all networks in the specified namespace first
+      if (state.enabledNetworkMap[namespace]) {
+        Object.keys(state.enabledNetworkMap[namespace]).forEach((key) => {
+          state.enabledNetworkMap[namespace][key as CaipChainId | Hex] = false;
+        });
+      }
+
+      // Enable the target network in the specified namespace
+      state.enabledNetworkMap[namespace][storageKey] = true;
+    });
+  }
+
+  /**
+   * Enables all popular networks and Solana mainnet.
+   *
+   * This method first disables all networks across all namespaces, then enables
+   * all networks defined in POPULAR_NETWORKS (EVM networks), Solana mainnet, and
+   * Bitcoin mainnet. This provides exclusive behavior - only popular networks will
+   * be enabled after calling this method.
+   *
+   * Popular networks that don't exist in NetworkController or MultichainNetworkController configurations will be skipped silently.
+   */
+  enableAllPopularNetworks(): void {
+    this.update((state) => {
+      // First disable all networks across all namespaces
+      Object.keys(state.enabledNetworkMap).forEach((ns) => {
+        Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {
+          state.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;
+        });
+      });
+
+      // Get current network configurations to check if networks exist
+      const networkControllerState = this.messenger.call(
+        'NetworkController:getState',
+      );
+      const multichainState = this.messenger.call(
+        'MultichainNetworkController:getState',
+      );
+
+      // Enable all popular EVM networks that exist in NetworkController configurations
+      POPULAR_NETWORKS.forEach((chainId) => {
+        const { namespace, storageKey } = deriveKeys(chainId as Hex);
+
+        // Check if network exists in NetworkController configurations
+        if (
+          networkControllerState.networkConfigurationsByChainId[chainId as Hex]
+        ) {
+          // Ensure namespace bucket exists
+          this.#ensureNamespaceBucket(state, namespace);
+          // Enable the network
+          state.enabledNetworkMap[namespace][storageKey] = true;
+        }
+      });
+
+      // Enable Solana mainnet if it exists in MultichainNetworkController configurations
+      const solanaKeys = deriveKeys(SolScope.Mainnet as CaipChainId);
+      if (
+        multichainState.multichainNetworkConfigurationsByChainId[
+          SolScope.Mainnet
+        ]
+      ) {
+        // Ensure namespace bucket exists
+        this.#ensureNamespaceBucket(state, solanaKeys.namespace);
+        // Enable Solana mainnet
+        state.enabledNetworkMap[solanaKeys.namespace][solanaKeys.storageKey] =
+          true;
+      }
+
+      // Enable Bitcoin mainnet if it exists in MultichainNetworkController configurations
+      const bitcoinKeys = deriveKeys(BtcScope.Mainnet as CaipChainId);
+      if (
+        multichainState.multichainNetworkConfigurationsByChainId[
+          BtcScope.Mainnet
+        ]
+      ) {
+        // Ensure namespace bucket exists
+        this.#ensureNamespaceBucket(state, bitcoinKeys.namespace);
+        // Enable Bitcoin mainnet
+        state.enabledNetworkMap[bitcoinKeys.namespace][bitcoinKeys.storageKey] =
+          true;
+      }
+
+      // Enable Tron mainnet if it exists in MultichainNetworkController configurations
+      const tronKeys = deriveKeys(TrxScope.Mainnet as CaipChainId);
+      if (
+        multichainState.multichainNetworkConfigurationsByChainId[
+          TrxScope.Mainnet
+        ]
+      ) {
+        // Ensure namespace bucket exists
+        this.#ensureNamespaceBucket(state, tronKeys.namespace);
+        // Enable Tron mainnet
+        state.enabledNetworkMap[tronKeys.namespace][tronKeys.storageKey] = true;
+      }
+    });
+  }
+
+  /**
+   * Initializes the network enablement state from network controller configurations.
+   *
+   * This method reads the current network configurations from both NetworkController
+   * and MultichainNetworkController and syncs the enabled network map and nativeAssetIdentifiers accordingly.
+   * It ensures proper namespace buckets exist for all configured networks and only
+   * adds missing networks with a default value of false, preserving existing user settings.
+   *
+   * This method should be called after the NetworkController and MultichainNetworkController
+   * have been initialized and their configurations are available.
+   */
+  async init(): Promise<void> {
+    // Get network configurations from NetworkController (EVM networks)
+    const networkControllerState = this.messenger.call(
+      'NetworkController:getState',
+    );
+
+    // Get network configurations from MultichainNetworkController (all networks)
+    const multichainState = this.messenger.call(
+      'MultichainNetworkController:getState',
+    );
+
+    // Build nativeAssetIdentifiers for EVM networks using chainid.network
+    const evmNativeAssetUpdates: {
+      caipChainId: CaipChainId;
+      identifier: NativeAssetIdentifier;
+    }[] = [];
+
+    for (const [chainId] of Object.entries(
+      networkControllerState.networkConfigurationsByChainId,
+    )) {
+      const { caipChainId } = deriveKeys(chainId as Hex);
+
+      // Skip if already in state
+      if (this.state.nativeAssetIdentifiers[caipChainId] !== undefined) {
+        continue;
+      }
+
+      // Parse hex chainId to number for chainid.network lookup
+      const numericChainId = parseInt(chainId, 16);
+
+      // EVM networks: use getEvmSlip44 (chainid.network data)
+      const slip44CoinType = await Slip44Service.getEvmSlip44(numericChainId);
+
+      evmNativeAssetUpdates.push({
+        caipChainId,
+        identifier: buildNativeAssetIdentifier(caipChainId, slip44CoinType),
+      });
+    }
+
+    // Update state synchronously
+    this.update((state) => {
+      // Initialize namespace buckets for EVM networks from NetworkController
+      Object.entries(
+        networkControllerState.networkConfigurationsByChainId,
+      ).forEach(([chainId]) => {
+        const { namespace, storageKey } = deriveKeys(chainId as Hex);
+        this.#ensureNamespaceBucket(state, namespace);
+
+        // Only add network if it doesn't already exist in state (preserves user settings)
+        state.enabledNetworkMap[namespace][storageKey] ??= false;
+      });
+
+      // Apply nativeAssetIdentifier updates
+      for (const { caipChainId, identifier } of evmNativeAssetUpdates) {
+        state.nativeAssetIdentifiers[caipChainId] = identifier;
+      }
+
+      // Initialize namespace buckets for all networks from MultichainNetworkController
+      Object.keys(
+        multichainState.multichainNetworkConfigurationsByChainId,
+      ).forEach((chainId) => {
+        const { namespace, storageKey } = deriveKeys(chainId as CaipChainId);
+        this.#ensureNamespaceBucket(state, namespace);
+
+        // Only add network if it doesn't already exist in state (preserves user settings)
+        state.enabledNetworkMap[namespace][storageKey] ??= false;
+      });
+    });
+  }
+
+  /**
+   * Initializes the native asset identifiers from network configurations.
+   * This method should be called from the client during controller initialization
+   * to populate the nativeAssetIdentifiers state based on actual network configurations.
+   *
+   * @param networks - Array of network configurations with chainId and nativeCurrency
+   * @example
+   * ```typescript
+   * const evmNetworks = Object.values(networkControllerState.networkConfigurationsByChainId)
+   *   .map(config => ({
+   *     chainId: toEvmCaipChainId(config.chainId),
+   *     nativeCurrency: config.nativeCurrency,
+   *   }));
+   *
+   * const multichainNetworks = Object.values(multichainState.multichainNetworkConfigurationsByChainId)
+   *   .map(config => ({
+   *     chainId: config.chainId,
+   *     nativeCurrency: config.nativeCurrency,
+   *   }));
+   *
+   * await controller.initNativeAssetIdentifiers([...evmNetworks, ...multichainNetworks]);
+   * ```
+   */
+  async initNativeAssetIdentifiers(networks: NetworkConfig[]): Promise<void> {
+    // Process networks and collect updates
+    const updates: {
+      chainId: CaipChainId;
+      identifier: NativeAssetIdentifier;
+    }[] = [];
+
+    for (const { chainId, nativeCurrency } of networks) {
+      // Check if nativeCurrency is already in CAIP-19 format (e.g., "bip122:.../slip44:0")
+      // Non-EVM networks from MultichainNetworkController use this format
+      if (nativeCurrency.includes('/slip44:')) {
+        updates.push({
+          chainId,
+          identifier: nativeCurrency as NativeAssetIdentifier,
+        });
+        continue;
+      }
+
+      // Extract namespace from CAIP-2 chainId
+      const [namespace, reference] = chainId.split(':');
+      let slip44CoinType: number | undefined;
+
+      if (namespace === 'eip155') {
+        // EVM networks: use getEvmSlip44 (chainid.network data)
+        const numericChainId = parseInt(reference, 10);
+        slip44CoinType = await Slip44Service.getEvmSlip44(numericChainId);
+      } else {
+        // Non-EVM networks: use getSlip44BySymbol (@metamask/slip44 package)
+        slip44CoinType = Slip44Service.getSlip44BySymbol(nativeCurrency);
+      }
+
+      if (slip44CoinType !== undefined) {
+        updates.push({
+          chainId,
+          identifier: buildNativeAssetIdentifier(chainId, slip44CoinType),
+        });
+      }
+    }
+
+    // Apply all updates synchronously
+    this.update((state) => {
+      for (const { chainId, identifier } of updates) {
+        state.nativeAssetIdentifiers[chainId] = identifier;
+      }
+    });
+  }
+
+  /**
+   * Disables a network for the user.
+   *
+   * This method accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID
+   * (for any blockchain network). The method will automatically convert Hex chain IDs
+   * to CAIP-2 format internally.
+   *
+   * Note: This method will prevent disabling the last remaining enabled network
+   * to ensure at least one network is always available.
+   *
+   * @param chainId - The chain ID of the network to disable. Can be either:
+   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks
+   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)
+   */
+  disableNetwork(chainId: Hex | CaipChainId): void {
+    const derivedKeys = deriveKeys(chainId);
+    const { namespace, storageKey } = derivedKeys;
+
+    this.update((state) => {
+      state.enabledNetworkMap[namespace][storageKey] = false;
+    });
+  }
+
+  /**
+   * Checks if a network is enabled.
+   *
+   * @param chainId - The chain ID of the network to check. Can be either:
+   * - A Hex string (e.g., '0x1' for Ethereum mainnet) for EVM networks
+   * - A CAIP-2 chain ID (e.g., 'eip155:1' for Ethereum mainnet, 'solana:mainnet' for Solana)
+   * @returns True if the network is enabled, false otherwise
+   */
+  isNetworkEnabled(chainId: Hex | CaipChainId): boolean {
+    const derivedKeys = deriveKeys(chainId);
+    const { namespace, storageKey } = derivedKeys;
+    return this.state.enabledNetworkMap[namespace]?.[storageKey] ?? false;
+  }
+
+  /**
+   * Ensures that a namespace bucket exists in the state.
+   *
+   * This method creates the namespace entry in the enabledNetworkMap if it doesn't
+   * already exist. This is used to prepare the state structure before adding
+   * network entries.
+   *
+   * @param state - The current controller state
+   * @param ns - The CAIP namespace to ensure exists
+   */
+  #ensureNamespaceBucket(
+    state: NetworkEnablementControllerState,
+    ns: CaipNamespace,
+  ): void {
+    if (!state.enabledNetworkMap[ns]) {
+      state.enabledNetworkMap[ns] = {};
+    }
+  }
+
+  /**
+   * Checks if popular networks mode is active (more than 2 popular networks enabled).
+   *
+   * This method counts how many networks defined in POPULAR_NETWORKS are currently
+   * enabled in the state and returns true if more than 2 are enabled. It only checks
+   * networks that actually exist in the NetworkController configurations.
+   *
+   * @returns True if more than 2 popular networks are enabled, false otherwise
+   */
+  #isInPopularNetworksMode(): boolean {
+    // Get current network configurations to check which popular networks exist
+    const networkControllerState = this.messenger.call(
+      'NetworkController:getState',
+    );
+
+    // Count how many popular networks are enabled
+    const enabledPopularNetworksCount = POPULAR_NETWORKS.reduce(
+      (count, chainId) => {
+        // Only check networks that actually exist in NetworkController configurations
+        if (
+          !networkControllerState.networkConfigurationsByChainId[chainId as Hex]
+        ) {
+          return count; // Skip networks that don't exist
+        }
+
+        const { namespace, storageKey } = deriveKeys(chainId as Hex);
+        const isEnabled = this.state.enabledNetworkMap[namespace]?.[storageKey];
+        return isEnabled ? count + 1 : count;
+      },
+      0,
+    );
+
+    // Return true if more than 2 popular networks are enabled
+    return enabledPopularNetworksCount > 1;
+  }
+
+  /**
+   * Removes a network entry from the state.
+   *
+   * This method is called when a network is removed from the system. It cleans up
+   * the network entry from both enabledNetworkMap and nativeAssetIdentifiers, and ensures that
+   * at least one network remains enabled.
+   *
+   * @param chainId - The chain ID to remove (Hex or CAIP-2 format)
+   */
+  #removeNetworkEntry(chainId: Hex | CaipChainId): void {
+    const derivedKeys = deriveKeys(chainId);
+    const { namespace, storageKey, caipChainId } = derivedKeys;
+
+    this.update((state) => {
+      // fallback and enable ethereum mainnet
+      if (isOnlyNetworkEnabledInNamespace(this.state, derivedKeys)) {
+        state.enabledNetworkMap[namespace][
+          ChainId[BuiltInNetworkName.Mainnet]
+        ] = true;
+      }
+
+      if (namespace in state.enabledNetworkMap) {
+        delete state.enabledNetworkMap[namespace][storageKey];
+      }
+
+      // Remove from nativeAssetIdentifiers as well
+      delete state.nativeAssetIdentifiers[caipChainId];
+    });
+  }
+
+  /**
+   * Handles the addition of a new EVM network to the controller.
+   *
+   * @param chainId - The chain ID to add (Hex format)
+   *
+   * @description
+   * - If in popular networks mode (>2 popular networks enabled) AND adding a popular network:
+   * - Keep current selection (add but don't enable the new network)
+   * - Otherwise:
+   * - Switch to the newly added network (disable all others, enable this one)
+   * - Also updates the nativeAssetIdentifiers with the CAIP-19-like identifier
+   */
+  async #onAddNetwork(chainId: Hex): Promise<void> {
+    const { namespace, storageKey, reference, caipChainId } =
+      deriveKeys(chainId);
+
+    // Parse reference (decimal string from CAIP-2) to number for chainid.network lookup
+    const numericChainId = parseInt(reference, 10);
+
+    // EVM networks: use getEvmSlip44 (chainid.network data)
+    const slip44CoinType = await Slip44Service.getEvmSlip44(numericChainId);
+
+    this.update((state) => {
+      // Ensure the namespace bucket exists
+      this.#ensureNamespaceBucket(state, namespace);
+
+      // Check if popular networks mode is active (>2 popular networks enabled)
+      const inPopularNetworksMode = this.#isInPopularNetworksMode();
+
+      // Check if the network being added is a popular network
+      const isAddedNetworkPopular = isPopularNetwork(reference);
+
+      // Keep current selection only if in popular networks mode AND adding a popular network
+      const shouldKeepCurrentSelection =
+        inPopularNetworksMode && isAddedNetworkPopular;
+
+      if (shouldKeepCurrentSelection) {
+        // Add the popular network but don't enable it (keep current selection)
+        state.enabledNetworkMap[namespace][storageKey] = true;
+      } else {
+        // Switch to the newly added network (disable all others, enable this one)
+        Object.keys(state.enabledNetworkMap).forEach((ns) => {
+          Object.keys(state.enabledNetworkMap[ns]).forEach((key) => {
+            state.enabledNetworkMap[ns][key as CaipChainId | Hex] = false;
+          });
+        });
+        // Enable the newly added network
+        state.enabledNetworkMap[namespace][storageKey] = true;
+      }
+
+      // Update nativeAssetIdentifiers with the CAIP-19-like identifier
+      state.nativeAssetIdentifiers[caipChainId] = buildNativeAssetIdentifier(
+        caipChainId,
+        slip44CoinType,
+      );
+    });
+  }
+}
diff --git a/src/constants.ts b/src/constants.ts
new file mode 100644
index 0000000000000000000000000000000000000000..6a9d5c812eb76f84495798f89ef7596c529e9580
--- /dev/null
+++ b/src/constants.ts
@@ -0,0 +1,22 @@
+export const POPULAR_NETWORKS = [
+  '0x1', // Ethereum Mainnet
+  '0xe708', // Linea (59144)
+  '0x2105', // Base (8453)
+  '0xa4b1', // Arbitrum One (42161)
+  '0xa86a', // Avalanche C-Chain (43114)
+  '0x38', // BNB Smart Chain (56)
+  '0xa', // Optimism (10)
+  '0x89', // Polygon (137)
+  '0x531', // Sei (Assuming 1329 used in EVM context)
+  '0x144', // zkSync Era (324)
+  '0x2a15c308d', // Palm (11297108109)
+  '0x3e7', // HyperEVM (999)
+  '0x8f', // Monad (143)
+  '0x10e6', // MegaETH (4326)
+  // Environment 3: Power User test networks (25 total)
+  '0xfa', // Fantom Opera (250)
+  '0x64', // Gnosis (100)
+  '0x19', // Cronos (25)
+  '0x504', // Moonbeam (1284)
+  '0x505', // Moonriver (1285)
+];
diff --git a/src/index.ts b/src/index.ts
new file mode 100644
index 0000000000000000000000000000000000000000..fd48ddfb3ccc693783f8b4f7b1af8d254502249c
--- /dev/null
+++ b/src/index.ts
@@ -0,0 +1,24 @@
+export { NetworkEnablementController } from './NetworkEnablementController';
+
+export type {
+  NetworkEnablementControllerState,
+  NetworkEnablementControllerGetStateAction,
+  NetworkEnablementControllerActions,
+  NetworkEnablementControllerEvents,
+  NetworkEnablementControllerMessenger,
+  NativeAssetIdentifier,
+  NativeAssetIdentifiersMap,
+  NetworkConfig,
+} from './NetworkEnablementController';
+
+export {
+  selectEnabledNetworkMap,
+  selectIsNetworkEnabled,
+  createSelectorForEnabledNetworksForNamespace,
+  selectAllEnabledNetworks,
+  selectEnabledNetworksCount,
+  selectEnabledEvmNetworks,
+  selectEnabledSolanaNetworks,
+} from './selectors';
+
+export { Slip44Service, getEvmSlip44, getSlip44BySymbol } from './services';
diff --git a/src/selectors.test.ts b/src/selectors.test.ts
new file mode 100644
index 0000000000000000000000000000000000000000..1410080bb479930069bb279b50ed2040f9bb70ac
--- /dev/null
+++ b/src/selectors.test.ts
@@ -0,0 +1,117 @@
+import { KnownCaipNamespace } from '@metamask/utils';
+
+import type { NetworkEnablementControllerState } from './NetworkEnablementController';
+import {
+  selectEnabledNetworkMap,
+  selectIsNetworkEnabled,
+  createSelectorForEnabledNetworksForNamespace,
+  selectAllEnabledNetworks,
+  selectEnabledNetworksCount,
+  selectEnabledEvmNetworks,
+  selectEnabledSolanaNetworks,
+} from './selectors';
+
+describe('NetworkEnablementController Selectors', () => {
+  const mockState: NetworkEnablementControllerState = {
+    enabledNetworkMap: {
+      [KnownCaipNamespace.Eip155]: {
+        '0x1': true, // Ethereum mainnet
+        '0xa': false, // Optimism (disabled)
+        '0xa4b1': true, // Arbitrum One
+      },
+      [KnownCaipNamespace.Solana]: {
+        'solana:mainnet': true,
+        'solana:testnet': false,
+      },
+    },
+    nativeAssetIdentifiers: {},
+  };
+
+  describe('selectEnabledNetworkMap', () => {
+    it('returns the enabled network map', () => {
+      const result = selectEnabledNetworkMap(mockState);
+      expect(result).toBe(mockState.enabledNetworkMap);
+    });
+  });
+
+  describe('selectIsNetworkEnabled', () => {
+    it('returns true for enabled EVM network with hex chain ID', () => {
+      const selector = selectIsNetworkEnabled('0x1');
+      const result = selector(mockState);
+      expect(result).toBe(true);
+    });
+
+    it('returns true for enabled EVM network with CAIP chain ID', () => {
+      const selector = selectIsNetworkEnabled('eip155:1');
+      const result = selector(mockState);
+      expect(result).toBe(true);
+    });
+
+    it('returns true for enabled Solana network', () => {
+      const selector = selectIsNetworkEnabled('solana:mainnet');
+      const result = selector(mockState);
+      expect(result).toBe(true);
+    });
+
+    it('returns false for unknown network', () => {
+      const selector = selectIsNetworkEnabled('0x999');
+      const result = selector(mockState);
+      expect(result).toBe(false);
+    });
+  });
+
+  describe('createSelectorForEnabledNetworksForNamespace', () => {
+    it('returns enabled EVM networks', () => {
+      const selector = createSelectorForEnabledNetworksForNamespace(
+        KnownCaipNamespace.Eip155,
+      );
+      const result = selector(mockState);
+      expect(result).toStrictEqual(['0x1', '0xa4b1']);
+    });
+
+    it('returns enabled Solana networks', () => {
+      const selector = createSelectorForEnabledNetworksForNamespace(
+        KnownCaipNamespace.Solana,
+      );
+      const result = selector(mockState);
+      expect(result).toStrictEqual(['solana:mainnet']);
+    });
+
+    it('returns empty array for unknown namespace', () => {
+      const selector = createSelectorForEnabledNetworksForNamespace('unknown');
+      const result = selector(mockState);
+      expect(result).toStrictEqual([]);
+    });
+  });
+
+  describe('selectAllEnabledNetworks', () => {
+    it('returns all enabled networks across namespaces', () => {
+      const result = selectAllEnabledNetworks(mockState);
+      expect(result).toStrictEqual({
+        [KnownCaipNamespace.Eip155]: ['0x1', '0xa4b1'],
+        [KnownCaipNamespace.Solana]: ['solana:mainnet'],
+      });
+    });
+  });
+
+  describe('selectEnabledNetworksCount', () => {
+    it('returns the total count of enabled networks', () => {
+      const result = selectEnabledNetworksCount(mockState);
+      expect(result).toBe(3); // 2 EVM + 1 Solana
+    });
+  });
+
+  describe('selectEnabledEvmNetworks', () => {
+    it('returns enabled EVM networks', () => {
+      const result = selectEnabledEvmNetworks(mockState);
+      expect(result).toStrictEqual(['0x1', '0xa4b1']);
+    });
+  });
+
+  describe('selectEnabledSolanaNetworks', () => {
+    it('returns enabled Solana networks', () => {
+      const result = selectEnabledSolanaNetworks(mockState);
+      expect(result).toStrictEqual(['solana:mainnet']);
+    });
+  });
+});
diff --git a/src/selectors.ts b/src/selectors.ts
new file mode 100644
index 0000000000000000000000000000000000000000..dae9938a419b050b6259feac87618dfc9f7f01dd
--- /dev/null
+++ b/src/selectors.ts
@@ -0,0 +1,113 @@
+import type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';
+import { KnownCaipNamespace } from '@metamask/utils';
+import { createSelector } from 'reselect';
+
+import type { NetworkEnablementControllerState } from './NetworkEnablementController';
+import { deriveKeys } from './utils';
+
+/**
+ * Base selector to get the enabled network map from the controller state.
+ *
+ * @param state - The NetworkEnablementController state
+ * @returns The enabled network map
+ */
+export const selectEnabledNetworkMap = (
+  state: NetworkEnablementControllerState,
+) => state.enabledNetworkMap;
+
+/**
+ * Selector to check if a specific network is enabled.
+ *
+ * This selector accepts either a Hex chain ID (for EVM networks) or a CAIP-2 chain ID
+ * (for any blockchain network) and returns whether the network is currently enabled.
+ * It returns false for unknown networks or if there's an error parsing the chain ID.
+ *
+ * @param chainId - The chain ID to check (Hex or CAIP-2 format)
+ * @returns A selector function that returns true if the network is enabled, false otherwise
+ */
+export const selectIsNetworkEnabled = (chainId: Hex | CaipChainId) =>
+  createSelector(selectEnabledNetworkMap, (enabledNetworkMap) => {
+    const { namespace, storageKey } = deriveKeys(chainId);
+
+    return (
+      namespace in enabledNetworkMap &&
+      storageKey in enabledNetworkMap[namespace] &&
+      enabledNetworkMap[namespace][storageKey]
+    );
+  });
+
+/**
+ * Selector builder to get all enabled networks for a specific namespace.
+ *
+ * The selector returned by this function returns an array of chain IDs (as strings) for all enabled networks
+ * within the specified namespace (e.g., 'eip155' for EVM networks, 'solana' for Solana).
+ *
+ * @param namespace - The CAIP namespace to get enabled networks for (e.g., 'eip155', 'solana')
+ * @returns A selector function that returns an array of chain ID strings for enabled networks in the namespace
+ */
+export const createSelectorForEnabledNetworksForNamespace = (
+  namespace: CaipNamespace,
+) =>
+  createSelector(selectEnabledNetworkMap, (enabledNetworkMap) => {
+    return Object.entries(enabledNetworkMap[namespace] ?? {})
+      .filter(([, enabled]) => enabled)
+      .map(([id]) => id);
+  });
+
+/**
+ * Selector to get all enabled networks across all namespaces.
+ *
+ * This selector returns a record where keys are CAIP namespaces and values are arrays
+ * of enabled chain IDs within each namespace.
+ *
+ * @returns A selector function that returns a record mapping namespace to array of enabled chain IDs
+ */
+export const selectAllEnabledNetworks = createSelector(
+  selectEnabledNetworkMap,
+  (enabledNetworkMap) => {
+    return Object.keys(enabledNetworkMap).reduce<
+      Record<CaipNamespace, string[]>
+    >((acc, ns) => {
+      acc[ns] = Object.entries(enabledNetworkMap[ns])
+        .filter(([, enabled]) => enabled)
+        .map(([id]) => id);
+      return acc;
+    }, {});
+  },
+);
+
+/**
+ * Selector to get the total count of enabled networks across all namespaces.
+ *
+ * @returns A selector function that returns the total number of enabled networks
+ */
+export const selectEnabledNetworksCount = createSelector(
+  selectAllEnabledNetworks,
+  (allEnabledNetworks) => {
+    return Object.values(allEnabledNetworks).flat().length;
+  },
+);
+
+/**
+ * Selector to get all enabled EVM networks.
+ *
+ * This is a convenience selector that specifically targets EIP-155 networks.
+ *
+ * @returns A selector function that returns an array of enabled EVM chain IDs
+ */
+export const selectEnabledEvmNetworks = createSelector(
+  createSelectorForEnabledNetworksForNamespace(KnownCaipNamespace.Eip155),
+  (enabledEvmNetworks) => enabledEvmNetworks,
+);
+
+/**
+ * Selector to get all enabled Solana networks.
+ *
+ * This is a convenience selector that specifically targets Solana networks.
+ *
+ * @returns A selector function that returns an array of enabled Solana chain IDs
+ */
+export const selectEnabledSolanaNetworks = createSelector(
+  createSelectorForEnabledNetworksForNamespace(KnownCaipNamespace.Solana),
+  (enabledSolanaNetworks) => enabledSolanaNetworks,
+);
diff --git a/src/services/Slip44Service.test.ts b/src/services/Slip44Service.test.ts
new file mode 100644
index 0000000000000000000000000000000000000000..54588947ec5913fd62a684acf1ad08475ca88d10
--- /dev/null
+++ b/src/services/Slip44Service.test.ts
@@ -0,0 +1,261 @@
+import { fetchWithErrorHandling } from '@metamask/controller-utils';
+
+import { Slip44Service } from './Slip44Service';
+
+jest.mock('@metamask/controller-utils', () => ({
+  fetchWithErrorHandling: jest.fn(),
+}));
+
+const mockFetchWithErrorHandling =
+  fetchWithErrorHandling as jest.MockedFunction<typeof fetchWithErrorHandling>;
+
+describe('Slip44Service', () => {
+  beforeEach(() => {
+    // Clear cache before each test to ensure clean state
+    Slip44Service.clearCache();
+    jest.clearAllMocks();
+  });
+
+  describe('getSlip44BySymbol', () => {
+    it('returns 60 for ETH symbol', () => {
+      const result = Slip44Service.getSlip44BySymbol('ETH');
+      expect(result).toBe(60);
+    });
+
+    it('returns 0 for BTC symbol', () => {
+      const result = Slip44Service.getSlip44BySymbol('BTC');
+      expect(result).toBe(0);
+    });
+
+    it('returns 501 for SOL symbol', () => {
+      const result = Slip44Service.getSlip44BySymbol('SOL');
+      expect(result).toBe(501);
+    });
+
+    it('returns 195 for TRX symbol', () => {
+      const result = Slip44Service.getSlip44BySymbol('TRX');
+      expect(result).toBe(195);
+    });
+
+    it('returns 2 for LTC symbol', () => {
+      const result = Slip44Service.getSlip44BySymbol('LTC');
+      expect(result).toBe(2);
+    });
+
+    it('returns 3 for DOGE symbol', () => {
+      const result = Slip44Service.getSlip44BySymbol('DOGE');
+      expect(result).toBe(3);
+    });
+
+    it('returns undefined for unknown symbol', () => {
+      const result = Slip44Service.getSlip44BySymbol('UNKNOWNCOIN');
+      expect(result).toBeUndefined();
+    });
+
+    it('is case-insensitive for symbols', () => {
+      const lowerResult = Slip44Service.getSlip44BySymbol('eth');
+      const upperResult = Slip44Service.getSlip44BySymbol('ETH');
+      const mixedResult = Slip44Service.getSlip44BySymbol('Eth');
+
+      expect(lowerResult).toBe(60);
+      expect(upperResult).toBe(60);
+      expect(mixedResult).toBe(60);
+    });
+
+    it('caches the result for repeated lookups', () => {
+      // First lookup
+      const firstResult = Slip44Service.getSlip44BySymbol('ETH');
+      // Second lookup (should come from cache)
+      const secondResult = Slip44Service.getSlip44BySymbol('ETH');
+
+      expect(firstResult).toBe(60);
+      expect(secondResult).toBe(60);
+    });
+
+    it('caches undefined for unknown symbols', () => {
+      // First lookup
+      const firstResult = Slip44Service.getSlip44BySymbol('UNKNOWNCOIN');
+      // Second lookup (should come from cache)
+      const secondResult = Slip44Service.getSlip44BySymbol('UNKNOWNCOIN');
+
+      expect(firstResult).toBeUndefined();
+      expect(secondResult).toBeUndefined();
+    });
+
+    it('returns coin type 1 for empty string (Testnet)', () => {
+      // The SLIP-44 data has an entry with empty symbol for "Testnet (all coins)" at index 1
+      const result = Slip44Service.getSlip44BySymbol('');
+      expect(result).toBe(1);
+    });
+  });
+
+  describe('clearCache', () => {
+    it('clears the cache so lookups are performed again', () => {
+      // Perform initial lookup to populate cache
+      Slip44Service.getSlip44BySymbol('ETH');
+
+      // Clear the cache
+      Slip44Service.clearCache();
+
+      // Perform another lookup - should work correctly
+      const result = Slip44Service.getSlip44BySymbol('ETH');
+      expect(result).toBe(60);
+    });
+
+    it('clears cached undefined values', () => {
+      // Perform initial lookup for unknown symbol
+      Slip44Service.getSlip44BySymbol('UNKNOWNCOIN');
+
+      // Clear the cache
+      Slip44Service.clearCache();
+
+      // Verify cache is cleared (no error thrown)
+      const result = Slip44Service.getSlip44BySymbol('UNKNOWNCOIN');
+      expect(result).toBeUndefined();
+    });
+  });
+
+  describe('real-world network symbols', () => {
+    it('correctly maps common EVM network native currencies', () => {
+      // All EVM networks use ETH or similar tokens with coin type 60
+      expect(Slip44Service.getSlip44BySymbol('ETH')).toBe(60);
+    });
+
+    it('correctly maps Polygon MATIC symbol', () => {
+      const result = Slip44Service.getSlip44BySymbol('MATIC');
+      // MATIC has coin type 966
+      expect(result).toBe(966);
+    });
+
+    it('correctly maps BNB symbol', () => {
+      const result = Slip44Service.getSlip44BySymbol('BNB');
+      // BNB has coin type 714
+      expect(result).toBe(714);
+    });
+  });
+
+  describe('getEvmSlip44', () => {
+    it('returns slip44 from chainid.network data when available', async () => {
+      // Mock chainid.network response with Ethereum data
+      mockFetchWithErrorHandling.mockResolvedValueOnce([
+        { chainId: 1, slip44: 60 },
+        { chainId: 56, slip44: 714 },
+      ]);
+
+      const result = await Slip44Service.getEvmSlip44(1);
+
+      expect(result).toBe(60);
+      expect(mockFetchWithErrorHandling).toHaveBeenCalledWith({
+        url: 'https://chainid.network/chains.json',
+        timeout: 10000,
+      });
+    });
+
+    it('returns cached value on subsequent calls without re-fetching', async () => {
+      // Mock chainid.network response
+      mockFetchWithErrorHandling.mockResolvedValueOnce([
+        { chainId: 1, slip44: 60 },
+        { chainId: 56, slip44: 714 },
+      ]);
+
+      // First call - fetches data
+      const result1 = await Slip44Service.getEvmSlip44(1);
+      // Second call - should use cache (line 144)
+      const result2 = await Slip44Service.getEvmSlip44(56);
+
+      expect(result1).toBe(60);
+      expect(result2).toBe(714);
+      // Should only fetch once
+      expect(mockFetchWithErrorHandling).toHaveBeenCalledTimes(1);
+    });
+
+    it('handles concurrent calls by reusing the fetch promise (line 82)', async () => {
+      // Mock chainid.network response with a delay
+      mockFetchWithErrorHandling.mockImplementation(
+        () =>
+          new Promise((resolve) => {
+            setTimeout(() => {
+              resolve([{ chainId: 1, slip44: 60 }]);
+            }, 10);
+          }),
+      );
+
+      // Make concurrent calls
+      const [result1, result2, result3] = await Promise.all([
+        Slip44Service.getEvmSlip44(1),
+        Slip44Service.getEvmSlip44(1),
+        Slip44Service.getEvmSlip44(1),
+      ]);
+
+      expect(result1).toBe(60);
+      expect(result2).toBe(60);
+      expect(result3).toBe(60);
+      // Should only fetch once despite concurrent calls
+      expect(mockFetchWithErrorHandling).toHaveBeenCalledTimes(1);
+    });
+
+    it('defaults to 60 when chainId not found in cache', async () => {
+      // Mock chainid.network response without the requested chainId
+      mockFetchWithErrorHandling.mockResolvedValueOnce([
+        { chainId: 1, slip44: 60 },
+      ]);
+
+      // Request a chainId not in the response
+      const result = await Slip44Service.getEvmSlip44(999);
+
+      expect(result).toBe(60); // Defaults to 60 (Ethereum)
+    });
+
+    it('handles invalid response by initializing empty cache and defaults to 60', async () => {
+      // Mock invalid response (not an array)
+      mockFetchWithErrorHandling.mockResolvedValueOnce('invalid response');
+
+      // Should not throw, defaults to 60
+      const result = await Slip44Service.getEvmSlip44(1);
+
+      expect(result).toBe(60);
+    });
+
+    it('handles null response by initializing empty cache and defaults to 60', async () => {
+      // Mock null response
+      mockFetchWithErrorHandling.mockResolvedValueOnce(null);
+
+      // Should not throw, defaults to 60
+      const result = await Slip44Service.getEvmSlip44(1);
+
+      expect(result).toBe(60);
+    });
+
+    it('handles network error by initializing empty cache and defaults to 60', async () => {
+      // Mock network error
+      mockFetchWithErrorHandling.mockRejectedValueOnce(
+        new Error('Network error'),
+      );
+
+      // Should not throw, defaults to 60
+      const result = await Slip44Service.getEvmSlip44(1);
+
+      expect(result).toBe(60);
+    });
+
+    it('filters out entries without slip44 field and defaults to 60', async () => {
+      // Mock response with some entries missing slip44
+      mockFetchWithErrorHandling.mockResolvedValueOnce([
+        { chainId: 1, slip44: 60 },
+        { chainId: 2 }, // No slip44 field
+        { chainId: 3, slip44: undefined }, // Explicit undefined
+        { chainId: 56, slip44: 714 },
+      ]);
+
+      const result1 = await Slip44Service.getEvmSlip44(1);
+      const result2 = await Slip44Service.getEvmSlip44(2);
+      const result3 = await Slip44Service.getEvmSlip44(3);
+      const result56 = await Slip44Service.getEvmSlip44(56);
+
+      expect(result1).toBe(60);
+      expect(result2).toBe(60); // Not in cache, defaults to 60
+      expect(result3).toBe(60); // Not in cache, defaults to 60
+      expect(result56).toBe(714);
+    });
+  });
+});
diff --git a/src/services/Slip44Service.ts b/src/services/Slip44Service.ts
new file mode 100644
index 0000000000000000000000000000000000000000..9c3ea2a8b3a2d6e08258e0e779cb320e79b67089
--- /dev/null
+++ b/src/services/Slip44Service.ts
@@ -0,0 +1,210 @@
+import { fetchWithErrorHandling } from '@metamask/controller-utils';
+// @ts-expect-error: No type definitions for '@metamask/slip44'
+import slip44 from '@metamask/slip44';
+
+const CHAINID_NETWORK_URL = 'https://chainid.network/chains.json';
+
+/**
+ * Represents a single SLIP-44 entry with its metadata.
+ */
+export type Slip44Entry = {
+  index: string;
+  symbol: string;
+  name: string;
+};
+
+/**
+ * Chain data from chainid.network
+ */
+type ChainIdNetworkEntry = {
+  chainId: number;
+  slip44?: number;
+  nativeCurrency?: {
+    symbol: string;
+  };
+};
+
+/**
+ * Internal type for SLIP-44 data from the @metamask/slip44 package.
+ * Includes the hex field which we don't expose externally.
+ */
+type Slip44DataEntry = Slip44Entry & {
+  // eslint-disable-next-line id-denylist
+  hex: `0x${string}`;
+};
+
+/**
+ * The SLIP-44 mapping type from the @metamask/slip44 package.
+ */
+type Slip44Data = Record<string, Slip44DataEntry>;
+
+/**
+ * Service for looking up SLIP-44 coin type identifiers.
+ *
+ * SLIP-44 defines registered coin types used in BIP-44 derivation paths.
+ *
+ * This service provides two lookup methods:
+ * 1. `getEvmSlip44` - For EVM networks, uses chainid.network data (recommended for eip155)
+ * 2. `getSlip44BySymbol` - Fallback method using @metamask/slip44 package
+ *
+ * @see https://github.com/satoshilabs/slips/blob/master/slip-0044.md
+ * @see https://chainid.network/chains.json
+ */
+export class Slip44Service {
+  /**
+   * Cache for chainId to slip44 lookups from chainid.network.
+   */
+  static #chainIdCache: Map<number, number> | null = null;
+
+  /**
+   * Whether a fetch is currently in progress.
+   */
+  static #fetchPromise: Promise<void> | null = null;
+
+  /**
+   * Cache for symbol to slip44 index lookups.
+   * This avoids iterating through all entries on repeated lookups.
+   */
+  static readonly #symbolCache: Map<string, number | undefined> = new Map();
+
+  /**
+   * Fetches and caches chain data from chainid.network.
+   * This is called automatically by getEvmSlip44.
+   */
+  static async #fetchChainData(): Promise<void> {
+    if (this.#chainIdCache !== null) {
+      return;
+    }
+
+    // Avoid duplicate fetches
+    if (this.#fetchPromise) {
+      await this.#fetchPromise;
+      return;
+    }
+
+    this.#fetchPromise = (async (): Promise<void> => {
+      try {
+        const chains: ChainIdNetworkEntry[] | undefined =
+          await fetchWithErrorHandling({
+            url: CHAINID_NETWORK_URL,
+            timeout: 10000,
+          });
+
+        if (chains && Array.isArray(chains)) {
+          this.#chainIdCache = new Map(
+            chains
+              .filter(
+                (chain): chain is ChainIdNetworkEntry & { slip44: number } =>
+                  chain.slip44 !== undefined,
+              )
+              .map((chain) => [chain.chainId, chain.slip44]),
+          );
+        } else {
+          // Invalid response, initialize empty cache
+          this.#chainIdCache = new Map();
+        }
+      } catch {
+        // Network failed, initialize empty cache so we fall back to symbol lookup
+        this.#chainIdCache = new Map();
+      }
+    })();
+
+    await this.#fetchPromise;
+    this.#fetchPromise = null;
+  }
+
+  /**
+   * Gets the SLIP-44 coin type identifier for an EVM network by chain ID.
+   *
+   * **IMPORTANT: This method is for EVM networks only (eip155 namespace).**
+   * For non-EVM networks (Bitcoin, Solana, Tron, etc.), use `getSlip44BySymbol`.
+   *
+   * This method checks chainid.network data (which maps chainId directly
+   * to slip44). If not found, defaults to 60 (Ethereum).
+   *
+   * @param chainId - The EVM chain ID as a number (e.g., 1 for Ethereum, 56 for BNB Chain)
+   * @returns The SLIP-44 coin type number (defaults to 60 if not found)
+   * @example
+   * ```typescript
+   * // For EVM networks only
+   * const ethCoinType = await Slip44Service.getEvmSlip44(1);
+   * // Returns 60
+   *
+   * const bnbCoinType = await Slip44Service.getEvmSlip44(56);
+   * // Returns 714
+   *
+   * const unknownEvmChain = await Slip44Service.getEvmSlip44(99999);
+   * // Returns 60 (default for EVM)
+   * ```
+   */
+  static async getEvmSlip44(chainId: number): Promise<number> {
+    // Ensure chain data is loaded
+    await this.#fetchChainData();
+
+    // Check chainId cache first
+    const cached = this.#chainIdCache?.get(chainId);
+    if (cached !== undefined) {
+      return cached;
+    }
+
+    // Default to 60 (Ethereum) for EVM networks without specific mapping
+    return 60;
+  }
+
+  /**
+   * Gets the SLIP-44 coin type identifier for a non-EVM network by symbol.
+   *
+   * **IMPORTANT: This method is for non-EVM networks only (Bitcoin, Solana, Tron, etc.).**
+   * For EVM networks (eip155 namespace), use `getEvmSlip44` instead.
+   *
+   * Note: Symbol lookup may return incorrect results for duplicate symbols
+   * (e.g., CPC is both CPChain and Capricoin).
+   *
+   * @param symbol - The network symbol (e.g., 'ETH', 'BTC', 'SOL')
+   * @returns The SLIP-44 coin type number, or undefined if not found
+   * @example
+   * ```typescript
+   * const ethCoinType = Slip44Service.getSlip44BySymbol('ETH');
+   * // Returns 60
+   *
+   * const btcCoinType = Slip44Service.getSlip44BySymbol('BTC');
+   * // Returns 0
+   * ```
+   */
+  static getSlip44BySymbol(symbol: string): number | undefined {
+    // Check cache first
+    if (this.#symbolCache.has(symbol)) {
+      return this.#symbolCache.get(symbol);
+    }
+
+    const slip44Data = slip44 as Slip44Data;
+    const upperSymbol = symbol.toUpperCase();
+
+    // Iterate through all entries to find matching symbol
+    // Note: Object.keys returns numeric keys in ascending order,
+    // so for duplicate symbols we get the lowest coin type first
+    // (which is the convention for resolving duplicates)
+    for (const key of Object.keys(slip44Data)) {
+      const entry = slip44Data[key];
+      if (entry.symbol.toUpperCase() === upperSymbol) {
+        const coinType = parseInt(key, 10);
+        this.#symbolCache.set(symbol, coinType);
+        return coinType;
+      }
+    }
+
+    // Cache the miss as well to avoid repeated lookups
+    this.#symbolCache.set(symbol, undefined);
+    return undefined;
+  }
+
+  /**
+   * Clears all internal caches.
+   * Useful for testing or if the underlying data might change.
+   */
+  static clearCache(): void {
+    this.#symbolCache.clear();
+    this.#chainIdCache = null;
+    this.#fetchPromise = null;
+  }
+}
diff --git a/src/services/index.ts b/src/services/index.ts
new file mode 100644
index 0000000000000000000000000000000000000000..5d87168f7ff21cac8a8ed82010864f9000eddffb
--- /dev/null
+++ b/src/services/index.ts
@@ -0,0 +1,10 @@
+import { Slip44Service } from './Slip44Service';
+
+export { Slip44Service };
+
+// Re-export static methods as standalone functions for convenience
+// getEvmSlip44: For EVM networks (eip155) - uses chainId lookup, defaults to 60
+export const getEvmSlip44 = Slip44Service.getEvmSlip44.bind(Slip44Service);
+// getSlip44BySymbol: For non-EVM networks (Bitcoin, Solana, Tron) - uses symbol lookup
+export const getSlip44BySymbol =
+  Slip44Service.getSlip44BySymbol.bind(Slip44Service);
diff --git a/src/utils.test.ts b/src/utils.test.ts
new file mode 100644
index 0000000000000000000000000000000000000000..ed975ab5641e54c6a7b07070e5fcd65f1dc194ed
--- /dev/null
+++ b/src/utils.test.ts
@@ -0,0 +1,292 @@
+import { KnownCaipNamespace } from '@metamask/utils';
+
+import type { NetworkEnablementControllerState } from './NetworkEnablementController';
+import {
+  deriveKeys,
+  isOnlyNetworkEnabledInNamespace,
+  isPopularNetwork,
+} from './utils';
+
+describe('Utils', () => {
+  describe('deriveKeys', () => {
+    describe('EVM networks', () => {
+      it('derives keys from hex chain ID', () => {
+        const result = deriveKeys('0x1');
+
+        expect(result).toStrictEqual({
+          namespace: 'eip155',
+          storageKey: '0x1',
+          caipChainId: 'eip155:1',
+          reference: '1',
+        });
+      });
+
+      it('derives keys from CAIP chain ID with decimal reference', () => {
+        const result = deriveKeys('eip155:1');
+
+        expect(result).toStrictEqual({
+          namespace: 'eip155',
+          storageKey: '0x1',
+          caipChainId: 'eip155:1',
+          reference: '1',
+        });
+      });
+
+      it('derives keys from CAIP chain ID with large decimal reference', () => {
+        const result = deriveKeys('eip155:42161');
+
+        expect(result).toStrictEqual({
+          namespace: 'eip155',
+          storageKey: '0xa4b1',
+          caipChainId: 'eip155:42161',
+          reference: '42161',
+        });
+      });
+    });
+
+    describe('non-EVM networks', () => {
+      it('derives keys from Solana CAIP chain ID', () => {
+        const result = deriveKeys('solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp');
+
+        expect(result).toStrictEqual({
+          namespace: 'solana',
+          storageKey: 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+          caipChainId: 'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+          reference: '5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+        });
+      });
+
+      it('derives keys from Bitcoin CAIP chain ID', () => {
+        const result = deriveKeys('bip122:000000000019d6689c085ae165831e93');
+
+        expect(result).toStrictEqual({
+          namespace: 'bip122',
+          storageKey: 'bip122:000000000019d6689c085ae165831e93',
+          caipChainId: 'bip122:000000000019d6689c085ae165831e93',
+          reference: '000000000019d6689c085ae165831e93',
+        });
+      });
+    });
+  });
+
+  describe('isOnlyNetworkEnabledInNamespace', () => {
+    const createMockState = (
+      enabledNetworkMap: NetworkEnablementControllerState['enabledNetworkMap'],
+    ): NetworkEnablementControllerState => ({
+      enabledNetworkMap,
+      nativeAssetIdentifiers: {},
+    });
+
+    describe('EVM namespace scenarios', () => {
+      it('returns true when network is the only enabled EVM network (hex chain ID)', () => {
+        const state = createMockState({
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': true,
+            '0xa': false,
+            '0xa4b1': false,
+          },
+        });
+
+        const derivedKeys = deriveKeys('0x1');
+        const result = isOnlyNetworkEnabledInNamespace(state, derivedKeys);
+
+        expect(result).toBe(true);
+      });
+
+      it('returns true when network is the only enabled EVM network (CAIP chain ID)', () => {
+        const state = createMockState({
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': true,
+            '0xa': false,
+            '0xa4b1': false,
+          },
+        });
+
+        const derivedKeys = deriveKeys('eip155:1');
+        const result = isOnlyNetworkEnabledInNamespace(state, derivedKeys);
+
+        expect(result).toBe(true);
+      });
+
+      it('returns false when there are multiple enabled EVM networks', () => {
+        const state = createMockState({
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': true,
+            '0xa': true,
+            '0xa4b1': false,
+          },
+        });
+
+        const derivedKeys = deriveKeys('0x1');
+        const result = isOnlyNetworkEnabledInNamespace(state, derivedKeys);
+
+        expect(result).toBe(false);
+      });
+
+      it('returns false when no EVM networks are enabled', () => {
+        const state = createMockState({
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': false,
+            '0xa': false,
+            '0xa4b1': false,
+          },
+        });
+
+        const derivedKeys = deriveKeys('0x1');
+        const result = isOnlyNetworkEnabledInNamespace(state, derivedKeys);
+
+        expect(result).toBe(false);
+      });
+
+      it('returns false when target network is not the only enabled one', () => {
+        const state = createMockState({
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': false,
+            '0xa': true,
+            '0xa4b1': false,
+          },
+        });
+
+        const derivedKeys = deriveKeys('0x1');
+        const result = isOnlyNetworkEnabledInNamespace(state, derivedKeys);
+
+        expect(result).toBe(false);
+      });
+    });
+
+    describe('Solana namespace scenarios', () => {
+      it('returns true when network is the only enabled Solana network', () => {
+        const state = createMockState({
+          [KnownCaipNamespace.Solana]: {
+            'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp': true,
+            'solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z': false,
+          },
+        });
+
+        const derivedKeys = deriveKeys(
+          'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+        );
+        const result = isOnlyNetworkEnabledInNamespace(state, derivedKeys);
+
+        expect(result).toBe(true);
+      });
+
+      it('returns false when there are multiple enabled Solana networks', () => {
+        const state = createMockState({
+          [KnownCaipNamespace.Solana]: {
+            'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp': true,
+            'solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z': true,
+          },
+        });
+
+        const derivedKeys = deriveKeys(
+          'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+        );
+        const result = isOnlyNetworkEnabledInNamespace(state, derivedKeys);
+
+        expect(result).toBe(false);
+      });
+
+      it('returns false when no Solana networks are enabled', () => {
+        const state = createMockState({
+          [KnownCaipNamespace.Solana]: {
+            'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp': false,
+            'solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z': false,
+          },
+        });
+
+        const derivedKeys = deriveKeys(
+          'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+        );
+        const result = isOnlyNetworkEnabledInNamespace(state, derivedKeys);
+
+        expect(result).toBe(false);
+      });
+
+      it('returns false when target network is not the only enabled one', () => {
+        const state = createMockState({
+          [KnownCaipNamespace.Solana]: {
+            'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp': false,
+            'solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z': true,
+          },
+        });
+
+        const derivedKeys = deriveKeys(
+          'solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp',
+        );
+        const result = isOnlyNetworkEnabledInNamespace(state, derivedKeys);
+
+        expect(result).toBe(false);
+      });
+    });
+
+    describe('Non-existent namespace scenarios', () => {
+      it('returns false when namespace does not exist', () => {
+        const state = createMockState({});
+
+        const derivedKeys = deriveKeys('0x1');
+        const result = isOnlyNetworkEnabledInNamespace(state, derivedKeys);
+
+        expect(result).toBe(false);
+      });
+
+      it('returns false when namespace exists but is empty', () => {
+        const state = createMockState({
+          [KnownCaipNamespace.Eip155]: {},
+        });
+
+        const derivedKeys = deriveKeys('0x1');
+        const result = isOnlyNetworkEnabledInNamespace(state, derivedKeys);
+
+        expect(result).toBe(false);
+      });
+    });
+
+    describe('Cross-format compatibility', () => {
+      it('should return consistent results for hex and CAIP formats of the same network', () => {
+        const state = createMockState({
+          [KnownCaipNamespace.Eip155]: {
+            '0x1': true,
+            '0xa': false,
+            '0xa4b1': false,
+          },
+        });
+
+        const hexKeys = deriveKeys('0x1');
+        const hexResult = isOnlyNetworkEnabledInNamespace(state, hexKeys);
+
+        const caipKeys = deriveKeys('eip155:1');
+        const caipResult = isOnlyNetworkEnabledInNamespace(state, caipKeys);
+
+        expect(hexResult).toBe(true);
+        expect(caipResult).toBe(true);
+        expect(hexResult).toBe(caipResult);
+      });
+    });
+  });
+
+  describe('isPopularNetwork', () => {
+    it('returns true for popular EVM networks', () => {
+      // Test with Ethereum mainnet (chain ID 1)
+      expect(isPopularNetwork('1')).toBe(true);
+
+      // Test with Polygon mainnet (chain ID 137)
+      expect(isPopularNetwork('137')).toBe(true);
+    });
+
+    it('returns false for non-popular EVM networks', () => {
+      // Test with a custom/test network
+      expect(isPopularNetwork('999999')).toBe(false);
+    });
+
+    it('returns false for non-decimal references (like Bitcoin hashes)', () => {
+      // Test with Bitcoin block hash reference
+      expect(isPopularNetwork('000000000019d6689c085ae165831e93')).toBe(false);
+    });
+
+    it('returns false for invalid references', () => {
+      // Test with completely invalid reference
+      expect(isPopularNetwork('invalid-reference')).toBe(false);
+    });
+  });
+});
diff --git a/src/utils.ts b/src/utils.ts
new file mode 100644
index 0000000000000000000000000000000000000000..09973e01120a13796b5d6fcc93704c2ece349a06
--- /dev/null
+++ b/src/utils.ts
@@ -0,0 +1,103 @@
+import { toHex } from '@metamask/controller-utils';
+import { toEvmCaipChainId } from '@metamask/multichain-network-controller';
+import type { CaipChainId, CaipNamespace, Hex } from '@metamask/utils';
+import {
+  isCaipChainId,
+  isHexString,
+  KnownCaipNamespace,
+  parseCaipChainId,
+} from '@metamask/utils';
+
+import { POPULAR_NETWORKS } from './constants';
+import type { NetworkEnablementControllerState } from './NetworkEnablementController';
+
+/**
+ * Represents the parsed keys derived from a chain ID.
+ */
+export type DerivedKeys = {
+  namespace: CaipNamespace;
+  storageKey: Hex | CaipChainId;
+  caipChainId: CaipChainId;
+  reference: string;
+};
+
+/**
+ * Derives the namespace, storage key, and CAIP chain ID from a given chain ID.
+ *
+ * This utility function handles the conversion between different chain ID formats.
+ * For EVM networks, it converts Hex chain IDs to CAIP-2 format and determines
+ * the appropriate storage key. For non-EVM networks, it parses the CAIP-2 chain ID
+ * and uses the full chain ID as the storage key.
+ *
+ * @param chainId - The chain ID to derive keys from (Hex or CAIP-2 format)
+ * @returns An object containing namespace, storageKey, and caipId
+ * @throws Error if the chain ID cannot be parsed
+ */
+export function deriveKeys(chainId: Hex | CaipChainId): DerivedKeys {
+  const caipChainId = isCaipChainId(chainId)
+    ? chainId
+    : toEvmCaipChainId(chainId);
+
+  const { namespace, reference } = parseCaipChainId(caipChainId);
+  let storageKey;
+  if (namespace === (KnownCaipNamespace.Eip155 as string)) {
+    storageKey = isHexString(chainId) ? chainId : toHex(reference);
+  } else {
+    storageKey = caipChainId;
+  }
+  return { namespace, storageKey, caipChainId, reference };
+}
+
+/**
+ * Checks if the specified network is the only enabled network in its namespace.
+ *
+ * This function is used to prevent unnecessary state updates when trying to enable
+ * This method is used to prevent the last network in a namespace from being removed.
+ *
+ * @param state - The current controller state
+ * @param derivedKeys - The parsed keys object containing namespace and storageKey
+ * @returns True if the network is the only enabled network in the namespace, false otherwise
+ */
+export function isOnlyNetworkEnabledInNamespace(
+  state: NetworkEnablementControllerState,
+  derivedKeys: DerivedKeys,
+): boolean {
+  const { namespace, storageKey } = derivedKeys;
+
+  // Early return if namespace doesn't exist
+  if (!state.enabledNetworkMap[namespace]) {
+    return false;
+  }
+
+  const networks = state.enabledNetworkMap[namespace];
+
+  // Get all enabled networks in this namespace
+  const enabledNetworks = Object.entries(networks).filter(
+    ([_, enabled]) => enabled,
+  );
+
+  // Check if there's exactly one enabled network and it matches our target
+  if (enabledNetworks.length === 1) {
+    const [onlyEnabledKey] = enabledNetworks[0];
+    return onlyEnabledKey === storageKey;
+  }
+
+  // Return false if there are zero or multiple enabled networks
+  return false;
+}
+
+/**
+ * Checks if a network is considered popular based on its reference.
+ *
+ * @param reference - The network reference (typically the chain ID reference part)
+ * @returns True if the network is popular, false otherwise
+ */
+export function isPopularNetwork(reference: string): boolean {
+  try {
+    return POPULAR_NETWORKS.includes(toHex(reference));
+  } catch {
+    // If toHex fails (e.g., for non-decimal references like Bitcoin hashes),
+    // the network is not popular
+    return false;
+  }
+}
diff --git a/tsconfig.build.json b/tsconfig.build.json
new file mode 100644
index 0000000000000000000000000000000000000000..11328a92b9425fb46a2c91ceb1a7c9d8d08c28af
--- /dev/null
+++ b/tsconfig.build.json
@@ -0,0 +1,17 @@
+{
+  "extends": "../../tsconfig.packages.build.json",
+  "compilerOptions": {
+    "baseUrl": "./",
+    "outDir": "./dist",
+    "rootDir": "./src"
+  },
+  "references": [
+    { "path": "../base-controller/tsconfig.build.json" },
+    { "path": "../network-controller/tsconfig.build.json" },
+    { "path": "../multichain-network-controller/tsconfig.build.json" },
+    { "path": "../controller-utils/tsconfig.build.json" },
+    { "path": "../transaction-controller/tsconfig.build.json" },
+    { "path": "../messenger/tsconfig.build.json" }
+  ],
+  "include": ["../../types", "./src"]
+}
diff --git a/tsconfig.build.tsbuildinfo b/tsconfig.build.tsbuildinfo
new file mode 100644
index 0000000000000000000000000000000000000000..8dc1b43e87686a2a9e1ce52da7b4d16f9c6eea5c
--- /dev/null
+++ b/tsconfig.build.tsbuildinfo
@@ -0,0 +1 @@
+{"version":"5.3.3"}
\ No newline at end of file
diff --git a/tsconfig.json b/tsconfig.json
new file mode 100644
index 0000000000000000000000000000000000000000..e1ebf3853354438b344041461f9518d0f00db588
--- /dev/null
+++ b/tsconfig.json
@@ -0,0 +1,16 @@
+{
+  "extends": "../../tsconfig.packages.json",
+  "compilerOptions": {
+    "baseUrl": "./",
+    "rootDir": "../.."
+  },
+  "references": [
+    { "path": "../base-controller" },
+    { "path": "../network-controller" },
+    { "path": "../multichain-network-controller" },
+    { "path": "../controller-utils" },
+    { "path": "../transaction-controller" },
+    { "path": "../messenger" }
+  ],
+  "include": ["../../types", "./src"]
+}
diff --git a/typedoc.json b/typedoc.json
new file mode 100644
index 0000000000000000000000000000000000000000..c9da015dbf8a0e0e3d39dd61f7c0386efac96ddc
--- /dev/null
+++ b/typedoc.json
@@ -0,0 +1,7 @@
+{
+  "entryPoints": ["./src/index.ts"],
+  "excludePrivate": true,
+  "hideGenerator": true,
+  "out": "docs",
+  "tsconfig": "./tsconfig.build.json"
+}

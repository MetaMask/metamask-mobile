---
globs: "**/*"
alwaysApply: true
---

# Feature Flag Guidelines

## Core Principle

**ALWAYS** use the `useFeatureFlag` hook instead of creating new feature flag selectors.

## Forbidden Patterns

### ❌ NEVER Create New Feature Flag Selectors

**DO NOT** create new selectors using `createSelector` for feature flags:

```typescript
// ❌ FORBIDDEN - Do not create new feature flag selectors
export const selectMyFeatureEnabledFlag = createSelector(
  selectRemoteFeatureFlags,
  (remoteFeatureFlags) => {
    // ... selector logic
  },
);
```

**DO NOT** add new feature flag selectors in:
- `app/selectors/featureFlagController/**/*.ts`
- `app/components/**/selectors/featureFlags/**/*.ts`
- Any other location that creates feature flag selectors

## Required Pattern

### ✅ ALWAYS Use the `useFeatureFlag` Hook

**MUST** use the `useFeatureFlag` hook from `app/components/hooks/FeatureFlags/useFeatureFlag.ts`:

```typescript
// ✅ REQUIRED - Use the hook instead
import { useFeatureFlag, FeatureFlagNames } from '../../../hooks/FeatureFlags/useFeatureFlag';

const MyComponent = () => {
  const isFeatureEnabled = useFeatureFlag(FeatureFlagNames.rewardsEnabled);
  
  // Use the flag value
  if (isFeatureEnabled) {
    // ... feature logic
  }
};
```

## Steps to Use Feature Flags

1. **Add the flag name** to the `FeatureFlagNames` enum in `app/components/hooks/FeatureFlags/useFeatureFlag.ts`:
   ```typescript
   export enum FeatureFlagNames {
     rewardsEnabled = 'rewardsEnabled',
     myNewFeature = 'myNewFeature', // Add your new flag here
   }
   ```

2. **Use the hook** in your component:
   ```typescript
   const isMyFeatureEnabled = useFeatureFlag(FeatureFlagNames.myNewFeature);
   ```

3. **Do NOT** create a selector for the feature flag

## Migration Pattern

If you encounter existing feature flag selectors, prefer migrating to the hook:

```typescript
// ❌ Old pattern (existing code - do not replicate)
const isFeatureEnabled = useSelector(selectMyFeatureEnabledFlag);

// ✅ New pattern (use this instead)
const isFeatureEnabled = useFeatureFlag(FeatureFlagNames.myNewFeature);
```

## Enforcement

- **REJECT** any code that creates new `createSelector` instances for feature flags
- **REJECT** any new files in `app/selectors/featureFlagController/` directories
- **REQUIRE** use of `useFeatureFlag` hook for all feature flag access
- **REQUIRE** adding flag names to `FeatureFlagNames` enum before use

## Exception

The only exception is the base selector `selectRemoteFeatureFlags` in `app/selectors/featureFlagController/index.ts`, which is used internally by the `useFeatureFlag` hook infrastructure.
